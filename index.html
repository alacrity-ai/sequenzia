<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sequenzia</title>
  <!-- Tailwind via CDN -->
  <link rel="stylesheet" href="./css/styles.css" />
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
  <link rel="icon" href="/favicon.ico" type="image/x-icon" />
</head>


<body class="bg-black text-gray-200 font-sans pb-36">
  <!-- Modal Mount -->
  <div id="modal-mount-root" class="content-hidden"></div>
  <div id="content-main" class="flex flex-col items-center mt-10 space-y-6 content-hidden">
    <!-- MAIN CONTAINER -->
    <div class="flex flex-col w-[1260px] space-y-4 relative">

      <!-- Interactive Piano -->
      <div id="top-controls-container" class="flex items-start gap-2">
        <!-- Piano/Mixer/AI Menus Injected Here -->
      </div>

      <!-- Waveform Visualizer + Mode Button -->
      <div id="visualizer-container" class="flex items-start gap-2">
        <!-- Visualizer Injected Here -->
      </div>

      <!-- Sequencer Container -->
      <div id="sequencers-container" class="flex flex-col space-y-4 mb-[320px]">
        <!-- individual sequencers will be injected here -->
        <button id="add-sequencer" class="self-end px-3 py-1 bg-green-600 rounded" style="cursor: pointer;">ï¼‹ Add Track</button>
      </div>
    </div>
  </div>

  <div id="footer-main" class="fixed bottom-0 left-0 right-0 z-40 content-hidden">
    <!--- Global Controls Injected Here -->
  </div>

  <!-- Load Modals and Icons -->
  <script type="module">
    (async () => {
      async function loadHTML(id, url) {
        const res = await fetch(url);
        const html = await res.text();
        const container = document.getElementById(id);
        container.insertAdjacentHTML('beforeend', html);
      }

      // Load icons first
      await loadHTML('modal-mount-root', './web/icons/icons.html');
      
      // Then load modals
      await loadHTML('modal-mount-root', 'web/modals/delete-confirm-modal.html');
      await loadHTML('modal-mount-root', 'web/modals/ai-extend-modal.html');
      await loadHTML('modal-mount-root', 'web/modals/ai-inpaint-modal.html');
      await loadHTML('modal-mount-root', 'web/modals/ai-generate-modal.html');
      await loadHTML('modal-mount-root', 'web/modals/openai-key-not-set.html');
      await loadHTML('modal-mount-root', 'web/modals/ai-generation-failed-modal.html');
      await loadHTML('modal-mount-root', 'web/modals/ai-working-modal.html');
      await loadHTML('modal-mount-root', 'web/modals/instrument-select-modal.html');

      // Only load the app after modals and icons are present
      await import('/src/main.js');
    })();
  </script>

</body>
</html>
