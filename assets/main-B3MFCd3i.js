const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/extendTracks-DT-G6MF-.js","assets/index-B_TdcBEa.js"])))=>i.map(i=>d[i]);
import{_ as gs}from"./index-B_TdcBEa.js";function aa(e){const i=e.startsWith("/")?e.substring(1):e;return(window.location.pathname.startsWith("/sequenzia")?"/sequenzia/":"./")+i}function vs(){const e=document.getElementById("splash-modal"),i=document.getElementById("splash-logo");i&&(i.src=aa("static/logo.png")),e==null||e.classList.remove("hidden")}function Ss(e=1e3){const i=document.getElementById("splash-modal"),t=document.getElementById("footer-main"),a=document.getElementById("content-main");i&&setTimeout(()=>{i.style.opacity="0",i.style.transition="opacity 0.5s ease-out",setTimeout(()=>{i.classList.add("hidden"),i.style.opacity="1",t&&(t.classList.remove("content-hidden"),t.classList.add("content-visible")),a&&(a.classList.remove("content-hidden"),a.classList.add("content-visible"))},500)},e)}function Ns(){const e=document.getElementById("splash-modal");return e?!e.classList.contains("hidden"):!1}const Bs="v0.0.7",Cs="April 29, 2025",Gs=["✨ New Features","- 🎹 Added support for WebAudioFont (1000+ new instruments)","- 📥 Added MIDI export and import functionality","- ⚙️ Introduced display customization in Userconfig (note styles, grid color schemes)","- 🎞️ Added animated notes during playback and editing","- 📐 Adjustable sequencer height per track","🐞 Known Issues","- 🚫 WebAudioFont audio export is currently silent","🛣️ Roadmap","- 🔊 Upcoming: velocity support and per-note volume control","- 🧠 Upcoming: AI-assisted generation and extension tools"];function Ls(){const e=document.getElementById("whats-new-modal"),i=e==null?void 0:e.querySelector("ul"),t=document.getElementById("whats-new-metadata"),a=e==null?void 0:e.querySelector("img");if(e&&i&&t){i.innerHTML="",t.textContent=`${Bs} — Updated ${Cs}`,a&&(a.src=aa("static/logo.png"));let s=null;for(const r of Gs)if(r.startsWith("✨")||r.startsWith("🐞")||r.startsWith("🛣️")){const n=document.createElement("li");n.textContent=r,n.classList.add("font-bold","mt-6","text-lg"),i.appendChild(n),s=document.createElement("ul"),s.classList.add("list-disc","list-inside","ml-6","mt-2","space-y-1"),i.appendChild(s)}else if(s){const n=document.createElement("li");n.textContent=r.replace(/^- /,""),s.appendChild(n)}e.classList.remove("hidden")}}function Ms(){const e=document.getElementById("whats-new-modal");e&&(e.style.opacity="0",e.style.transition="opacity 0.4s ease-out",setTimeout(()=>{e.classList.add("hidden"),e.style.opacity="1"},400))}var ra;(ra=document.getElementById("whats-new-close-btn"))==null||ra.addEventListener("click",Ms);function ws(){var e;(e=document.getElementById("footer-whats-new-btn"))==null||e.addEventListener("click",Ls)}function Es(){const e=document.getElementById("footer-help-btn");e&&e.addEventListener("click",()=>{window.open("https://github.com/alacrity-ai/sequenzia","_blank")})}function at(e=3){const r=["C","D","E","F","G","A","B"],n=["C#","D#","","F#","G#","A#",""],o=[e,e+1,e+2],d={};let c=0;for(const l of o)r.forEach(u=>{const _=`${u}${l}`;d[_]={note:_,x:c,width:60,height:200,isBlack:!1},c+=60});c=0;for(const l of o)n.forEach((u,_)=>{if(u===""){c+=60;return}const f=`${u}${l}`;d[f]={note:f,x:c+60-40/2,width:40,height:120,isBlack:!0},c+=60});return d}function ri(e,i,t=new Set,a=null){e.clearRect(0,0,e.canvas.width,e.canvas.height);const s={};if(a)for(const[r,n]of Object.entries(a))s[n]=r;for(const r of Object.values(i))r.isBlack||(pr(e,{...r,fill:t.has(r.note)?"#cce0ff":"#ffffff",stroke:"#333",radius:6}),e.fillStyle="#333",e.font="12px sans-serif",e.textAlign="center",s[r.note]&&(e.fillStyle="#7c3aed",e.fillText(s[r.note],r.x+r.width/2,r.height-24),e.fillStyle="#333"),e.fillText(r.note,r.x+r.width/2,r.height-8));for(const r of Object.values(i))r.isBlack&&(pr(e,{...r,fill:t.has(r.note)?"#4a60ff":"#111111",stroke:"#000000",radius:4}),Fs(e,r),s[r.note]&&(e.fillStyle="#c084fc",e.font="10px sans-serif",e.textAlign="center",e.fillText(s[r.note],r.x+r.width/2,r.height-28)))}function pr(e,i){const{x:t,width:a,height:s,fill:r,stroke:n,radius:o=8}=i;e.beginPath(),e.moveTo(t,0),e.lineTo(t,s-o),e.quadraticCurveTo(t,s,t+o,s),e.lineTo(t+a-o,s),e.quadraticCurveTo(t+a,s,t+a,s-o),e.lineTo(t+a,0),e.closePath(),e.fillStyle=r,e.fill(),e.strokeStyle=n,e.lineWidth=1,e.stroke()}function Fs(e,i){const t=e.createLinearGradient(i.x,0,i.x,i.height);t.addColorStop(0,"rgba(255,255,255,0.2)"),t.addColorStop(.3,"rgba(255,255,255,0)"),e.fillStyle=t,e.beginPath(),e.moveTo(i.x,0),e.lineTo(i.x+i.width,0),e.lineTo(i.x+i.width,i.height*.4),e.lineTo(i.x,i.height*.4),e.closePath(),e.fill()}const Q={cellWidth:40,cellHeight:20,visibleNotes:36,noteRange:["C1","B9"],currentDuration:1,snapResolution:1,isTripletMode:!1,loopEnabled:!1,useEqualTemperament:!0},se=64,Ps={C:"#FF0000","C#":"#9400D3",D:"#FFFF00","D#":"#FF69B4",E:"#0000FF",F:"#00FF00","F#":"#87CEFA",G:"#FFA500","G#":"#800080",A:"#2E8B57","A#":"#FFB6C1",B:"#4B0082"},ks={4:"𝅝",2:"𝅗𝅥",1:"𝅘𝅥","0.5":"♪","0.25":"♬","0.125":"𝅘𝅥𝅰"},yr={Digit1:4,Digit2:2,Digit3:1,Digit4:.5,Digit5:.25,Digit6:.125},Ri=[{cellWidth:20,cellHeight:10},{cellWidth:30,cellHeight:15},{cellWidth:40,cellHeight:20},{cellWidth:60,cellHeight:25},{cellWidth:80,cellHeight:30}],sa={openaiApiKey:"",openaiModel:"gpt-4o",gridColorScheme:"Darkroom",noteColorScheme:"Track Color"};function li(){return sa}function wi(e){Object.assign(sa,e)}function As(){const e=li();localStorage.setItem("userConfig",JSON.stringify(e))}function Is(){const e=localStorage.getItem("userConfig");if(e)try{const i=JSON.parse(e);wi(i)}catch(i){console.error("Failed to parse userConfig from localStorage:",i)}}Is();const mr=["gpt-4o","gpt-4o-mini","gpt-4.1","gpt-4.1-mini","o3-mini","o4-mini"];function St(){return li().openaiApiKey}function hr(){return li().openaiModel}function Os(e){wi({openaiApiKey:e})}function Rs(e){if(!mr.includes(e))throw new Error(`Invalid model: ${e}. Must be one of: ${mr.join(", ")}`);wi({openaiModel:e})}function Ts(){var s;const e=document.getElementById("openai-key-input"),i=document.getElementById("openai-model-select"),t=document.getElementById("config-save"),a=document.querySelectorAll("#config-close, #config-close-bottom");e.value=St(),i.value=hr(),t.addEventListener("click",()=>{var r;Os(e.value),Rs(i.value),As(),(r=document.getElementById("userconfig-modal"))==null||r.classList.add("hidden")}),a.forEach(r=>{r.addEventListener("click",()=>{var n;e.value=St(),i.value=hr(),(n=document.getElementById("userconfig-modal"))==null||n.classList.add("hidden")})}),(s=document.getElementById("key-not-set-ok"))==null||s.addEventListener("click",()=>{var r;(r=document.getElementById("openai-key-not-set-modal"))==null||r.classList.add("hidden")})}function Us(e,i){return e/i()}function na(e,i){const t=i.snapResolution||.25,a=i.isTripletMode?t*(2/3):t;return Math.round(e/a)*a}function Ds(e,i,t){const a=Us(e,t);return na(a,i)}const Js={C:0,"C#":1,Db:1,D:2,"D#":3,Eb:3,E:4,Fb:4,"E#":5,F:5,"F#":6,Gb:6,G:7,"G#":8,Ab:8,A:9,"A#":10,Bb:10,B:11,Cb:11,"B#":0};function F(e){const i=e==null?void 0:e.match(/^([A-Ga-g])([#b]*)(-?\d+)$/);if(!i)return null;const[,t,a,s]=i,r=t.toUpperCase(),n=Js[r];if(n===void 0)return null;const o=[...a].reduce((c,l)=>l==="#"?c+1:l==="b"?c-1:c,0);return 12*(parseInt(s,10)+1)+(n+o)}const xs=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],qs=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"];function we(e,i=!1){const a=(i?qs:xs)[e%12],s=Math.floor(e/12)-1;return`${a}${s}`}function Hs(e){return e.replace(/\d+$/,"")}function $s(e){return e.includes("#")}function la(e,i,t,a,s,r=4){e.beginPath(),e.moveTo(i+r,t),e.lineTo(i+a-r,t),e.quadraticCurveTo(i+a,t,i+a,t+r),e.lineTo(i+a,t+s-r),e.quadraticCurveTo(i+a,t+s,i+a-r,t+s),e.lineTo(i+r,t+s),e.quadraticCurveTo(i,t+s,i,t+s-r),e.lineTo(i,t+r),e.quadraticCurveTo(i,t,i+r,t),e.closePath()}function Ks(e,i){const t=structuredClone(e);return t.tempo=i.bpm,t}function oa(e){return{type:"CHANGE_TEMPO",bpm:e}}function Ws(e){return oa(e)}function zs(e,i){const t=structuredClone(e);return t.timeSignature=[i.beats,4],t}function da(e){return{type:"SET_TIME_SIGNATURE",beats:e}}function js(e){return da(e)}function Xs(e,i){const t=structuredClone(e);return t.totalMeasures=i.measures,t}function ca(e){return{type:"SET_TOTAL_MEASURES",measures:e}}function Vs(e){return ca(e)}function Ys(e,i){const t=structuredClone(e);if(t.sequencers.push({id:i.id,instrument:i.instrument,notes:i.notes??[]}),!k.find(s=>s.id===i.id)){const s={id:i.id,instrument:i.instrument,notes:i.notes??[]},{wrapper:r}=Ia(s);ki(r,!0)}return t}function ua(e,i){return{type:"CREATE_SEQUENCER",id:e,instrument:i}}function Dt(e){return{type:"DELETE_SEQUENCER",id:e}}function Qs(e,i){const t=structuredClone(e);t.sequencers=t.sequencers.filter(s=>s.id!==i.id);const a=k.findIndex(s=>s.id===i.id);return a!==-1&&(k[a].destroy(),k.splice(a,1)),t}function Zs(e,i,t=[]){return{type:"DELETE_SEQUENCER",id:e,instrument:i,notes:structuredClone(t)}}function en(e,i,t=[]){return{type:"CREATE_SEQUENCER",id:e,instrument:i,notes:structuredClone(t)}}function tn(e,i){const t=structuredClone(e),a=t.sequencers.find(s=>s.id===i.sequencerId);return a&&i.instrument&&(a.instrument=i.instrument),t}function rn(e,i){return{type:"SET_INSTRUMENT",sequencerId:e,instrument:i}}function an(e,i){return{type:"SET_INSTRUMENT",sequencerId:e,instrument:i}}const ai=["#ff006e","#3a86ff","#ffbe0b","#8338ec","#06d6a0","#ef476f","#118ab2","#ffd166","#073b4c","#8ac926"];function br(e){return e<0&&(console.error(`Invalid trackId: ${e}. Using default color.`),e=0),ai[e%ai.length]}function sn(e){return e&&typeof e.colorIndex=="number"?br(e.colorIndex):(console.error(`Invalid sequencer colorIndex: ${e==null?void 0:e.colorIndex}. Using default color.`),br(0))}function si(e,i,t,a=0){const s=e.getContext("2d");if(!s)return;s.imageSmoothingEnabled=!1;const r=e.width,n=e.height;if(s.clearRect(0,0,r,n),!i.length)return;const o=ai[a%ai.length];s.fillStyle=o;const d=K(),c=i.map(m=>F(m.pitch)).filter(m=>m!==null);if(!c.length)return;let l=Math.min(...c),u=Math.max(...c),_=Math.max(1,u-l);for(;n%_!==0;)u++,_=u-l;const f=n/_;for(const m of i){const g=F(m.pitch);if(g==null)continue;const v=m.start/d*r,b=m.duration/d*r,N=(g-l)/_,S=n-N*n-f/2,L=Math.round(v),M=Math.max(1,Math.round(b)),E=Math.round(S);s.fillRect(L,E,M,f)}const p=Fi(),h=Pi();s.save();let y=1;h>256?y=16:h>128?y=8:h>32&&(y=4);for(let m=0;m<=h;m++){if(m%y!==0)continue;const v=m*p/d*r,b=Math.round(v)+.5;s.beginPath(),s.moveTo(b,0),s.lineTo(b,n);const N=y===1||m%(y*2)===0;s.strokeStyle=N?"rgba(255, 255, 255, 0.12)":"rgba(255, 255, 255, 0.04)",s.lineWidth=.2,s.stroke()}s.restore()}function re(e,i){const t=e.getContext("2d");if(!t)return;const a=e.width,s=e.height;t.clearRect(0,0,a,s);const r=K();for(const n of i){const{notes:o,config:d}=n;if(!(o!=null&&o.length))continue;const c=ai[i.indexOf(n)%ai.length];t.fillStyle=c;const l=F(d.noteRange[0]),u=F(d.noteRange[1]);if(l==null||u==null)continue;const _=u-l||1,f=Math.max(2,s/_);for(const p of o){const h=F(p.pitch);if(h==null)continue;const y=p.start/r*a,m=Math.max(1,p.duration/r*a),g=(h-l)/_,v=s-g*s-f/2;t.fillRect(y,v,m,f)}}}function nn(e,i){re(e,i)}function ln(e,i){const t=structuredClone(e),a=t.sequencers.find(r=>r.id===i.sequencerId);if(!a)return e;a.notes.push(...i.notes);const s=document.getElementById("global-mini-contour");return s&&re(s,k),t}function on(e,i){return{type:"PLACE_NOTES",sequencerId:e,notes:structuredClone(i)}}function dn(e,i){return{type:"DELETE_NOTES",sequencerId:e,notes:structuredClone(i)}}function cn(e,i){const t=structuredClone(e),a=t.sequencers.find(n=>n.id===i.sequencerId);if(!a)return e;const s=new Set(i.notes.map(n=>`${n.pitch}|${n.start}|${n.duration}`));a.notes=a.notes.filter(n=>{const o=`${n.pitch}|${n.start}|${n.duration}`;return!s.has(o)});const r=document.getElementById("global-mini-contour");return r&&re(r,k),t}function Jt(e,i){return{type:"DELETE_NOTES",sequencerId:e,notes:structuredClone(i)}}function xt(e,i){return{type:"PLACE_NOTES",sequencerId:e,notes:structuredClone(i)}}function un(e,i){const t=structuredClone(e),a=t.sequencers.find(n=>n.id===i.sequencerId);if(!a)return e;const s=i.from,r=i.to;for(let n=0;n<s.length;n++){const o=s[n],d=r[n],c=a.notes.findIndex(l=>l.pitch===o.pitch&&l.start===o.start&&l.duration===o.duration);c!==-1&&(a.notes[c].pitch=d.pitch,a.notes[c].start=d.start)}return t}function qt(e,i,t){return{type:"MOVE_NOTES",sequencerId:e,from:structuredClone(i),to:structuredClone(t)}}function fa(e,i,t){return qt(e,t,i)}function fn(e,i){const t=structuredClone(e),a=t.sequencers.find(r=>r.id===i.sequencerId);if(!a)return e;const s=new Set(i.notes.map(r=>`${r.pitch}|${r.start}|${r.duration}`));return a.notes=a.notes.filter(r=>{const n=`${r.pitch}|${r.start}|${r.duration}`;return!s.has(n)}),t}function _n(e,i){return{type:"CUT_NOTES",sequencerId:e,notes:structuredClone(i)}}function pn(e,i){return{type:"PLACE_NOTES",sequencerId:e,notes:structuredClone(i)}}function yn(e,i){const t=structuredClone(e),a=t.sequencers.find(s=>s.id===i.sequencerId);return a?(a.notes.push(...i.notes),t):e}function mn(e,i){return{type:"PASTE_NOTES",sequencerId:e,notes:structuredClone(i)}}function hn(e,i){return{type:"DELETE_NOTES",sequencerId:e,notes:structuredClone(i)}}function bn(e,i){return structuredClone(e)}function gn(e,i){const t=structuredClone(e),a=t.sequencers.find(n=>n.id===i.sequencerId);if(!a)return e;const s=i.resizes;for(const n of s){const o=a.notes.find(d=>d.pitch===n.pitch&&d.start===n.start);o&&(o.duration=n.newDuration)}const r=document.getElementById("global-mini-contour");return r&&re(r,k),t}function vn(e,i){return{type:"RESIZE_NOTES",sequencerId:e,resizes:structuredClone(i)}}function Sn(e,i){const t=i.map(a=>({pitch:a.pitch,start:a.start,newDuration:a.oldDuration}));return{type:"RESIZE_NOTES",sequencerId:e,resizes:t}}function Nn(e,i){return structuredClone(e)}function Ht(e=""){return{type:"CHECKPOINT",label:e}}function _a(e=""){return Ht(e)}const Bn=Object.freeze(Object.defineProperty({__proto__:null,CHANGE_TEMPO:Ks,CHECKPOINT:Nn,CREATE_SEQUENCER:Ys,CUT_NOTES:fn,DELETE_NOTES:cn,DELETE_SEQUENCER:Qs,MOVE_NOTES:un,PASTE_NOTES:yn,PLACE_NOTES:ln,RESIZE_NOTES:gn,SET_INSTRUMENT:tn,SET_TIME_SIGNATURE:zs,SET_TOTAL_MEASURES:Xs,UPDATE_NOTE_VELOCITY:bn},Symbol.toStringTag,{value:"Module"}));function $t(e){const i=Bn[e.type];if(!i)throw new Error(`Unknown diff type: ${e.type}`);const t=i(oi(),e);pa(t)}const Nt=new Set;function Cn(e){return Nt.add(e),()=>Nt.delete(e)}function Ei(e){for(const i of Nt)i(e)}const he=[];let ue=-1;const Gn=100;function Ln({forwardDiff:e,reverseDiff:i}){he.splice(ue+1),he.push({forwardDiff:e,reverseDiff:i}),ue=he.length-1,he.length>Gn&&(he.shift(),ue--)}function Mn(){var e;if(ue<0)return null;for(let i=ue;i>=0;i--){const t=he[i];if(((e=t==null?void 0:t.forwardDiff)==null?void 0:e.type)==="CHECKPOINT")return null;if(t!=null&&t.reverseDiff)return ue=i-1,$t(t.reverseDiff),Ei(oi()),t.reverseDiff}return null}function wn(){if(ue>=he.length-1)return null;ue++;const e=he[ue];return!e||!e.forwardDiff?null:($t(e.forwardDiff),Ei(oi()),e.forwardDiff)}function En(){he.length=0,ue=-1}let Vi={tempo:120,timeSignature:[4,4],totalMeasures:8,sequencers:[]};function oi(){return Vi}function pa(e){Vi=structuredClone(e),Ei(Vi)}function H(e,i){$t(e),Ln({forwardDiff:e,reverseDiff:i}),Ei(Vi)}let te=null,ve=500,Se=null,Yi=!1,gr=1/0,Ze=[],Ki=null,ya=0,ma=4,ha=8;function Bt(e){return Ze.push(e),()=>{const i=Ze.indexOf(e);i!==-1&&Ze.splice(i,1)}}function Fn(){Ze=[]}function Ne(e){ya=e}function Qi(){return ya}function K(){return Pi()*Fi()}function Kt(e,i=!0){if(i){const r=qe();H(oa(e),Ws(r));return}const t=performance.now(),a=(t-(Se??t))/ve;ve=60/e*1e3,Se!==null&&(Se=t-a*ve);const s=document.getElementById("tempo-input");s&&s.value!==String(e)&&(s.value=String(e))}function qe(){return 60/(ve/1e3)}function Wt(e,i=!0){if(i){const a=Fi();H(da(e),js(a));return}ma=e;const t=document.getElementById("beats-per-measure-input");t&&t.value!==String(e)&&(t.value=String(e)),Fe().forEach(a=>{var s,r;(s=a.grid)!=null&&s.resizeAndRedraw?a.grid.resizeAndRedraw():(r=a.grid)==null||r.scheduleRedraw()})}function Fi(){return ma}function zt(e,i=!0){if(i){const a=Pi();H(ca(e),Vs(a));return}ha=e;const t=document.getElementById("measures-input");t&&t.value!==String(e)&&(t.value=String(e)),Fe().forEach(a=>{var s;(s=a.grid)==null||s.scheduleRedraw()})}function Pi(){return ha}function Pn(e){Yi=e}function kn(e){Ki=e}function An(){return Q.snapResolution}function In(e,i={}){ve=60/e*1e3,Yi=i.loop??!1,gr=i.endBeat??K();const t=i.startBeat??0;Se=performance.now()-t*ve,Ne(t);const a=i.onLoop;function s(r){const o=(r-(Se??r))/ve;if(Ne(o),Ze.forEach(d=>d(o)),o>=gr)if(Yi)Se=performance.now(),Ne(0),a&&a();else{Zi();return}te=requestAnimationFrame(s)}te=requestAnimationFrame(s)}function Zi(){te!==null&&cancelAnimationFrame(te),te=null,Fn(),Ki&&(Ki(),Ki=null)}function On(){return te!==null}function ba(){te!==null&&cancelAnimationFrame(te),te=null}function ga(){if(te!==null)return;Se=performance.now()-Qi()*ve;function i(t){const s=(t-(Se??t))/ve;if(Ne(s),Ze.forEach(r=>r(s)),s>=K())if(Yi)Se=performance.now(),Ne(0);else{Zi();return}te=requestAnimationFrame(i)}te=requestAnimationFrame(i)}const vr={Midnight:{whiteKey:"#1e1e1e",blackKey:"#2a103b",labelWhite:"#2c2c2c",labelBlack:"#3a1d4d",textWhite:"#cfcfcf",textBlack:"#e6d9ff",gridLine:"#333",beatLine:"#4e3d63",measureLine:"#8561c2"},Seashell:{whiteKey:"#fefefe",blackKey:"#f1e7dc",labelWhite:"#dddddd",labelBlack:"#d4cfc9",textWhite:"#444",textBlack:"#663300",gridLine:"#ccc",beatLine:"#bbb",measureLine:"#999"},Cyberpunk:{whiteKey:"#1b1b2f",blackKey:"#162447",labelWhite:"#1f4068",labelBlack:"#1f4068",textWhite:"#e43f5a",textBlack:"#e43f5a",gridLine:"#1f4068",beatLine:"#e43f5a",measureLine:"#ffcc00"},"Classic Blue":{whiteKey:"#f5faff",blackKey:"#dceeff",labelWhite:"#aaccee",labelBlack:"#88bbdd",textWhite:"#002244",textBlack:"#001122",gridLine:"#99bbdd",beatLine:"#88aacc",measureLine:"#336699"},Darkroom:{whiteKey:"#2c2c2c",blackKey:"#1e1e1e",labelWhite:"#383838",labelBlack:"#2a2a2a",textWhite:"#a0a0a0",textBlack:"#e0e0e0",gridLine:"#404040",beatLine:"#606060",measureLine:"#808080"}},Rn=Array.from({length:47},(e,i)=>35+i),Tn={B1:"kick2",C2:"kick1","C#2":"rim",D2:"snare1","D#2":"clap",E2:"snare2",F2:"lowtom2","F#2":"hh_closed",G2:"lowtom1","G#2":"hh_pedal",A2:"midtom2","A#2":"hh_open",B2:"midtom1",C3:"hitom2","C#3":"crash1",D3:"hitom1","D#3":"ride1",E3:"china",F3:"ride_bell","F#3":"tamb",G3:"splash","G#3":"cowbell",A3:"crash2","A#3":"vibraslap",B3:"ride2",C4:"bongo_hi","C#4":"bongo_lo",D4:"conga_hi_mute","D#4":"conga_hi_open",E4:"conga_lo",F4:"timbale_hi","F#4":"timbale_lo",G4:"agogo_hi","G#4":"agogo_lo",A4:"cabasa","A#4":"maracas",B4:"whistle_short",C5:"whistle_long","C#5":"guiro_short",D5:"guiro_long","D#5":"claves",E5:"woodblock_hi",F5:"woodblock_lo","F#5":"cuica_mute",G5:"cuica_open","G#5":"triangle_mute",A5:"triangle_open"};function Un(e,i,t,a,s,r,n=!1){const{gridColorScheme:o}=li(),d=vr[o]||vr.Darkroom,c=Fi(),l=K(),u=l*a,_=t*s;e.font=`${Math.floor(s*.6)}px sans-serif`,e.textAlign="right",e.textBaseline="middle";for(let f=0;f<t;f++){const p=f*s,h=r(f),y=$s(h);if(e.fillStyle=y?d.blackKey:d.whiteKey,e.fillRect(0,p,u,s),e.fillStyle=y?d.labelBlack:d.labelWhite,e.fillRect(-64,p,se,s),n){const m=Tn[h]||h;e.fillStyle=y?d.textBlack:d.textWhite,e.fillText(m,-8,p+s/2)}else e.fillStyle=y?d.textBlack:d.textWhite,e.fillText(h,-8,p+s/2)}e.strokeStyle=d.gridLine,e.lineWidth=1;for(let f=0;f<t;f++){const p=f*s;e.beginPath(),e.moveTo(0,p),e.lineTo(u,p),e.stroke()}for(let f=0;f<=l;f++){const p=f*a,h=f%c===0;e.strokeStyle=h?d.measureLine:d.beatLine,e.lineWidth=h?2:1,e.beginPath(),e.moveTo(p,0),e.lineTo(p,_),e.stroke()}}const Dn={Scriabin:(e,{getPitchClass:i}={})=>{const t=i?i(e.pitch):0;return Ps[t]||"#999"},"Track Color":(e,{getTrackColor:i}={})=>(i==null?void 0:i())||"#999","Octave Bands":e=>{const i=F(e.pitch);return i==null?"#999":`hsl(${i*3%360}, 100%, 60%)`},"Pitch Class Contrast":(e,{getPitchClass:i}={})=>{const t=F(e.pitch);if(t==null)return"#999";const a=t%12;return["#ff0000","#ff7f00","#ffff00","#7fff00","#00ff00","#00ff7f","#00ffff","#007fff","#0000ff","#7f00ff","#ff00ff","#ff007f"][a]||"#999"}};function Jn(e,i=1){if(e.startsWith("#")){const t=parseInt(e.slice(1),16),a=t>>16&255,s=t>>8&255,r=t&255;return`rgba(${a}, ${s}, ${r}, ${i})`}if(e.startsWith("hsl(")){const[t,a,s]=e.slice(4,-1).split(",").map(d=>parseFloat(d.trim())),[r,n,o]=xn(t,a/100,s/100);return`rgba(${r}, ${n}, ${o}, ${i})`}return e}function xn(e,i,t){const a=(1-Math.abs(2*t-1))*i,s=a*(1-Math.abs(e/60%2-1)),r=t-a/2;let n=0,o=0,d=0;return 0<=e&&e<60?[n,o,d]=[a,s,0]:60<=e&&e<120?[n,o,d]=[s,a,0]:120<=e&&e<180?[n,o,d]=[0,a,s]:180<=e&&e<240?[n,o,d]=[0,s,a]:240<=e&&e<300?[n,o,d]=[s,0,a]:300<=e&&e<360&&([n,o,d]=[a,0,s]),[Math.round((n+r)*255),Math.round((o+r)*255),Math.round((d+r)*255)]}function qn(e,i,{previewNotes:t=null,hoveredNote:a,selectedNote:s,selectedNotes:r=[],highlightedNotes:n=[],cellWidth:o,cellHeight:d,visibleStartBeat:c,visibleEndBeat:l,getPitchRow:u,getPitchClass:_,getTrackColor:f,drawRoundedRect:p}){const{noteColorScheme:y}=li(),m=Dn[y]||(()=>"#999");for(const g of i){if(g.start+g.duration<c-2||g.start>l)continue;const v=g.start*o,b=u(g.pitch)*d,N=g.duration*o,S=d-1,L=m(g,{getPitchClass:_,getTrackColor:f});e.shadowColor="rgba(0,0,0,0.3)",e.shadowBlur=4,e.shadowOffsetX=1,e.shadowOffsetY=2,e.fillStyle=n.includes(g)?"rgba(96, 165, 250, 0.6)":L,p(e,v,b,N,S),e.fill();const M=e.createLinearGradient(v,b,v,b+S);M.addColorStop(0,"rgba(255,255,255,0.4)"),M.addColorStop(.2,"rgba(255,255,255,0.15)"),M.addColorStop(.5,"rgba(255,255,255,0.05)"),M.addColorStop(1,"rgba(255,255,255,0)"),e.shadowColor="transparent",e.fillStyle=M,p(e,v,b,N,S),e.fill();const E=r.includes(g),P=g===a,w=n.includes(g);(E||P||w)&&(e.lineWidth=E?3:2,e.strokeStyle=E?"rgba(0, 255, 255, 1.0)":P?"rgba(255, 255, 255, 0.9)":"rgba(255, 200, 50, 0.7)",p(e,v,b,N,S),e.stroke())}if(t)for(const g of t){const v=g.start*o,b=u(g.pitch)*d,N=g.duration*o,S=d-1,L=m(g,{getPitchClass:_,getTrackColor:f});e.fillStyle=Jn(L,.4),p(e,v,b,N,S),e.fill()}}function Hn(e,i,t,a){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.save(),e.strokeStyle="red",e.lineWidth=2,e.beginPath(),e.moveTo(i+t,0),e.lineTo(i+t,a),e.stroke(),e.restore()}function $n(e,i,t,a=se){const s=e.getBoundingClientRect(),r=parseFloat(e.style.width||`${s.width}`),n=parseFloat(e.style.height||`${s.height}`),o=e.width/r,d=e.height/n,c=(i.clientX-s.left)*o-a,l=(i.clientY-s.top)*d;return{x:c,y:l}}function Kn(e,i,t,a,s,r){const n=Math.floor(i/s),o=e/r;return t.find(d=>o>=d.start&&o<d.start+d.duration&&a(d.pitch)===n)}function Ct(e,i){const t=F(e),a=F(i);if(t===null||a===null)throw new Error(`Invalid pitches provided: ${e}, ${i}`);return t-a}function Wn(e,i,t,a){const s=e.querySelector(".zoom-in-btn"),r=e.querySelector(".zoom-out-btn"),n=e.querySelector(".zoom-reset-btn");!s||!r||!n||(s.addEventListener("click",i),r.addEventListener("click",t),n.addEventListener("click",a))}let st=!1,et=null,z=null;function zn(e){st=!0,et=e,z=null}function jt(){var e;if(z){if(!z.gridContext.setPastePreviewNotes)return;z.gridContext.setPastePreviewNotes(null),z.scheduleRedraw(),(e=z.setCursor)==null||e.call(z,"default")}st=!1,et=null,z=null,document.body.style.cursor="default"}function Xt(){return st}function jn(e,i){!st||!et||(et(e,i),jt())}function Xn(e){if(z&&z!==e){if(!z.gridContext.setPastePreviewNotes)return;z.gridContext.setPastePreviewNotes(null),z.scheduleRedraw()}z=e}const Be={NOTE_PLACEMENT:"note-placement",SELECT:"select"};let va=Be.NOTE_PLACEMENT;const Gt=new Set;function Sa(){return va}function ne(e){jt(),va=e;for(const i of Gt)i(e)}function Vn(e){return Gt.add(e),()=>Gt.delete(e)}let Vt=!1;function Yn(){Vt=!0,ne(Be.SELECT)}function ei(){Vt=!1}function ii(){return Vt}let Yt=!1;function Ni(e=!0){Yt=e}function Sr(){return Yt}function Nr(){Yt=!1}let Na={notes:[],anchorBeat:0,anchorMidi:0};function Ba(e){if(e.length===0)return;const i=e[0],t=i.start,a=F(i.pitch)??0;Na={notes:e.map(s=>({pitch:s.pitch,start:s.start,duration:s.duration})),anchorBeat:t,anchorMidi:a}}function Lt(){return Na}let Qt=null,Zt=null;function Qn(e){Qt=e}function Mt(){return Qt}function Br(){Qt=null}function Cr(e,i,t){Zt={anchorNote:e,startX:i,startY:t,originalDuration:e.duration}}function ut(){return Zt}function Zn(){Zt=null}function Ca(e,i,t){if(!e.setPastePreviewNotes)return;if(!Xt()){e.setPastePreviewNotes(null);return}const{notes:a,anchorBeat:s,anchorMidi:r}=Lt(),n=e.getSnappedBeatFromX(i),o=e.getPitchFromRow(Math.floor(t/e.getCellHeight())),d=F(o);if(d===null)return;const c=n-s,l=d-r,u=a.map(_=>{const f=F(_.pitch);return f===null?{..._}:{pitch:we(f+l)??_.pitch,start:_.start+c,duration:_.duration}});e.setPastePreviewNotes(u),e.scheduleRedraw()}function Ga(e){e.setPastePreviewNotes&&Xt()&&e.setPastePreviewNotes(null)}function La(e,i){return Xt()?(jn(e.grid,i),i.preventDefault(),i.stopPropagation(),!0):!1}let Bi=null;const el=8;function Gr(){Bi=null}function il(e,i){Bi={x:e,y:i}}function tl(e,i){if(!Bi)return!1;const t=e-Bi.x,a=i-Bi.y;return Math.sqrt(t*t+a*a)>=el}let Ve=null;function mi(e){Ve&&Ve!==e&&Ve.clearSelection(),Ve=e}function rl(){Ve=null}function er(){return Ve}function al(e,i,{getPitchRow:t,cellWidth:a,cellHeight:s,labelWidth:r}){const n=i.start*a+r,o=t(i.pitch)*s,d=i.duration*a,c=s-1,l=n+d/2,u=o+c/2,_=F(i.pitch);if(_===null)return;const f=_*5%360,p=e.animationCtx,h=performance.now(),y=500,m=3,g=60;function v(S,L,M){const E=Math.sin(S*Math.PI),P=1+L*E,w=(1-S)*M;p.globalAlpha=w,p.strokeStyle=`hsl(${f}, 100%, 65%)`,p.lineWidth=2;const O=d*P,T=c*P;p.beginPath(),p.roundRect(l-O/2,u-T/2,O,T,4),p.stroke()}function b(S){const L=Math.sin(S*Math.PI),E=`hsla(${f}, 100%, 80%, ${.4*L})`;p.globalAlpha=1,p.fillStyle=E,p.beginPath(),p.roundRect(n,o,d,c,3),p.fill()}function N(S){const L=S-h,M=L/y;if(M>1){p.clearRect(0,0,p.canvas.width,p.canvas.height);return}p.clearRect(0,0,p.canvas.width,p.canvas.height),p.save(),b(M);for(let E=0;E<m;E++){const P=E*g,w=Math.max(0,Math.min(1,(L-P)/(y-P)));v(w,.1+E*.1,.2)}p.restore(),requestAnimationFrame(N)}requestAnimationFrame(N)}function sl(e,i,{getPitchRow:t,cellWidth:a,cellHeight:s,labelWidth:r}){const n=i.start*a+r,o=t(i.pitch)*s,d=i.duration*a,c=s-1,l=n+d/2,u=o+c/2,_=F(i.pitch);if(_===null)return;const f=_*5%360,p=e.animationCtx,h=performance.now(),y=300;function m(g){const b=(g-h)/y;if(b>1){p.clearRect(0,0,p.canvas.width,p.canvas.height);return}p.clearRect(0,0,p.canvas.width,p.canvas.height),p.save();const N=1-.4*b,S=1-b,L=d*N,M=c*N;p.globalAlpha=S,p.fillStyle=`hsl(${f}, 100%, 70%)`,p.beginPath(),p.roundRect(l-L/2,u-M/2,L,M,3),p.fill(),p.restore(),requestAnimationFrame(m)}requestAnimationFrame(m)}function ft(e,i,t,a){if(!e||typeof e.getCellWidth!="function"||typeof e.getCellHeight!="function"||typeof e.getPitchRow!="function")return console.error("Invalid ctx object passed to isOnResizeHandle"),!1;const s=e.getCellWidth(),r=e.getCellHeight(),n=e.getPitchRow,o=Math.min(10,r*.8),c=(i.start+i.duration)*s+6,l=n(i.pitch)*r+(r-o)/2,u=4,_=c-u,f=c+o+u,p=l-u,h=l+o+u;return t>=_&&t<=f&&a>=p&&a<=h?console.log("Hit resize handle!"):console.log("Missed resize handle."),t>=_&&t<=f&&a>=p&&a<=h}function Lr(e){let i=null,t=null,a=!1;function s(l){var g;if(console.log("ClickHandler called"),mi(e.grid),Sr()){Nr(),e.scheduleRedraw();return}const{x:u,y:_}=e.getCanvasPos(l);if(u<0){const v=e.getPitchFromRow(Math.floor(_/e.getCellHeight()));e.sequencer.playNote(v,.5);return}const f=e.getSnappedBeatFromX(u),p=e.getPitchFromRow(Math.floor(_/e.getCellHeight())),h=K();if(f+e.config.currentDuration>h||e.notes.some(v=>v.pitch===p&&v.start===f))return;e.sequencer.playNote(p,.5);const m={pitch:p,start:f,duration:e.config.currentDuration};H(on(e.sequencer.id,[m]),dn(e.sequencer.id,[m])),e.setSelectedNote(null),al(e,m,{getPitchRow:e.getPitchRow,cellWidth:e.getCellWidth(),cellHeight:e.getCellHeight(),labelWidth:se}),e.scheduleRedraw(),(g=e.onNotesChanged)==null||g.call(e)}function r(l){l.preventDefault();const{x:u,y:_}=e.getCanvasPos(l),f=e.findNoteAt(u,_);if(!f||e.notes.indexOf(f)===-1)return;sl(e,f,{getPitchRow:e.getPitchRow,cellWidth:e.getCellWidth(),cellHeight:e.getCellHeight(),labelWidth:se});const h=[f];H(Jt(e.sequencer.id,h),xt(e.sequencer.id,h)),Nr(),e.setSelectedNote(null),e.scheduleRedraw()}function n(l){if(La(e,l))return;const{x:u,y:_}=e.getCanvasPos(l),f=e.findNoteAt(u,_),p=Mt();if(p&&ft(e,p,u,_)){Cr(p,u,_);return}if(f){if(ft(e,f,u,_)){console.log("Resize mode started!"),Cr(f,u,_);return}mi(e.grid),e.setSelectedNote(f),mi(e.grid),e.setSelectedNote(f),i={startX:u,startY:_,anchorNote:f,initialNotes:[{note:f,start:f.start,midi:F(f.pitch)??0}],lastPreviewPitch:void 0};return}il(u,_),a=!1}function o(l){var m,g,v;e.grid.setCursor("default");const{x:u,y:_}=e.getCanvasPos(l);if(u<0){e.clearPreview();return}const f=ut();if(f){e.grid.setCursor("ew-resize");const b=u-f.startX,N=e.getSnappedBeatFromX(b)-e.getSnappedBeatFromX(0),S=Math.max(An(),f.originalDuration+N);f.anchorNote.duration=S,e.scheduleRedraw(),(m=e.onNotesChanged)==null||m.call(e);return}Ca(e,u,_),Br(),e.grid.setCursor("default");const p=((g=e.getSelectedNotes)==null?void 0:g.call(e))??[];for(const b of p)if(ft(e,b,u,_)){Qn(b),e.grid.setCursor("ew-resize");break}if(!f&&!a&&tl(u,_)){Yn(),e.selectionBox={active:!0,startX:u,startY:_,currentX:u,currentY:_},a=!0,mi(e.grid),Gr();return}const h=e.findNoteAt(u,_);e.setHoveredNote(h??null);const y=e.getSelectedNote();if(ut()||(i&&y?e.grid.setCursor("grabbing"):h&&e.grid.setCursor("grab")),!h&&!i&&!Sr()&&!Mt()){const b=e.getSnappedBeatFromX(u),N=e.getPitchFromRow(Math.floor(_/e.getCellHeight())),S=K();b+e.config.currentDuration<=S?e.updatePreview({pitch:N,start:b,duration:e.config.currentDuration}):e.clearPreview()}else e.clearPreview();if(i&&y){const b=u-i.startX,N=e.getSnappedBeatFromX(b)-e.getSnappedBeatFromX(0),S=_-i.startY,L=Math.round(S/e.getCellHeight()),M=Math.max(0,i.initialNotes[0].start+N),E=K();M+y.duration<=E&&(y.start=M);const P=i.initialNotes[0].midi-L,w=F(e.config.noteRange[0])??0,O=F(e.config.noteRange[1])??127,T=Math.max(w,Math.min(O,P)),x=we(T)??y.pitch;x!==y.pitch&&(y.pitch=x,t!==x&&(t=x,e.sequencer.playNote(x,.5))),e.scheduleRedraw(),(v=e.onNotesChanged)==null||v.call(e),Ni();return}e.scheduleRedraw()}function d(l){console.log("UpHandler called"),Gr(),a=!1;const u=ut();if(u){const{anchorNote:y,originalDuration:m}=u,g=y.duration;m!==g&&H(vn(e.sequencer.id,[{pitch:y.pitch,start:y.start,newDuration:g}]),Sn(e.sequencer.id,[{pitch:y.pitch,start:y.start,oldDuration:m}])),Zn(),Ni();return}if(!i||!e.getSelectedNote()){i=null;return}const{anchorNote:_}=i,f=i.initialNotes.find(y=>y.note===_);if(!f)return;const p={pitch:f.note.pitch,start:f.note.start,duration:f.note.duration};(f.start!==f.note.start||f.midi!==F(f.note.pitch))&&H(qt(e.sequencer.id,[{pitch:we(f.midi)??f.note.pitch,start:f.start,duration:f.note.duration}],[p]),fa(e.sequencer.id,[{pitch:we(f.midi)??f.note.pitch,start:f.start,duration:f.note.duration}],[p])),Ni(),i=null}function c(){e.clearPreview(),e.setHoveredNote(null),Br(),Ga(e),e.scheduleRedraw()}return{attach(l){l.addEventListener("click",s),l.addEventListener("contextmenu",r),l.addEventListener("mousemove",o),l.addEventListener("mouseleave",c),l.addEventListener("mousedown",n),l.addEventListener("mouseup",d)},detach(l){l.removeEventListener("click",s),l.removeEventListener("contextmenu",r),l.removeEventListener("mousemove",o),l.removeEventListener("mouseleave",c),l.removeEventListener("mousedown",n),l.removeEventListener("mouseup",d)}}}function Mr(e,{startX:i,currentX:t,startY:a,currentY:s,getCellHeight:r,getSnappedBeatFromX:n,getPitchFromRow:o}){const d=Math.min(i,t),c=Math.min(a,s),l=Math.max(i,t),u=Math.max(a,s),_=Math.floor(c/r()),f=Math.floor(u/r()),p=n(d),h=n(l),y=F(o(_)),m=F(o(f));return e.filter(g=>{const v=F(g.pitch);if(v===null||y===null||m===null)return!1;const b=g.start,S=g.start+g.duration>p&&b<h,L=v>=m-1&&v<=y+1;return S&&L})}function wr(e){let i=null;function t(o){o.preventDefault();const{x:d,y:c}=e.getCanvasPos(o),l=e.findNoteAt(d,c);if(!l)return;const u=e.getSelectedNotes(),_=u.includes(l)?u:[l];_.length&&(e.setSelectedNotes([]),H(Jt(e.sequencer.id,_),xt(e.sequencer.id,_)),ii()&&(ei(),ne(Be.NOTE_PLACEMENT)))}function a(o){if(!e.grid||La(e,o))return;const{x:d,y:c}=e.getCanvasPos(o);if(d<0)return;const l=e.findNoteAt(d,c);e.setHoveredNote(l??null),mi(e.grid);const u=e.getSelectedNotes();if(l&&u.includes(l)){i={startX:d,startY:c,anchorNote:l,initialNotes:u.map(_=>({note:_,start:_.start,midi:F(_.pitch)??0}))};return}e.selectionBox={active:!0,startX:d,startY:c,currentX:d,currentY:c},e.clearPreview(),e.setSelectedNote(null)}function s(o){var b,N;if(!e.grid)return;Xn(e.grid);const{x:d,y:c}=e.getCanvasPos(o),l=e.findNoteAt(d,c);if(e.setHoveredNote(l??null),Ca(e,d,c),(b=e.selectionBox)!=null&&b.active){if(!e.setHighlightedNotes)return;e.selectionBox.currentX=d,e.selectionBox.currentY=c;const S=e.selectionBox,L=Mr(e.notes,{startX:S.startX,currentX:S.currentX,startY:S.startY,currentY:S.currentY,getCellHeight:e.getCellHeight,getSnappedBeatFromX:e.getSnappedBeatFromX,getPitchFromRow:e.getPitchFromRow});e.setHighlightedNotes(L),e.scheduleRedraw();return}if(!i)return;const u=i,_=d-u.startX,f=e.getSnappedBeatFromX(_)-e.getSnappedBeatFromX(0),p=c-u.startY,h=Math.round(p/e.getCellHeight()),y=K(),m=F(e.config.noteRange[0])??0,g=F(e.config.noteRange[1])??127;for(const{note:S,start:L,midi:M}of u.initialNotes){const E=Math.max(0,L+f),P=Math.max(m,Math.min(g,M-h)),w=we(P)??S.pitch;E+S.duration<=y&&(S.start=E,S.pitch=w)}const v=u.initialNotes.find(S=>S.note===u.anchorNote);if(v){const S=v.note.pitch;u.lastPreviewPitch!==S&&(u.lastPreviewPitch=S,e.sequencer.playNote(S,.5))}e.scheduleRedraw(),(N=e.onNotesChanged)==null||N.call(e)}function r(o){var d,c;if((d=i==null?void 0:i.initialNotes)!=null&&d.length){const{initialNotes:l}=i,u=l.map(({start:p,midi:h,note:y})=>({pitch:we(h)??y.pitch,start:p,duration:y.duration})),_=l.map(({note:p})=>({pitch:p.pitch,start:p.start,duration:p.duration}));u.some((p,h)=>p.pitch!==_[h].pitch||p.start!==_[h].start)&&(H(qt(e.sequencer.id,u,_),fa(e.sequencer.id,u,_)),ii()&&(ei(),ne(Be.NOTE_PLACEMENT)))}if(i=null,(c=e.selectionBox)!=null&&c.active){if(!e.setHighlightedNotes)return;const{x:l,y:u}=e.getCanvasPos(o);e.selectionBox.currentX=l,e.selectionBox.currentY=u,e.selectionBox.active=!1;const _=Mr(e.notes,{startX:e.selectionBox.startX,currentX:e.selectionBox.currentX,startY:e.selectionBox.startY,currentY:e.selectionBox.currentY,getCellHeight:e.getCellHeight,getSnappedBeatFromX:e.getSnappedBeatFromX,getPitchFromRow:e.getPitchFromRow});e.setHighlightedNotes([]),e.setSelectedNotes(_),e.scheduleRedraw(),ii()&&e.getSelectedNotes().length===0&&(o.stopPropagation(),ei(),ne(Be.NOTE_PLACEMENT),Ni()),Ni()}}function n(){e.setHighlightedNotes&&(e.setHoveredNote(null),e.setHighlightedNotes([]),Ga(e),e.scheduleRedraw())}return{attach(o){o.addEventListener("mousedown",a),o.addEventListener("mousemove",s),o.addEventListener("mouseup",r),o.addEventListener("mouseleave",n),o.addEventListener("contextmenu",t)},detach(o){o.removeEventListener("mousedown",a),o.removeEventListener("mousemove",s),o.removeEventListener("mouseup",r),o.removeEventListener("mouseleave",n),o.removeEventListener("contextmenu",t)}}}function nl(e,i){const t=i.selectionBox;if(!t)return;const a=t.startX,s=t.startY,r=t.currentX,n=t.currentY,o=Math.min(a,r),d=Math.min(s,n),c=Math.abs(r-a),l=Math.abs(n-s);e.save(),e.strokeStyle="rgba(128, 90, 213, 1.0)",e.lineWidth=2,e.setLineDash([5,5]),la(e,o,d,c,l,3),e.stroke(),e.restore()}function ll(e,i,{cellWidth:t,cellHeight:a,getPitchRow:s,isHovered:r=!1}){const n=Math.min(10,a*.8),d=(i.start+i.duration)*t+6,c=s(i.pitch)*a+(a-n)/2;e.save(),e.shadowColor="rgba(0,0,0,0.4)",e.shadowBlur=3,e.shadowOffsetX=1,e.shadowOffsetY=2,e.fillStyle=r?"rgba(0, 255, 255, 0.95)":"rgba(255, 255, 255, 0.85)",e.beginPath(),e.moveTo(d,c),e.lineTo(d+n,c+n/2),e.lineTo(d,c+n),e.closePath(),e.fill();const l=e.createLinearGradient(d,c,d,c+n);l.addColorStop(0,"rgba(255,255,255,0.9)"),l.addColorStop(.5,"rgba(255,255,255,0.5)"),l.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=l,e.beginPath(),e.moveTo(d,c),e.lineTo(d+n,c+n/2),e.lineTo(d,c+n),e.closePath(),e.fill(),e.restore()}function ol(e,i,t,a,s,r,n){let o=null,d=null,c=null,l=null,u=[],_=2;const f=e.getContext("2d"),p=i.getContext("2d"),h=t.getContext("2d");if(!f||!p||!h)throw new Error("Failed to acquire required canvas contexts");const y=f,m=p,g=h;let v=Ri[_].cellWidth,b=Ri[_].cellHeight;const N=Ct(r.noteRange[1],r.noteRange[0])+1,S=N*b,M=K()*v+se;e.width=M,e.height=S,e.style.width=`${M}px`,e.style.height=`${S}px`,i.width=M,i.height=S,i.style.width=`${M}px`,i.style.height=`${S}px`,t.width=M,t.height=S,t.style.width=`${M}px`,t.style.height=`${S}px`;let E=null;function P(){E!==null&&cancelAnimationFrame(E),E=requestAnimationFrame(w)}function w(){var D,ee;y.clearRect(0,0,e.width,e.height),y.save(),y.translate(se,0);let G=!!n.instrumentName.toLowerCase().includes("drum kit ");Un(y,r,N,v,b,Pe,G),qn(y,s,{previewNotes:d??(o?[o]:null),hoveredNote:c,selectedNote:l,selectedNotes:u,highlightedNotes:((D=B.getHighlightedNotes)==null?void 0:D.call(B))??[],cellWidth:v,cellHeight:b,visibleStartBeat:0,visibleEndBeat:e.width/v,getPitchRow:oe,getPitchClass:Hs,getTrackColor:()=>sn(n),drawRoundedRect:la});for(const j of u)ll(y,j,{cellWidth:v,cellHeight:b,getPitchRow:oe,isHovered:j===Mt()});(ee=B.selectionBox)!=null&&ee.active&&nl(y,B),y.restore()}function O(){_<Ri.length-1&&(_++,q())}function T(){_>0&&(_--,q())}function x(){_=2,q()}function q(){const G=Ri[_];v=G.cellWidth,b=G.cellHeight,I()}function I(){const D=K()*v+se,j=(Ct(r.noteRange[1],r.noteRange[0])+1)*b;e.width=D,e.height=j,e.style.width=`${D}px`,e.style.height=`${j}px`,i.width=D,i.height=j,i.style.width=`${D}px`,i.style.height=`${j}px`,t.width=D,t.height=j,t.style.width=`${D}px`,t.style.height=`${j}px`,g.clearRect(0,0,t.width,t.height),P()}function U(G){Hn(m,G,se,e.height)}Wn(n.container,O,T,x);function oe(G){const D=F(r.noteRange[1]),ee=F(G);return D===null||ee===null?(console.warn(`Invalid pitch encountered: ${G}`),0):D-ee}function Pe(G){const D=F(r.noteRange[1]),ee=F(r.noteRange[0]);if(D===null||ee===null)return console.warn(`Invalid pitch range configured: ${r.noteRange}`),"C4";const j=D-G,bs=Math.max(ee,Math.min(D,j));return we(bs)??"C4"}function V(){const G=document.getElementById("global-mini-contour");G instanceof HTMLCanvasElement&&re(G,k)}let Z=null;const B={sequencer:n,grid:null,config:r,notes:s,canvas:e,animationCtx:g,getCellHeight:()=>b,getCellWidth:()=>v,getCanvasPos:G=>$n(e,G,a,se),findNoteAt:(G,D)=>Kn(G,D,s,oe,b,v),scheduleRedraw:P,getPitchFromRow:Pe,getPitchRow:oe,getSnappedBeatFromX:G=>Ds(G,r,()=>v),updatePreview:G=>o=G,clearPreview:()=>o=null,getSelectedNote:()=>l,setSelectedNote:G=>{l=G,u=G?[G]:[]},getSelectedNotes:()=>u,setSelectedNotes:G=>{u=G,l=G.length===1?G[0]:null},setHoveredNote:G=>c=G,onNotesChanged:V};function R(G){Z==null||Z.detach(e),Z=G,Z==null||Z.attach(e)}function A(){l=null,u=[],c=null,Oi=[],P()}const W={"note-placement":()=>R(Lr(B)),select:()=>R(wr(B)),none:()=>R(null)};let fe=Vn(G=>{var D,ee,j;o=null,d=null,Oi=[],(D=B.clearPreview)==null||D.call(B),(ee=B.setPastePreviewNotes)==null||ee.call(B,null),B.selectionBox&&(B.selectionBox.active=!1,B.selectionBox=null),A(),(j=W[G])==null||j.call(W),P()});function Ii(){return l}function fs(){return o}function _s(G){return G*v}function ps(G){e.style.cursor=G}function ys(){return u}function ms(G){u=G,l=G.length===1?G[0]:null}function hs(){fe(),rl()}const cr={canvas:e,scheduleRedraw:P,drawPlayhead:U,getSelectedNote:Ii,clearSelection:A,getPreviewNote:fs,zoomIn:O,zoomOut:T,getXForBeat:_s,setMouseHandler:R,setCursor:ps,gridContext:B,getSelectedNotes:ys,setSelectedNotes:ms,destroy:hs,resizeAndRedraw:I},ur=Sa();let fr=null,_r=null;ur==="note-placement"?(fr=Lr(B),R(fr)):ur==="select"?(_r=wr(B),R(_r)):R(null),B.setPastePreviewNotes=G=>{d=G};let Oi=[];return B.getHighlightedNotes=()=>Oi,B.setHighlightedNotes=G=>{Oi=G},B.grid=cr,cr}const ir=[{id:"0000_Aspirin_sf2_file",library:"Aspirin",displayName:"Acoustic Grand Piano"},{id:"0000_Chaos_sf2_file",library:"Chaos",displayName:"Acoustic Grand Piano"},{id:"0000_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Acoustic Grand Piano"},{id:"0000_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Acoustic Grand Piano"},{id:"0000_JCLive_sf2_file",library:"JCLive",displayName:"Acoustic Grand Piano"},{id:"0000_SBLive_sf2",library:"SBLive",displayName:"Acoustic Grand Piano"},{id:"0000_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Acoustic Grand Piano"},{id:"0010_Aspirin_sf2_file",library:"Aspirin",displayName:"Bright Acoustic Piano"},{id:"0010_Chaos_sf2_file",library:"Chaos",displayName:"Bright Acoustic Piano"},{id:"0010_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Bright Acoustic Piano"},{id:"0010_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Bright Acoustic Piano"},{id:"0010_JCLive_sf2_file",library:"JCLive",displayName:"Bright Acoustic Piano"},{id:"0010_SBLive_sf2",library:"SBLive",displayName:"Bright Acoustic Piano"},{id:"0010_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Bright Acoustic Piano"},{id:"0020_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Grand Piano"},{id:"0020_Chaos_sf2_file",library:"Chaos",displayName:"Electric Grand Piano"},{id:"0020_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Grand Piano"},{id:"0020_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Grand Piano"},{id:"0020_JCLive_sf2_file",library:"JCLive",displayName:"Electric Grand Piano"},{id:"0020_SBLive_sf2",library:"SBLive",displayName:"Electric Grand Piano"},{id:"0020_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Grand Piano"},{id:"0050_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Piano 2"},{id:"0050_Chaos_sf2_file",library:"Chaos",displayName:"Electric Piano 2"},{id:"0050_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Piano 2"},{id:"0050_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Piano 2"},{id:"0050_JCLive_sf2_file",library:"JCLive",displayName:"Electric Piano 2"},{id:"0050_SBLive_sf2",library:"SBLive",displayName:"Electric Piano 2"},{id:"0050_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Piano 2"},{id:"0060_Aspirin_sf2_file",library:"Aspirin",displayName:"Harpsichord"},{id:"0060_Chaos_sf2_file",library:"Chaos",displayName:"Harpsichord"},{id:"0060_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Harpsichord"},{id:"0060_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Harpsichord"},{id:"0060_JCLive_sf2_file",library:"JCLive",displayName:"Harpsichord"},{id:"0060_SBLive_sf2",library:"SBLive",displayName:"Harpsichord"},{id:"0060_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Harpsichord"},{id:"0070_Aspirin_sf2_file",library:"Aspirin",displayName:"Clavinet"},{id:"0070_Chaos_sf2_file",library:"Chaos",displayName:"Clavinet"},{id:"0070_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Clavinet"},{id:"0070_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Clavinet"},{id:"0070_JCLive_sf2_file",library:"JCLive",displayName:"Clavinet"},{id:"0070_SBLive_sf2",library:"SBLive",displayName:"Clavinet"},{id:"0070_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Clavinet"},{id:"0080_Aspirin_sf2_file",library:"Aspirin",displayName:"Celesta"},{id:"0080_Chaos_sf2_file",library:"Chaos",displayName:"Celesta"},{id:"0080_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Celesta"},{id:"0080_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Celesta"},{id:"0080_JCLive_sf2_file",library:"JCLive",displayName:"Celesta"},{id:"0080_SBLive_sf2",library:"SBLive",displayName:"Celesta"},{id:"0080_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Celesta"},{id:"0090_Aspirin_sf2_file",library:"Aspirin",displayName:"Glockenspiel"},{id:"0090_Chaos_sf2_file",library:"Chaos",displayName:"Glockenspiel"},{id:"0090_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Glockenspiel"},{id:"0090_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Glockenspiel"},{id:"0090_JCLive_sf2_file",library:"JCLive",displayName:"Glockenspiel"},{id:"0090_SBLive_sf2",library:"SBLive",displayName:"Glockenspiel"},{id:"0090_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Glockenspiel"},{id:"0100_Aspirin_sf2_file",library:"Aspirin",displayName:"Music Box"},{id:"0100_Chaos_sf2_file",library:"Chaos",displayName:"Music Box"},{id:"0100_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Music Box"},{id:"0100_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Music Box"},{id:"0100_JCLive_sf2_file",library:"JCLive",displayName:"Music Box"},{id:"0100_SBLive_sf2",library:"SBLive",displayName:"Music Box"},{id:"0100_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Music Box"},{id:"0110_Aspirin_sf2_file",library:"Aspirin",displayName:"Vibraphone"},{id:"0110_Chaos_sf2_file",library:"Chaos",displayName:"Vibraphone"},{id:"0110_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Vibraphone"},{id:"0110_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Vibraphone"},{id:"0110_JCLive_sf2_file",library:"JCLive",displayName:"Vibraphone"},{id:"0110_SBLive_sf2",library:"SBLive",displayName:"Vibraphone"},{id:"0110_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Vibraphone"},{id:"0120_Aspirin_sf2_file",library:"Aspirin",displayName:"Marimba"},{id:"0120_Chaos_sf2_file",library:"Chaos",displayName:"Marimba"},{id:"0120_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Marimba"},{id:"0120_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Marimba"},{id:"0120_JCLive_sf2_file",library:"JCLive",displayName:"Marimba"},{id:"0120_SBLive_sf2",library:"SBLive",displayName:"Marimba"},{id:"0120_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Marimba"},{id:"0130_Aspirin_sf2_file",library:"Aspirin",displayName:"Xylophone"},{id:"0130_Chaos_sf2_file",library:"Chaos",displayName:"Xylophone"},{id:"0130_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Xylophone"},{id:"0130_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Xylophone"},{id:"0130_JCLive_sf2_file",library:"JCLive",displayName:"Xylophone"},{id:"0130_SBLive_sf2",library:"SBLive",displayName:"Xylophone"},{id:"0130_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Xylophone"},{id:"0140_Aspirin_sf2_file",library:"Aspirin",displayName:"Tubular Bells"},{id:"0140_Chaos_sf2_file",library:"Chaos",displayName:"Tubular Bells"},{id:"0140_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tubular Bells"},{id:"0140_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tubular Bells"},{id:"0140_JCLive_sf2_file",library:"JCLive",displayName:"Tubular Bells"},{id:"0140_SBLive_sf2",library:"SBLive",displayName:"Tubular Bells"},{id:"0140_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tubular Bells"},{id:"0150_Aspirin_sf2_file",library:"Aspirin",displayName:"Dulcimer"},{id:"0150_Chaos_sf2_file",library:"Chaos",displayName:"Dulcimer"},{id:"0150_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Dulcimer"},{id:"0150_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Dulcimer"},{id:"0150_JCLive_sf2_file",library:"JCLive",displayName:"Dulcimer"},{id:"0150_SBLive_sf2",library:"SBLive",displayName:"Dulcimer"},{id:"0150_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Dulcimer"},{id:"0160_Aspirin_sf2_file",library:"Aspirin",displayName:"Drawbar Organ"},{id:"0160_Chaos_sf2_file",library:"Chaos",displayName:"Drawbar Organ"},{id:"0160_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drawbar Organ"},{id:"0160_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Drawbar Organ"},{id:"0160_JCLive_sf2_file",library:"JCLive",displayName:"Drawbar Organ"},{id:"0160_SBLive_sf2",library:"SBLive",displayName:"Drawbar Organ"},{id:"0160_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Drawbar Organ"},{id:"0170_Aspirin_sf2_file",library:"Aspirin",displayName:"Percussive Organ"},{id:"0170_Chaos_sf2_file",library:"Chaos",displayName:"Percussive Organ"},{id:"0170_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Percussive Organ"},{id:"0170_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Percussive Organ"},{id:"0170_JCLive_sf2_file",library:"JCLive",displayName:"Percussive Organ"},{id:"0170_SBLive_sf2",library:"SBLive",displayName:"Percussive Organ"},{id:"0170_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Percussive Organ"},{id:"0180_Aspirin_sf2_file",library:"Aspirin",displayName:"Rock Organ"},{id:"0180_Chaos_sf2_file",library:"Chaos",displayName:"Rock Organ"},{id:"0180_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Rock Organ"},{id:"0180_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Rock Organ"},{id:"0180_JCLive_sf2_file",library:"JCLive",displayName:"Rock Organ"},{id:"0180_SBLive_sf2",library:"SBLive",displayName:"Rock Organ"},{id:"0180_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Rock Organ"},{id:"0190_Aspirin_sf2_file",library:"Aspirin",displayName:"Church Organ"},{id:"0190_Chaos_sf2_file",library:"Chaos",displayName:"Church Organ"},{id:"0190_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Church Organ"},{id:"0190_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Church Organ"},{id:"0190_JCLive_sf2_file",library:"JCLive",displayName:"Church Organ"},{id:"0190_SBLive_sf2",library:"SBLive",displayName:"Church Organ"},{id:"0190_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Church Organ"},{id:"0200_Aspirin_sf2_file",library:"Aspirin",displayName:"Reed Organ"},{id:"0200_Chaos_sf2_file",library:"Chaos",displayName:"Reed Organ"},{id:"0200_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Reed Organ"},{id:"0200_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Reed Organ"},{id:"0200_JCLive_sf2_file",library:"JCLive",displayName:"Reed Organ"},{id:"0200_SBLive_sf2",library:"SBLive",displayName:"Reed Organ"},{id:"0200_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Reed Organ"},{id:"0210_Aspirin_sf2_file",library:"Aspirin",displayName:"Accordion"},{id:"0210_Chaos_sf2_file",library:"Chaos",displayName:"Accordion"},{id:"0210_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Accordion"},{id:"0210_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Accordion"},{id:"0210_JCLive_sf2_file",library:"JCLive",displayName:"Accordion"},{id:"0210_SBLive_sf2",library:"SBLive",displayName:"Accordion"},{id:"0210_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Accordion"},{id:"0220_Aspirin_sf2_file",library:"Aspirin",displayName:"Harmonica"},{id:"0220_Chaos_sf2_file",library:"Chaos",displayName:"Harmonica"},{id:"0220_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Harmonica"},{id:"0220_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Harmonica"},{id:"0220_JCLive_sf2_file",library:"JCLive",displayName:"Harmonica"},{id:"0220_SBLive_sf2",library:"SBLive",displayName:"Harmonica"},{id:"0220_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Harmonica"},{id:"0230_Aspirin_sf2_file",library:"Aspirin",displayName:"Tango Accordion"},{id:"0230_Chaos_sf2_file",library:"Chaos",displayName:"Tango Accordion"},{id:"0230_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tango Accordion"},{id:"0230_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tango Accordion"},{id:"0230_JCLive_sf2_file",library:"JCLive",displayName:"Tango Accordion"},{id:"0230_SBLive_sf2",library:"SBLive",displayName:"Tango Accordion"},{id:"0230_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tango Accordion"},{id:"0240_Aspirin_sf2_file",library:"Aspirin",displayName:"Acoustic Guitar (nylon)"},{id:"0240_Chaos_sf2_file",library:"Chaos",displayName:"Acoustic Guitar (nylon)"},{id:"0240_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Acoustic Guitar (nylon)"},{id:"0240_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Acoustic Guitar (nylon)"},{id:"0240_JCLive_sf2_file",library:"JCLive",displayName:"Acoustic Guitar (nylon)"},{id:"0240_SBLive_sf2",library:"SBLive",displayName:"Acoustic Guitar (nylon)"},{id:"0240_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Acoustic Guitar (nylon)"},{id:"0250_Aspirin_sf2_file",library:"Aspirin",displayName:"Acoustic Guitar (steel)"},{id:"0250_Chaos_sf2_file",library:"Chaos",displayName:"Acoustic Guitar (steel)"},{id:"0250_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Acoustic Guitar (steel)"},{id:"0250_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Acoustic Guitar (steel)"},{id:"0250_JCLive_sf2_file",library:"JCLive",displayName:"Acoustic Guitar (steel)"},{id:"0250_SBLive_sf2",library:"SBLive",displayName:"Acoustic Guitar (steel)"},{id:"0250_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Acoustic Guitar (steel)"},{id:"0260_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Guitar (jazz)"},{id:"0260_Chaos_sf2_file",library:"Chaos",displayName:"Electric Guitar (jazz)"},{id:"0260_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Guitar (jazz)"},{id:"0260_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Guitar (jazz)"},{id:"0260_JCLive_sf2_file",library:"JCLive",displayName:"Electric Guitar (jazz)"},{id:"0260_SBLive_sf2",library:"SBLive",displayName:"Electric Guitar (jazz)"},{id:"0260_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Guitar (jazz)"},{id:"0270_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Guitar (clean)"},{id:"0270_Chaos_sf2_file",library:"Chaos",displayName:"Electric Guitar (clean)"},{id:"0270_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Guitar (clean)"},{id:"0270_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Guitar (clean)"},{id:"0270_JCLive_sf2_file",library:"JCLive",displayName:"Electric Guitar (clean)"},{id:"0270_SBLive_sf2",library:"SBLive",displayName:"Electric Guitar (clean)"},{id:"0270_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Guitar (clean)"},{id:"0280_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Guitar (muted)"},{id:"0280_Chaos_sf2_file",library:"Chaos",displayName:"Electric Guitar (muted)"},{id:"0280_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Guitar (muted)"},{id:"0280_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Guitar (muted)"},{id:"0280_JCLive_sf2_file",library:"JCLive",displayName:"Electric Guitar (muted)"},{id:"0280_SBLive_sf2",library:"SBLive",displayName:"Electric Guitar (muted)"},{id:"0280_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Guitar (muted)"},{id:"0290_Aspirin_sf2_file",library:"Aspirin",displayName:"Overdriven Guitar"},{id:"0290_Chaos_sf2_file",library:"Chaos",displayName:"Overdriven Guitar"},{id:"0290_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Overdriven Guitar"},{id:"0290_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Overdriven Guitar"},{id:"0290_JCLive_sf2_file",library:"JCLive",displayName:"Overdriven Guitar"},{id:"0290_SBLive_sf2",library:"SBLive",displayName:"Overdriven Guitar"},{id:"0290_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Overdriven Guitar"},{id:"0300_Aspirin_sf2_file",library:"Aspirin",displayName:"Distortion Guitar"},{id:"0300_Chaos_sf2_file",library:"Chaos",displayName:"Distortion Guitar"},{id:"0300_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Distortion Guitar"},{id:"0300_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Distortion Guitar"},{id:"0300_JCLive_sf2_file",library:"JCLive",displayName:"Distortion Guitar"},{id:"0300_SBLive_sf2",library:"SBLive",displayName:"Distortion Guitar"},{id:"0300_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Distortion Guitar"},{id:"0310_Aspirin_sf2_file",library:"Aspirin",displayName:"Guitar Harmonics"},{id:"0310_Chaos_sf2_file",library:"Chaos",displayName:"Guitar Harmonics"},{id:"0310_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Guitar Harmonics"},{id:"0310_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Guitar Harmonics"},{id:"0310_JCLive_sf2_file",library:"JCLive",displayName:"Guitar Harmonics"},{id:"0310_SBLive_sf2",library:"SBLive",displayName:"Guitar Harmonics"},{id:"0310_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Guitar Harmonics"},{id:"0320_Aspirin_sf2_file",library:"Aspirin",displayName:"Acoustic Bass"},{id:"0320_Chaos_sf2_file",library:"Chaos",displayName:"Acoustic Bass"},{id:"0320_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Acoustic Bass"},{id:"0320_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Acoustic Bass"},{id:"0320_JCLive_sf2_file",library:"JCLive",displayName:"Acoustic Bass"},{id:"0320_SBLive_sf2",library:"SBLive",displayName:"Acoustic Bass"},{id:"0320_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Acoustic Bass"},{id:"0330_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Bass (finger)"},{id:"0330_Chaos_sf2_file",library:"Chaos",displayName:"Electric Bass (finger)"},{id:"0330_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Bass (finger)"},{id:"0330_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Bass (finger)"},{id:"0330_JCLive_sf2_file",library:"JCLive",displayName:"Electric Bass (finger)"},{id:"0330_SBLive_sf2",library:"SBLive",displayName:"Electric Bass (finger)"},{id:"0330_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Bass (finger)"},{id:"0340_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Bass (pick)"},{id:"0340_Chaos_sf2_file",library:"Chaos",displayName:"Electric Bass (pick)"},{id:"0340_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Bass (pick)"},{id:"0340_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Bass (pick)"},{id:"0340_JCLive_sf2_file",library:"JCLive",displayName:"Electric Bass (pick)"},{id:"0340_SBLive_sf2",library:"SBLive",displayName:"Electric Bass (pick)"},{id:"0340_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Bass (pick)"},{id:"0350_Aspirin_sf2_file",library:"Aspirin",displayName:"Fretless Bass"},{id:"0350_Chaos_sf2_file",library:"Chaos",displayName:"Fretless Bass"},{id:"0350_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Fretless Bass"},{id:"0350_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Fretless Bass"},{id:"0350_JCLive_sf2_file",library:"JCLive",displayName:"Fretless Bass"},{id:"0350_SBLive_sf2",library:"SBLive",displayName:"Fretless Bass"},{id:"0350_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Fretless Bass"},{id:"0360_Aspirin_sf2_file",library:"Aspirin",displayName:"Slap Bass 1"},{id:"0360_Chaos_sf2_file",library:"Chaos",displayName:"Slap Bass 1"},{id:"0360_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Slap Bass 1"},{id:"0360_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Slap Bass 1"},{id:"0360_JCLive_sf2_file",library:"JCLive",displayName:"Slap Bass 1"},{id:"0360_SBLive_sf2",library:"SBLive",displayName:"Slap Bass 1"},{id:"0360_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Slap Bass 1"},{id:"0370_Aspirin_sf2_file",library:"Aspirin",displayName:"Slap Bass 2"},{id:"0370_Chaos_sf2_file",library:"Chaos",displayName:"Slap Bass 2"},{id:"0370_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Slap Bass 2"},{id:"0370_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Slap Bass 2"},{id:"0370_JCLive_sf2_file",library:"JCLive",displayName:"Slap Bass 2"},{id:"0370_SBLive_sf2",library:"SBLive",displayName:"Slap Bass 2"},{id:"0370_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Slap Bass 2"},{id:"0380_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Bass 1"},{id:"0380_Chaos_sf2_file",library:"Chaos",displayName:"Synth Bass 1"},{id:"0380_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Bass 1"},{id:"0380_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Bass 1"},{id:"0380_JCLive_sf2_file",library:"JCLive",displayName:"Synth Bass 1"},{id:"0380_SBLive_sf2",library:"SBLive",displayName:"Synth Bass 1"},{id:"0380_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Bass 1"},{id:"0390_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Bass 2"},{id:"0390_Chaos_sf2_file",library:"Chaos",displayName:"Synth Bass 2"},{id:"0390_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Bass 2"},{id:"0390_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Bass 2"},{id:"0390_JCLive_sf2_file",library:"JCLive",displayName:"Synth Bass 2"},{id:"0390_SBLive_sf2",library:"SBLive",displayName:"Synth Bass 2"},{id:"0390_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Bass 2"},{id:"0400_Aspirin_sf2_file",library:"Aspirin",displayName:"Violin"},{id:"0400_Chaos_sf2_file",library:"Chaos",displayName:"Violin"},{id:"0400_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Violin"},{id:"0400_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Violin"},{id:"0400_JCLive_sf2_file",library:"JCLive",displayName:"Violin"},{id:"0400_SBLive_sf2",library:"SBLive",displayName:"Violin"},{id:"0400_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Violin"},{id:"0410_Aspirin_sf2_file",library:"Aspirin",displayName:"Viola"},{id:"0410_Chaos_sf2_file",library:"Chaos",displayName:"Viola"},{id:"0410_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Viola"},{id:"0410_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Viola"},{id:"0410_JCLive_sf2_file",library:"JCLive",displayName:"Viola"},{id:"0410_SBLive_sf2",library:"SBLive",displayName:"Viola"},{id:"0410_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Viola"},{id:"0420_Aspirin_sf2_file",library:"Aspirin",displayName:"Cello"},{id:"0420_Chaos_sf2_file",library:"Chaos",displayName:"Cello"},{id:"0420_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Cello"},{id:"0420_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Cello"},{id:"0420_JCLive_sf2_file",library:"JCLive",displayName:"Cello"},{id:"0420_SBLive_sf2",library:"SBLive",displayName:"Cello"},{id:"0420_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Cello"},{id:"0430_Aspirin_sf2_file",library:"Aspirin",displayName:"Contrabass"},{id:"0430_Chaos_sf2_file",library:"Chaos",displayName:"Contrabass"},{id:"0430_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Contrabass"},{id:"0430_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Contrabass"},{id:"0430_JCLive_sf2_file",library:"JCLive",displayName:"Contrabass"},{id:"0430_SBLive_sf2",library:"SBLive",displayName:"Contrabass"},{id:"0430_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Contrabass"},{id:"0440_Aspirin_sf2_file",library:"Aspirin",displayName:"Tremolo Strings"},{id:"0440_Chaos_sf2_file",library:"Chaos",displayName:"Tremolo Strings"},{id:"0440_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tremolo Strings"},{id:"0440_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tremolo Strings"},{id:"0440_JCLive_sf2_file",library:"JCLive",displayName:"Tremolo Strings"},{id:"0440_SBLive_sf2",library:"SBLive",displayName:"Tremolo Strings"},{id:"0440_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tremolo Strings"},{id:"0450_Aspirin_sf2_file",library:"Aspirin",displayName:"Pizzicato Strings"},{id:"0450_Chaos_sf2_file",library:"Chaos",displayName:"Pizzicato Strings"},{id:"0450_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pizzicato Strings"},{id:"0450_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pizzicato Strings"},{id:"0450_JCLive_sf2_file",library:"JCLive",displayName:"Pizzicato Strings"},{id:"0450_SBLive_sf2",library:"SBLive",displayName:"Pizzicato Strings"},{id:"0450_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pizzicato Strings"},{id:"0460_Aspirin_sf2_file",library:"Aspirin",displayName:"Orchestral Harp"},{id:"0460_Chaos_sf2_file",library:"Chaos",displayName:"Orchestral Harp"},{id:"0460_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Orchestral Harp"},{id:"0460_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Orchestral Harp"},{id:"0460_JCLive_sf2_file",library:"JCLive",displayName:"Orchestral Harp"},{id:"0460_SBLive_sf2",library:"SBLive",displayName:"Orchestral Harp"},{id:"0460_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Orchestral Harp"},{id:"0470_Aspirin_sf2_file",library:"Aspirin",displayName:"Timpani"},{id:"0470_Chaos_sf2_file",library:"Chaos",displayName:"Timpani"},{id:"0470_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Timpani"},{id:"0470_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Timpani"},{id:"0470_JCLive_sf2_file",library:"JCLive",displayName:"Timpani"},{id:"0470_SBLive_sf2",library:"SBLive",displayName:"Timpani"},{id:"0470_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Timpani"},{id:"0480_Aspirin_sf2_file",library:"Aspirin",displayName:"String Ensemble 1"},{id:"0480_Chaos_sf2_file",library:"Chaos",displayName:"String Ensemble 1"},{id:"0480_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"String Ensemble 1"},{id:"0480_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"String Ensemble 1"},{id:"0480_JCLive_sf2_file",library:"JCLive",displayName:"String Ensemble 1"},{id:"0480_SBLive_sf2",library:"SBLive",displayName:"String Ensemble 1"},{id:"0480_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"String Ensemble 1"},{id:"0490_Aspirin_sf2_file",library:"Aspirin",displayName:"String Ensemble 2"},{id:"0490_Chaos_sf2_file",library:"Chaos",displayName:"String Ensemble 2"},{id:"0490_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"String Ensemble 2"},{id:"0490_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"String Ensemble 2"},{id:"0490_JCLive_sf2_file",library:"JCLive",displayName:"String Ensemble 2"},{id:"0490_SBLive_sf2",library:"SBLive",displayName:"String Ensemble 2"},{id:"0490_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"String Ensemble 2"},{id:"0500_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Strings 1"},{id:"0500_Chaos_sf2_file",library:"Chaos",displayName:"Synth Strings 1"},{id:"0500_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Strings 1"},{id:"0500_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Strings 1"},{id:"0500_JCLive_sf2_file",library:"JCLive",displayName:"Synth Strings 1"},{id:"0500_SBLive_sf2",library:"SBLive",displayName:"Synth Strings 1"},{id:"0500_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Strings 1"},{id:"0510_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Strings 2"},{id:"0510_Chaos_sf2_file",library:"Chaos",displayName:"Synth Strings 2"},{id:"0510_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Strings 2"},{id:"0510_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Strings 2"},{id:"0510_JCLive_sf2_file",library:"JCLive",displayName:"Synth Strings 2"},{id:"0510_SBLive_sf2",library:"SBLive",displayName:"Synth Strings 2"},{id:"0510_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Strings 2"},{id:"0520_Aspirin_sf2_file",library:"Aspirin",displayName:"Choir Aahs"},{id:"0520_Chaos_sf2_file",library:"Chaos",displayName:"Choir Aahs"},{id:"0520_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Choir Aahs"},{id:"0520_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Choir Aahs"},{id:"0520_JCLive_sf2_file",library:"JCLive",displayName:"Choir Aahs"},{id:"0520_SBLive_sf2",library:"SBLive",displayName:"Choir Aahs"},{id:"0520_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Choir Aahs"},{id:"0530_Aspirin_sf2_file",library:"Aspirin",displayName:"Voice Oohs"},{id:"0530_Chaos_sf2_file",library:"Chaos",displayName:"Voice Oohs"},{id:"0530_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Voice Oohs"},{id:"0530_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Voice Oohs"},{id:"0530_JCLive_sf2_file",library:"JCLive",displayName:"Voice Oohs"},{id:"0530_SBLive_sf2",library:"SBLive",displayName:"Voice Oohs"},{id:"0530_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Voice Oohs"},{id:"0540_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Choir"},{id:"0540_Chaos_sf2_file",library:"Chaos",displayName:"Synth Choir"},{id:"0540_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Choir"},{id:"0540_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Choir"},{id:"0540_JCLive_sf2_file",library:"JCLive",displayName:"Synth Choir"},{id:"0540_SBLive_sf2",library:"SBLive",displayName:"Synth Choir"},{id:"0540_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Choir"},{id:"0550_Aspirin_sf2_file",library:"Aspirin",displayName:"Orchestra Hit"},{id:"0550_Chaos_sf2_file",library:"Chaos",displayName:"Orchestra Hit"},{id:"0550_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Orchestra Hit"},{id:"0550_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Orchestra Hit"},{id:"0550_JCLive_sf2_file",library:"JCLive",displayName:"Orchestra Hit"},{id:"0550_SBLive_sf2",library:"SBLive",displayName:"Orchestra Hit"},{id:"0550_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Orchestra Hit"},{id:"0560_Aspirin_sf2_file",library:"Aspirin",displayName:"Trumpet"},{id:"0560_Chaos_sf2_file",library:"Chaos",displayName:"Trumpet"},{id:"0560_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Trumpet"},{id:"0560_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Trumpet"},{id:"0560_JCLive_sf2_file",library:"JCLive",displayName:"Trumpet"},{id:"0560_SBLive_sf2",library:"SBLive",displayName:"Trumpet"},{id:"0560_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Trumpet"},{id:"0570_Aspirin_sf2_file",library:"Aspirin",displayName:"Trombone"},{id:"0570_Chaos_sf2_file",library:"Chaos",displayName:"Trombone"},{id:"0570_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Trombone"},{id:"0570_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Trombone"},{id:"0570_JCLive_sf2_file",library:"JCLive",displayName:"Trombone"},{id:"0570_SBLive_sf2",library:"SBLive",displayName:"Trombone"},{id:"0570_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Trombone"},{id:"0580_Aspirin_sf2_file",library:"Aspirin",displayName:"Tuba"},{id:"0580_Chaos_sf2_file",library:"Chaos",displayName:"Tuba"},{id:"0580_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tuba"},{id:"0580_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tuba"},{id:"0580_JCLive_sf2_file",library:"JCLive",displayName:"Tuba"},{id:"0580_SBLive_sf2",library:"SBLive",displayName:"Tuba"},{id:"0580_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tuba"},{id:"0590_Aspirin_sf2_file",library:"Aspirin",displayName:"Muted Trumpet"},{id:"0590_Chaos_sf2_file",library:"Chaos",displayName:"Muted Trumpet"},{id:"0590_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Muted Trumpet"},{id:"0590_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Muted Trumpet"},{id:"0590_JCLive_sf2_file",library:"JCLive",displayName:"Muted Trumpet"},{id:"0590_SBLive_sf2",library:"SBLive",displayName:"Muted Trumpet"},{id:"0590_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Muted Trumpet"},{id:"0600_Aspirin_sf2_file",library:"Aspirin",displayName:"French Horn"},{id:"0600_Chaos_sf2_file",library:"Chaos",displayName:"French Horn"},{id:"0600_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"French Horn"},{id:"0600_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"French Horn"},{id:"0600_JCLive_sf2_file",library:"JCLive",displayName:"French Horn"},{id:"0600_SBLive_sf2",library:"SBLive",displayName:"French Horn"},{id:"0600_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"French Horn"},{id:"0610_Aspirin_sf2_file",library:"Aspirin",displayName:"Brass Section"},{id:"0610_Chaos_sf2_file",library:"Chaos",displayName:"Brass Section"},{id:"0610_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Brass Section"},{id:"0610_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Brass Section"},{id:"0610_JCLive_sf2_file",library:"JCLive",displayName:"Brass Section"},{id:"0610_SBLive_sf2",library:"SBLive",displayName:"Brass Section"},{id:"0610_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Brass Section"},{id:"0620_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Brass 1"},{id:"0620_Chaos_sf2_file",library:"Chaos",displayName:"Synth Brass 1"},{id:"0620_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Brass 1"},{id:"0620_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Brass 1"},{id:"0620_JCLive_sf2_file",library:"JCLive",displayName:"Synth Brass 1"},{id:"0620_SBLive_sf2",library:"SBLive",displayName:"Synth Brass 1"},{id:"0620_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Brass 1"},{id:"0630_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Brass 2"},{id:"0630_Chaos_sf2_file",library:"Chaos",displayName:"Synth Brass 2"},{id:"0630_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Brass 2"},{id:"0630_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Brass 2"},{id:"0630_JCLive_sf2_file",library:"JCLive",displayName:"Synth Brass 2"},{id:"0630_SBLive_sf2",library:"SBLive",displayName:"Synth Brass 2"},{id:"0630_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Brass 2"},{id:"0640_Aspirin_sf2_file",library:"Aspirin",displayName:"Soprano Sax"},{id:"0640_Chaos_sf2_file",library:"Chaos",displayName:"Soprano Sax"},{id:"0640_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Soprano Sax"},{id:"0640_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Soprano Sax"},{id:"0640_JCLive_sf2_file",library:"JCLive",displayName:"Soprano Sax"},{id:"0640_SBLive_sf2",library:"SBLive",displayName:"Soprano Sax"},{id:"0640_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Soprano Sax"},{id:"0650_Aspirin_sf2_file",library:"Aspirin",displayName:"Alto Sax"},{id:"0650_Chaos_sf2_file",library:"Chaos",displayName:"Alto Sax"},{id:"0650_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Alto Sax"},{id:"0650_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Alto Sax"},{id:"0650_JCLive_sf2_file",library:"JCLive",displayName:"Alto Sax"},{id:"0650_SBLive_sf2",library:"SBLive",displayName:"Alto Sax"},{id:"0650_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Alto Sax"},{id:"0660_Aspirin_sf2_file",library:"Aspirin",displayName:"Tenor Sax"},{id:"0660_Chaos_sf2_file",library:"Chaos",displayName:"Tenor Sax"},{id:"0660_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tenor Sax"},{id:"0660_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tenor Sax"},{id:"0660_JCLive_sf2_file",library:"JCLive",displayName:"Tenor Sax"},{id:"0660_SBLive_sf2",library:"SBLive",displayName:"Tenor Sax"},{id:"0660_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tenor Sax"},{id:"0670_Aspirin_sf2_file",library:"Aspirin",displayName:"Baritone Sax"},{id:"0670_Chaos_sf2_file",library:"Chaos",displayName:"Baritone Sax"},{id:"0670_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Baritone Sax"},{id:"0670_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Baritone Sax"},{id:"0670_JCLive_sf2_file",library:"JCLive",displayName:"Baritone Sax"},{id:"0670_SBLive_sf2",library:"SBLive",displayName:"Baritone Sax"},{id:"0670_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Baritone Sax"},{id:"0680_Aspirin_sf2_file",library:"Aspirin",displayName:"Oboe"},{id:"0680_Chaos_sf2_file",library:"Chaos",displayName:"Oboe"},{id:"0680_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Oboe"},{id:"0680_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Oboe"},{id:"0680_JCLive_sf2_file",library:"JCLive",displayName:"Oboe"},{id:"0680_SBLive_sf2",library:"SBLive",displayName:"Oboe"},{id:"0680_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Oboe"},{id:"0690_Aspirin_sf2_file",library:"Aspirin",displayName:"English Horn"},{id:"0690_Chaos_sf2_file",library:"Chaos",displayName:"English Horn"},{id:"0690_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"English Horn"},{id:"0690_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"English Horn"},{id:"0690_JCLive_sf2_file",library:"JCLive",displayName:"English Horn"},{id:"0690_SBLive_sf2",library:"SBLive",displayName:"English Horn"},{id:"0690_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"English Horn"},{id:"0700_Aspirin_sf2_file",library:"Aspirin",displayName:"Bassoon"},{id:"0700_Chaos_sf2_file",library:"Chaos",displayName:"Bassoon"},{id:"0700_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Bassoon"},{id:"0700_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Bassoon"},{id:"0700_JCLive_sf2_file",library:"JCLive",displayName:"Bassoon"},{id:"0700_SBLive_sf2",library:"SBLive",displayName:"Bassoon"},{id:"0700_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Bassoon"},{id:"0710_Aspirin_sf2_file",library:"Aspirin",displayName:"Clarinet"},{id:"0710_Chaos_sf2_file",library:"Chaos",displayName:"Clarinet"},{id:"0710_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Clarinet"},{id:"0710_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Clarinet"},{id:"0710_JCLive_sf2_file",library:"JCLive",displayName:"Clarinet"},{id:"0710_SBLive_sf2",library:"SBLive",displayName:"Clarinet"},{id:"0710_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Clarinet"},{id:"0720_Aspirin_sf2_file",library:"Aspirin",displayName:"Piccolo"},{id:"0720_Chaos_sf2_file",library:"Chaos",displayName:"Piccolo"},{id:"0720_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Piccolo"},{id:"0720_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Piccolo"},{id:"0720_JCLive_sf2_file",library:"JCLive",displayName:"Piccolo"},{id:"0720_SBLive_sf2",library:"SBLive",displayName:"Piccolo"},{id:"0720_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Piccolo"},{id:"0730_Aspirin_sf2_file",library:"Aspirin",displayName:"Flute"},{id:"0730_Chaos_sf2_file",library:"Chaos",displayName:"Flute"},{id:"0730_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Flute"},{id:"0730_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Flute"},{id:"0730_JCLive_sf2_file",library:"JCLive",displayName:"Flute"},{id:"0730_SBLive_sf2",library:"SBLive",displayName:"Flute"},{id:"0730_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Flute"},{id:"0740_Aspirin_sf2_file",library:"Aspirin",displayName:"Recorder"},{id:"0740_Chaos_sf2_file",library:"Chaos",displayName:"Recorder"},{id:"0740_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Recorder"},{id:"0740_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Recorder"},{id:"0740_JCLive_sf2_file",library:"JCLive",displayName:"Recorder"},{id:"0740_SBLive_sf2",library:"SBLive",displayName:"Recorder"},{id:"0740_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Recorder"},{id:"0750_Aspirin_sf2_file",library:"Aspirin",displayName:"Pan Flute"},{id:"0750_Chaos_sf2_file",library:"Chaos",displayName:"Pan Flute"},{id:"0750_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pan Flute"},{id:"0750_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pan Flute"},{id:"0750_JCLive_sf2_file",library:"JCLive",displayName:"Pan Flute"},{id:"0750_SBLive_sf2",library:"SBLive",displayName:"Pan Flute"},{id:"0750_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pan Flute"},{id:"0760_Aspirin_sf2_file",library:"Aspirin",displayName:"Blown Bottle"},{id:"0760_Chaos_sf2_file",library:"Chaos",displayName:"Blown Bottle"},{id:"0760_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Blown Bottle"},{id:"0760_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Blown Bottle"},{id:"0760_JCLive_sf2_file",library:"JCLive",displayName:"Blown Bottle"},{id:"0760_SBLive_sf2",library:"SBLive",displayName:"Blown Bottle"},{id:"0760_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Blown Bottle"},{id:"0770_Aspirin_sf2_file",library:"Aspirin",displayName:"Shakuhachi"},{id:"0770_Chaos_sf2_file",library:"Chaos",displayName:"Shakuhachi"},{id:"0770_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Shakuhachi"},{id:"0770_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Shakuhachi"},{id:"0770_JCLive_sf2_file",library:"JCLive",displayName:"Shakuhachi"},{id:"0770_SBLive_sf2",library:"SBLive",displayName:"Shakuhachi"},{id:"0770_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Shakuhachi"},{id:"0780_Aspirin_sf2_file",library:"Aspirin",displayName:"Whistle"},{id:"0780_Chaos_sf2_file",library:"Chaos",displayName:"Whistle"},{id:"0780_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Whistle"},{id:"0780_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Whistle"},{id:"0780_JCLive_sf2_file",library:"JCLive",displayName:"Whistle"},{id:"0780_SBLive_sf2",library:"SBLive",displayName:"Whistle"},{id:"0780_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Whistle"},{id:"0790_Aspirin_sf2_file",library:"Aspirin",displayName:"Ocarina"},{id:"0790_Chaos_sf2_file",library:"Chaos",displayName:"Ocarina"},{id:"0790_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Ocarina"},{id:"0790_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Ocarina"},{id:"0790_JCLive_sf2_file",library:"JCLive",displayName:"Ocarina"},{id:"0790_SBLive_sf2",library:"SBLive",displayName:"Ocarina"},{id:"0790_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Ocarina"},{id:"0800_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 1 (square)"},{id:"0800_Chaos_sf2_file",library:"Chaos",displayName:"Lead 1 (square)"},{id:"0800_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 1 (square)"},{id:"0800_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 1 (square)"},{id:"0800_JCLive_sf2_file",library:"JCLive",displayName:"Lead 1 (square)"},{id:"0800_SBLive_sf2",library:"SBLive",displayName:"Lead 1 (square)"},{id:"0800_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 1 (square)"},{id:"0810_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 2 (sawtooth)"},{id:"0810_Chaos_sf2_file",library:"Chaos",displayName:"Lead 2 (sawtooth)"},{id:"0810_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 2 (sawtooth)"},{id:"0810_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 2 (sawtooth)"},{id:"0810_JCLive_sf2_file",library:"JCLive",displayName:"Lead 2 (sawtooth)"},{id:"0810_SBLive_sf2",library:"SBLive",displayName:"Lead 2 (sawtooth)"},{id:"0810_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 2 (sawtooth)"},{id:"0820_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 3 (calliope)"},{id:"0820_Chaos_sf2_file",library:"Chaos",displayName:"Lead 3 (calliope)"},{id:"0820_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 3 (calliope)"},{id:"0820_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 3 (calliope)"},{id:"0820_JCLive_sf2_file",library:"JCLive",displayName:"Lead 3 (calliope)"},{id:"0820_SBLive_sf2",library:"SBLive",displayName:"Lead 3 (calliope)"},{id:"0820_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 3 (calliope)"},{id:"0830_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 4 (chiff)"},{id:"0830_Chaos_sf2_file",library:"Chaos",displayName:"Lead 4 (chiff)"},{id:"0830_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 4 (chiff)"},{id:"0830_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 4 (chiff)"},{id:"0830_JCLive_sf2_file",library:"JCLive",displayName:"Lead 4 (chiff)"},{id:"0830_SBLive_sf2",library:"SBLive",displayName:"Lead 4 (chiff)"},{id:"0830_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 4 (chiff)"},{id:"0840_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 5 (charang)"},{id:"0840_Chaos_sf2_file",library:"Chaos",displayName:"Lead 5 (charang)"},{id:"0840_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 5 (charang)"},{id:"0840_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 5 (charang)"},{id:"0840_JCLive_sf2_file",library:"JCLive",displayName:"Lead 5 (charang)"},{id:"0840_SBLive_sf2",library:"SBLive",displayName:"Lead 5 (charang)"},{id:"0840_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 5 (charang)"},{id:"0850_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 6 (voice)"},{id:"0850_Chaos_sf2_file",library:"Chaos",displayName:"Lead 6 (voice)"},{id:"0850_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 6 (voice)"},{id:"0850_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 6 (voice)"},{id:"0850_JCLive_sf2_file",library:"JCLive",displayName:"Lead 6 (voice)"},{id:"0850_SBLive_sf2",library:"SBLive",displayName:"Lead 6 (voice)"},{id:"0850_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 6 (voice)"},{id:"0860_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 7 (fifths)"},{id:"0860_Chaos_sf2_file",library:"Chaos",displayName:"Lead 7 (fifths)"},{id:"0860_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 7 (fifths)"},{id:"0860_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 7 (fifths)"},{id:"0860_JCLive_sf2_file",library:"JCLive",displayName:"Lead 7 (fifths)"},{id:"0860_SBLive_sf2",library:"SBLive",displayName:"Lead 7 (fifths)"},{id:"0860_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 7 (fifths)"},{id:"0870_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 8 (bass + lead)"},{id:"0870_Chaos_sf2_file",library:"Chaos",displayName:"Lead 8 (bass + lead)"},{id:"0870_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 8 (bass + lead)"},{id:"0870_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 8 (bass + lead)"},{id:"0870_JCLive_sf2_file",library:"JCLive",displayName:"Lead 8 (bass + lead)"},{id:"0870_SBLive_sf2",library:"SBLive",displayName:"Lead 8 (bass + lead)"},{id:"0870_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 8 (bass + lead)"},{id:"0880_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 1 (new age)"},{id:"0880_Chaos_sf2_file",library:"Chaos",displayName:"Pad 1 (new age)"},{id:"0880_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 1 (new age)"},{id:"0880_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 1 (new age)"},{id:"0880_JCLive_sf2_file",library:"JCLive",displayName:"Pad 1 (new age)"},{id:"0880_SBLive_sf2",library:"SBLive",displayName:"Pad 1 (new age)"},{id:"0880_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 1 (new age)"},{id:"0890_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 2 (warm)"},{id:"0890_Chaos_sf2_file",library:"Chaos",displayName:"Pad 2 (warm)"},{id:"0890_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 2 (warm)"},{id:"0890_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 2 (warm)"},{id:"0890_JCLive_sf2_file",library:"JCLive",displayName:"Pad 2 (warm)"},{id:"0890_SBLive_sf2",library:"SBLive",displayName:"Pad 2 (warm)"},{id:"0890_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 2 (warm)"},{id:"0900_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 3 (polysynth)"},{id:"0900_Chaos_sf2_file",library:"Chaos",displayName:"Pad 3 (polysynth)"},{id:"0900_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 3 (polysynth)"},{id:"0900_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 3 (polysynth)"},{id:"0900_JCLive_sf2_file",library:"JCLive",displayName:"Pad 3 (polysynth)"},{id:"0900_SBLive_sf2",library:"SBLive",displayName:"Pad 3 (polysynth)"},{id:"0900_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 3 (polysynth)"},{id:"0910_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 4 (choir)"},{id:"0910_Chaos_sf2_file",library:"Chaos",displayName:"Pad 4 (choir)"},{id:"0910_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 4 (choir)"},{id:"0910_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 4 (choir)"},{id:"0910_JCLive_sf2_file",library:"JCLive",displayName:"Pad 4 (choir)"},{id:"0910_SBLive_sf2",library:"SBLive",displayName:"Pad 4 (choir)"},{id:"0910_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 4 (choir)"},{id:"0920_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 5 (bowed)"},{id:"0920_Chaos_sf2_file",library:"Chaos",displayName:"Pad 5 (bowed)"},{id:"0920_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 5 (bowed)"},{id:"0920_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 5 (bowed)"},{id:"0920_JCLive_sf2_file",library:"JCLive",displayName:"Pad 5 (bowed)"},{id:"0920_SBLive_sf2",library:"SBLive",displayName:"Pad 5 (bowed)"},{id:"0920_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 5 (bowed)"},{id:"0930_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 6 (metallic)"},{id:"0930_Chaos_sf2_file",library:"Chaos",displayName:"Pad 6 (metallic)"},{id:"0930_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 6 (metallic)"},{id:"0930_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 6 (metallic)"},{id:"0930_JCLive_sf2_file",library:"JCLive",displayName:"Pad 6 (metallic)"},{id:"0930_SBLive_sf2",library:"SBLive",displayName:"Pad 6 (metallic)"},{id:"0930_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 6 (metallic)"},{id:"0940_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 7 (halo)"},{id:"0940_Chaos_sf2_file",library:"Chaos",displayName:"Pad 7 (halo)"},{id:"0940_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 7 (halo)"},{id:"0940_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 7 (halo)"},{id:"0940_JCLive_sf2_file",library:"JCLive",displayName:"Pad 7 (halo)"},{id:"0940_SBLive_sf2",library:"SBLive",displayName:"Pad 7 (halo)"},{id:"0940_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 7 (halo)"},{id:"0950_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 8 (sweep)"},{id:"0950_Chaos_sf2_file",library:"Chaos",displayName:"Pad 8 (sweep)"},{id:"0950_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 8 (sweep)"},{id:"0950_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 8 (sweep)"},{id:"0950_JCLive_sf2_file",library:"JCLive",displayName:"Pad 8 (sweep)"},{id:"0950_SBLive_sf2",library:"SBLive",displayName:"Pad 8 (sweep)"},{id:"0950_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 8 (sweep)"},{id:"0960_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 1 (rain)"},{id:"0960_Chaos_sf2_file",library:"Chaos",displayName:"FX 1 (rain)"},{id:"0960_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 1 (rain)"},{id:"0960_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 1 (rain)"},{id:"0960_JCLive_sf2_file",library:"JCLive",displayName:"FX 1 (rain)"},{id:"0960_SBLive_sf2",library:"SBLive",displayName:"FX 1 (rain)"},{id:"0960_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 1 (rain)"},{id:"0970_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 2 (soundtrack)"},{id:"0970_Chaos_sf2_file",library:"Chaos",displayName:"FX 2 (soundtrack)"},{id:"0970_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 2 (soundtrack)"},{id:"0970_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 2 (soundtrack)"},{id:"0970_JCLive_sf2_file",library:"JCLive",displayName:"FX 2 (soundtrack)"},{id:"0970_SBLive_sf2",library:"SBLive",displayName:"FX 2 (soundtrack)"},{id:"0970_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 2 (soundtrack)"},{id:"0980_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 3 (crystal)"},{id:"0980_Chaos_sf2_file",library:"Chaos",displayName:"FX 3 (crystal)"},{id:"0980_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 3 (crystal)"},{id:"0980_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 3 (crystal)"},{id:"0980_JCLive_sf2_file",library:"JCLive",displayName:"FX 3 (crystal)"},{id:"0980_SBLive_sf2",library:"SBLive",displayName:"FX 3 (crystal)"},{id:"0980_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 3 (crystal)"},{id:"0990_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 4 (atmosphere)"},{id:"0990_Chaos_sf2_file",library:"Chaos",displayName:"FX 4 (atmosphere)"},{id:"0990_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 4 (atmosphere)"},{id:"0990_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 4 (atmosphere)"},{id:"0990_JCLive_sf2_file",library:"JCLive",displayName:"FX 4 (atmosphere)"},{id:"0990_SBLive_sf2",library:"SBLive",displayName:"FX 4 (atmosphere)"},{id:"0990_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 4 (atmosphere)"},{id:"1000_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 5 (brightness)"},{id:"1000_Chaos_sf2_file",library:"Chaos",displayName:"FX 5 (brightness)"},{id:"1000_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 5 (brightness)"},{id:"1000_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 5 (brightness)"},{id:"1000_JCLive_sf2_file",library:"JCLive",displayName:"FX 5 (brightness)"},{id:"1000_SBLive_sf2",library:"SBLive",displayName:"FX 5 (brightness)"},{id:"1000_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 5 (brightness)"},{id:"1010_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 6 (goblins)"},{id:"1010_Chaos_sf2_file",library:"Chaos",displayName:"FX 6 (goblins)"},{id:"1010_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 6 (goblins)"},{id:"1010_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 6 (goblins)"},{id:"1010_JCLive_sf2_file",library:"JCLive",displayName:"FX 6 (goblins)"},{id:"1010_SBLive_sf2",library:"SBLive",displayName:"FX 6 (goblins)"},{id:"1010_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 6 (goblins)"},{id:"1020_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 7 (echoes)"},{id:"1020_Chaos_sf2_file",library:"Chaos",displayName:"FX 7 (echoes)"},{id:"1020_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 7 (echoes)"},{id:"1020_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 7 (echoes)"},{id:"1020_JCLive_sf2_file",library:"JCLive",displayName:"FX 7 (echoes)"},{id:"1020_SBLive_sf2",library:"SBLive",displayName:"FX 7 (echoes)"},{id:"1020_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 7 (echoes)"},{id:"1030_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 8 (sci-fi)"},{id:"1030_Chaos_sf2_file",library:"Chaos",displayName:"FX 8 (sci-fi)"},{id:"1030_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 8 (sci-fi)"},{id:"1030_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 8 (sci-fi)"},{id:"1030_JCLive_sf2_file",library:"JCLive",displayName:"FX 8 (sci-fi)"},{id:"1030_SBLive_sf2",library:"SBLive",displayName:"FX 8 (sci-fi)"},{id:"1030_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 8 (sci-fi)"},{id:"1040_Aspirin_sf2_file",library:"Aspirin",displayName:"Sitar"},{id:"1040_Chaos_sf2_file",library:"Chaos",displayName:"Sitar"},{id:"1040_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Sitar"},{id:"1040_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Sitar"},{id:"1040_JCLive_sf2_file",library:"JCLive",displayName:"Sitar"},{id:"1040_SBLive_sf2",library:"SBLive",displayName:"Sitar"},{id:"1040_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Sitar"},{id:"1050_Aspirin_sf2_file",library:"Aspirin",displayName:"Banjo"},{id:"1050_Chaos_sf2_file",library:"Chaos",displayName:"Banjo"},{id:"1050_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Banjo"},{id:"1050_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Banjo"},{id:"1050_JCLive_sf2_file",library:"JCLive",displayName:"Banjo"},{id:"1050_SBLive_sf2",library:"SBLive",displayName:"Banjo"},{id:"1050_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Banjo"},{id:"1060_Aspirin_sf2_file",library:"Aspirin",displayName:"Shamisen"},{id:"1060_Chaos_sf2_file",library:"Chaos",displayName:"Shamisen"},{id:"1060_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Shamisen"},{id:"1060_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Shamisen"},{id:"1060_JCLive_sf2_file",library:"JCLive",displayName:"Shamisen"},{id:"1060_SBLive_sf2",library:"SBLive",displayName:"Shamisen"},{id:"1060_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Shamisen"},{id:"1070_Aspirin_sf2_file",library:"Aspirin",displayName:"Koto"},{id:"1070_Chaos_sf2_file",library:"Chaos",displayName:"Koto"},{id:"1070_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Koto"},{id:"1070_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Koto"},{id:"1070_JCLive_sf2_file",library:"JCLive",displayName:"Koto"},{id:"1070_SBLive_sf2",library:"SBLive",displayName:"Koto"},{id:"1070_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Koto"},{id:"1080_Aspirin_sf2_file",library:"Aspirin",displayName:"Kalimba"},{id:"1080_Chaos_sf2_file",library:"Chaos",displayName:"Kalimba"},{id:"1080_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Kalimba"},{id:"1080_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Kalimba"},{id:"1080_JCLive_sf2_file",library:"JCLive",displayName:"Kalimba"},{id:"1080_SBLive_sf2",library:"SBLive",displayName:"Kalimba"},{id:"1080_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Kalimba"},{id:"1090_Aspirin_sf2_file",library:"Aspirin",displayName:"Bagpipe"},{id:"1090_Chaos_sf2_file",library:"Chaos",displayName:"Bagpipe"},{id:"1090_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Bagpipe"},{id:"1090_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Bagpipe"},{id:"1090_JCLive_sf2_file",library:"JCLive",displayName:"Bagpipe"},{id:"1090_SBLive_sf2",library:"SBLive",displayName:"Bagpipe"},{id:"1090_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Bagpipe"},{id:"1100_Aspirin_sf2_file",library:"Aspirin",displayName:"Fiddle"},{id:"1100_Chaos_sf2_file",library:"Chaos",displayName:"Fiddle"},{id:"1100_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Fiddle"},{id:"1100_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Fiddle"},{id:"1100_JCLive_sf2_file",library:"JCLive",displayName:"Fiddle"},{id:"1100_SBLive_sf2",library:"SBLive",displayName:"Fiddle"},{id:"1100_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Fiddle"},{id:"1110_Aspirin_sf2_file",library:"Aspirin",displayName:"Shanai"},{id:"1110_Chaos_sf2_file",library:"Chaos",displayName:"Shanai"},{id:"1110_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Shanai"},{id:"1110_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Shanai"},{id:"1110_JCLive_sf2_file",library:"JCLive",displayName:"Shanai"},{id:"1110_SBLive_sf2",library:"SBLive",displayName:"Shanai"},{id:"1110_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Shanai"},{id:"1120_Aspirin_sf2_file",library:"Aspirin",displayName:"Tinkle Bell"},{id:"1120_Chaos_sf2_file",library:"Chaos",displayName:"Tinkle Bell"},{id:"1120_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tinkle Bell"},{id:"1120_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tinkle Bell"},{id:"1120_JCLive_sf2_file",library:"JCLive",displayName:"Tinkle Bell"},{id:"1120_SBLive_sf2",library:"SBLive",displayName:"Tinkle Bell"},{id:"1120_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tinkle Bell"},{id:"1130_Aspirin_sf2_file",library:"Aspirin",displayName:"Agogo"},{id:"1130_Chaos_sf2_file",library:"Chaos",displayName:"Agogo"},{id:"1130_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Agogo"},{id:"1130_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Agogo"},{id:"1130_JCLive_sf2_file",library:"JCLive",displayName:"Agogo"},{id:"1130_SBLive_sf2",library:"SBLive",displayName:"Agogo"},{id:"1130_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Agogo"},{id:"1140_Aspirin_sf2_file",library:"Aspirin",displayName:"Steel Drums"},{id:"1140_Chaos_sf2_file",library:"Chaos",displayName:"Steel Drums"},{id:"1140_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Steel Drums"},{id:"1140_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Steel Drums"},{id:"1140_JCLive_sf2_file",library:"JCLive",displayName:"Steel Drums"},{id:"1140_SBLive_sf2",library:"SBLive",displayName:"Steel Drums"},{id:"1140_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Steel Drums"},{id:"1150_Aspirin_sf2_file",library:"Aspirin",displayName:"Woodblock"},{id:"1150_Chaos_sf2_file",library:"Chaos",displayName:"Woodblock"},{id:"1150_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Woodblock"},{id:"1150_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Woodblock"},{id:"1150_JCLive_sf2_file",library:"JCLive",displayName:"Woodblock"},{id:"1150_SBLive_sf2",library:"SBLive",displayName:"Woodblock"},{id:"1150_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Woodblock"},{id:"1160_Aspirin_sf2_file",library:"Aspirin",displayName:"Taiko Drum"},{id:"1160_Chaos_sf2_file",library:"Chaos",displayName:"Taiko Drum"},{id:"1160_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Taiko Drum"},{id:"1160_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Taiko Drum"},{id:"1160_JCLive_sf2_file",library:"JCLive",displayName:"Taiko Drum"},{id:"1160_SBLive_sf2",library:"SBLive",displayName:"Taiko Drum"},{id:"1160_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Taiko Drum"},{id:"1170_Aspirin_sf2_file",library:"Aspirin",displayName:"Melodic Tom"},{id:"1170_Chaos_sf2_file",library:"Chaos",displayName:"Melodic Tom"},{id:"1170_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Melodic Tom"},{id:"1170_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Melodic Tom"},{id:"1170_JCLive_sf2_file",library:"JCLive",displayName:"Melodic Tom"},{id:"1170_SBLive_sf2",library:"SBLive",displayName:"Melodic Tom"},{id:"1170_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Melodic Tom"},{id:"1180_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Drum"},{id:"1180_Chaos_sf2_file",library:"Chaos",displayName:"Synth Drum"},{id:"1180_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Drum"},{id:"1180_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Drum"},{id:"1180_JCLive_sf2_file",library:"JCLive",displayName:"Synth Drum"},{id:"1180_SBLive_sf2",library:"SBLive",displayName:"Synth Drum"},{id:"1180_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Drum"},{id:"1190_Aspirin_sf2_file",library:"Aspirin",displayName:"Reverse Cymbal"},{id:"1190_Chaos_sf2_file",library:"Chaos",displayName:"Reverse Cymbal"},{id:"1190_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Reverse Cymbal"},{id:"1190_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Reverse Cymbal"},{id:"1190_JCLive_sf2_file",library:"JCLive",displayName:"Reverse Cymbal"},{id:"1190_SBLive_sf2",library:"SBLive",displayName:"Reverse Cymbal"},{id:"1190_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Reverse Cymbal"},{id:"1200_Aspirin_sf2_file",library:"Aspirin",displayName:"Guitar Fret Noise"},{id:"1200_Chaos_sf2_file",library:"Chaos",displayName:"Guitar Fret Noise"},{id:"1200_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Guitar Fret Noise"},{id:"1200_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Guitar Fret Noise"},{id:"1200_JCLive_sf2_file",library:"JCLive",displayName:"Guitar Fret Noise"},{id:"1200_SBLive_sf2",library:"SBLive",displayName:"Guitar Fret Noise"},{id:"1200_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Guitar Fret Noise"},{id:"1210_Aspirin_sf2_file",library:"Aspirin",displayName:"Breath Noise"},{id:"1210_Chaos_sf2_file",library:"Chaos",displayName:"Breath Noise"},{id:"1210_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Breath Noise"},{id:"1210_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Breath Noise"},{id:"1210_JCLive_sf2_file",library:"JCLive",displayName:"Breath Noise"},{id:"1210_SBLive_sf2",library:"SBLive",displayName:"Breath Noise"},{id:"1210_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Breath Noise"},{id:"1220_Aspirin_sf2_file",library:"Aspirin",displayName:"Seashore"},{id:"1220_Chaos_sf2_file",library:"Chaos",displayName:"Seashore"},{id:"1220_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Seashore"},{id:"1220_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Seashore"},{id:"1220_JCLive_sf2_file",library:"JCLive",displayName:"Seashore"},{id:"1220_SBLive_sf2",library:"SBLive",displayName:"Seashore"},{id:"1220_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Seashore"},{id:"1230_Aspirin_sf2_file",library:"Aspirin",displayName:"Bird Tweet"},{id:"1230_Chaos_sf2_file",library:"Chaos",displayName:"Bird Tweet"},{id:"1230_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Bird Tweet"},{id:"1230_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Bird Tweet"},{id:"1230_JCLive_sf2_file",library:"JCLive",displayName:"Bird Tweet"},{id:"1230_SBLive_sf2",library:"SBLive",displayName:"Bird Tweet"},{id:"1230_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Bird Tweet"},{id:"1240_Aspirin_sf2_file",library:"Aspirin",displayName:"Telephone Ring"},{id:"1240_Chaos_sf2_file",library:"Chaos",displayName:"Telephone Ring"},{id:"1240_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Telephone Ring"},{id:"1240_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Telephone Ring"},{id:"1240_JCLive_sf2_file",library:"JCLive",displayName:"Telephone Ring"},{id:"1240_SBLive_sf2",library:"SBLive",displayName:"Telephone Ring"},{id:"1240_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Telephone Ring"},{id:"1250_Aspirin_sf2_file",library:"Aspirin",displayName:"Helicopter"},{id:"1250_Chaos_sf2_file",library:"Chaos",displayName:"Helicopter"},{id:"1250_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Helicopter"},{id:"1250_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Helicopter"},{id:"1250_JCLive_sf2_file",library:"JCLive",displayName:"Helicopter"},{id:"1250_SBLive_sf2",library:"SBLive",displayName:"Helicopter"},{id:"1250_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Helicopter"},{id:"1260_Aspirin_sf2_file",library:"Aspirin",displayName:"Applause"},{id:"1260_Chaos_sf2_file",library:"Chaos",displayName:"Applause"},{id:"1260_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Applause"},{id:"1260_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Applause"},{id:"1260_JCLive_sf2_file",library:"JCLive",displayName:"Applause"},{id:"1260_SBLive_sf2",library:"SBLive",displayName:"Applause"},{id:"1260_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Applause"},{id:"1270_Aspirin_sf2_file",library:"Aspirin",displayName:"Gunshot"},{id:"1270_Chaos_sf2_file",library:"Chaos",displayName:"Gunshot"},{id:"1270_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Gunshot"},{id:"1270_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Gunshot"},{id:"1270_JCLive_sf2_file",library:"JCLive",displayName:"Gunshot"},{id:"1270_SBLive_sf2",library:"SBLive",displayName:"Gunshot"},{id:"1270_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Gunshot"},{id:"12835_1_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 1"},{id:"12835_1_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 1"},{id:"12835_1_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 1"},{id:"12835_1_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 1"},{id:"12835_2_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 2"},{id:"12835_2_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 2"},{id:"12835_2_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 2"},{id:"12835_2_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 2"},{id:"12835_3_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 3"},{id:"12835_3_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 3"},{id:"12835_3_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 3"},{id:"12835_3_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 3"},{id:"12835_4_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 4"},{id:"12835_4_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 4"},{id:"12835_4_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 4"},{id:"12835_4_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 4"},{id:"12835_5_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 5"},{id:"12835_5_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 5"},{id:"12835_5_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 5"},{id:"12835_5_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 5"},{id:"12835_6_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 6"},{id:"12835_6_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 6"},{id:"12835_6_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 6"},{id:"12835_6_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 6"},{id:"12835_7_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 7"},{id:"12835_7_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 7"},{id:"12835_7_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 7"},{id:"12835_7_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 7"},{id:"12835_8_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 8"},{id:"12835_8_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 8"},{id:"12835_8_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 8"},{id:"12835_8_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 8"},{id:"12835_9_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 9"},{id:"12835_9_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 9"},{id:"12835_9_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 9"},{id:"12835_10_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 10"},{id:"12835_10_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 10"},{id:"12835_10_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 10"},{id:"12835_11_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 11"},{id:"12835_11_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 11"},{id:"12835_11_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 11"},{id:"12835_12_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 12"},{id:"12835_12_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 12"},{id:"12835_13_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 13"},{id:"12835_13_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 13"},{id:"12835_14_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 14"},{id:"12835_14_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 14"},{id:"12835_15_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 15"},{id:"12835_15_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 15"},{id:"12835_16_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 16"},{id:"12835_16_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 16"},{id:"12835_17_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 17"},{id:"12835_17_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 17"},{id:"12835_18_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 18"},{id:"12835_18_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 18"}],_t=new Map;let Ye=null;async function wt(e){return new Promise((i,t)=>{const a=document.createElement("script");a.src=e,a.onload=()=>i(),a.onerror=()=>t(new Error(`Failed to load script: ${e}`)),document.body.appendChild(a)})}async function dl(){Ye||(await wt("https://surikov.github.io/webaudiofont/npm/dist/WebAudioFontPlayer.js"),Ye=new window.WebAudioFontPlayer)}async function tr(e,i=ae(),t=null){const[a,s]=e.split("/"),r=`${a}/${s}`;_t.has(i)||_t.set(i,new Map);const n=_t.get(i);if(n.has(r))return n.get(r);await dl();const o=ir.find(p=>p.library===a&&p.displayName===s);if(!o)throw new Error(`Could not find WebAudioFont entry for library=${a} and instrument=${s}`);if(!o.displayName.startsWith("Drum Kit")){const p=`_tone_${o.id}`,h=`https://surikov.github.io/webaudiofontdata/sound/${o.id}.js`;await Er(wt(h));const y=window[p];if(!y)throw new Error(`Missing preset: ${p}`);Ye.loader.decodeAfterLoading(i,p);const m={_preset:y,start({note:g,duration:v=1,velocity:b=100,time:N}){const S=typeof g=="string"?F(g):g;if(S==null||typeof S!="number")return;const L=typeof N=="number"?N:0;Ye.queueWaveTable(i,t||be(),y,L,S,v,b/127)},stop(){},load:Promise.resolve()};return n.set(r,m),m}const[,c,l]=o.id.match(/^12835_(\d+)_([A-Za-z0-9]+)_sf2_file$/),u=parseInt(c,10),_={};await Er((async()=>{for(const p of Rn){const h=`_drum_${p}_${u}_${l}_sf2_file`,y=`https://surikov.github.io/webaudiofontdata/sound/${12800+p}_${u}_${l}_sf2_file.js`;try{await wt(y);const m=window[h];if(!m){console.warn(`Missing drum preset: ${h}`);continue}Ye.loader.decodeAfterLoading(i,h),_[p]=m}catch(m){console.warn(`Failed to load drum preset ${p}: ${m}`)}}})());const f={_preset:_,start({note:p,duration:h=1,velocity:y=100,time:m}){const g=typeof p=="string"?F(p):p;if(g==null||typeof g!="number"){console.warn(`Invalid MIDI pitch: ${p}`);return}const v=_[g];if(!v){console.warn(`No drum preset loaded for MIDI ${g}`);return}const b=typeof m=="number"?m:0;Ye.queueWaveTable(i,t||be(),v,b,g,h,y/127)},stop(){},load:Promise.resolve()};return n.set(r,f),f}async function cl(){const e=new Set;for(const i of ir)e.add(i.library);return Array.from(e)}async function ul(e){return ir.filter(i=>i.library===e).map(i=>i.displayName)}async function Er(e){Oa();try{return await e}finally{Ra()}}function fl(){return{name:"webaudiofont",loadInstrument:tr,getAvailableLibraries:cl,getAvailableInstruments:ul}}const nt={sf2:$o(),webaudiofont:fl()},Ma="sf2";async function Fr(e,i,t){const a=e.split("/");if(a.length!==3)throw new Error(`Invalid instrument fullName format: "${e}". Expected format "engine/library/instrument"`);const[s,r,n]=a,o=nt[s];if(!o)throw new Error(`Engine "${s}" not available`);return console.log("Calling instrument-loader.ts LoadInstrument with:",e,s,i,t),await o.loadInstrument(`${r}/${n}`,i,t)}async function _l(e=Ma){const i=nt[e];if(!i)throw new Error(`Engine "${e}" not available`);const t=await i.getAvailableLibraries();return console.log("getAvailableLibraries was called!: ",t),t}async function pl(e,i=Ma){const t=nt[i];if(!t)throw new Error(`Engine "${i}" not available`);return await t.getAvailableInstruments(e)}function yl(){return Object.keys(nt)}function ml(e,i,{getPitchRow:t,cellWidth:a,cellHeight:s,labelWidth:r}){if(!(e!=null&&e.animationCtx)){console.warn("Missing animationCtx in animateNotePlay");return}const n=i.start*a+r,o=t(i.pitch)*s,d=i.duration*a,c=s-1,l=n+d/2,u=o+c/2,f=(F(i.pitch)||0)*5%360,p=e.animationCtx,h=document.createElement("canvas");h.width=p.canvas.width,h.height=p.canvas.height;let y=h.getContext("2d");if(!y){console.warn("Could not get animation context from offscreen canvas");return}const m=performance.now(),g=qe();let v=i.duration*6e4/g;v=Math.max(100,Math.min(v,1600));const b=2,N=50;function S(E){const P=Math.sin(E*Math.PI),w=`hsla(${f}, 100%, 70%, ${.4*P})`;y&&(y.globalAlpha=1,y.fillStyle=w,y.beginPath(),y.roundRect(n,o,d,c,3),y.fill())}function L(E,P,w){const O=Math.sin(E*Math.PI),T=1+P*O,x=(1-E)*w;if(y){y.globalAlpha=x,y.strokeStyle=`hsl(${f}, 100%, 65%)`,y.lineWidth=1.5;const q=d*T,I=c*T;y.beginPath(),y.roundRect(l-q/2,u-I/2,q,I,4),y.stroke()}}function M(E){const P=E-m,w=P/v;if(w>1){y=null,h.width=0,h.height=0;return}if(y){y.clearRect(0,0,h.width,h.height),y.save(),S(w);for(let q=0;q<b;q++){const I=q*N,U=Math.max(0,Math.min(1,(P-I)/(v-I)));L(U,.1+q*.1,.3)}y.restore(),p.save();const O=1.5,T=d*O+8,x=c*O+8;p.clearRect(l-T/2,u-x/2,T,x),p.globalAlpha=1,p.drawImage(h,0,0),p.restore()}requestAnimationFrame(M)}requestAnimationFrame(M)}class wa{constructor(i,t,a=ae(),s=be(),r="sf2/fluidr3-gm/acoustic_grand_piano"){this.notes=[],this.colorIndex=0,this.id=0,this.mute=!1,this.solo=!1,this.shouldPlay=!0,this._activeNotes=new Set,this._noteHandlers=new Map,this._beatHandler=null,this._unsub=null,this.container=i,this.config={...t},this.context=a,this.destination=s,this.instrumentName=r,this.container&&(this.pianoRollCanvas=this.container.querySelector(".piano-roll"),this.gridCanvas=this.container.querySelector(".note-grid"),this.animationCanvas=this.container.querySelector(".note-animate-canvas"),this._initCanvases())}async initInstrument(){try{Fr(this.instrumentName,this.context,this.destination),this.updateToDrumNoteRange(),console.log(`[SEQ:${this.id}] Instrument '${this.instrumentName}' loaded`)}catch(i){console.error(`[SEQ:${this.id}] Failed to load instrument '${this.instrumentName}':`,i)}}updateTrackLabel(){var t;const i=(t=this.container)==null?void 0:t.querySelector(".track-name");i&&(i.textContent=`${this.id+1}: ${this.instrumentName}`)}setInstrument(i){this.instrumentName=i,this.updateTrackLabel(),this.initInstrument()}playNote(i,t,a=100,s=!1){return sd(this.instrumentName,i,t,a,s)}_initCanvases(){if(!this.container)return;const i=this.container.querySelector("canvas.note-grid"),t=this.container.querySelector("canvas.playhead-canvas"),a=this.container.querySelector("#grid-scroll-container"),s=this.container.querySelector("canvas.note-animate-canvas");this.grid=ol(i,t,s,a,this.notes,this.config,this),this.grid.scheduleRedraw()}onTransportLoop(){this._activeNotes.clear()}updateTotalMeasures(){var n,o,d;const i=K();this.clampNotesToGrid();const t=i*this.config.cellWidth+se,a=(n=this.container)==null?void 0:n.querySelector("canvas.note-grid"),s=(o=this.container)==null?void 0:o.querySelector(".playhead-canvas"),r=(d=this.container)==null?void 0:d.querySelector(".mini-contour");a&&(a.width=t,a.style.width=`${t}px`),s&&(s.width=t,s.style.width=`${t}px`),r&&si(r,this.notes,this.config,this.colorIndex),this.redraw()}clampNotesToGrid(){const i=K(),t=this.notes.filter(a=>a.start<i);t.forEach(a=>{a.start+a.duration>i&&(a.duration=i-a.start)}),this.notes.splice(0,this.notes.length,...t)}play(){this.stop(),this.clampNotesToGrid(),this._activeNotes.clear(),this._noteHandlers.clear();const t=60/qe();this._beatHandler=a=>{var s,r;if((s=this.grid)==null||s.drawPlayhead(this.grid.getXForBeat(a)),!!this.shouldPlay)for(const n of this.notes){const o=n.start,d=n.start+n.duration;if(!this._activeNotes.has(n)&&o<=a&&a<=d){const c=n.duration*t;if(this.playNote(n.pitch,c),(r=this.grid)!=null&&r.gridContext){const l=this.grid.gridContext;ml(l,n,{getPitchRow:l.getPitchRow,cellWidth:l.getCellWidth(),cellHeight:l.getCellHeight(),labelWidth:se})}this._activeNotes.add(n)}}},this._unsub=Bt(this._beatHandler),this._beatHandler(0)}stop(){var i,t,a;this._unsub&&(this._unsub(),this._unsub=null),this._beatHandler=null;for(const s of this._activeNotes){const r=this._noteHandlers.get(s);(i=r==null?void 0:r.forceStop)==null||i.call(r),(t=r==null?void 0:r.stop)==null||t.call(r)}this._activeNotes.clear(),this._noteHandlers.clear(),(a=this.grid)==null||a.drawPlayhead(0),this.redraw()}pause(){var i;for(const t of this._activeNotes){const a=this._noteHandlers.get(t);(i=a==null?void 0:a.stop)==null||i.call(a)}this._activeNotes.clear(),this._unsub&&(this._unsub(),this._unsub=null)}resume(){this._beatHandler&&!this._unsub&&(this._unsub=Bt(this._beatHandler))}seekTo(i){this.stop(),this.play()}toggleMute(){this.mute=!this.mute,this.mute&&(this.solo=!1),this.updateTrackStyle()}toggleSolo(){this.solo=!this.solo,this.solo&&(this.mute=!1),this.updateTrackStyle()}updateTrackStyle(){if(!this.container)return;const i=this.container.querySelector(".mute-btn"),t=this.container.querySelector(".solo-btn");i==null||i.classList.toggle("bg-red-600",this.mute),i==null||i.classList.toggle("bg-gray-700",!this.mute),t==null||t.classList.toggle("bg-yellow-200",this.solo),t==null||t.classList.toggle("bg-gray-700",!this.solo),this.container.classList.toggle("opacity-40",this.mute&&!this.solo),this.container.classList.toggle("opacity-100",!(this.mute&&!this.solo))}redraw(){var i;(i=this.grid)==null||i.scheduleRedraw()}destroy(){var i;this.stop(),(i=this.container)==null||i.remove()}getState(){return{notes:[...this.notes],config:{...this.config},instrument:this.instrumentName}}setState({notes:i,config:t,instrument:a}){this.notes.length=0,this.notes.push(...i),Object.assign(this.config,t),a&&(this.instrumentName=a),this.redraw()}updateNotesFromTrackMap(i){this.notes.splice(0,this.notes.length,...i.n.map(([t,a,s])=>({pitch:t,start:a,duration:s})))}async exportToOffline(){const i=60/qe(),t=await Fr(this.instrumentName,this.context,this.destination);for(const a of this.notes){const s=a.start*i,r=a.duration*i,n=F(a.pitch);if(n==null)continue;const o=this.instrumentName.split("/");if((o.length>=3?o[1]:o[0])==="drummachines"&&t.__midiMap){const c=t.__midiMap.get(n);c&&t.start({note:c,duration:r,velocity:100,time:s,loop:!1})}else t.start({note:n,duration:r,velocity:100,time:s,loop:!1})}}updateNoteRange(i){var l,u,_,f;const[t,a]=i,s=F(t),r=F(a);if(s===null||r===null){console.warn(`Invalid note range: ${i}`);return}if(s>=r){console.warn("Invalid note range: low note must be lower than high note");return}this.config.noteRange=i,this.config.visibleNotes=Ct(a,t)+1;const n=(l=this.container)==null?void 0:l.querySelector("canvas.note-grid"),o=(u=this.container)==null?void 0:u.querySelector(".playhead-canvas"),d=(_=this.container)==null?void 0:_.querySelector(".note-animate-canvas"),c=(f=this.container)==null?void 0:f.querySelector(".mini-contour");if(n&&o&&d){const p=this.config.visibleNotes*this.config.cellHeight;[n,o,d].forEach(h=>{h.height=p,h.style.height=`${p}px`}),c&&si(c,this.notes,this.config,this.colorIndex),this.redraw()}this.notes.forEach(p=>{const h=F(p.pitch);h!==null&&(h<s?p.pitch=t:h>r&&(p.pitch=a))})}updateToDrumNoteRange(){this.instrumentName.toLowerCase().includes("drum kit")?this.updateNoteRange(["B1","A5"]):this.updateNoteRange(["C1","B9"])}}let Me,Qe,Ea,Fa,xe,ce,ge="sf2";function hl(){Me=document.getElementById("instrument-select-modal"),Qe=document.getElementById("instrument-select"),Ea=document.getElementById("instrument-select-confirm"),Fa=document.getElementById("instrument-cancel-btn"),xe=document.getElementById("instrument-engine-select"),ce=document.getElementById("instrument-library-select"),bl(),gl()}function bl(){const e=yl();xe.innerHTML="",e.forEach(i=>{const t=document.createElement("option");t.value=i,t.textContent=i.toUpperCase(),xe.appendChild(t)}),xe.value=ge}function gl(){xe.addEventListener("change",async()=>{ge=xe.value,await Pa()}),ce.addEventListener("change",()=>{const e=new CustomEvent("instrument-library-change",{detail:{preselect:null}});ce.dispatchEvent(e)}),ce.addEventListener("instrument-library-change",async e=>{var s;const i=e,t=ce.value,a=((s=i.detail)==null?void 0:s.preselect)??null;try{const r=await pl(t,ge);Qe.innerHTML="",r.forEach(n=>{const o=document.createElement("option");o.value=`${ge}/${t}/${n}`,o.textContent=n.split("_").map(d=>d?d[0].toUpperCase()+d.slice(1):"").join(" "),Qe.appendChild(o)}),a?Qe.value=a:r.length>0&&(Qe.value=`${ge}/${t}/${r[0]}`)}catch(r){console.error(`Failed to load instruments for library: ${t}`,r)}}),Ea.addEventListener("click",vl),Fa.addEventListener("click",Sl)}async function Pa(e=null,i=null){try{const t=await _l(ge);ce.innerHTML="",t.forEach(s=>{const r=document.createElement("option");r.value=s,r.textContent=s.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()),ce.appendChild(r)}),e&&t.includes(e)?ce.value=e:t.length>0&&(ce.value=t[0]);const a=new CustomEvent("instrument-library-change",{detail:{preselect:i}});ce.dispatchEvent(a)}catch(t){console.error("Failed to refresh libraries for engine:",ge,t)}}async function ka(e,i){const[t,a,s]=e.split("/");ge=t||"sf2",xe.value=ge,i!==void 0?Me.dataset.currentSequencer=String(i):delete Me.dataset.currentSequencer,await Pa(a,e)}async function vl(){const e=Qe.value;Me.classList.add("hidden");const i=Number(Me.dataset.currentSequencer);if(Me.dataset.currentSequencer!==void 0&&!isNaN(i)){const t=Cl(i);if(t){H(rn(t.id,e),an(t.id,t.instrumentName)),t.setInstrument(e);return}console.warn(`Failed to find sequencer with ID ${i}`);return}if(Me.dataset.currentSequencer===void 0)try{return await Va(e),window.dispatchEvent(new CustomEvent("global-instrument-selected",{detail:{fullName:e}})),e}catch(t){console.error("Failed to load global instrument:",e,t)}}function Sl(){Me.classList.add("hidden")}const k=[],Nl=document.getElementById("sequencers-container"),Bl=document.getElementById("sequencer-template"),Aa=document.getElementById("add-sequencer");function Ia(e){const t=Bl.content.cloneNode(!0).querySelector(".sequencer");Nl.insertBefore(t,Aa);const a=k.length,s={id:a,...Q},r=(e==null?void 0:e.instrument)||"sf2/fluidr3-gm/acoustic_grand_piano",n=new wa(t,s,ae(),be(),r);n.id=a,n.colorIndex=a,n.mute=!1,n.solo=!1,n.shouldPlay=!0;const o=t.querySelector("canvas.mini-contour");e&&n.setState({notes:e.notes,config:{},instrument:e.instrument}),si(o,n.notes,n.config,n.colorIndex),n.updateTrackLabel(),n.initInstrument();const d=t.querySelector(".collapse-btn"),c=d.querySelector("use"),l=t.querySelector(".sequencer-body");d.addEventListener("click",()=>{const h=l.classList.toggle("hidden");c.setAttribute("href",h?"#icon-caret-up":"#icon-caret-down"),o.classList.toggle("hidden",!h),ki(t,!h),h&&si(o,n.notes,n.config,n.colorIndex)}),t.querySelector(".delete-btn").addEventListener("click",()=>{const h=document.getElementById("delete-confirm-modal"),y=document.getElementById("delete-confirm"),m=document.getElementById("delete-cancel");h.classList.remove("hidden");const g=()=>{const N=Zs(n.id,n.instrumentName,n.notes),S=en(n.id,n.instrumentName,n.notes);H(N,S),b()},v=()=>{b()},b=()=>{h.classList.add("hidden"),y.removeEventListener("click",g),m.removeEventListener("click",v)};y.addEventListener("click",g),m.addEventListener("click",v)});const _=t.querySelector(".mute-btn"),f=t.querySelector(".solo-btn"),p=t.querySelector(".instrument-select-btn");return _.addEventListener("click",()=>{n.mute=!n.mute,n.mute&&(n.solo=!1,f.classList.remove("bg-yellow-200","hover:bg-yellow-400"),f.classList.add("bg-gray-700","hover:bg-purple-700"),di(f,!1)),di(_,n.mute),Pr(),n.seekTo(Qi())}),f.addEventListener("click",()=>{n.solo=!n.solo,n.solo&&(n.mute=!1,di(_,!1)),f.classList.toggle("bg-yellow-200",n.solo),f.classList.toggle("bg-gray-700",!n.solo),f.classList.toggle("hover:bg-yellow-400",n.solo),f.classList.toggle("hover:bg-purple-700",!n.solo),Pr(),n.seekTo(Qi())}),p.addEventListener("click",async()=>{const h=n.instrumentName||"sf2/fluidr3-gm/acoustic_grand_piano";await ka(h,n.id),document.getElementById("instrument-select-modal").classList.remove("hidden")}),Al(t),di(_,!1),di(f,!1),f.classList.add("hover:bg-purple-700"),k.push(n),{seq:n,wrapper:t}}function ki(e,i){var t,a,s,r,n;(t=e.querySelector(".zoom-in-btn"))==null||t.classList.toggle("hidden",!i),(a=e.querySelector(".zoom-out-btn"))==null||a.classList.toggle("hidden",!i),(s=e.querySelector(".zoom-reset-btn"))==null||s.classList.toggle("hidden",!i),(r=e.querySelector(".zoom-button-divider"))==null||r.classList.toggle("hidden",!i),(n=e.querySelector(".grip-handle"))==null||n.classList.toggle("hidden",!i)}function Fe(){return k}function Cl(e){const i=e;return k.find(t=>t.id===i)}function Pr(){const e=k.some(i=>i.solo);k.forEach(i=>{i.shouldPlay=e?i.solo:!i.mute})}function di(e,i){e.classList.toggle("opacity-100",i),e.classList.toggle("opacity-40",!i)}function Gl(){k.slice().forEach(t=>t.destroy()),k.length=0;const e=oi(),i=structuredClone(e);i.sequencers=[],En(),pa(i),Ei(i)}function Ll(){document.getElementById("global-mini-contour"),Aa.addEventListener("click",()=>{const e=k.length;H(ua(e,"sf2/fluidr3-gm/acoustic_grand_piano"),Dt(e))})}const Ml=["Darkroom","Seashell","Cyberpunk","Classic Blue","Midnight"],wl=["Track Color","Pitch Class Contrast","Scriabin","Octave Bands"];function El(){const e=document.getElementById("grid-color-select"),i=document.getElementById("note-color-select");if(!e||!i)return;for(const a of Ml){const s=document.createElement("option");s.value=a,s.textContent=a,e.appendChild(s)}for(const a of wl){const s=document.createElement("option");s.value=a,s.textContent=a,i.appendChild(s)}const t=li();e.value=t.gridColorScheme,i.value=t.noteColorScheme,e.addEventListener("change",a=>{const s=a.target;wi({gridColorScheme:s.value}),Fe().forEach(r=>{var n;return(n=r.grid)==null?void 0:n.scheduleRedraw()})}),i.addEventListener("change",a=>{const s=a.target;wi({noteColorScheme:s.value}),Fe().forEach(r=>{var n;return(n=r.grid)==null?void 0:n.scheduleRedraw()})})}function Fl(){const e=document.getElementById("userconfig-modal"),i=document.querySelectorAll(".settings-tab"),t=document.querySelectorAll(".settings-section");if(!e)return;function a(){i.forEach(s=>{const r=s.dataset.tab;if(!r)return;const n=document.getElementById(r),o=n!==null&&!n.classList.contains("hidden");s.classList.toggle("text-purple-500",o),s.classList.toggle("opacity-100",o),s.classList.toggle("text-gray-500",!o),s.classList.toggle("opacity-50",!o)})}i.forEach(s=>{s.addEventListener("click",()=>{const r=s.dataset.tab;if(!r)return;t.forEach(o=>o.classList.add("hidden"));const n=document.getElementById(r);n&&n.classList.remove("hidden"),a()})}),a(),Ts(),El()}let kr=!1,Oe=!1,Re=!1;function Pl({getSequencers:e,onPlay:i,onStop:t,onPause:a,onResume:s,onDurationChange:r,onSnapChange:n,onToggleLoop:o,onTempoChange:d,onSave:c,onLoad:l,onMeasuresChange:u,onBeatsPerMeasureChange:_}){if(kr)return;kr=!0;const f=document.getElementById("play-button"),p=f.querySelector("use"),h=document.getElementById("stop-button"),y=document.getElementById("note-duration"),m=document.getElementById("dotted-note-btn"),g=document.getElementById("triplet-note-btn"),v=document.getElementById("snap-resolution"),b=document.getElementById("loop-toggle"),N=document.getElementById("tempo-input"),S=document.getElementById("save-button"),L=document.getElementById("load-button"),M=document.getElementById("measures-input"),E=document.getElementById("beats-per-measure-input"),P=document.getElementById("config-button"),w=document.getElementById("export-modal"),O=document.getElementById("export-json"),T=document.getElementById("export-wav"),x=document.getElementById("export-midi"),q=document.getElementById("export-cancel");y.value=String(Q.currentDuration||1),v.value=String(Q.snapResolution||.25);const I=document.getElementById("import-modal"),U=document.getElementById("import-json"),oe=document.getElementById("import-midi"),Pe=document.getElementById("import-cancel"),V=document.getElementById("load-input");L.addEventListener("click",()=>{I==null||I.classList.remove("hidden")}),V&&V.addEventListener("change",B=>{var W;const R=B.target,A=(W=R.files)==null?void 0:W[0];A&&l(A),R.value=""}),U&&U.addEventListener("click",()=>{I==null||I.classList.add("hidden"),V&&(V.setAttribute("accept",".json"),V.click())}),oe&&oe.addEventListener("click",()=>{I==null||I.classList.add("hidden"),V&&(V.setAttribute("accept",".mid,.midi"),V.click())}),Pe&&Pe.addEventListener("click",()=>{I==null||I.classList.add("hidden")}),p.setAttribute("href","#icon-play"),f.addEventListener("click",()=>{!Oe&&!Re?(Oe=!0,Re=!1,i(),p.setAttribute("href","#icon-pause")):Oe?(Oe=!1,Re=!0,a(),p.setAttribute("href","#icon-play")):Re&&(Oe=!0,Re=!1,s(),p.setAttribute("href","#icon-pause"))}),h.addEventListener("click",()=>{t(),Oe=!1,Re=!1,p.setAttribute("href","#icon-play")}),window.addEventListener("keydown",B=>{var W;if(document.querySelector(".ai-modal:not(.hidden)"))return;const A=(W=document.activeElement)==null?void 0:W.tagName;if(!(A==="INPUT"||A==="TEXTAREA")){if(B.code==="Space"){B.preventDefault(),f.click();return}if((B.metaKey||B.ctrlKey)&&(B.key==="z"&&Mn(),B.key==="y"&&wn()),(B.metaKey||B.ctrlKey)&&B.key.toLowerCase()==="r"){B.preventDefault();return}if(Sa()===Be.NOTE_PLACEMENT){if(Object.prototype.hasOwnProperty.call(yr,B.code)){B.preventDefault();const fe=yr[B.code];y.value=String(fe),y.dispatchEvent(new Event("change"))}if(B.key==="."){B.preventDefault(),m==null||m.click();return}if(B.key==="/"){B.preventDefault(),g==null||g.click();return}}}}),y.addEventListener("change",B=>{const R=B.target,A=parseFloat(R.value);Z(A),r(A),e().forEach(W=>{const fe=W.grid;if(fe!=null&&fe.getPreviewNote){const Ii=fe.getPreviewNote();Ii&&(Ii.duration=A,fe.scheduleRedraw())}})});function Z(B){document.querySelectorAll(".note-duration-btn").forEach(A=>{const W=parseFloat(A.dataset.value??"0");A.classList.remove("bg-purple-700","bg-gray-800"),W===B?A.classList.add("bg-purple-700"):A.classList.add("bg-gray-800")})}v.addEventListener("change",B=>{const A=B.target.value;Object.prototype.hasOwnProperty.call(ks,A)&&(Q.snapResolution=parseFloat(A),v.value=String(A),n(Q.snapResolution))}),b.addEventListener("change",B=>{const R=B.target;o(R.checked)}),N.addEventListener("change",B=>{const R=B.target,A=parseInt(R.value,10);isNaN(A)||d(A)}),S.addEventListener("click",()=>{w?w.classList.remove("hidden"):c("json")}),O&&O.addEventListener("click",()=>{w==null||w.classList.add("hidden"),c==null||c("json")}),T&&T.addEventListener("click",()=>{w==null||w.classList.add("hidden"),c==null||c("wav")}),x&&x.addEventListener("click",()=>{w==null||w.classList.add("hidden"),c==null||c("midi")}),q&&q.addEventListener("click",()=>{w==null||w.classList.add("hidden")}),P==null||P.addEventListener("click",()=>{const B=document.getElementById("userconfig-modal");B==null||B.classList.remove("hidden")}),Fl(),M&&(M.value=String(Pi())),E&&(E.value=String(Fi())),M==null||M.addEventListener("change",B=>{const R=B.target,A=parseInt(R.value,10);!isNaN(A)&&A>0&&(u==null||u(A))}),E==null||E.addEventListener("change",B=>{const R=B.target,A=parseInt(R.value,10);!isNaN(A)&&A>0&&(_==null||_(A))}),Z(parseFloat(y.value))}function kl(){Oe=!1,Re=!1;const e=document.getElementById("play-button"),i=e==null?void 0:e.querySelector("use");i&&i.setAttribute("href","#icon-play")}function Oa(){var e;Ns()||(e=document.getElementById("loading-modal"))==null||e.classList.remove("hidden")}function Ra(){var e;(e=document.getElementById("loading-modal"))==null||e.classList.add("hidden")}function Al(e){const i=e.querySelector(".cursor-grab");if(!i)return;const t=e.querySelector(".sequencer-body");if(!t)return;let a=!1,s=0,r=0;const n=150,o=1e3;i.addEventListener("mousedown",d=>{a=!0,s=d.clientY,r=t.offsetHeight,i.classList.replace("cursor-grab","cursor-grabbing"),document.body.style.userSelect="none"}),window.addEventListener("mousemove",d=>{if(!a)return;const c=d.clientY-s;let l=r+c;l=Math.max(n,Math.min(o,l)),t.style.height=`${l}px`}),window.addEventListener("mouseup",()=>{a&&(a=!1,i.classList.replace("cursor-grabbing","cursor-grab"),document.body.style.userSelect="")})}var Il=Object.defineProperty,Ol=Object.defineProperties,Rl=Object.getOwnPropertyDescriptors,Ar=Object.getOwnPropertySymbols,Tl=Object.prototype.hasOwnProperty,Ul=Object.prototype.propertyIsEnumerable,Ta=e=>{throw TypeError(e)},Ir=(e,i,t)=>i in e?Il(e,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[i]=t,le=(e,i)=>{for(var t in i||(i={}))Tl.call(i,t)&&Ir(e,t,i[t]);if(Ar)for(var t of Ar(i))Ul.call(i,t)&&Ir(e,t,i[t]);return e},Ee=(e,i)=>Ol(e,Rl(i)),rr=(e,i,t)=>i.has(e)||Ta("Cannot "+t),C=(e,i,t)=>(rr(e,i,"read from private field"),t?t.call(e):i.get(e)),$=(e,i,t)=>i.has(e)?Ta("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(e):i.set(e,t),J=(e,i,t,a)=>(rr(e,i,"write to private field"),i.set(e,t),t),Wi=(e,i,t)=>(rr(e,i,"access private method"),t),X=(e,i,t)=>new Promise((a,s)=>{var r=d=>{try{o(t.next(d))}catch(c){s(c)}},n=d=>{try{o(t.throw(d))}catch(c){s(c)}},o=d=>d.done?a(d.value):Promise.resolve(d.value).then(r,n);o((t=t.apply(e,i)).next())});function zi(e){const i=e.filter(t=>!!t);return i.reduce((t,a)=>{const s="output"in t?t.output:t,r="input"in a?a.input:a;return s.connect(r),a}),()=>{i.reduce((t,a)=>{const s="output"in t?t.output:t,r="input"in a?a.input:a;return s.disconnect(r),a})}}function Dl(e){let i=e;const t=new Set;function a(n){return t.add(n),n(i),()=>{t.delete(n)}}function s(n){i=n,t.forEach(o=>o(i))}function r(){return i}return{subscribe:a,set:s,get:r}}function Jl(){const e=new Set;function i(a){return e.add(a),()=>{e.delete(a)}}function t(a){e.forEach(s=>s(a))}return{subscribe:i,trigger:t}}function xl(e){let i=!1;return()=>{i||(i=!0,e.forEach(t=>t==null?void 0:t()))}}function Ua(e){return e*e/16129}function ql(e){return Math.pow(10,e/20)}var Te,Ge,Ke,We,ji,Ue,De,Da=class{constructor(e,i){this.context=e,$(this,Te),$(this,Ge),$(this,Ke),$(this,We),$(this,ji),$(this,Ue),$(this,De,!1);var t,a,s;J(this,Ue,{destination:(t=i==null?void 0:i.destination)!=null?t:e.destination,volume:(a=i==null?void 0:i.volume)!=null?a:100,volumeToGain:(s=i==null?void 0:i.volumeToGain)!=null?s:Ua}),this.input=e.createGain(),J(this,Te,e.createGain()),J(this,We,zi([this.input,C(this,Te),C(this,Ue).destination]));const r=Dl(C(this,Ue).volume);this.setVolume=r.set,J(this,ji,r.subscribe(n=>{C(this,Te).gain.value=C(this,Ue).volumeToGain(n)}))}addInsert(e){var i;if(C(this,De))throw Error("Can't add insert to disconnected channel");(i=C(this,Ke))!=null||J(this,Ke,[]),C(this,Ke).push(e),C(this,We).call(this),J(this,We,zi([this.input,...C(this,Ke),C(this,Te),C(this,Ue).destination]))}addEffect(e,i,t){var a;if(C(this,De))throw Error("Can't add effect to disconnected channel");const s=this.context.createGain();s.gain.value=t;const r="input"in i?i.input:i,n=zi([C(this,Te),s,r]);(a=C(this,Ge))!=null||J(this,Ge,[]),C(this,Ge).push({name:e,mix:s,disconnect:n})}sendEffect(e,i){var t;if(C(this,De))throw Error("Can't send effect to disconnected channel");const a=(t=C(this,Ge))==null?void 0:t.find(s=>s.name===e);a?a.mix.gain.value=i:console.warn("Send bus not found: "+e)}disconnect(){var e;C(this,De)||(J(this,De,!0),C(this,We).call(this),C(this,ji).call(this),(e=C(this,Ge))==null||e.forEach(i=>i.disconnect()),J(this,Ge,void 0))}};Te=new WeakMap;Ge=new WeakMap;Ke=new WeakMap;We=new WeakMap;ji=new WeakMap;Ue=new WeakMap;De=new WeakMap;var Y,Hl=class{constructor(e){this.compare=e,$(this,Y,[])}push(e){const i=C(this,Y).length;let t=0,a=i-1,s=i;for(;t<=a;){const r=Math.floor((t+a)/2);this.compare(e,C(this,Y)[r])<0?(s=r,a=r-1):t=r+1}C(this,Y).splice(s,0,e)}pop(){return C(this,Y).shift()}peek(){return C(this,Y)[0]}removeAll(e){const i=C(this,Y).length;return J(this,Y,C(this,Y).filter(t=>!e(t))),C(this,Y).length!==i}clear(){J(this,Y,[])}size(){return C(this,Y).length}};Y=new WeakMap;function Or(e,i){return e&&i?t=>{e(t),i(t)}:e??i}function $l(e){var i,t,a;const s={disableScheduler:(i=e.disableScheduler)!=null?i:!1,scheduleLookaheadMs:(t=e.scheduleLookaheadMs)!=null?t:200,scheduleIntervalMs:(a=e.scheduleIntervalMs)!=null?a:50,onStart:e.onStart,onEnded:e.onEnded};if(s.scheduleLookaheadMs<1)throw Error("scheduleLookaheadMs must be greater than 0");if(s.scheduleIntervalMs<1)throw Error("scheduleIntervalMs must be greater than 0");if(s.scheduleLookaheadMs<s.scheduleIntervalMs)throw Error("scheduleLookaheadMs must be greater than scheduleIntervalMs");return s}var pe,ie,Je,Ja=class{constructor(e,i={}){$(this,pe),$(this,ie),$(this,Je),J(this,pe,$l(i)),J(this,ie,new Hl((t,a)=>t.time-a.time)),this.player=e}get context(){return this.player.context}get buffers(){return this.player.buffers}get isRunning(){return C(this,Je)!==void 0}start(e){var i;if(C(this,pe).disableScheduler)return this.player.start(e);const t=this.player.context,a=t.currentTime,s=(i=e.time)!=null?i:a,r=C(this,pe).scheduleLookaheadMs/1e3;return e.onStart=Or(e.onStart,C(this,pe).onStart),e.onEnded=Or(e.onEnded,C(this,pe).onEnded),s<a+r?this.player.start(e):(C(this,ie).push(Ee(le({},e),{time:s})),C(this,Je)||J(this,Je,setInterval(()=>{const n=t.currentTime+r;for(;C(this,ie).size()&&C(this,ie).peek().time<=n;){const o=C(this,ie).pop();o&&this.player.start(o)}C(this,ie).size()||(clearInterval(C(this,Je)),J(this,Je,void 0))},C(this,pe).scheduleIntervalMs)),n=>{!n||n<s?C(this,ie).removeAll(o=>o===e)||this.player.stop(Ee(le({},e),{time:n})):this.player.stop(Ee(le({},e),{time:n}))})}stop(e){var i;if(C(this,pe).disableScheduler)return this.player.stop(e);if(this.player.stop(e),!e){C(this,ie).clear();return}const t=(i=e==null?void 0:e.time)!=null?i:0,a=e==null?void 0:e.stopId;a?C(this,ie).removeAll(s=>s.time>=t&&s.stopId?s.stopId===a:s.note===a):C(this,ie).removeAll(s=>s.time>=t)}disconnect(){this.player.disconnect()}};pe=new WeakMap;ie=new WeakMap;Je=new WeakMap;var hi,ze,bi,xa=class{constructor(e,i){this.context=e,this.options=i,$(this,hi),$(this,ze,!1),$(this,bi);var t,a;J(this,hi,{velocityToGain:(t=i.velocityToGain)!=null?t:Ua,destination:(a=i.destination)!=null?a:e.destination}),this.buffers={},J(this,bi,Jl())}start(e){var i,t,a,s,r,n,o,d,c,l,u,_,f,p;if(C(this,ze))throw new Error("Can't start a sample on disconnected player");const h=this.context,y=e.name&&this.buffers[e.name]||this.buffers[e.note];if(!y)return console.warn(`Sample not found: '${e.note}'`),()=>{};const m=h.createBufferSource();m.buffer=y;const g=(t=(i=e.detune)!=null?i:this.options.detune)!=null?t:0;m.detune?m.detune.value=g:m.playbackRate&&(m.playbackRate.value=Math.pow(2,g/1200));const v=(a=e.lpfCutoffHz)!=null?a:this.options.lpfCutoffHz,b=v?h.createBiquadFilter():void 0;v&&b&&(b.type="lowpass",b.frequency.value=v);const N=h.createGain(),S=(r=(s=e.velocity)!=null?s:this.options.velocity)!=null?r:100;N.gain.value=C(this,hi).velocityToGain(S),((n=e.loop)!=null?n:this.options.loop)&&(m.loop=!0,m.loopStart=(o=e.loopStart)!=null?o:0,m.loopEnd=(d=e.loopEnd)!=null?d:y.duration);const M=(c=e.decayTime)!=null?c:this.options.decayTime,[E,P]=Kl(h,M);function w(U){if(U??(U=h.currentTime),U<=q)m.stop(U);else{const oe=P(U);m.stop(oe)}}const O=e.gainOffset?h.createGain():void 0;O&&e.gainOffset&&(O.gain.value=e.gainOffset);const T=(l=e.stopId)!=null?l:e.note,x=xl([zi([m,b,N,E,O,C(this,hi).destination]),(u=e.stop)==null?void 0:u.call(e,w),C(this,bi).subscribe(U=>{(!U||U.stopId===void 0||U.stopId===T)&&w(U==null?void 0:U.time)})]);m.onended=()=>{var U;x(),(U=e.onEnded)==null||U.call(e,e)},(_=e.onStart)==null||_.call(e,e);const q=Math.max((f=e.time)!=null?f:0,h.currentTime);m.start(e.time);let I=(p=e.duration)!=null?p:y.duration;return typeof e.duration=="number"&&w(q+I),w}stop(e){C(this,bi).trigger(e)}disconnect(){C(this,ze)||(J(this,ze,!0),this.stop(),Object.keys(this.buffers).forEach(e=>{delete this.buffers[e]}))}get connected(){return!C(this,ze)}};hi=new WeakMap;ze=new WeakMap;bi=new WeakMap;function Kl(e,i=.2){let t=0;const a=e.createGain();a.gain.value=1;function s(r){if(t)return t;a.gain.cancelScheduledValues(r);const n=r||e.currentTime;return t=n+i,a.gain.setValueAtTime(1,n),a.gain.linearRampToValueAtTime(0,t),t}return[a,s]}var lt=class{constructor(e,i){this.context=e;const t=new Da(e,i);this.player=new Ja(new xa(e,Ee(le({},i),{destination:t.input})),i),this.output=t}get buffers(){return this.player.buffers}start(e){return this.player.start(e)}stop(e){this.player.stop(typeof e=="object"?e:e!==void 0?{stopId:e}:void 0)}disconnect(){this.output.disconnect(),this.player.disconnect()}};function ar(e,i,t){return X(this,null,function*(){i=i.replace(/#/g,"%23").replace(/([^:]\/)\/+/g,"$1");const a=yield t.fetch(i);if(a.status!==200){console.warn("Error loading buffer. Invalid status: ",a.status,i);return}try{const s=yield a.arrayBuffer();return yield e.decodeAudioData(s)}catch(s){console.warn("Error loading buffer",s,i)}})}function ot(e){if(typeof document>"u")return null;const i=document.createElement("audio");for(let t=0;t<e.length;t++){const a=e[t],s=i.canPlayType(`audio/${a}`);if(s==="probably"||s==="maybe")return a;if(a==="m4a"){const r=i.canPlayType("audio/aac");if(r==="probably"||r==="maybe")return a}}return null}function Wl(){var e;return"."+((e=ot(["ogg","m4a"]))!=null?e:"ogg")}var Ai={fetch(e){return fetch(e)}};function qa(e){return typeof e=="object"&&typeof e.baseUrl=="string"&&typeof e.name=="string"&&Array.isArray(e.samples)&&Array.isArray(e.groupNames)&&typeof e.nameToSampleName=="object"&&typeof e.sampleGroupVariations=="object"}var zl={baseUrl:"",name:"",samples:[],groupNames:[],nameToSampleName:{},sampleGroupVariations:{}};function jl(e,i){return X(this,null,function*(){var t,a,s,r;const o=yield(yield i.fetch(e)).json();o.baseUrl=e.replace("/dm.json",""),o.groupNames=[],o.nameToSampleName={},o.sampleGroupVariations={};for(const d of o.samples){o.nameToSampleName[d]=d;const c=d.indexOf("/")!==-1?"/":"-",[l,u]=d.split(c);o.groupNames.includes(l)||o.groupNames.push(l),(a=(t=o.nameToSampleName)[l])!=null||(t[l]=d),(r=(s=o.sampleGroupVariations)[l])!=null||(s[l]=[]),u&&o.sampleGroupVariations[l].push(`${l}${c}${u}`)}return o})}function Ha(){return Object.keys($a)}var $a={"TR-808":"https://smpldsnds.github.io/drum-machines/TR-808/dm.json","Casio-RZ1":"https://smpldsnds.github.io/drum-machines/Casio-RZ1/dm.json","LM-2":"https://smpldsnds.github.io/drum-machines/LM-2/dm.json","MFB-512":"https://smpldsnds.github.io/drum-machines/MFB-512/dm.json","Roland CR-8000":"https://smpldsnds.github.io/drum-machines/Roland-CR-8000/dm.json"};function Xl(e){var i,t,a;const s={instrument:(i=e==null?void 0:e.instrument)!=null?i:"TR-808",storage:(t=e==null?void 0:e.storage)!=null?t:Ai,url:(a=e==null?void 0:e.url)!=null?a:""};if(typeof s.instrument=="string"){if(s.url||(s.url=$a[s.instrument]),!s.url)throw new Error("Invalid instrument: "+s.instrument)}else if(!qa(s.instrument))throw new Error("Invalid instrument: "+s.instrument);return s}var ye,Vl=class{constructor(e,i){$(this,ye,zl);const t=Xl(i),a=qa(t.instrument)?Promise.resolve(t.instrument):jl(t.url,t.storage);this.player=new lt(e,i),this.output=this.player.output,this.load=Yl(e,this.player.buffers,a,t.storage).then(()=>this),a.then(s=>{J(this,ye,s)})}getSampleNames(){return C(this,ye).samples.slice()}getGroupNames(){return C(this,ye).groupNames.slice()}getSampleNamesForGroup(e){var i;return(i=C(this,ye).sampleGroupVariations[e])!=null?i:[]}start(e){var i;const t=C(this,ye).nameToSampleName[e.note];return this.player.start(Ee(le({},e),{note:t||e.note,stopId:(i=e.stopId)!=null?i:e.note}))}stop(e){return this.player.stop(e)}loaded(){return X(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}get sampleNames(){return console.log("deprecated: Use getGroupNames instead"),C(this,ye).groupNames.slice()}getVariations(e){var i;return console.warn("deprecated: use getSampleNamesForGroup"),(i=C(this,ye).sampleGroupVariations[e])!=null?i:[]}};ye=new WeakMap;function Yl(e,i,t,a){var s;const r=(s=ot(["ogg","m4a"]))!=null?s:"ogg";return t.then(n=>Promise.all(n.samples.map(o=>X(this,null,function*(){const d=`${n.baseUrl}/${o}.${r}`,c=yield ar(e,d,a);c&&(i[o]=c)}))))}function Ql(e){const t=/^([a-gA-G]?)(#{1,}|b{1,}|)(-?\d+)$/.exec(e);if(!t)return;const a=t[1].toUpperCase();if(!a)return;const s=t[2],r=s[0]==="b"?-s.length:s.length,n=t[3]?+t[3]:4,o=(a.charCodeAt(0)+3)%7;return[0,2,4,5,7,9,11][o]+r+12*(n+1)}function Ce(e){return e===void 0?void 0:typeof e=="number"?e:Ql(e)}function Zl(e={}){return{groups:[],options:e}}function sr(){return{regions:[]}}function Ka(e,i,t,a){const s=[],r=Ce(i.note);if(r===void 0)return s;for(const n of e.regions){const o=Wa(r,t??0,i,n,a);o&&s.push(o)}return s}function eo(e,i,t,a){const s=Ce(i.note);if(s!==void 0)for(const r of e.regions){const n=Wa(s,0,i,r,a);if(n)return n}}function Wa(e,i,t,a,s){var r,n,o,d,c,l,u,_,f,p,h,y,m,g,v,b,N,S,L,M,E,P,w,O,T,x,q,I;if(!(e>=((r=a.midiLow)!=null?r:0)&&e<((n=a.midiHigh)!=null?n:127)+1)||!(t.velocity===void 0||t.velocity>=((o=a.velLow)!=null?o:0)&&t.velocity<=((d=a.velHigh)!=null?d:127)))return;if(a.seqLength){const A=i%a.seqLength,W=((c=a.seqPosition)!=null?c:1)-1;if(A!==W)return}const Pe=e-a.midiPitch,V=(l=t.velocity)!=null?l:s==null?void 0:s.velocity,Z=a.volume?ql(a.volume):0,B=(_=(u=t.gainOffset)!=null?u:void 0)!=null?_:0,R=(f=t.detune)!=null?f:0;return{decayTime:(y=(h=t==null?void 0:t.decayTime)!=null?h:(p=a.sample)==null?void 0:p.decayTime)!=null?y:s==null?void 0:s.decayTime,detune:100*(Pe+((m=a.tune)!=null?m:0))+R,duration:(b=(v=t==null?void 0:t.duration)!=null?v:(g=a.sample)==null?void 0:g.duration)!=null?b:s==null?void 0:s.duration,gainOffset:B+Z||void 0,loop:(L=(S=t==null?void 0:t.loop)!=null?S:(N=a.sample)==null?void 0:N.loop)!=null?L:s==null?void 0:s.loop,loopEnd:(P=(E=t==null?void 0:t.loopEnd)!=null?E:(M=a.sample)==null?void 0:M.loopEnd)!=null?P:s==null?void 0:s.loopEnd,loopStart:(T=(O=t==null?void 0:t.loopStart)!=null?O:(w=a.sample)==null?void 0:w.loopStart)!=null?T:s==null?void 0:s.loopStart,lpfCutoffHz:(I=(q=t==null?void 0:t.lpfCutoffHz)!=null?q:(x=a.sample)==null?void 0:x.lpfCutoffHz)!=null?I:s==null?void 0:s.lpfCutoffHz,name:a.sampleName,note:e,onEnded:t.onEnded,onStart:t.onStart,stopId:t.name,time:t.time,velocity:V??void 0}}function io(e){if(e.length===0)return[];if(e.sort((i,t)=>i.midiPitch-t.midiPitch),e[0].midiLow=0,e[0].midiHigh=127,e.length===1)return e;for(let i=1;i<e.length;i++){const t=e[i-1],a=e[i],s=Math.floor((t.midiPitch+a.midiPitch)/2);t.midiHigh=s,a.midiLow=s+1}return e[e.length-1].midiHigh=127,e}var to=class{constructor(e,i){this.context=e,this.seqNum=0;const t=new Da(e,i);this.instrument=Zl(i),this.player=new Ja(new xa(e,Ee(le({},i),{destination:t.input})),i),this.output=t}get buffers(){return this.player.buffers}start(e){const i=[],t=typeof e=="object"?e:{note:e};for(const a of this.instrument.groups){const s=Ka(a,t,this.seqNum);this.seqNum++;for(const r of s){let n=this.player.start(r);i.push(n)}}return a=>i.forEach(s=>s(a))}stop(e){if(e==null){this.player.stop();return}const i=typeof e=="object"?e:{stopId:e},t=Ce(i.stopId);t&&(i.stopId=t,this.player.stop(i))}disconnect(){this.output.disconnect(),this.player.disconnect()}};function za(e,i){const t=Wl();return(a,s)=>X(this,null,function*(){const r=yield fetch(e).then(d=>d.text()),n=ro(r,i.group);n.length&&console.warn("Problems converting sfz",n);const o=new Set;return i.group.regions.forEach(d=>o.add(d.sampleName)),Promise.all(Array.from(o).map(d=>X(this,null,function*(){const c=i.urlFromSampleName(d,t),l=yield ar(a,c,s);i.buffers[d]=l}))).then(()=>i.group)})}function ro(e,i){let t="global";const a=e.split(`
`).map(oo).filter(n=>!!n),s=new co;let r=[];for(const n of a)switch(n.type){case"mode":r.push(s.closeScope(t,i)),t=n.value;break;case"prop:num":case"prop:str":case"prop:num_arr":s.push(n.key,n.value);break;case"unknown":console.warn("Unknown SFZ token",n.value);break}return r.filter(n=>!!n)}var ao=/^<([^>]+)>$/,so=/^([^=]+)=([-\.\d]+)$/,no=/^([^=]+)=(.+)$/,lo=/^([^=]+)_(\d+)=(\d+)$/;function oo(e){if(e=e.trim(),e===""||e.startsWith("//"))return;const i=e.match(ao);if(i)return{type:"mode",value:i[1]};const t=e.match(lo);if(t)return{type:"prop:num_arr",key:t[1],value:[Number(t[2]),Number(t[3])]};const a=e.match(so);if(a)return{type:"prop:num",key:a[1],value:Number(a[2])};const s=e.match(no);return s?{type:"prop:str",key:s[1],value:s[2]}:{type:"unknown",value:e}}var gi,Xi,co=class{constructor(){$(this,gi),this.values={},this.global={},this.group={}}closeScope(e,i){if(e==="global")Wi(this,gi,Xi).call(this,this.global);else if(e==="group")this.group=Wi(this,gi,Xi).call(this,{});else if(e==="region"){const t=Wi(this,gi,Xi).call(this,le(le({sampleName:"",midiPitch:-1},this.global),this.group));if(t.sampleName==="")return"Missing sample name";if(t.midiPitch===-1)if(t.midiLow!==void 0)t.midiPitch=t.midiLow;else return"Missing pitch_keycenter";t.seqLength&&t.seqPosition===void 0&&(t.seqPosition=1),t.ampRelease&&(t.sample={decayTime:t.ampRelease},delete t.ampRelease),i.regions.push(t)}}get empty(){return Object.keys(this.values).length===0}get keys(){return Object.keys(this.values)}push(e,i){this.values[e]=i}popNum(e,i,t){return typeof this.values[e]!="number"?!1:(i[t]=this.values[e],delete this.values[e],!0)}popStr(e,i,t){return typeof this.values[e]!="string"?!1:(i[t]=this.values[e],delete this.values[e],!0)}popNumArr(e,i,t){return Array.isArray(this.values[e])?(i[t]=this.values[e],delete this.values[e],!0):!1}};gi=new WeakSet;Xi=function(e){return this.popStr("sample",e,"sampleName"),this.popNum("pitch_keycenter",e,"midiPitch"),this.popNum("ampeg_attack",e,"ampAttack"),this.popNum("ampeg_release",e,"ampRelease"),this.popNum("bend_down",e,"bendDown"),this.popNum("bend_up",e,"bendUp"),this.popNum("group",e,"group"),this.popNum("hikey",e,"midiHigh"),this.popNum("hivel",e,"velHigh"),this.popNum("lokey",e,"midiLow"),this.popNum("offset",e,"offset"),this.popNum("lovel",e,"velLow"),this.popNum("off_by",e,"groupOffBy"),this.popNum("pitch_keytrack",e,"ignore"),this.popNum("seq_length",e,"seqLength"),this.popNum("seq_position",e,"seqPosition"),this.popNum("tune",e,"tune"),this.popNum("volume",e,"volume"),this.popNumArr("amp_velcurve",e,"ampVelCurve"),this.values={},e};var uo="https://smpldsnds.github.io/sgossner-vcsl/";function fo(e){return uo+e+".sfz"}function _o(e,i){const t=fo(e),s=`https://smpldsnds.github.io/sgossner-vcsl/${e.slice(0,e.lastIndexOf("/")+1)}`,r=sr();return za(t,{buffers:i,group:r,urlFromSampleName:(n,o)=>s+"/"+n.replace(".wav",o)})}var po=class{constructor(e,i={}){var t,a;this.config={instrument:(t=i.instrument)!=null?t:"Arco",storage:(a=i.storage)!=null?a:Ai},this.player=new to(e,i);const s=_o(this.config.instrument,this.player.buffers);this.load=s(e,this.config.storage).then(r=>(this.player.instrument.groups.push(r),this))}get output(){return this.player.output}get buffers(){return this.player.buffers}get context(){return this.player.context}start(e){return this.player.start(e)}stop(e){return this.player.stop(e)}disconnect(){this.player.disconnect()}};function yo(){return Object.keys(ja)}var mo=class extends po{constructor(e,i){var t;super(e,Ee(le({},i),{instrument:ja[(t=i.instrument)!=null?t:""]}))}},ja={"Balafon - Hard Mallet":"Idiophones/Struck Idiophones/Balafon - Hard Mallet","Balafon - Keyswitch":"Idiophones/Struck Idiophones/Balafon - Keyswitch","Balafon - Soft Mallet":"Idiophones/Struck Idiophones/Balafon - Soft Mallet","Balafon - Traditional Mallet":"Idiophones/Struck Idiophones/Balafon - Traditional Mallet","Tubular Bells 1":"Idiophones/Struck Idiophones/Tubular Bells 1","Tubular Bells 2":"Idiophones/Struck Idiophones/Tubular Bells 2","Vibraphone - Bowed":"Idiophones/Struck Idiophones/Vibraphone - Bowed","Vibraphone - Hard Mallets":"Idiophones/Struck Idiophones/Vibraphone - Hard Mallets","Vibraphone - Keyswitch":"Idiophones/Struck Idiophones/Vibraphone - Keyswitch","Vibraphone - Soft Mallets":"Idiophones/Struck Idiophones/Vibraphone - Soft Mallets","Xylophone - Hard Mallets":"Idiophones/Struck Idiophones/Xylophone - Hard Mallets","Xylophone - Keyswitch":"Idiophones/Struck Idiophones/Xylophone - Keyswitch","Xylophone - Medium Mallets":"Idiophones/Struck Idiophones/Xylophone - Medium Mallets","Xylophone - Soft Mallets":"Idiophones/Struck Idiophones/Xylophone - Soft Mallets"};function ho(){return["Pizzicato","Arco","Switched"]}function bo(e){return`https://smpldsnds.github.io/sfzinstruments-dsmolken-double-bass/d_smolken_rubner_bass_${{Arco:"arco",Pizzicato:"pizz",Switched:"switched"}[e]}.sfz`}var go=class{constructor(e,i={}){this.seqNum=0;var t,a;this.config={instrument:(t=i.instrument)!=null?t:"Arco",storage:(a=i.storage)!=null?a:Ai},this.player=new lt(e,i),this.group=sr();const s=bo(this.config.instrument),r=za(s,{buffers:this.player.buffers,group:this.group,urlFromSampleName:(n,o)=>`https://smpldsnds.github.io/sfzinstruments-dsmolken-double-bass/${n.replace("\\","/").replace(".wav",o)}`});this.load=r(e,this.config.storage).then(()=>this)}get output(){return this.player.output}get buffers(){return this.player.buffers}get context(){return this.player.context}start(e){const i=Ka(this.group,typeof e=="object"?e:{note:e},this.seqNum);this.seqNum++;const t=i.map(a=>this.player.start(a));return a=>t.forEach(s=>s(a))}stop(e){if(e==null){this.player.stop();return}const i=typeof e=="object"?e:{stopId:e},t=Ce(i.stopId);t&&(i.stopId=t,this.player.stop(i))}disconnect(){this.player.disconnect()}};function vo(e,i){var t;const a=(t=ot(["ogg","mp3"]))!=null?t:"mp3";return`https://gleitz.github.io/midi-js-soundfonts/${i}/${e}-${a}.js`}function So(e,i,t){return(a,s)=>X(this,null,function*(){const r=yield(yield s.fetch(e)).text(),n=No(r),o=Object.keys(n);yield Promise.all(o.map(d=>X(this,null,function*(){const c=Ce(d);if(!c)return;const l=Co(Bo(n[d])),u=yield a.decodeAudioData(l);i[d]=u,t.regions.push({sampleName:d,midiPitch:c})}))),io(t.regions)})}function No(e){const i=e.indexOf("MIDI.Soundfont.");if(i<0)throw Error("Invalid MIDI.js Soundfont format");const t=e.indexOf("=",i)+2,a=e.lastIndexOf(",");return JSON.parse(e.slice(t,a)+"}")}function Bo(e){return e.slice(e.indexOf(",")+1)}function Co(e){const i=window.atob(e),t=i.length,a=new Uint8Array(t);for(let s=0;s<t;s++)a[s]=i.charCodeAt(s);return a.buffer}var Go=["MusyngKite","FluidR3_GM"],Lo=["accordion","acoustic_bass","acoustic_grand_piano","acoustic_guitar_nylon","acoustic_guitar_steel","agogo","alto_sax","applause","bagpipe","banjo","baritone_sax","bassoon","bird_tweet","blown_bottle","brass_section","breath_noise","bright_acoustic_piano","celesta","cello","choir_aahs","church_organ","clarinet","clavinet","contrabass","distortion_guitar","drawbar_organ","dulcimer","electric_bass_finger","electric_bass_pick","electric_grand_piano","electric_guitar_clean","electric_guitar_jazz","electric_guitar_muted","electric_piano_1","electric_piano_2","english_horn","fiddle","flute","french_horn","fretless_bass","fx_1_rain","fx_2_soundtrack","fx_3_crystal","fx_4_atmosphere","fx_5_brightness","fx_6_goblins","fx_7_echoes","fx_8_scifi","glockenspiel","guitar_fret_noise","guitar_harmonics","gunshot","harmonica","harpsichord","helicopter","honkytonk_piano","kalimba","koto","lead_1_square","lead_2_sawtooth","lead_3_calliope","lead_4_chiff","lead_5_charang","lead_6_voice","lead_7_fifths","lead_8_bass__lead","marimba","melodic_tom","music_box","muted_trumpet","oboe","ocarina","orchestra_hit","orchestral_harp","overdriven_guitar","pad_1_new_age","pad_2_warm","pad_3_polysynth","pad_4_choir","pad_5_bowed","pad_6_metallic","pad_7_halo","pad_8_sweep","pan_flute","percussive_organ","piccolo","pizzicato_strings","recorder","reed_organ","reverse_cymbal","rock_organ","seashore","shakuhachi","shamisen","shanai","sitar","slap_bass_1","slap_bass_2","soprano_sax","steel_drums","string_ensemble_1","string_ensemble_2","synth_bass_1","synth_bass_2","synth_brass_1","synth_brass_2","synth_choir","synth_drum","synth_strings_1","synth_strings_2","taiko_drum","tango_accordion","telephone_ring","tenor_sax","timpani","tinkle_bell","tremolo_strings","trombone","trumpet","tuba","tubular_bells","vibraphone","viola","violin","voice_oohs","whistle","woodblock","xylophone"];function Mo(e,i){if(!e.startsWith("http"))return`https://goldst.dev/midi-js-soundfonts/${i}/${e}-loop.json`}function wo(e,i=44100){return X(this,null,function*(){if(e)try{const t=yield fetch(e);if(t.status!==200)return;const a=yield t.json(),s={};return Object.keys(a).forEach(r=>{const n=Ce(r);if(n){const o=a[r];s[n]=[o[0]/i,o[1]/i]}}),s}catch{return}})}function Eo(){return Go}function Fo(){return Lo}var vi,Po=class{constructor(e,i){this.context=e,$(this,vi),this.config=Ao(i),this.player=new lt(e,i),this.group=sr(),J(this,vi,!1);const t=ko(this.config.instrumentUrl,this.config.loopDataUrl,this.player.buffers,this.group);this.load=t(e,this.config.storage).then(s=>(J(this,vi,s),this));const a=e.createGain();a.gain.value=this.config.extraGain,this.player.output.addInsert(a)}get output(){return this.player.output}get hasLoops(){return C(this,vi)}loaded(){return X(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}disconnect(){this.player.disconnect()}start(e){const i=eo(this.group,typeof e=="object"?e:{note:e});return i?this.player.start(i):()=>{}}stop(e){return this.player.stop(e)}};vi=new WeakMap;function ko(e,i,t,a){const s=So(e,t,a);return(r,n)=>X(this,null,function*(){const[o,d]=yield Promise.all([s(r,n),wo(i)]);return d&&a.regions.forEach(c=>{var l;const u=d[c.midiPitch];u&&((l=c.sample)!=null||(c.sample={}),c.sample.loop=!0,c.sample.loopStart=u[0],c.sample.loopEnd=u[1])}),!!d})}function Ao(e){var i,t,a,s;if(!e.instrument&&!e.instrumentUrl)throw Error("Soundfont: instrument or instrumentUrl is required");const r={kit:"MusyngKite",instrument:e.instrument,storage:(i=e.storage)!=null?i:Ai,extraGain:(t=e.extraGain)!=null?t:5,loadLoopData:(a=e.loadLoopData)!=null?a:!1,loopDataUrl:e.loopDataUrl,instrumentUrl:(s=e.instrumentUrl)!=null?s:""};if(r.instrument&&r.instrument.startsWith("http")&&(console.warn("Use 'instrumentUrl' instead of 'instrument' to load from a URL"),r.instrumentUrl=r.instrument,r.instrument=void 0),r.instrumentUrl)(r.kit||r.instrument)&&console.warn("Soundfont: 'kit' and 'instrument' config parameters are ignored because 'instrumentUrl' is explicitly set.");else if(r.instrument)r.instrumentUrl=vo(r.instrument,r.kit);else throw Error("Soundfont: 'instrument' or 'instrumentUrl' configuration parameter is required");return r.loadLoopData&&r.instrument&&!r.loopDataUrl&&(r.loopDataUrl=Mo(r.instrument,r.kit)),r}var Io="https://danigb.github.io/samples/splendid-grand-piano",Et,Xa,Oo=class{constructor(e,i){this.context=e,$(this,Et),this.options=Object.assign({baseUrl:Io,storage:Ai,detune:0,volume:100,velocity:100,decayTime:.5},i),this.player=new lt(e,this.options);const t=To(this.options.baseUrl,this.options.storage,this.options.notesToLoad);this.load=t(e,this.player.buffers).then(()=>this)}get output(){return this.player.output}get buffers(){return this.player.buffers}loaded(){return X(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}start(e){var i,t;const a=typeof e=="object"?le({},e):{note:e},s=Wi(this,Et,Xa).call(this,a);return s?(a.note=s[0],a.stopId=(i=a.stopId)!=null?i:s[1],a.detune=s[2]+((t=a.detune)!=null?t:this.options.detune),this.player.start(a)):()=>{}}stop(e){var i;if(typeof e=="string")return this.player.stop((i=Ce(e))!=null?i:e);if(typeof e=="object"){const t=Ce(e.stopId);return this.player.stop(t!==void 0?Ee(le({},e),{stopId:t}):e)}else return this.player.stop(e)}};Et=new WeakSet;Xa=function(e){var i;const t=Ce(e.note);if(!t)return;const a=(i=e.velocity)!=null?i:this.options.velocity,s=it.findIndex(n=>a>=n.vel_range[0]&&a<=n.vel_range[1]),r=it[s];if(r)return Ro(r.name,t,this.player.buffers)};function Ro(e,i,t){let a=0;for(;t[e+(i+a)]===void 0&&a<128;)a>0?a=-a:a=-a+1;return a===127?[e+i,i,0]:[e+(i+a),i,-a*100]}function To(e,i,t){var a;const s=(a=ot(["ogg","m4a"]))!=null?a:"ogg";let r=t?it.filter(n=>n.vel_range[0]<=t.velocityRange[1]&&n.vel_range[1]>=t.velocityRange[0]):it;return(n,o)=>X(this,null,function*(){for(const d of r){const c=t?d.samples.filter(l=>t.notes.includes(l[0])):d.samples;yield Promise.all(c.map(l=>X(this,[l],function*([u,_]){const f=`${e}/${_}.${s}`,p=yield ar(n,f,i);p&&(o[d.name+u]=p)})))}})}var it=[{name:"PPP",vel_range:[1,40],cutoff:1e3,samples:[[23,"PP-B-1"],[27,"PP-D#0"],[29,"PP-F0"],[31,"PP-G0"],[33,"PP-A0"],[35,"PP-B0"],[37,"PP-C#1"],[38,"PP-D1"],[40,"PP-E1"],[41,"PP-F1"],[43,"PP-G1"],[45,"PP-A1"],[47,"PP-B1"],[48,"PP-C2"],[50,"PP-D2"],[52,"PP-E2"],[53,"PP-F2"],[55,"PP-G2"],[56,"PP-G#2"],[57,"PP-A2"],[58,"PP-A#2"],[59,"PP-B2"],[60,"PP-C3"],[62,"PP-D3"],[64,"PP-E3"],[65,"PP-F3"],[67,"PP-G3"],[69,"PP-A3"],[71,"PP-B3"],[72,"PP-C4"],[74,"PP-D4"],[76,"PP-E4"],[77,"PP-F4"],[79,"PP-G4"],[80,"PP-G#4"],[81,"PP-A4"],[82,"PP-A#4"],[83,"PP-B4"],[85,"PP-C#5"],[86,"PP-D5"],[87,"PP-D#5"],[89,"PP-F5"],[90,"PP-F#5"],[91,"PP-G5"],[92,"PP-G#5"],[93,"PP-A5"],[94,"PP-A#5"],[95,"PP-B5"],[96,"PP-C6"],[97,"PP-C#6"],[98,"PP-D6"],[99,"PP-D#6"],[100,"PP-E6"],[101,"PP-F6"],[102,"PP-F#6"],[103,"PP-G6"],[104,"PP-G#6"],[105,"PP-A6"],[106,"PP-A#6"],[107,"PP-B6"],[108,"PP-C7"]]},{name:"PP",vel_range:[41,67],samples:[[23,"PP-B-1"],[27,"PP-D#0"],[29,"PP-F0"],[31,"PP-G0"],[33,"PP-A0"],[35,"PP-B0"],[37,"PP-C#1"],[38,"PP-D1"],[40,"PP-E1"],[41,"PP-F1"],[43,"PP-G1"],[45,"PP-A1"],[47,"PP-B1"],[48,"PP-C2"],[50,"PP-D2"],[52,"PP-E2"],[53,"PP-F2"],[55,"PP-G2"],[56,"PP-G#2"],[57,"PP-A2"],[58,"PP-A#2"],[59,"PP-B2"],[60,"PP-C3"],[62,"PP-D3"],[64,"PP-E3"],[65,"PP-F3"],[67,"PP-G3"],[69,"PP-A3"],[71,"PP-B3"],[72,"PP-C4"],[74,"PP-D4"],[76,"PP-E4"],[77,"PP-F4"],[79,"PP-G4"],[80,"PP-G#4"],[81,"PP-A4"],[82,"PP-A#4"],[83,"PP-B4"],[85,"PP-C#5"],[86,"PP-D5"],[87,"PP-D#5"],[89,"PP-F5"],[90,"PP-F#5"],[91,"PP-G5"],[92,"PP-G#5"],[93,"PP-A5"],[94,"PP-A#5"],[95,"PP-B5"],[96,"PP-C6"],[97,"PP-C#6"],[98,"PP-D6"],[99,"PP-D#6"],[100,"PP-E6"],[101,"PP-F6"],[102,"PP-F#6"],[103,"PP-G6"],[104,"PP-G#6"],[105,"PP-A6"],[106,"PP-A#6"],[107,"PP-B6"],[108,"PP-C7"]]},{name:"MP",vel_range:[68,84],samples:[[23,"Mp-B-1"],[27,"Mp-D#0"],[29,"Mp-F0"],[31,"Mp-G0"],[33,"Mp-A0"],[35,"Mp-B0"],[37,"Mp-C#1"],[38,"Mp-D1"],[40,"Mp-E1"],[41,"Mp-F1"],[43,"Mp-G1"],[45,"Mp-A1"],[47,"Mp-B1"],[48,"Mp-C2"],[50,"Mp-D2"],[52,"Mp-E2"],[53,"Mp-F2"],[55,"Mp-G2"],[56,"Mp-G#2"],[57,"Mp-A2"],[58,"Mp-A#2"],[59,"Mp-B2"],[60,"Mp-C3"],[62,"Mp-D3"],[64,"Mp-E3"],[65,"Mp-F3"],[67,"Mp-G3"],[69,"Mp-A3"],[71,"Mp-B3"],[72,"Mp-C4"],[74,"Mp-D4"],[76,"Mp-E4"],[77,"Mp-F4"],[79,"Mp-G4"],[80,"Mp-G#4"],[81,"Mp-A4"],[82,"Mp-A#4"],[83,"Mp-B4"],[85,"Mp-C#5"],[86,"Mp-D5"],[87,"Mp-D#5"],[88,"Mp-E5"],[89,"Mp-F5"],[90,"Mp-F#5"],[91,"Mp-G5"],[92,"Mp-G#5"],[93,"Mp-A5"],[94,"Mp-A#5"],[95,"Mp-B5"],[96,"Mp-C6"],[97,"Mp-C#6"],[98,"Mp-D6"],[99,"Mp-D#6"],[100,"PP-E6"],[101,"Mp-F6"],[102,"Mp-F#6"],[103,"Mp-G6"],[104,"Mp-G#6"],[105,"Mp-A6"],[106,"Mp-A#6"],[107,"PP-B6"],[108,"PP-C7"]]},{name:"MF",vel_range:[85,100],samples:[[23,"Mf-B-1"],[27,"Mf-D#0"],[29,"Mf-F0"],[31,"Mf-G0"],[33,"Mf-A0"],[35,"Mf-B0"],[37,"Mf-C#1"],[38,"Mf-D1"],[40,"Mf-E1"],[41,"Mf-F1"],[43,"Mf-G1"],[45,"Mf-A1"],[47,"Mf-B1"],[48,"Mf-C2"],[50,"Mf-D2"],[52,"Mf-E2"],[53,"Mf-F2"],[55,"Mf-G2"],[56,"Mf-G#2"],[57,"Mf-A2"],[58,"Mf-A#2"],[59,"Mf-B2"],[60,"Mf-C3"],[62,"Mf-D3"],[64,"Mf-E3"],[65,"Mf-F3"],[67,"Mf-G3"],[69,"Mf-A3"],[71,"Mf-B3"],[72,"Mf-C4"],[74,"Mf-D4"],[76,"Mf-E4"],[77,"Mf-F4"],[79,"Mf-G4"],[80,"Mf-G#4"],[81,"Mf-A4"],[82,"Mf-A#4"],[83,"Mf-B4"],[85,"Mf-C#5"],[86,"Mf-D5"],[87,"Mf-D#5"],[88,"Mf-E5"],[89,"Mf-F5"],[90,"Mf-F#5"],[91,"Mf-G5"],[92,"Mf-G#5"],[93,"Mf-A5"],[94,"Mf-A#5"],[95,"Mf-B5"],[96,"Mf-C6"],[97,"Mf-C#6"],[98,"Mf-D6"],[99,"Mf-D#6"],[100,"Mf-E6"],[101,"Mf-F6"],[102,"Mf-F#6"],[103,"Mf-G6"],[104,"Mf-G#6"],[105,"Mf-A6"],[106,"Mf-A#6"],[107,"Mf-B6"],[108,"PP-C7"]]},{name:"FF",vel_range:[101,127],samples:[[23,"FF-B-1"],[27,"FF-D#0"],[29,"FF-F0"],[31,"FF-G0"],[33,"FF-A0"],[35,"FF-B0"],[37,"FF-C#1"],[38,"FF-D1"],[40,"FF-E1"],[41,"FF-F1"],[43,"FF-G1"],[45,"FF-A1"],[47,"FF-B1"],[48,"FF-C2"],[50,"FF-D2"],[52,"FF-E2"],[53,"FF-F2"],[55,"FF-G2"],[56,"FF-G#2"],[57,"FF-A2"],[58,"FF-A#2"],[59,"FF-B2"],[60,"FF-C3"],[62,"FF-D3"],[64,"FF-E3"],[65,"FF-F3"],[67,"FF-G3"],[69,"FF-A3"],[71,"FF-B3"],[72,"FF-C4"],[74,"FF-D4"],[76,"FF-E4"],[77,"FF-F4"],[79,"FF-G4"],[80,"FF-G#4"],[81,"FF-A4"],[82,"FF-A#4"],[83,"FF-B4"],[85,"FF-C#5"],[86,"FF-D5"],[88,"FF-E5"],[89,"FF-F5"],[91,"FF-G5"],[93,"FF-A5"],[95,"Mf-B5"],[96,"Mf-C6"],[97,"Mf-C#6"],[98,"Mf-D6"],[99,"Mf-D#6"],[100,"Mf-E6"],[102,"Mf-F#6"],[103,"Mf-G6"],[104,"Mf-G#6"],[105,"Mf-A6"],[106,"Mf-A#6"],[107,"Mf-B6"],[108,"Mf-C7"]]}];let Ci=0;const pt=new Map;async function dt(e,i=ae(),t=null){var u;const a=e.split("/");let s="sf2",r="musyngkite",n="acoustic_grand_piano";a.length===3?[s,r,n]=a:a.length===2?[r,n]=a:a.length===1&&(n=a[0]);const o=i instanceof OfflineAudioContext;pt.has(i)||pt.set(i,new Map);const d=pt.get(i),c=`${r}/${n}`;if(d.has(c))return d.get(c);let l;if(r==="smolken")l=new go(i,{instrument:n,destination:t||be(),disableScheduler:o}),await ci(l.load);else if(r==="splendidgrandpiano")l=new Oo(i,{destination:t||be(),disableScheduler:o}),await ci(l.load);else if(r==="mallets")l=new mo(i,{instrument:n,destination:t||be(),disableScheduler:o}),await ci(l.load);else if(r==="drummachines"){l=new Vl(i,{instrument:n,destination:t||be(),disableScheduler:o}),await ci(l.load);const _=((u=l.getSampleNames)==null?void 0:u.call(l))??[],f=new Map;_.forEach((p,h)=>{const y=36+h;f.set(y,p)}),l.__midiMap=f}else{const f={"fluidr3-gm":"FluidR3_GM",fatboy:"FatBoy",musyngkite:"MusyngKite"}[r.toLowerCase()]||"MusyngKite",h=`https://gleitz.github.io/midi-js-soundfonts/${f}/${n}-ogg.js`;l=new Po(i,{instrument:n,instrumentUrl:h,kit:f,destination:t||be(),disableScheduler:o}),await ci(l.load)}return d.set(c,l),l}async function Uo(){console.log("[SF2] Getting available libraries");const e=Do();console.log("[SF2] Available kits:",e);const i=e.map(a=>{switch(a){case"FluidR3_GM":return"fluidr3-gm";case"FatBoy":return"fatboy";case"MusyngKite":return"musyngkite";default:return a.toLowerCase()}}),t=["splendidgrandpiano","mallets","drummachines","smolken"];return[...new Set([...i,...t])]}function Do(){const i=[...Eo()];return i.includes("FatBoy")||i.push("FatBoy"),i}async function Jo(e){const i=e.toLowerCase();return i==="splendidgrandpiano"?["splendidgrandpiano"]:i==="mallets"?yo():i==="drummachines"?Ha():i==="smolken"?ho():(await dt(`${e}/acoustic_grand_piano`),Fo()??[])}function xo(){return Ha()}function qo(){Ci++,Ci===1&&Oa()}function Ho(){Ci--,Ci<=0&&(Ci=0,Ra())}async function ci(e){qo();try{await e}finally{Ho()}}function $o(){return{name:"sf2",loadInstrument:dt,getAvailableLibraries:Uo,getAvailableInstruments:Jo}}let de=null,Ft=null;async function Ko(e){if(Ft===e)return;de=await dt(e),Ft=e,console.log(`[SF2] Global keyboard instrument set to: ${e}`)}function Wo(){return Ft}function zo(e,i=100,t=!1){var o;if(!de)return null;const s=ae().currentTime,r=F(e);if(r===null)return null;const n=((o=de.__midiMap)==null?void 0:o.get(r))??r;return de.start({note:n,stopId:n,velocity:i,time:s,loop:t}),()=>{de==null||de.stop({stopId:n})}}function jo(e){var a;if(!de)return;const i=F(e);if(i===null)return;const t=((a=de.__midiMap)==null?void 0:a.get(i))??i;de.stop({stopId:t})}async function Xo(e,i,t,a=100,s=!1,r=null,n=null,o=null){var _;const d=n||ae(),c=await dt(e,d,o),l=F(i);if(l===null)return null;const u=((_=c.__midiMap)==null?void 0:_.get(l))??l;return c.start({note:u,duration:t,velocity:a,loop:s,time:r??d.currentTime}),null}function Vo(){return{name:"sf2",setActiveInstrument:Ko,getActiveInstrumentName:Wo,playNote:zo,stopNoteByPitch:jo,loadAndPlayNote:Xo}}let Pt=null,kt=null;async function Yo(e){if(kt===e)return;const[,i,t]=e.split("/");Pt=await tr(`${i}/${t}`),kt=e,console.log(`[WebAudioFont] Global keyboard instrument set to: ${e}`)}function Qo(){return kt}function Zo(e,i=100,t=!1){if(!Pt)return null;const s=ae().currentTime,r=F(e);return r===null?null:(Pt.start({note:r,velocity:i,time:s,duration:1.5,loop:t}),()=>{})}function ed(e){}async function id(e,i,t,a=100,s=!1,r=null,n=null,o=null){const d=n||ae(),[,c,l]=e.split("/"),u=await tr(`${c}/${l}`,d,o),_=F(i);return _===null||u.start({note:_,duration:t,velocity:a,loop:s,time:r??d.currentTime}),null}function td(){return{name:"webaudiofont",setActiveInstrument:Yo,getActiveInstrumentName:Qo,playNote:Zo,stopNoteByPitch:ed,loadAndPlayNote:id}}const ct={sf2:Vo(),webaudiofont:td()};let ni=null;async function Va(e){if(!e.includes("/"))throw new Error(`Invalid instrument name: "${e}". Expected "<engine>/<library>/<instrument>"`);const i=e.split("/")[0],t=ct[i];if(!t)throw new Error(`Engine "${i}" not available`);await t.setActiveInstrument(e),ni=e}function rd(){return ni}function Ya(e,i=100,t=!1){if(!ni)return null;const a=ni.split("/")[0],s=ct[a];if(!s)throw new Error(`Engine "${a}" not available`);return s.playNote(e,i,t)}function ad(e){if(!ni)return;const i=ni.split("/")[0],t=ct[i];if(!t)throw new Error(`Engine "${i}" not available`);t.stopNoteByPitch(e)}async function sd(e,i,t,a=100,s=!1,r=null,n=null,o=null){const d=e.split("/")[0],c=ct[d];if(!c)throw new Error(`Engine "${d}" not available`);return await c.loadAndPlayNote(e,i,t,a,s,r,n,o)}let yt=null;function ae(){return yt||(yt=new(window.AudioContext||window.webkitAudioContext)),yt}let Ti=null,Ui=null;function At(){return Ti||(Ti=ae().createAnalyser(),Ti.fftSize=2048),Ti}function be(){return Ui||(Ui=ae().createGain(),At().connect(ae().destination),Ui.connect(At())),Ui}function nd(e){ae().resume();try{const i=Ya(e,100,!1);return i?{stop:i,forceStop:i}:null}catch(i){return console.error("[playNote] Failed to play note",e,i),null}}let Rr=!1,Di=null;function Qa(e,i){if(Rr)return;Rr=!0,Di=i;const t=e.getContext("2d");if(!t)return;const a=new Map,s=new Set;function r(l,u){const _=Di();for(const f of Object.values(_))if(f.isBlack&&l>=f.x&&l<=f.x+f.width&&u>=0&&u<=f.height)return f.note;for(const f of Object.values(_))if(!f.isBlack&&l>=f.x&&l<=f.x+f.width&&u>=0&&u<=f.height)return f.note;return null}function n(l){if(!l||s.has(l))return;const u=nd(l);u&&(a.set(l,u),s.add(l),t&&ri(t,Di(),s))}function o(l){if(!s.has(l))return;const u=a.get(l);u&&(u.stop(),a.delete(l)),s.delete(l),t&&ri(t,Di(),s)}function d(){for(const l of s)o(l)}let c=!1;e.addEventListener("mousedown",l=>{c=!0;const u=e.getBoundingClientRect(),_=l.clientX-u.left,f=l.clientY-u.top,p=r(_,f);n(p)}),e.addEventListener("mousemove",l=>{if(!c)return;const u=e.getBoundingClientRect(),_=l.clientX-u.left,f=l.clientY-u.top,p=r(_,f);n(p)}),e.addEventListener("mouseup",()=>{c=!1,d()}),e.addEventListener("mouseleave",()=>{c=!1,d()})}const nr=[..."qwertyuiop[zxcvbnm,./"],lr=["2","3","5","6","7","9","0","=","s","d","g","h","k","l",";"];function ld(){const e=document.getElementById("instrument-loop-toggle");return(e==null?void 0:e.checked)??!1}let It=!1,Ji=null,Gi=null,Li=null;function Za(e,i){if(It)return;It=!0;const t=e.getContext("2d");if(!t)throw new Error("Canvas 2D context not available.");const a=new Set,s=new Set,r=new Map,n=nr,o=lr;Ji=i;function d(){const u=Ji(),_=Object.values(u).filter(h=>!h.isBlack).sort((h,y)=>h.x-y.x).map(h=>h.note),f=Object.values(u).filter(h=>h.isBlack).sort((h,y)=>h.x-y.x).map(h=>h.note),p={};return n.forEach((h,y)=>{_[y]&&(p[h]=_[y])}),o.forEach((h,y)=>{f[y]&&(p[h]=f[y])}),p}function c(u){const _=d(),f=_[u];if(!(!f||a.has(u))){if(a.add(u),!s.has(f)){const p=Ya(f,100,ld());p&&(r.set(f,{stop:p}),s.add(f))}t&&ri(t,Ji(),s,_)}}function l(u){const _=d(),f=_[u];f&&(a.delete(u),s.has(f)&&(ad(f),r.delete(f),s.delete(f)),t&&ri(t,Ji(),s,_))}Gi=u=>{u.repeat||c(u.key)},Li=u=>{l(u.key)},window.addEventListener("keydown",Gi),window.addEventListener("keyup",Li)}function es(){Gi&&(window.removeEventListener("keydown",Gi),Gi=null),Li&&(window.removeEventListener("keyup",Li),Li=null),It=!1}let je=3,He=at(je),xi=!1;async function od(e){var r,n;const i=e.getContext("2d");if(!i)throw new Error("Failed to get 2D context for keyboard canvas");function t(){const o=Object.values(He).filter(l=>!l.isBlack).sort((l,u)=>l.x-u.x).map(l=>l.note),d=Object.values(He).filter(l=>l.isBlack).sort((l,u)=>l.x-u.x).map(l=>l.note),c={};return nr.forEach((l,u)=>{o[u]&&(c[l]=o[u])}),lr.forEach((l,u)=>{d[u]&&(c[l]=d[u])}),c}function a(){if(!i)return;He=at(je);const o=xi?t():null;ri(i,He,new Set,o)}Qa(e,()=>He),a(),(r=document.getElementById("octave-up"))==null||r.addEventListener("click",()=>{je<7&&(je++,a())}),(n=document.getElementById("octave-down"))==null||n.addEventListener("click",()=>{je>1&&(je--,a())});const s=document.getElementById("disable-keyboard-inputs");return s.classList.remove("bg-purple-600"),s.classList.add("bg-gray-700"),s.addEventListener("click",()=>{xi=!xi,xi?(Za(e,()=>He),s.classList.remove("bg-gray-700"),s.classList.add("bg-purple-600")):(es(),s.classList.remove("bg-purple-600"),s.classList.add("bg-gray-700")),a()}),{refreshKeyboard:a}}let Xe=3,$e=at(Xe),qi=!1,Hi=null;async function dd(e){var r,n;if(Hi=e.getContext("2d"),!Hi)throw new Error("Failed to get 2D context for keyboard canvas.");await Va("sf2/fluidr3-gm/acoustic_grand_piano");function i(){const o=Object.values($e).filter(l=>!l.isBlack).sort((l,u)=>l.x-u.x).map(l=>l.note),d=Object.values($e).filter(l=>l.isBlack).sort((l,u)=>l.x-u.x).map(l=>l.note),c={};return nr.forEach((l,u)=>{o[u]&&(c[l]=o[u])}),lr.forEach((l,u)=>{d[u]&&(c[l]=d[u])}),c}function t(){$e=at(Xe);const o=qi?i():null;Hi&&ri(Hi,$e,new Set,o)}Qa(e,()=>$e),t(),(r=document.getElementById("octave-up"))==null||r.addEventListener("click",()=>{Xe<7&&(Xe++,t())}),(n=document.getElementById("octave-down"))==null||n.addEventListener("click",()=>{Xe>1&&(Xe--,t())});const a=document.getElementById("disable-keyboard-inputs");a.classList.remove("bg-purple-600"),a.classList.add("bg-gray-700"),a.addEventListener("click",()=>{qi=!qi,qi?(Za(e,()=>$e),a.classList.remove("bg-gray-700"),a.classList.add("bg-purple-600")):(es(),a.classList.remove("bg-purple-600"),a.classList.add("bg-gray-700")),t()}),document.getElementById("global-instrument-select-btn").addEventListener("click",async()=>{console.log("GLOBAL KEYBOARD BUTTON CLICKED");const o=rd()||"sf2/fluidr3-gm/acoustic_grand_piano",d=document.getElementById("instrument-select-modal");delete d.dataset.currentSequencer,await ka(o),d.classList.remove("hidden")})}async function cd(e){await dd(e);const{refreshKeyboard:i}=await od(e)}function ud(e,i){const t=i.getContext("2d");if(!t)throw new Error("Canvas 2D context not available");const a=i.width,s=i.height,r=new Uint8Array(e.fftSize),n=new Uint8Array(e.frequencyBinCount),o=document.createElement("canvas");o.width=a,o.height=s;const d=o.getContext("2d");if(!d)throw new Error("Offscreen canvas 2D context not available");let c="frequency";function l(){if(!t)return;e.getByteTimeDomainData(r),t.fillStyle="#000",t.fillRect(0,0,a,s),t.lineWidth=2,t.strokeStyle="#00ffcc",t.beginPath();const p=a/r.length;let h=0;for(let y=0;y<r.length;y++){const g=r[y]/128*s/2;y===0?t.moveTo(h,g):t.lineTo(h,g),h+=p}t.lineTo(a,s/2),t.stroke()}function u(){if(e.getByteFrequencyData(n),!t)return;t.fillStyle="#000",t.fillRect(0,0,a,s),t.fillStyle="rgba(255,255,255,0.2)",t.fillRect(0,0,1,s),t.fillRect(a-1,0,1,s);const p=128,h=2,y=[];for(let m=0;m<p;m++)y.push(m*a/(p-1));y[y.length-1]=a-1;for(let m=0;m<p;m++){const g=y[m],v=m<p-1?y[m+1]:a,b=Math.max(1,v-g-h),N=20,S=2e4,L=m/(p-1),M=N*Math.pow(S/N,L),P=Math.min(n.length-1,Math.floor(M/22050*n.length)),w=n[P]/255,O=Math.max(1,w*s),T=240-L*240;t.fillStyle=`hsl(${T}, ${80+w*20}%, ${40+w*40}%)`,t.fillRect(g,s-O,b,O)}}function _(){if(e.getByteFrequencyData(n),!d)return;o.initialized||(d.fillStyle="#000",d.fillRect(0,0,a,s),o.initialized=!0),d.drawImage(o,-1,0),d.fillStyle="#000",d.fillRect(a-1,0,1,s);const p=128,h=20,y=2e4;for(let m=0;m<p;m++){const g=m/(p-1),v=h*Math.pow(y/h,g),N=Math.min(n.length-1,Math.floor(v/22050*n.length)),S=n[N]/255,L=s-1-Math.floor(m*s/p);if(S<.05)continue;const M=Math.floor(S*255),E=Math.floor(S*(255-g*200)),P=Math.floor(S*(100+g*155));d.fillStyle=`rgb(${M}, ${E}, ${P})`,d.fillRect(a-1,L,1,1)}t&&(t.fillStyle="#000",t.fillRect(0,0,a,s),t.drawImage(o,0,0))}function f(){switch(requestAnimationFrame(f),c){case"frequency":u();break;case"spectrogram":_();break;case"waveform":default:l()}}return f(),{setMode(p){["waveform","frequency","spectrogram"].includes(p)&&(c=p,t.clearRect(0,0,a,s),c==="spectrogram"&&d.clearRect(0,0,a,s))}}}function fd(e,i){const t=ud(At(),e),a=[{name:"waveform",emoji:"🌊"},{name:"frequency",emoji:"📊"},{name:"spectrogram",emoji:"🌈"}];let s=0;function r(){s=(s+1)%a.length;const{name:n,emoji:o}=a[s];t.setMode(n),i.textContent=o,i.title=`Mode: ${n}`}i.addEventListener("click",r),r()}function _d(){var u;const e=document.getElementById("global-mini-expand-btn"),i=document.getElementById("global-mini-contour"),t=document.getElementById("global-mini-playhead"),a=(u=i==null?void 0:i.parentElement)==null?void 0:u.parentElement,s=i==null?void 0:i.parentElement,r=e==null?void 0:e.querySelector("svg use"),n=document.querySelector(".footer-spacer"),o=40;let d=!1;function c(_,f){const p=_.offsetWidth;_.style.height=`${f}px`,_.height=f,_.width=p}if(!e||!i||!t||!a||!s||!r||!n){console.warn("FooterUI: One or more elements not found.");return}a.style.height=`${o}px`,s.style.height=`${o}px`,c(i,o),c(t,o),re(i,Fe());function l(){d=!d;const _=d?200:40;!a||!s||!i||!t||!r||!n||(a.style.height=`${_}px`,s.style.height=`${_}px`,c(i,_),c(t,_),r.setAttribute("href",d?"#icon-caret-down":"#icon-caret-up"),n.style.height=`${_-40+140}px`,re(i,Fe()))}e.addEventListener("click",l)}function pd(e){if(!e.sequencers.length)throw new Error("No tracks to export.");const i=e.tempo,t=e.timeSignature[0],a=e.totalMeasures,s={v:3,t:new Date().toISOString(),c:{b:i,bpm:t,tm:a},i:e.sequencers.map(n=>n.instrument||"sf2/fluidr3-gm/acoustic_grand_piano"),tr:e.sequencers.map(n=>({n:n.notes.map(o=>[o.pitch,o.start,o.duration])}))},r=new Blob([JSON.stringify(s)],{type:"application/json"});return{url:URL.createObjectURL(r),filename:`session-${Date.now()}.json`}}async function yd(e){if(!e.tracks||e.tracks.length===0)throw new Error("No tracks to export.");const t=60/qe(),a=Math.max(...e.tracks.flatMap(l=>l.notes.map(u=>(u.start+u.duration)*t+.2))),s=44100,r=new OfflineAudioContext(2,Math.ceil(s*a),s);for(const l of e.tracks){const u=l.instrument||"sf2/fluidr3-gm/acoustic_grand_piano";console.log("Exporting track with instrument: ",u);const _=new wa(null,l.config,r,r.destination,u);_.setState(l),await _.exportToOffline()}const n=await r.startRendering(),o=md(n),d=URL.createObjectURL(o),c=document.createElement("a");c.href=d,c.download=`session-${Date.now()}.wav`,c.click(),URL.revokeObjectURL(d)}function md(e){const i=e.numberOfChannels,t=e.length*i*2,a=new DataView(new ArrayBuffer(44+t)),s=(n,o)=>{for(let d=0;d<o.length;d++)a.setUint8(n+d,o.charCodeAt(d))};s(0,"RIFF"),a.setUint32(4,36+t,!0),s(8,"WAVE"),s(12,"fmt "),a.setUint32(16,16,!0),a.setUint16(20,1,!0),a.setUint16(22,i,!0),a.setUint32(24,e.sampleRate,!0),a.setUint32(28,e.sampleRate*i*2,!0),a.setUint16(32,i*2,!0),a.setUint16(34,16,!0),s(36,"data"),a.setUint32(40,t,!0);let r=44;for(let n=0;n<e.length;n++)for(let o=0;o<i;o++){const d=e.getChannelData(o)[n],c=Math.max(-1,Math.min(1,d));a.setInt16(r,c*32767,!0),r+=2}return new Blob([a.buffer],{type:"audio/wav"})}function hd(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var i=e.default;if(typeof i=="function"){var t=function a(){return this instanceof a?Reflect.construct(i,arguments,this.constructor):i.apply(this,arguments)};t.prototype=i.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(a){var s=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,s.get?s:{enumerable:!0,get:function(){return e[a]}})}),t}var ke={},$i={},mt,Tr;function bd(){if(Tr)return mt;Tr=1;function e(s){var r=new a(s),n=r.readChunk();if(n.id!="MThd")throw"Bad MIDI file.  Expected 'MHdr', got: '"+n.id+"'";for(var o=i(n.data),d=[],c=0;!r.eof()&&c<o.numTracks;c++){var l=r.readChunk();if(l.id!="MTrk")throw"Bad MIDI file.  Expected 'MTrk', got: '"+l.id+"'";var u=t(l.data);d.push(u)}return{header:o,tracks:d}}function i(s){var r=new a(s),n=r.readUInt16(),o=r.readUInt16(),d={format:n,numTracks:o},c=r.readUInt16();return c&32768?(d.framesPerSecond=256-(c>>8),d.ticksPerFrame=c&255):d.ticksPerBeat=c,d}function t(s){for(var r=new a(s),n=[];!r.eof();){var o=c();n.push(o)}return n;var d;function c(){var l={};l.deltaTime=r.readVarInt();var u=r.readUInt8();if((u&240)===240)if(u===255){l.meta=!0;var _=r.readUInt8(),f=r.readVarInt();switch(_){case 0:if(l.type="sequenceNumber",f!==2)throw"Expected length for sequenceNumber event is 2, got "+f;return l.number=r.readUInt16(),l;case 1:return l.type="text",l.text=r.readString(f),l;case 2:return l.type="copyrightNotice",l.text=r.readString(f),l;case 3:return l.type="trackName",l.text=r.readString(f),l;case 4:return l.type="instrumentName",l.text=r.readString(f),l;case 5:return l.type="lyrics",l.text=r.readString(f),l;case 6:return l.type="marker",l.text=r.readString(f),l;case 7:return l.type="cuePoint",l.text=r.readString(f),l;case 32:if(l.type="channelPrefix",f!=1)throw"Expected length for channelPrefix event is 1, got "+f;return l.channel=r.readUInt8(),l;case 33:if(l.type="portPrefix",f!=1)throw"Expected length for portPrefix event is 1, got "+f;return l.port=r.readUInt8(),l;case 47:if(l.type="endOfTrack",f!=0)throw"Expected length for endOfTrack event is 0, got "+f;return l;case 81:if(l.type="setTempo",f!=3)throw"Expected length for setTempo event is 3, got "+f;return l.microsecondsPerBeat=r.readUInt24(),l;case 84:if(l.type="smpteOffset",f!=5)throw"Expected length for smpteOffset event is 5, got "+f;var p=r.readUInt8(),h={0:24,32:25,64:29,96:30};return l.frameRate=h[p&96],l.hour=p&31,l.min=r.readUInt8(),l.sec=r.readUInt8(),l.frame=r.readUInt8(),l.subFrame=r.readUInt8(),l;case 88:if(l.type="timeSignature",f!=2&&f!=4)throw"Expected length for timeSignature event is 4 or 2, got "+f;return l.numerator=r.readUInt8(),l.denominator=1<<r.readUInt8(),f===4?(l.metronome=r.readUInt8(),l.thirtyseconds=r.readUInt8()):(l.metronome=36,l.thirtyseconds=8),l;case 89:if(l.type="keySignature",f!=2)throw"Expected length for keySignature event is 2, got "+f;return l.key=r.readInt8(),l.scale=r.readUInt8(),l;case 127:return l.type="sequencerSpecific",l.data=r.readBytes(f),l;default:return l.type="unknownMeta",l.data=r.readBytes(f),l.metatypeByte=_,l}}else if(u==240){l.type="sysEx";var f=r.readVarInt();return l.data=r.readBytes(f),l}else if(u==247){l.type="endSysEx";var f=r.readVarInt();return l.data=r.readBytes(f),l}else throw"Unrecognised MIDI event type byte: "+u;else{var y;if((u&128)===0){if(d===null)throw"Running status byte encountered before status byte";y=u,u=d,l.running=!0}else y=r.readUInt8(),d=u;var m=u>>4;switch(l.channel=u&15,m){case 8:return l.type="noteOff",l.noteNumber=y,l.velocity=r.readUInt8(),l;case 9:var g=r.readUInt8();return l.type=g===0?"noteOff":"noteOn",l.noteNumber=y,l.velocity=g,g===0&&(l.byte9=!0),l;case 10:return l.type="noteAftertouch",l.noteNumber=y,l.amount=r.readUInt8(),l;case 11:return l.type="controller",l.controllerType=y,l.value=r.readUInt8(),l;case 12:return l.type="programChange",l.programNumber=y,l;case 13:return l.type="channelAftertouch",l.amount=y,l;case 14:return l.type="pitchBend",l.value=y+(r.readUInt8()<<7)-8192,l;default:throw"Unrecognised MIDI event type: "+m}}}}function a(s){this.buffer=s,this.bufferLen=this.buffer.length,this.pos=0}return a.prototype.eof=function(){return this.pos>=this.bufferLen},a.prototype.readUInt8=function(){var s=this.buffer[this.pos];return this.pos+=1,s},a.prototype.readInt8=function(){var s=this.readUInt8();return s&128?s-256:s},a.prototype.readUInt16=function(){var s=this.readUInt8(),r=this.readUInt8();return(s<<8)+r},a.prototype.readInt16=function(){var s=this.readUInt16();return s&32768?s-65536:s},a.prototype.readUInt24=function(){var s=this.readUInt8(),r=this.readUInt8(),n=this.readUInt8();return(s<<16)+(r<<8)+n},a.prototype.readInt24=function(){var s=this.readUInt24();return s&8388608?s-16777216:s},a.prototype.readUInt32=function(){var s=this.readUInt8(),r=this.readUInt8(),n=this.readUInt8(),o=this.readUInt8();return(s<<24)+(r<<16)+(n<<8)+o},a.prototype.readBytes=function(s){var r=this.buffer.slice(this.pos,this.pos+s);return this.pos+=s,r},a.prototype.readString=function(s){var r=this.readBytes(s);return String.fromCharCode.apply(null,r)},a.prototype.readVarInt=function(){for(var s=0;!this.eof();){var r=this.readUInt8();if(r&128)s+=r&127,s<<=7;else return s+r}return s},a.prototype.readChunk=function(){var s=this.readString(4),r=this.readUInt32(),n=this.readBytes(r);return{id:s,length:r,data:n}},mt=e,mt}var ht,Ur;function gd(){if(Ur)return ht;Ur=1;function e(r,n){if(typeof r!="object")throw"Invalid MIDI data";n=n||{};var o=r.header||{},d=r.tracks||[],c,l=d.length,u=new s;for(i(u,o,l),c=0;c<l;c++)t(u,d[c],n);return u.buffer}function i(r,n,o){var d=n.format==null?1:n.format,c=128;n.timeDivision?c=n.timeDivision:n.ticksPerFrame&&n.framesPerSecond?c=-(n.framesPerSecond&255)<<8|n.ticksPerFrame&255:n.ticksPerBeat&&(c=n.ticksPerBeat&32767);var l=new s;l.writeUInt16(d),l.writeUInt16(o),l.writeUInt16(c),r.writeChunk("MThd",l.buffer)}function t(r,n,o){var d=new s,c,l=n.length,u=null;for(c=0;c<l;c++)(o.running===!1||!o.running&&!n[c].running)&&(u=null),u=a(d,n[c],u,o.useByte9ForNoteOff);r.writeChunk("MTrk",d.buffer)}function a(r,n,o,d){var c=n.type,l=n.deltaTime,u=n.text||"",_=n.data||[],f=null;switch(r.writeVarInt(l),c){case"sequenceNumber":r.writeUInt8(255),r.writeUInt8(0),r.writeVarInt(2),r.writeUInt16(n.number);break;case"text":r.writeUInt8(255),r.writeUInt8(1),r.writeVarInt(u.length),r.writeString(u);break;case"copyrightNotice":r.writeUInt8(255),r.writeUInt8(2),r.writeVarInt(u.length),r.writeString(u);break;case"trackName":r.writeUInt8(255),r.writeUInt8(3),r.writeVarInt(u.length),r.writeString(u);break;case"instrumentName":r.writeUInt8(255),r.writeUInt8(4),r.writeVarInt(u.length),r.writeString(u);break;case"lyrics":r.writeUInt8(255),r.writeUInt8(5),r.writeVarInt(u.length),r.writeString(u);break;case"marker":r.writeUInt8(255),r.writeUInt8(6),r.writeVarInt(u.length),r.writeString(u);break;case"cuePoint":r.writeUInt8(255),r.writeUInt8(7),r.writeVarInt(u.length),r.writeString(u);break;case"channelPrefix":r.writeUInt8(255),r.writeUInt8(32),r.writeVarInt(1),r.writeUInt8(n.channel);break;case"portPrefix":r.writeUInt8(255),r.writeUInt8(33),r.writeVarInt(1),r.writeUInt8(n.port);break;case"endOfTrack":r.writeUInt8(255),r.writeUInt8(47),r.writeVarInt(0);break;case"setTempo":r.writeUInt8(255),r.writeUInt8(81),r.writeVarInt(3),r.writeUInt24(n.microsecondsPerBeat);break;case"smpteOffset":r.writeUInt8(255),r.writeUInt8(84),r.writeVarInt(5);var p={24:0,25:32,29:64,30:96},h=n.hour&31|p[n.frameRate];r.writeUInt8(h),r.writeUInt8(n.min),r.writeUInt8(n.sec),r.writeUInt8(n.frame),r.writeUInt8(n.subFrame);break;case"timeSignature":r.writeUInt8(255),r.writeUInt8(88),r.writeVarInt(4),r.writeUInt8(n.numerator);var y=Math.floor(Math.log(n.denominator)/Math.LN2)&255;r.writeUInt8(y),r.writeUInt8(n.metronome),r.writeUInt8(n.thirtyseconds||8);break;case"keySignature":r.writeUInt8(255),r.writeUInt8(89),r.writeVarInt(2),r.writeInt8(n.key),r.writeUInt8(n.scale);break;case"sequencerSpecific":r.writeUInt8(255),r.writeUInt8(127),r.writeVarInt(_.length),r.writeBytes(_);break;case"unknownMeta":n.metatypeByte!=null&&(r.writeUInt8(255),r.writeUInt8(n.metatypeByte),r.writeVarInt(_.length),r.writeBytes(_));break;case"sysEx":r.writeUInt8(240),r.writeVarInt(_.length),r.writeBytes(_);break;case"endSysEx":r.writeUInt8(247),r.writeVarInt(_.length),r.writeBytes(_);break;case"noteOff":var m=d!==!1&&n.byte9||d&&n.velocity==0?144:128;f=m|n.channel,f!==o&&r.writeUInt8(f),r.writeUInt8(n.noteNumber),r.writeUInt8(n.velocity);break;case"noteOn":f=144|n.channel,f!==o&&r.writeUInt8(f),r.writeUInt8(n.noteNumber),r.writeUInt8(n.velocity);break;case"noteAftertouch":f=160|n.channel,f!==o&&r.writeUInt8(f),r.writeUInt8(n.noteNumber),r.writeUInt8(n.amount);break;case"controller":f=176|n.channel,f!==o&&r.writeUInt8(f),r.writeUInt8(n.controllerType),r.writeUInt8(n.value);break;case"programChange":f=192|n.channel,f!==o&&r.writeUInt8(f),r.writeUInt8(n.programNumber);break;case"channelAftertouch":f=208|n.channel,f!==o&&r.writeUInt8(f),r.writeUInt8(n.amount);break;case"pitchBend":f=224|n.channel,f!==o&&r.writeUInt8(f);var g=8192+n.value,v=g&127,b=g>>7&127;r.writeUInt8(v),r.writeUInt8(b);break;default:throw"Unrecognized event type: "+c}return f}function s(){this.buffer=[]}return s.prototype.writeUInt8=function(r){this.buffer.push(r&255)},s.prototype.writeInt8=s.prototype.writeUInt8,s.prototype.writeUInt16=function(r){var n=r>>8&255,o=r&255;this.writeUInt8(n),this.writeUInt8(o)},s.prototype.writeInt16=s.prototype.writeUInt16,s.prototype.writeUInt24=function(r){var n=r>>16&255,o=r>>8&255,d=r&255;this.writeUInt8(n),this.writeUInt8(o),this.writeUInt8(d)},s.prototype.writeInt24=s.prototype.writeUInt24,s.prototype.writeUInt32=function(r){var n=r>>24&255,o=r>>16&255,d=r>>8&255,c=r&255;this.writeUInt8(n),this.writeUInt8(o),this.writeUInt8(d),this.writeUInt8(c)},s.prototype.writeInt32=s.prototype.writeUInt32,s.prototype.writeBytes=function(r){this.buffer=this.buffer.concat(Array.prototype.slice.call(r,0))},s.prototype.writeString=function(r){var n,o=r.length,d=[];for(n=0;n<o;n++)d.push(r.codePointAt(n));this.writeBytes(d)},s.prototype.writeVarInt=function(r){if(r<0)throw"Cannot write negative variable-length integer";if(r<=127)this.writeUInt8(r);else{var n=r,o=[];for(o.push(n&127),n>>=7;n;){var d=n&127|128;o.push(d),n>>=7}this.writeBytes(o.reverse())}},s.prototype.writeChunk=function(r,n){this.writeString(r),this.writeUInt32(n.length),this.writeBytes(n)},ht=e,ht}var Dr;function is(){return Dr||(Dr=1,$i.parseMidi=bd(),$i.writeMidi=gd()),$i}var bt={},Ae={},Jr;function ts(){if(Jr)return Ae;Jr=1,Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.insert=Ae.search=void 0;function e(t,a,s){s===void 0&&(s="ticks");var r=0,n=t.length,o=n;if(n>0&&t[n-1][s]<=a)return n-1;for(;r<o;){var d=Math.floor(r+(o-r)/2),c=t[d],l=t[d+1];if(c[s]===a){for(var u=d;u<t.length;u++){var _=t[u];_[s]===a&&(d=u)}return d}else{if(c[s]<a&&l[s]>a)return d;c[s]>a?o=d:c[s]<a&&(r=d+1)}}return-1}Ae.search=e;function i(t,a,s){if(s===void 0&&(s="ticks"),t.length){var r=e(t,a[s],s);t.splice(r+1,0,a)}else t.push(a)}return Ae.insert=i,Ae}var xr;function Ot(){return xr||(xr=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Header=e.keySignatureKeys=void 0;var i=ts(),t=new WeakMap;e.keySignatureKeys=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];var a=function(){function s(r){var n=this;if(this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",t.set(this,480),r){t.set(this,r.header.ticksPerBeat),r.tracks.forEach(function(d){d.forEach(function(c){c.meta&&(c.type==="timeSignature"?n.timeSignatures.push({ticks:c.absoluteTime,timeSignature:[c.numerator,c.denominator]}):c.type==="setTempo"?n.tempos.push({bpm:6e7/c.microsecondsPerBeat,ticks:c.absoluteTime}):c.type==="keySignature"&&n.keySignatures.push({key:e.keySignatureKeys[c.key+7],scale:c.scale===0?"major":"minor",ticks:c.absoluteTime}))})});var o=0;r.tracks[0].forEach(function(d){o+=d.deltaTime,d.meta&&(d.type==="trackName"?n.name=d.text:(d.type==="text"||d.type==="cuePoint"||d.type==="marker"||d.type==="lyrics")&&n.meta.push({text:d.text,ticks:o,type:d.type}))}),this.update()}}return s.prototype.update=function(){var r=this,n=0,o=0;this.tempos.sort(function(d,c){return d.ticks-c.ticks}),this.tempos.forEach(function(d,c){var l=c>0?r.tempos[c-1].bpm:r.tempos[0].bpm,u=d.ticks/r.ppq-o,_=60/l*u;d.time=_+n,n=d.time,o+=u}),this.timeSignatures.sort(function(d,c){return d.ticks-c.ticks}),this.timeSignatures.forEach(function(d,c){var l=c>0?r.timeSignatures[c-1]:r.timeSignatures[0],u=(d.ticks-l.ticks)/r.ppq,_=u/l.timeSignature[0]/(l.timeSignature[1]/4);l.measures=l.measures||0,d.measures=_+l.measures})},s.prototype.ticksToSeconds=function(r){var n=(0,i.search)(this.tempos,r);if(n!==-1){var o=this.tempos[n],d=o.time,c=(r-o.ticks)/this.ppq;return d+60/o.bpm*c}else{var l=r/this.ppq;return 60/120*l}},s.prototype.ticksToMeasures=function(r){var n=(0,i.search)(this.timeSignatures,r);if(n!==-1){var o=this.timeSignatures[n],d=(r-o.ticks)/this.ppq;return o.measures+d/(o.timeSignature[0]/o.timeSignature[1])/4}else return r/this.ppq/4},Object.defineProperty(s.prototype,"ppq",{get:function(){return t.get(this)},enumerable:!1,configurable:!0}),s.prototype.secondsToTicks=function(r){var n=(0,i.search)(this.tempos,r,"time");if(n!==-1){var o=this.tempos[n],d=o.time,c=r-d,l=c/(60/o.bpm);return Math.round(o.ticks+l*this.ppq)}else{var u=r/.5;return Math.round(u*this.ppq)}},s.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map(function(r){return{bpm:r.bpm,ticks:r.ticks}}),timeSignatures:this.timeSignatures}},s.prototype.fromJSON=function(r){this.name=r.name,this.tempos=r.tempos.map(function(n){return Object.assign({},n)}),this.timeSignatures=r.timeSignatures.map(function(n){return Object.assign({},n)}),this.keySignatures=r.keySignatures.map(function(n){return Object.assign({},n)}),this.meta=r.meta.map(function(n){return Object.assign({},n)}),t.set(this,r.ppq),this.update()},s.prototype.setTempo=function(r){this.tempos=[{bpm:r,ticks:0}],this.update()},s}();e.Header=a}(bt)),bt}var ui={},gt={},qr;function rs(){return qr||(qr=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ControlChange=e.controlChangeIds=e.controlChangeNames=void 0,e.controlChangeNames={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"},e.controlChangeIds=Object.keys(e.controlChangeNames).reduce(function(s,r){return s[e.controlChangeNames[r]]=r,s},{});var i=new WeakMap,t=new WeakMap,a=function(){function s(r,n){i.set(this,n),t.set(this,r.controllerType),this.ticks=r.absoluteTime,this.value=r.value}return Object.defineProperty(s.prototype,"number",{get:function(){return t.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"name",{get:function(){return e.controlChangeNames[this.number]?e.controlChangeNames[this.number]:null},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"time",{get:function(){var r=i.get(this);return r.ticksToSeconds(this.ticks)},set:function(r){var n=i.get(this);this.ticks=n.secondsToTicks(r)},enumerable:!1,configurable:!0}),s.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},s}();e.ControlChange=a}(gt)),gt}var fi={},Hr;function vd(){if(Hr)return fi;Hr=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.createControlChanges=void 0;var e=rs();function i(){return new Proxy({},{get:function(t,a){if(t[a])return t[a];if(e.controlChangeIds.hasOwnProperty(a))return t[e.controlChangeIds[a]]},set:function(t,a,s){return e.controlChangeIds.hasOwnProperty(a)?t[e.controlChangeIds[a]]=s:t[a]=s,!0}})}return fi.createControlChanges=i,fi}var _i={},$r;function Sd(){if($r)return _i;$r=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.PitchBend=void 0;var e=new WeakMap,i=function(){function t(a,s){e.set(this,s),this.ticks=a.absoluteTime,this.value=a.value}return Object.defineProperty(t.prototype,"time",{get:function(){var a=e.get(this);return a.ticksToSeconds(this.ticks)},set:function(a){var s=e.get(this);this.ticks=s.secondsToTicks(a)},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},t}();return _i.PitchBend=i,_i}var pi={},_e={},Kr;function Nd(){return Kr||(Kr=1,Object.defineProperty(_e,"__esModule",{value:!0}),_e.DrumKitByPatchID=_e.InstrumentFamilyByID=_e.instrumentByPatchID=void 0,_e.instrumentByPatchID=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"],_e.InstrumentFamilyByID=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"],_e.DrumKitByPatchID={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"}),_e}var Wr;function Bd(){if(Wr)return pi;Wr=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.Instrument=void 0;var e=Nd(),i=new WeakMap,t=function(){function a(s,r){if(this.number=0,i.set(this,r),this.number=0,s){var n=s.find(function(o){return o.type==="programChange"});n&&(this.number=n.programNumber)}}return Object.defineProperty(a.prototype,"name",{get:function(){return this.percussion?e.DrumKitByPatchID[this.number]:e.instrumentByPatchID[this.number]},set:function(s){var r=e.instrumentByPatchID.indexOf(s);r!==-1&&(this.number=r)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"family",{get:function(){return this.percussion?"drums":e.InstrumentFamilyByID[Math.floor(this.number/8)]},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"percussion",{get:function(){var s=i.get(this);return s.channel===9},enumerable:!1,configurable:!0}),a.prototype.toJSON=function(){return{family:this.family,number:this.number,name:this.name}},a.prototype.fromJSON=function(s){this.number=s.number},a}();return pi.Instrument=t,pi}var yi={},zr;function Cd(){if(zr)return yi;zr=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.Note=void 0;function e(n){var o=Math.floor(n/12)-1;return i(n)+o.toString()}function i(n){var o=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],d=n%12;return o[d]}function t(n){var o=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return o.indexOf(n)}var a=function(){var n=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,o={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13};return function(d){var c=n.exec(d),l=c[1],u=c[2],_=o[l.toLowerCase()];return _+(parseInt(u,10)+1)*12}}(),s=new WeakMap,r=function(){function n(o,d,c){s.set(this,c),this.midi=o.midi,this.velocity=o.velocity,this.noteOffVelocity=d.velocity,this.ticks=o.ticks,this.durationTicks=d.ticks-o.ticks}return Object.defineProperty(n.prototype,"name",{get:function(){return e(this.midi)},set:function(o){this.midi=a(o)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(o){var d=o-this.octave;this.midi+=d*12},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pitch",{get:function(){return i(this.midi)},set:function(o){this.midi=12*(this.octave+1)+t(o)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"duration",{get:function(){var o=s.get(this);return o.ticksToSeconds(this.ticks+this.durationTicks)-o.ticksToSeconds(this.ticks)},set:function(o){var d=s.get(this),c=d.secondsToTicks(this.time+o);this.durationTicks=c-this.ticks},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"time",{get:function(){var o=s.get(this);return o.ticksToSeconds(this.ticks)},set:function(o){var d=s.get(this);this.ticks=d.secondsToTicks(o)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bars",{get:function(){var o=s.get(this);return o.ticksToMeasures(this.ticks)},enumerable:!1,configurable:!0}),n.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},n}();return yi.Note=r,yi}var jr;function Xr(){if(jr)return ui;jr=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.Track=void 0;var e=ts(),i=rs(),t=vd(),a=Sd(),s=Bd(),r=Cd(),n=new WeakMap,o=function(){function d(c,l){var u=this;if(this.name="",this.notes=[],this.controlChanges=(0,t.createControlChanges)(),this.pitchBends=[],n.set(this,l),c){var _=c.find(function(b){return b.type==="trackName"});this.name=_?_.text:""}if(this.instrument=new s.Instrument(c,this),this.channel=0,c){for(var f=c.filter(function(b){return b.type==="noteOn"}),p=c.filter(function(b){return b.type==="noteOff"}),h=function(){var b=f.shift();y.channel=b.channel;var N=p.findIndex(function(L){return L.noteNumber===b.noteNumber&&L.absoluteTime>=b.absoluteTime});if(N!==-1){var S=p.splice(N,1)[0];y.addNote({durationTicks:S.absoluteTime-b.absoluteTime,midi:b.noteNumber,noteOffVelocity:S.velocity/127,ticks:b.absoluteTime,velocity:b.velocity/127})}},y=this;f.length;)h();var m=c.filter(function(b){return b.type==="controller"});m.forEach(function(b){u.addCC({number:b.controllerType,ticks:b.absoluteTime,value:b.value/127})});var g=c.filter(function(b){return b.type==="pitchBend"});g.forEach(function(b){u.addPitchBend({ticks:b.absoluteTime,value:b.value/Math.pow(2,13)})});var v=c.find(function(b){return b.type==="endOfTrack"});this.endOfTrackTicks=v!==void 0?v.absoluteTime:void 0}}return d.prototype.addNote=function(c){var l=n.get(this),u=new r.Note({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},l);return Object.assign(u,c),(0,e.insert)(this.notes,u,"ticks"),this},d.prototype.addCC=function(c){var l=n.get(this),u=new i.ControlChange({controllerType:c.number},l);return delete c.number,Object.assign(u,c),Array.isArray(this.controlChanges[u.number])||(this.controlChanges[u.number]=[]),(0,e.insert)(this.controlChanges[u.number],u,"ticks"),this},d.prototype.addPitchBend=function(c){var l=n.get(this),u=new a.PitchBend({},l);return Object.assign(u,c),(0,e.insert)(this.pitchBends,u,"ticks"),this},Object.defineProperty(d.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var c=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,l=0;l<this.notes.length-1;l++){var u=this.notes[l].time+this.notes[l].duration;c<u&&(c=u)}return c},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var c=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,l=0;l<this.notes.length-1;l++){var u=this.notes[l].ticks+this.notes[l].durationTicks;c<u&&(c=u)}return c},enumerable:!1,configurable:!0}),d.prototype.fromJSON=function(c){var l=this;this.name=c.name,this.channel=c.channel,this.instrument=new s.Instrument(void 0,this),this.instrument.fromJSON(c.instrument),c.endOfTrackTicks!==void 0&&(this.endOfTrackTicks=c.endOfTrackTicks);for(var u in c.controlChanges)c.controlChanges[u]&&c.controlChanges[u].forEach(function(_){l.addCC({number:_.number,ticks:_.ticks,value:_.value})});c.notes.forEach(function(_){l.addNote({durationTicks:_.durationTicks,midi:_.midi,ticks:_.ticks,velocity:_.velocity})})},d.prototype.toJSON=function(){for(var c={},l=0;l<127;l++)this.controlChanges.hasOwnProperty(l)&&(c[l]=this.controlChanges[l].map(function(_){return _.toJSON()}));var u={channel:this.channel,controlChanges:c,pitchBends:this.pitchBends.map(function(_){return _.toJSON()}),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map(function(_){return _.toJSON()})};return this.endOfTrackTicks!==void 0&&(u.endOfTrackTicks=this.endOfTrackTicks),u},d}();return ui.Track=o,ui}var Ie={};function Gd(e){var i=[];return as(e,i),i}function as(e,i){for(var t=0;t<e.length;t++){var a=e[t];Array.isArray(a)?as(a,i):i.push(a)}}const Ld=Object.freeze(Object.defineProperty({__proto__:null,flatten:Gd},Symbol.toStringTag,{value:"Module"})),Md=hd(Ld);var Vr;function wd(){if(Vr)return Ie;Vr=1;var e=Ie&&Ie.__spreadArray||function(m,g,v){if(v||arguments.length===2)for(var b=0,N=g.length,S;b<N;b++)(S||!(b in g))&&(S||(S=Array.prototype.slice.call(g,0,b)),S[b]=g[b]);return m.concat(S||Array.prototype.slice.call(g))};Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.encode=void 0;var i=is(),t=Ot(),a=Md;function s(m,g){return[{absoluteTime:m.ticks,channel:g,deltaTime:0,noteNumber:m.midi,type:"noteOn",velocity:Math.floor(m.velocity*127)},{absoluteTime:m.ticks+m.durationTicks,channel:g,deltaTime:0,noteNumber:m.midi,type:"noteOff",velocity:Math.floor(m.noteOffVelocity*127)}]}function r(m){return(0,a.flatten)(m.notes.map(function(g){return s(g,m.channel)}))}function n(m,g){return{absoluteTime:m.ticks,channel:g,controllerType:m.number,deltaTime:0,type:"controller",value:Math.floor(m.value*127)}}function o(m){for(var g=[],v=0;v<127;v++)m.controlChanges.hasOwnProperty(v)&&m.controlChanges[v].forEach(function(b){g.push(n(b,m.channel))});return g}function d(m,g){return{absoluteTime:m.ticks,channel:g,deltaTime:0,type:"pitchBend",value:m.value}}function c(m){var g=[];return m.pitchBends.forEach(function(v){g.push(d(v,m.channel))}),g}function l(m){return{absoluteTime:0,channel:m.channel,deltaTime:0,programNumber:m.instrument.number,type:"programChange"}}function u(m){return{absoluteTime:0,deltaTime:0,meta:!0,text:m,type:"trackName"}}function _(m){return{absoluteTime:m.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/m.bpm),type:"setTempo"}}function f(m){return{absoluteTime:m.ticks,deltaTime:0,denominator:m.timeSignature[1],meta:!0,metronome:24,numerator:m.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}function p(m){var g=t.keySignatureKeys.indexOf(m.key);return{absoluteTime:m.ticks,deltaTime:0,key:g+7,meta:!0,scale:m.scale==="major"?0:1,type:"keySignature"}}function h(m){return{absoluteTime:m.ticks,deltaTime:0,meta:!0,text:m.text,type:m.type}}function y(m){var g={header:{format:1,numTracks:m.tracks.length+1,ticksPerBeat:m.header.ppq},tracks:e([e(e(e(e([{absoluteTime:0,deltaTime:0,meta:!0,text:m.header.name,type:"trackName"}],m.header.keySignatures.map(function(v){return p(v)}),!0),m.header.meta.map(function(v){return h(v)}),!0),m.header.tempos.map(function(v){return _(v)}),!0),m.header.timeSignatures.map(function(v){return f(v)}),!0)],m.tracks.map(function(v){return e(e(e([u(v.name),l(v)],r(v),!0),o(v),!0),c(v),!0)}),!0)};return g.tracks=g.tracks.map(function(v){v=v.sort(function(N,S){return N.absoluteTime-S.absoluteTime});var b=0;return v.forEach(function(N){N.deltaTime=N.absoluteTime-b,b=N.absoluteTime,delete N.absoluteTime}),v.push({deltaTime:0,meta:!0,type:"endOfTrack"}),v}),new Uint8Array((0,i.writeMidi)(g))}return Ie.encode=y,Ie}var Yr;function Ed(){return Yr||(Yr=1,function(e){var i=ke&&ke.__awaiter||function(u,_,f,p){function h(y){return y instanceof f?y:new f(function(m){m(y)})}return new(f||(f=Promise))(function(y,m){function g(N){try{b(p.next(N))}catch(S){m(S)}}function v(N){try{b(p.throw(N))}catch(S){m(S)}}function b(N){N.done?y(N.value):h(N.value).then(g,v)}b((p=p.apply(u,_||[])).next())})},t=ke&&ke.__generator||function(u,_){var f={label:0,sent:function(){if(y[0]&1)throw y[1];return y[1]},trys:[],ops:[]},p,h,y,m;return m={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function g(b){return function(N){return v([b,N])}}function v(b){if(p)throw new TypeError("Generator is already executing.");for(;f;)try{if(p=1,h&&(y=b[0]&2?h.return:b[0]?h.throw||((y=h.return)&&y.call(h),0):h.next)&&!(y=y.call(h,b[1])).done)return y;switch(h=0,y&&(b=[b[0]&2,y.value]),b[0]){case 0:case 1:y=b;break;case 4:return f.label++,{value:b[1],done:!1};case 5:f.label++,h=b[1],b=[0];continue;case 7:b=f.ops.pop(),f.trys.pop();continue;default:if(y=f.trys,!(y=y.length>0&&y[y.length-1])&&(b[0]===6||b[0]===2)){f=0;continue}if(b[0]===3&&(!y||b[1]>y[0]&&b[1]<y[3])){f.label=b[1];break}if(b[0]===6&&f.label<y[1]){f.label=y[1],y=b;break}if(y&&f.label<y[2]){f.label=y[2],f.ops.push(b);break}y[2]&&f.ops.pop(),f.trys.pop();continue}b=_.call(u,f)}catch(N){b=[6,N],h=0}finally{p=y=0}if(b[0]&5)throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Header=e.Track=e.Midi=void 0;var a=is(),s=Ot(),r=Xr(),n=wd(),o=function(){function u(_){var f=this,p=null;if(_){var h=_ instanceof ArrayBuffer?new Uint8Array(_):_;p=(0,a.parseMidi)(h),p.tracks.forEach(function(y){var m=0;y.forEach(function(g){m+=g.deltaTime,g.absoluteTime=m})}),p.tracks=l(p.tracks)}this.header=new s.Header(p),this.tracks=[],_&&(this.tracks=p.tracks.map(function(y){return new r.Track(y,f.header)}),p.header.format===1&&this.tracks[0].duration===0&&this.tracks.shift())}return u.fromUrl=function(_){return i(this,void 0,void 0,function(){var f,p;return t(this,function(h){switch(h.label){case 0:return[4,fetch(_)];case 1:return f=h.sent(),f.ok?[4,f.arrayBuffer()]:[3,3];case 2:return p=h.sent(),[2,new u(p)];case 3:throw new Error("Could not load '".concat(_,"'"))}})})},Object.defineProperty(u.prototype,"name",{get:function(){return this.header.name},set:function(_){this.header.name=_},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"duration",{get:function(){var _=this.tracks.map(function(f){return f.duration});return Math.max.apply(Math,_)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"durationTicks",{get:function(){var _=this.tracks.map(function(f){return f.durationTicks});return Math.max.apply(Math,_)},enumerable:!1,configurable:!0}),u.prototype.addTrack=function(){var _=new r.Track(void 0,this.header);return this.tracks.push(_),_},u.prototype.toArray=function(){return(0,n.encode)(this)},u.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map(function(_){return _.toJSON()})}},u.prototype.fromJSON=function(_){var f=this;this.header=new s.Header,this.header.fromJSON(_.header),this.tracks=_.tracks.map(function(p){var h=new r.Track(void 0,f.header);return h.fromJSON(p),h})},u.prototype.clone=function(){var _=new u;return _.fromJSON(this.toJSON()),_},u}();e.Midi=o;var d=Xr();Object.defineProperty(e,"Track",{enumerable:!0,get:function(){return d.Track}});var c=Ot();Object.defineProperty(e,"Header",{enumerable:!0,get:function(){return c.Header}});function l(u){for(var _=[],f=0;f<u.length;f++)for(var p=_.length,h=new Map,y=Array(16).fill(0),m=0,g=u[f];m<g.length;m++){var v=g[m],b=p,N=v.channel;if(N!==void 0){v.type==="programChange"&&(y[N]=v.programNumber);var S=y[N],L="".concat(S," ").concat(N);h.has(L)?b=h.get(L):(b=p+h.size,h.set(L,b))}_[b]||_.push([]),_[b].push(v)}return _}}(ke)),ke}var ss=Ed();const ns=["acoustic_grand_piano","bright_acoustic_piano","electric_grand_piano","honkytonk_piano","electric_piano_1","electric_piano_2","harpsichord","clavinet","celesta","glockenspiel","music_box","vibraphone","marimba","xylophone","tubular_bells","dulcimer","drawbar_organ","percussive_organ","rock_organ","church_organ","reed_organ","accordion","harmonica","tango_accordion","acoustic_guitar_nylon","acoustic_guitar_steel","electric_guitar_jazz","electric_guitar_clean","electric_guitar_muted","overdriven_guitar","distortion_guitar","guitar_harmonics","acoustic_bass","electric_bass_finger","electric_bass_pick","fretless_bass","slap_bass_1","slap_bass_2","synth_bass_1","synth_bass_2","violin","viola","cello","contrabass","tremolo_strings","pizzicato_strings","orchestral_harp","timpani","string_ensemble_1","string_ensemble_2","synth_strings_1","synth_strings_2","choir_aahs","voice_oohs","synth_choir","orchestra_hit","trumpet","trombone","tuba","muted_trumpet","french_horn","brass_section","synth_brass_1","synth_brass_2","soprano_sax","alto_sax","tenor_sax","baritone_sax","oboe","english_horn","bassoon","clarinet","piccolo","flute","recorder","pan_flute","blown_bottle","shakuhachi","whistle","ocarina","lead_1_square","lead_2_sawtooth","lead_3_calliope","lead_4_chiff","lead_5_charang","lead_6_voice","lead_7_fifths","lead_8_bass__lead","pad_1_new_age","pad_2_warm","pad_3_polysynth","pad_4_choir","pad_5_bowed","pad_6_metallic","pad_7_halo","pad_8_sweep","fx_1_rain","fx_2_soundtrack","fx_3_crystal","fx_4_atmosphere","fx_5_brightness","fx_6_goblins","fx_7_echoes","fx_8_scifi","sitar","banjo","shamisen","koto","kalimba","bagpipe","fiddle","shanai","tinkle_bell","agogo","steel_drums","woodblock","taiko_drum","melodic_tom","synth_drum","reverse_cymbal","guitar_fret_noise","breath_noise","seashore","bird_tweet","telephone_ring","helicopter","applause","gunshot"];function Fd(e){console.log("MIDI MAP GOT INSTRUMENT NAME: ",e);const i=e.split("/"),a=i[i.length-1].trim().toLowerCase().replace(/\s+/g,"_"),s=ns.findIndex(r=>r===a);return s!==-1?s:(a.includes("drum")||a.includes("drummachine"),0)}async function Pd(e){if(!e.sequencers.length)throw new Error("No tracks to export.");const i=new ss.Midi;i.header.setTempo(e.tempo),i.header.timeSignatures.push({ticks:0,timeSignature:e.timeSignature});for(const[s,r]of e.sequencers.entries()){const n=i.addTrack(),o=r.instrument.toLowerCase().includes("drum");n.channel=o?9:s%16;const d=Fd(r.instrument);n.instrument.number=d;for(const c of r.notes){const l=F(c.pitch);if(l===null)continue;const u=Qr(c.start,e.tempo),_=Qr(c.duration,e.tempo);n.addNote({midi:l,time:u,duration:_,velocity:.8})}}const t=new Blob([i.toArray()],{type:"audio/midi"});return{url:URL.createObjectURL(t),filename:`session-${Date.now()}.mid`}}function Qr(e,i){return 60/i*e}async function kd(e){var n,o,d;const i=await e.text();let t;try{t=JSON.parse(i)}catch{throw new Error("Invalid JSON format.")}if(!Array.isArray(t.tr))throw new Error("Missing or invalid `tr` (tracks) array.");const a={bpm:((n=t.c)==null?void 0:n.b)??120,beatsPerMeasure:((o=t.c)==null?void 0:o.bpm)??4,totalMeasures:((d=t.c)==null?void 0:d.tm)??8},s=Array.isArray(t.i)?t.i:[],r=t.tr.map((c,l)=>{if(!Array.isArray(c.n))throw new Error(`Track ${l} missing \`n\` (notes) array.`);const u=c.n.map(([f,p,h])=>({pitch:f,start:p,duration:h})),_=s[l]||"sf2/fluidr3-gm/acoustic_grand_piano";return{notes:u,instrument:_,config:{}}});return{globalConfig:a,tracks:r}}async function Ad(e){var p;const i=await e.arrayBuffer(),t=new ss.Midi(i),a=t.header.tempos[0],s=t.header.timeSignatures[0],r=(a==null?void 0:a.bpm)??120,n=((p=s==null?void 0:s.timeSignature)==null?void 0:p[0])??4,d=Math.max(0,...t.tracks.flatMap(h=>h.notes.map(y=>y.time+y.duration)))*(r/60),c=Math.ceil(d/n)||8,l={bpm:r,beatsPerMeasure:n,totalMeasures:c},u=await xo();console.log(`[MIDI] Available drum machines: ${u.join(", ")}`);const _=u.includes("LM-2")?"LM-2":u[0]??"TR-808",f=t.tracks.map(h=>{const y=h.notes.map(b=>({pitch:b.name,start:b.time*(r/60),duration:b.duration*(r/60)}));let m=h.instrument.number;(m===void 0||m===0)&&(h.channel===9?m=0:m=h.channel%128);const g=ns[m]||"acoustic_grand_piano",v=h.channel===9?`sf2/drummachines/${_}`:`sf2/fluidr3-gm/${g}`;return{notes:y,instrument:v,config:{}}});return{globalConfig:l,tracks:f}}function Id(){for(const e of k){const i=e.container;if(!i)continue;const t=i.querySelector(".sequencer-body"),a=i.querySelector("canvas.mini-contour"),s=i.querySelector(".collapse-btn use");!t||!a||t.classList.contains("hidden")||(t.classList.add("hidden"),a.classList.remove("hidden"),s==null||s.setAttribute("href","#icon-caret-up"),ki(i,!1),si(a,e.notes,e.config,e.colorIndex))}}let me=null,tt=null;function Od(e){tt=e,me=tt.getContext("2d")}function ti(e){if(!me||!tt)return;const{width:i,height:t}=tt;me.clearRect(0,0,i,t);const a=Math.round(e)+.5;me.strokeStyle="#ff00ff",me.lineWidth=1,me.beginPath(),me.moveTo(a,0),me.lineTo(a,t),me.stroke()}function Zr(e,i){Kt(i.bpm),Wt(i.beatsPerMeasure),zt(i.totalMeasures);const t=document.getElementById("tempo-input");t&&(t.value=String(qe()));const a=document.getElementById("measures-input");a&&(a.value=String(Pi())),Gl();for(const[r,n]of e.entries()){const o=r,d=n.instrument||"sf2/fluidr3-gm/acoustic_grand_piano",c=n.notes||[];H({type:"CREATE_SEQUENCER",id:o,instrument:d,notes:structuredClone(c),config:n.config||{}},Dt(o))}H(Ht("Session Loaded"),_a("Session Loaded")),Id();const s=document.getElementById("global-mini-contour");s&&nn(s,k),Ne(0),ti(0)}function Rd(){const e=document.querySelectorAll(".note-duration-btn"),i=document.getElementById("note-duration"),t=document.getElementById("dotted-note-btn"),a=document.getElementById("triplet-note-btn");let s=!1,r=!1;function n(d){let c=d;s?c=d*1.5:r&&(c=d*(2/3));let l=Array.from(i.options).find(u=>Math.abs(parseFloat(u.value)-c)<1e-4);l||(l=new Option(c.toString(),c.toString()),i.add(l)),i.value=l.value,i.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))}e.forEach(d=>{d.addEventListener("click",()=>{e.forEach(l=>l.classList.remove("bg-purple-600")),d.classList.add("bg-purple-600");const c=parseFloat(d.dataset.value);n(c)})}),t.addEventListener("click",()=>{r&&(r=!1,a.classList.remove("bg-purple-600")),s=!s,t.classList.toggle("bg-purple-600"),o()}),a.addEventListener("click",()=>{s&&(s=!1,t.classList.remove("bg-purple-600")),r=!r,a.classList.toggle("bg-purple-600"),Q.isTripletMode=r,k.forEach(d=>{d.config.isTripletMode=r}),o()});function o(){const d=document.querySelector(".note-duration-btn.bg-purple-600");if(d){const c=parseFloat(d.dataset.value);n(c)}}n(Q.currentDuration||1)}let rt=!1,Le=null,Rt=null,Tt=!1;function Td(e,i){Le=e,Rt=i,Le.addEventListener("mousedown",Ud),window.addEventListener("mousemove",Dd),window.addEventListener("mouseup",Jd)}function Ud(e){On()&&(ba(),k.forEach(i=>{var t;return(t=i.pause)==null?void 0:t.call(i)}),Tt=!0),rt=!0,ls(e)}function Dd(e){rt&&ls(e)}function Jd(){rt&&(rt=!1,Tt&&(ga(),k.forEach(e=>{var i;return(i=e.resume)==null?void 0:i.call(e)}),Tt=!1))}function ls(e){if(!Le||!Rt)return;const i=Le.getBoundingClientRect(),t=Le.width/i.width;let a=(e.clientX-i.left)*t;a=Math.max(0,Math.min(Le.width,a));const s=K(),r=a/Le.width*s,n=na(r,Rt),o=n/s*Le.width;Ne(n),ti(o)}const or={maxBeatsContext:32,extendBeatsAmount:16};function ec(){return or.maxBeatsContext}function ic(){return or.extendBeatsAmount}function Ut(e,i,t,a){const s=K(),r=a/s*i;e.clearRect(0,0,i,t);const n=or.maxBeatsContext,d=Math.max(0,a-n)/s*i,c=r-d;e.fillStyle="rgba(85, 187, 255, 0.55)",e.fillRect(d,0,c,t),e.strokeStyle="#ffffff",e.lineWidth=2,e.beginPath(),e.moveTo(r,0),e.lineTo(r,t),e.stroke()}let ea=!1,vt=!1,Mi=0;function tc(){return Mi}function ia(){if(!ea){ea=!0;const a=document.getElementById("extend-use-tags"),s=document.getElementById("extend-tags");if(a&&s){let c=function(){const _=l.checked;u.disabled=!_,u.classList.toggle("opacity-50",!_),u.classList.toggle("cursor-not-allowed",!_)};const l=a,u=s;c(),l.addEventListener("change",c)}const r=document.getElementById("extend-start-help-btn"),n=document.getElementById("extend-start-help-popup"),o=document.getElementById("extend-start-help-close");r&&n&&o&&(r.addEventListener("click",()=>n.classList.remove("hidden")),o.addEventListener("click",()=>n.classList.add("hidden")),document.addEventListener("click",c=>{c.target instanceof Node&&!n.contains(c.target)&&c.target!==r&&n.classList.add("hidden")}));const d=document.querySelector("#ai-extend-modal .generate-btn");d&&d.addEventListener("click",async()=>{const{extendTracksWithAI:c}=await gs(async()=>{const{extendTracksWithAI:l}=await import("./extendTracks-DT-G6MF-.js");return{extendTracksWithAI:l}},__vite__mapDeps([0,1]));await c()})}const e=document.getElementById("extend-track-checkboxes"),i=document.getElementById("extend-select-all"),t=document.getElementById("extend-deselect-all");e&&i&&t&&(e.innerHTML="",Fe().forEach((s,r)=>{const n=`extend-track-${r}`,o=document.createElement("div");o.className="flex items-center gap-2";const d=document.createElement("input");d.type="checkbox",d.id=n,d.dataset.index=r.toString(),d.checked=!0,d.className="w-4 h-4 rounded border-gray-600 bg-gray-700 text-purple-600 focus:ring-purple-500";const c=document.createElement("label");c.htmlFor=n,c.className="text-sm text-gray-200",c.textContent=s.config.name||`Track ${r+1}`,d.addEventListener("change",()=>{Si()}),o.appendChild(d),o.appendChild(c),e.appendChild(o)}),i.addEventListener("click",()=>{e.querySelectorAll('input[type="checkbox"]').forEach(s=>s.checked=!0),Si()}),t.addEventListener("click",()=>{e.querySelectorAll('input[type="checkbox"]').forEach(s=>s.checked=!1),Si()}),Si())}function xd(){const e=document.getElementById("extend-mini-contour"),i=document.getElementById("extend-mini-playhead");if(!e||!i)return;const t=i.getContext("2d");if(!t)return;const a=e.clientWidth,s=e.clientHeight;e.width=a,e.height=s,i.width=a,i.height=s,Si(),Ut(t,a,s,Mi),i.addEventListener("mousedown",n=>{vt=!0,r(n.offsetX)}),window.addEventListener("mouseup",()=>{vt=!1}),window.addEventListener("mousemove",n=>{if(!vt)return;const o=i.getBoundingClientRect();r(n.clientX-o.left)});function r(n){if(!t)return;const o=K(),d=Math.max(0,Math.min(n,a));Mi=Math.round(d/a*o),Ut(t,a,s,Mi)}}function Si(){const e=document.getElementById("extend-mini-contour"),i=document.getElementById("extend-mini-playhead");if(!e||!i)return;const t=i.getContext("2d");if(!t)return;const a=i.width,s=i.height,r=document.querySelectorAll('#extend-track-checkboxes input[type="checkbox"]'),n=Array.from(r).filter(d=>d.checked).map(d=>parseInt(d.dataset.index||"0",10)),o=Fe().filter((d,c)=>n.includes(c));re(e,o),Ut(t,a,s,Mi)}function qd(){const e=document.getElementById("note-placement-mode-btn"),i=document.getElementById("select-mode-btn"),t=document.getElementById("velocity-mode-btn"),a=document.getElementById("note-duration-controls"),s=document.getElementById("select-mode-controls"),r=document.getElementById("velocity-mode-controls");if(!e||!i||!t||!a||!s||!r){console.error("Missing essential UI elements for edit mode switching.");return}function n(d){[e,i,t].forEach(c=>{c&&(c.classList.remove("bg-purple-600"),c.classList.add("bg-gray-800"))}),d.classList.remove("bg-gray-800"),d.classList.add("bg-purple-600")}function o(d){[a,s,r].forEach(c=>{c&&c.classList.add("hidden")}),d.classList.remove("hidden")}e.addEventListener("click",()=>{n(e),o(a),ne("note-placement")}),i.addEventListener("click",()=>{n(i),o(s),ne("select")}),t.addEventListener("click",()=>{n(t),o(r),ne("none")}),window.addEventListener("keydown",d=>{var u;const c=(u=document.activeElement)==null?void 0:u.tagName;if(!(c==="INPUT"||c==="TEXTAREA"||document.querySelector(".ai-modal:not(.hidden)")))switch(d.key.toLowerCase()){case"q":e.click();break;case"w":i.click();break;case"e":t.click();break;default:return}}),n(e),o(a),ne("note-placement")}function Hd(){var _,f,p;const e=document.getElementById("note-mode-btn"),i=document.getElementById("ai-mode-btn"),t=document.getElementById("note-duration-panel"),a=document.getElementById("ai-control-panel");if(!e||!i||!t||!a){console.error("Missing essential elements for control mode switching.");return}function s(){document.querySelectorAll(".sequencer").forEach(h=>{const y=h.querySelector(".delete-btn"),m=h.querySelector(".collapse-btn"),g=m==null?void 0:m.querySelector("use"),v=h.querySelector(".sequencer-body"),b=h.querySelector(".mini-contour");!y||!m||!g||!v||!b||(y.classList.add("button-locked"),m.classList.add("button-locked"),ki(h,!1),v.classList.contains("hidden")||(v.classList.add("hidden"),b.classList.remove("hidden"),g.setAttribute("href","#icon-caret-up")))})}function r(){document.querySelectorAll(".sequencer").forEach(h=>{const y=h.querySelector(".delete-btn"),m=h.querySelector(".collapse-btn");y==null||y.classList.remove("button-locked"),m==null||m.classList.remove("button-locked")})}function n(){!e||!i||!t||!a||(e.classList.replace("bg-gray-800","bg-blue-600"),i.classList.replace("bg-purple-600","bg-gray-800"),t.classList.remove("hidden"),a.classList.add("hidden"),r())}function o(){if(!St()){const h=document.getElementById("openai-key-not-set-modal");h==null||h.classList.remove("hidden");return}!e||!i||!t||!a||(i.classList.replace("bg-gray-800","bg-purple-600"),e.classList.replace("bg-blue-600","bg-gray-800"),t.classList.add("hidden"),a.classList.remove("hidden"),s())}e.addEventListener("click",n),i.addEventListener("click",o);const d=document.getElementById("ai-inpaint-modal"),c=document.getElementById("ai-extend-modal"),l=document.getElementById("ai-generate-modal");function u(h){if(!h)return;const y=h.querySelector(".cancel-btn");y==null||y.addEventListener("click",()=>{h.classList.add("hidden")})}u(d),u(c),u(l),ia(),(_=document.getElementById("ai-inpaint-btn"))==null||_.addEventListener("click",()=>{d==null||d.classList.remove("hidden")}),(f=document.getElementById("ai-extend-btn"))==null||f.addEventListener("click",()=>{c==null||c.classList.remove("hidden"),xd(),ia()}),(p=document.getElementById("ai-generate-btn"))==null||p.addEventListener("click",()=>{l==null||l.classList.remove("hidden")}),qd()}function os(){const e=er();if(!e)return;const i=e.gridContext,t=i.getSelectedNotes();t.length!==0&&(H(Jt(i.sequencer.id,t),xt(i.sequencer.id,t)),ii()&&(ei(),ne(Be.NOTE_PLACEMENT)),i.setSelectedNotes([]))}function ds(){console.log("performCopy called");const e=er();if(!e)return;const i=e.getSelectedNotes();i.length!==0&&Ba(i)}function cs(){const e=er();if(!e)return;const i=e.gridContext,t=i.getSelectedNotes();t.length!==0&&(Ba(t),H(_n(i.sequencer.id,t),pn(i.sequencer.id,t)),ii()&&(ei(),ne(Be.NOTE_PLACEMENT)),i.setSelectedNotes([]))}function us(){if(console.log("performPaste called"),!Lt().notes.length){console.log("No notes in clipboard");return}document.body.style.cursor="crosshair",zn((i,t)=>{const a=i.gridContext,{x:s,y:r}=a.getCanvasPos(t),n=a.getSnappedBeatFromX(s),o=a.getPitchFromRow(Math.floor(r/a.getCellHeight())),d=F(o);if(d===null)return;const{notes:c,anchorBeat:l,anchorMidi:u}=Lt(),_=n-l,f=d-u,p=c.map(h=>{const y=F(h.pitch);return y===null?{...h}:{pitch:we(y+f)??h.pitch,start:h.start+_,duration:h.duration}});H(mn(a.sequencer.id,p),hn(a.sequencer.id,p)),ii()&&(ei(),ne(Be.NOTE_PLACEMENT)),a.setSelectedNotes(p),document.body.style.cursor="default",jt()})}function $d(){document.addEventListener("keydown",e=>{const t=navigator.platform.toUpperCase().includes("MAC")?e.metaKey:e.ctrlKey,a=document.activeElement,s=a instanceof HTMLElement?a.tagName:null;if(!(s==="INPUT"||s==="TEXTAREA"))switch(!0){case(t&&e.key==="c"):e.preventDefault(),ds();break;case(t&&e.key==="x"):e.preventDefault(),cs();break;case(t&&e.key==="v"):e.preventDefault(),us();break;case e.key==="Delete":e.preventDefault(),os();break}})}function Kd(){const e=document.querySelector(".select-mode-copy");e&&(e.onclick=ds);const i=document.querySelector(".select-mode-cut");i&&(i.onclick=cs);const t=document.querySelector(".select-mode-paste");t&&(t.onclick=us);const a=document.querySelector(".select-mode-delete");a&&(a.onclick=os),$d()}function Wd(e,i){return e!==void 0&&i!==void 0&&e===i}function zd(e=oi()){var t,a,s;Kt(e.tempo,!1),Wt(e.timeSignature[0],!1),zt(e.totalMeasures,!1);for(const r of k)r.updateTotalMeasures();for(const r of e.sequencers){const n=k.find(o=>Wd(o.id,r.id));if(n){n.instrumentName=r.instrument;const o=(t=n.container)==null?void 0:t.querySelector("canvas.mini-contour");o&&si(o,n.notes,n.config,n.colorIndex);const d=(a=n.grid)==null?void 0:a.gridContext;if(d){const c=d.getSelectedNotes?d.getSelectedNotes():[],l=d.getSelectedNote?d.getSelectedNote():null,u=c.map(_=>({pitch:_.pitch,start:_.start,duration:_.duration}));if(d.notes.length=0,d.notes.push(...structuredClone(r.notes)),c.length>0){const _=u.map(f=>d.notes.find(p=>p.pitch===f.pitch&&p.start===f.start&&p.duration===f.duration)).filter(Boolean);_.length>0&&(d.setSelectedNotes(_),l&&_.length===1&&d.setSelectedNote(_[0]))}(s=n.grid)==null||s.scheduleRedraw()}}else{const o={id:r.id,instrument:r.instrument,notes:structuredClone(r.notes)},{wrapper:d}=Ia(o),c=d.querySelector(".sequencer");c&&ki(c,!0)}}const i=document.getElementById("global-mini-contour");i&&re(i,k)}vs();Cn(zd);hl();function jd(){const e=document.getElementById("global-mini-contour");e&&re(e,k)}document.getElementById("global-mini-contour");const dr=document.getElementById("global-mini-playhead");Od(dr);Td(dr,Q);ti(0);const ta=0,Xd="sf2/fluidr3-gm/acoustic_grand_piano";H(ua(ta,Xd),Dt(ta));const Vd=document.getElementById("piano");cd(Vd);const Yd=document.getElementById("waveform"),Qd=document.getElementById("visualizer-mode");fd(Yd,Qd);H(Ht("Initial App State"),_a("Initial App State"));Kd();jd();Ll();Rd();Hd();_d();ws();Es();Pl({getSequencers:()=>k,onPlay:()=>{Zi();const e=K(),i=Qi();In(qe(),{loop:Q.loopEnabled,endBeat:e,startBeat:i,onLoop:()=>{k.forEach(t=>{var a;return(a=t.onTransportLoop)==null?void 0:a.call(t)})}}),Bt(t=>{const a=t/e*dr.width;ti(a)}),k.forEach(t=>t.play()),kn(()=>{kl(),Ne(0),ti(0)})},onPause:()=>{ba(),k.forEach(e=>e.pause())},onResume:()=>{ga(),k.forEach(e=>e.resume())},onStop:()=>{Zi(),Ne(0),k.forEach(e=>e.stop()),ti(0)},onDurationChange:e=>{Q.currentDuration=e,k.forEach(i=>i.config.currentDuration=e)},onSnapChange:e=>{Q.snapResolution=e,k.forEach(i=>i.config.snapResolution=e)},onToggleLoop:e=>{Q.loopEnabled=e,k.forEach(i=>i.config.loopEnabled=e),Pn(e)},onTempoChange:e=>{Kt(e)},onSave:async e=>{const i=oi();if(e==="json"){const{url:t,filename:a}=pd(i),s=document.createElement("a");s.href=t,s.download=a,s.click(),URL.revokeObjectURL(t)}else if(e==="wav"){const t={globalConfig:{bpm:i.tempo,beatsPerMeasure:i.timeSignature[0],totalMeasures:i.totalMeasures},tracks:k.map(a=>({notes:a.notes,instrument:a.instrumentName,config:a.config}))};await yd(t)}else if(e==="midi"){const{url:t,filename:a}=await Pd(i),s=document.createElement("a");s.href=t,s.download=a,s.click(),URL.revokeObjectURL(t)}},onLoad:async e=>{var i;try{const t=(i=e.name.split(".").pop())==null?void 0:i.toLowerCase();if(t==="json"){const{tracks:a,globalConfig:s}=await kd(e);await Zr(a,s)}else if(t==="mid"||t==="midi"){const{tracks:a,globalConfig:s}=await Ad(e);await Zr(a,s)}else throw new Error("Unsupported file type.")}catch(t){t instanceof Error?alert("Failed to load file: "+t.message):alert("Failed to load file: Unknown error")}},onMeasuresChange:e=>{zt(e);const i=document.getElementById("global-mini-contour");i&&re(i,k)},onBeatsPerMeasureChange:e=>{Wt(e);const i=document.getElementById("global-mini-contour");i&&re(i,k)}});Ss();const rc=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));export{hr as a,Fe as b,tc as c,ec as d,ic as e,Fi as f,St as g,si as h,re as i,rc as m,zt as u};
