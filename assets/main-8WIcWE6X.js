const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/extendTracks-BOA3q-li.js","assets/index-usb6P-Zn.js"])))=>i.map(i=>d[i]);
import{_ as vn}from"./index-usb6P-Zn.js";function aa(e){const t=e.startsWith("/")?e.substring(1):e;return(window.location.pathname.startsWith("/sequenzia")?"/sequenzia/":"./")+t}function Sn(){const e=document.getElementById("splash-modal"),t=document.getElementById("splash-logo");t&&(t.src=aa("static/logo.png")),e==null||e.classList.remove("hidden")}function Nn(e=1e3){const t=document.getElementById("splash-modal"),i=document.getElementById("footer-main"),a=document.getElementById("content-main");t&&setTimeout(()=>{t.style.opacity="0",t.style.transition="opacity 0.5s ease-out",setTimeout(()=>{t.classList.add("hidden"),t.style.opacity="1",i&&(i.classList.remove("content-hidden"),i.classList.add("content-visible")),a&&(a.classList.remove("content-hidden"),a.classList.add("content-visible"))},500)},e)}function Bn(){const e=document.getElementById("splash-modal");return e?!e.classList.contains("hidden"):!1}function Cn(){const e=document.getElementById("feature-not-implemented-modal"),t=document.getElementById("feature-modal-close-btn");if(!e||!t){console.warn("Feature modal elements not found");return}function i(){e&&e.classList.remove("hidden")}t.addEventListener("click",()=>{e.classList.add("hidden")});const a=document.getElementById("piano-toggle-btn");a&&a.addEventListener("click",()=>{i()});const n=document.getElementById("mixer-toggle-btn");n&&n.addEventListener("click",()=>{i()});const r=document.getElementById("ai-toggle-btn");r&&r.addEventListener("click",()=>{i()})}const Gn="v0.0.7",Ln="April 29, 2025",Mn=["âœ¨ New Features","- ðŸŽ¹ Added support for WebAudioFont (1000+ new instruments)","- ðŸŽ§ Added per-instrument panning","- ðŸ”Š Added per-instrument volume","- ðŸŽ¨ Major UI visual enhancements","ðŸž Known Issues","- ðŸš« Scaling groups of notes not functional","ðŸ›£ï¸ Roadmap","- ðŸ”Š Upcoming: velocity support and per-note volume control","- ðŸ§  Upcoming: AI-assisted generation and extension tools"];function wn(){const e=document.getElementById("whats-new-modal"),t=e==null?void 0:e.querySelector("ul"),i=document.getElementById("whats-new-metadata"),a=e==null?void 0:e.querySelector("img");if(e&&t&&i){t.innerHTML="",i.textContent=`${Gn} â€” Updated ${Ln}`,a&&(a.src=aa("static/logo.png"));let n=null;for(const r of Mn)if(r.startsWith("âœ¨")||r.startsWith("ðŸž")||r.startsWith("ðŸ›£ï¸")){const s=document.createElement("li");s.textContent=r,s.classList.add("font-bold","mt-6","text-lg"),t.appendChild(s),n=document.createElement("ul"),n.classList.add("list-disc","list-inside","ml-6","mt-2","space-y-1"),t.appendChild(n)}else if(n){const s=document.createElement("li");s.textContent=r.replace(/^- /,""),n.appendChild(s)}e.classList.remove("hidden")}}function En(){const e=document.getElementById("whats-new-modal");e&&(e.style.opacity="0",e.style.transition="opacity 0.4s ease-out",setTimeout(()=>{e.classList.add("hidden"),e.style.opacity="1"},400))}var ra;(ra=document.getElementById("whats-new-close-btn"))==null||ra.addEventListener("click",En);function Fn(){var e;(e=document.getElementById("footer-whats-new-btn"))==null||e.addEventListener("click",wn)}function Pn(){const e=document.getElementById("footer-help-btn");e&&e.addEventListener("click",()=>{window.open("https://github.com/alacrity-ai/sequenzia","_blank")})}function ai(e=3){const r=["C","D","E","F","G","A","B"],s=["C#","D#","","F#","G#","A#",""],d=[e,e+1,e+2],o={};let c=0;for(const l of d)r.forEach(u=>{const _=`${u}${l}`;o[_]={note:_,x:c,width:60,height:200,isBlack:!1},c+=60});c=0;for(const l of d)s.forEach((u,_)=>{if(u===""){c+=60;return}const f=`${u}${l}`;o[f]={note:f,x:c+60-40/2,width:40,height:120,isBlack:!0},c+=60});return o}function rt(e,t,i=new Set,a=null){e.clearRect(0,0,e.canvas.width,e.canvas.height);const n={};if(a)for(const[r,s]of Object.entries(a))n[s]=r;for(const r of Object.values(t))r.isBlack||(_r(e,{...r,fill:i.has(r.note)?"#cce0ff":"#ffffff",stroke:"#333",radius:6}),e.fillStyle="#333",e.font="12px sans-serif",e.textAlign="center",n[r.note]&&(e.fillStyle="#7c3aed",e.fillText(n[r.note],r.x+r.width/2,r.height-24),e.fillStyle="#333"),e.fillText(r.note,r.x+r.width/2,r.height-8));for(const r of Object.values(t))r.isBlack&&(_r(e,{...r,fill:i.has(r.note)?"#4a60ff":"#111111",stroke:"#000000",radius:4}),An(e,r),n[r.note]&&(e.fillStyle="#c084fc",e.font="10px sans-serif",e.textAlign="center",e.fillText(n[r.note],r.x+r.width/2,r.height-28)))}function _r(e,t){const{x:i,width:a,height:n,fill:r,stroke:s,radius:d=8}=t;e.beginPath(),e.moveTo(i,0),e.lineTo(i,n-d),e.quadraticCurveTo(i,n,i+d,n),e.lineTo(i+a-d,n),e.quadraticCurveTo(i+a,n,i+a,n-d),e.lineTo(i+a,0),e.closePath(),e.fillStyle=r,e.fill(),e.strokeStyle=s,e.lineWidth=1,e.stroke()}function An(e,t){const i=e.createLinearGradient(t.x,0,t.x,t.height);i.addColorStop(0,"rgba(255,255,255,0.2)"),i.addColorStop(.3,"rgba(255,255,255,0)"),e.fillStyle=i,e.beginPath(),e.moveTo(t.x,0),e.lineTo(t.x+t.width,0),e.lineTo(t.x+t.width,t.height*.4),e.lineTo(t.x,t.height*.4),e.closePath(),e.fill()}const Q={cellWidth:40,cellHeight:20,visibleNotes:36,noteRange:["C1","B9"],currentDuration:1,snapResolution:1,isTripletMode:!1,loopEnabled:!1,useEqualTemperament:!0},ne=64,kn={C:"#FF0000","C#":"#9400D3",D:"#FFFF00","D#":"#FF69B4",E:"#0000FF",F:"#00FF00","F#":"#87CEFA",G:"#FFA500","G#":"#800080",A:"#2E8B57","A#":"#FFB6C1",B:"#4B0082"},In={4:"ð…",2:"ð…—ð…¥",1:"ð…˜ð…¥","0.5":"â™ª","0.25":"â™¬","0.125":"ð…˜ð…¥ð…°"},pr={Digit1:4,Digit2:2,Digit3:1,Digit4:.5,Digit5:.25,Digit6:.125},Rt=[{cellWidth:20,cellHeight:10},{cellWidth:30,cellHeight:15},{cellWidth:40,cellHeight:20},{cellWidth:60,cellHeight:25},{cellWidth:80,cellHeight:30}],na={openaiApiKey:"",openaiModel:"gpt-4o",gridColorScheme:"Darkroom",noteColorScheme:"Track Color"};function lt(){return na}function Mt(e){Object.assign(na,e)}function On(){const e=lt();localStorage.setItem("userConfig",JSON.stringify(e))}function Tn(){const e=localStorage.getItem("userConfig");if(e)try{const t=JSON.parse(e);Mt(t)}catch(t){console.error("Failed to parse userConfig from localStorage:",t)}}Tn();const mr=["gpt-4o","gpt-4o-mini","gpt-4.1","gpt-4.1-mini","o3-mini","o4-mini"];function Si(){return lt().openaiApiKey}function yr(){return lt().openaiModel}function Rn(e){Mt({openaiApiKey:e})}function Un(e){if(!mr.includes(e))throw new Error(`Invalid model: ${e}. Must be one of: ${mr.join(", ")}`);Mt({openaiModel:e})}function Dn(){var n;const e=document.getElementById("openai-key-input"),t=document.getElementById("openai-model-select"),i=document.getElementById("config-save"),a=document.querySelectorAll("#config-close, #config-close-bottom");e.value=Si(),t.value=yr(),i.addEventListener("click",()=>{var r;Rn(e.value),Un(t.value),On(),(r=document.getElementById("userconfig-modal"))==null||r.classList.add("hidden")}),a.forEach(r=>{r.addEventListener("click",()=>{var s;e.value=Si(),t.value=yr(),(s=document.getElementById("userconfig-modal"))==null||s.classList.add("hidden")})}),(n=document.getElementById("key-not-set-ok"))==null||n.addEventListener("click",()=>{var r;(r=document.getElementById("openai-key-not-set-modal"))==null||r.classList.add("hidden")})}function Jn(e,t){return e/t()}function sa(e,t){const i=t.snapResolution||.25,a=t.isTripletMode?i*(2/3):i;return Math.round(e/a)*a}function xn(e,t,i){const a=Jn(e,i);return sa(a,t)}const qn={C:0,"C#":1,Db:1,D:2,"D#":3,Eb:3,E:4,Fb:4,"E#":5,F:5,"F#":6,Gb:6,G:7,"G#":8,Ab:8,A:9,"A#":10,Bb:10,B:11,Cb:11,"B#":0};function P(e){const t=e==null?void 0:e.match(/^([A-Ga-g])([#b]*)(-?\d+)$/);if(!t)return null;const[,i,a,n]=t,r=i.toUpperCase(),s=qn[r];if(s===void 0)return null;const d=[...a].reduce((c,l)=>l==="#"?c+1:l==="b"?c-1:c,0);return 12*(parseInt(n,10)+1)+(s+d)}const Hn=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],$n=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"];function Me(e,t=!1){const a=(t?$n:Hn)[e%12],n=Math.floor(e/12)-1;return`${a}${n}`}function Kn(e){return e.replace(/\d+$/,"")}function Wn(e){return e.includes("#")}function la(e,t,i,a,n,r=4){e.beginPath(),e.moveTo(t+r,i),e.lineTo(t+a-r,i),e.quadraticCurveTo(t+a,i,t+a,i+r),e.lineTo(t+a,i+n-r),e.quadraticCurveTo(t+a,i+n,t+a-r,i+n),e.lineTo(t+r,i+n),e.quadraticCurveTo(t,i+n,t,i+n-r),e.lineTo(t,i+r),e.quadraticCurveTo(t,i,t+r,i),e.closePath()}function Xn(e,t){const i=structuredClone(e);return i.tempo=t.bpm,i}function oa(e){return{type:"CHANGE_TEMPO",bpm:e}}function zn(e){return oa(e)}function jn(e,t){const i=structuredClone(e);return i.timeSignature=[t.beats,4],i}function da(e){return{type:"SET_TIME_SIGNATURE",beats:e}}function Vn(e){return da(e)}function Yn(e,t){const i=structuredClone(e);return i.totalMeasures=t.measures,i}function ca(e){return{type:"SET_TOTAL_MEASURES",measures:e}}function Qn(e){return ca(e)}function Zn(e,t){const i=structuredClone(e);if(i.sequencers.push({id:t.id,instrument:t.instrument,notes:t.notes??[],volume:t.volume,pan:t.pan}),!A.find(n=>n.id===t.id)){const n={id:t.id,instrument:t.instrument,notes:t.notes??[],volume:t.volume,pan:t.pan},{wrapper:r}=Oa(n);At(r,!0)}return i}function ua(e,t,i,a){return{type:"CREATE_SEQUENCER",id:e,instrument:t,volume:i,pan:a}}function Di(e){return{type:"DELETE_SEQUENCER",id:e}}function es(e,t){const i=structuredClone(e);i.sequencers=i.sequencers.filter(n=>n.id!==t.id);const a=A.findIndex(n=>n.id===t.id);return a!==-1&&(A[a].destroy(),A.splice(a,1)),i}function ts(e,t,i=[],a,n){return{type:"DELETE_SEQUENCER",id:e,instrument:t,notes:structuredClone(i),volume:a,pan:n}}function is(e,t,i=[],a,n){return{type:"CREATE_SEQUENCER",id:e,instrument:t,notes:structuredClone(i),volume:a,pan:n}}function rs(e,t){const i=structuredClone(e),a=i.sequencers.find(n=>n.id===t.sequencerId);return a&&t.instrument&&(a.instrument=t.instrument),i}function as(e,t){return{type:"SET_INSTRUMENT",sequencerId:e,instrument:t}}function ns(e,t){return{type:"SET_INSTRUMENT",sequencerId:e,instrument:t}}function ss(e,t){var n;const i=structuredClone(e),a=i.sequencers.find(r=>r.id===t.id);if(a&&typeof t.volume=="number"){a.volume=t.volume;const r=A.find(s=>s.id===t.id);r&&(r.volume=t.volume,(n=r.refreshVolumeUI)==null||n.call(r))}return i}function ls(e,t){return{type:"SET_VOLUME",id:e,volume:t}}function os(e,t){return{type:"SET_VOLUME",id:e,volume:t}}function ds(e,t){var n;const i=structuredClone(e),a=i.sequencers.find(r=>r.id===t.id);if(a&&typeof t.pan=="number"){a.pan=t.pan;const r=A.find(s=>s.id===t.id);r&&(r.pan=t.pan,(n=r.refreshPanUI)==null||n.call(r))}return i}function cs(e,t){return{type:"SET_PAN",id:e,pan:t}}function us(e,t){return{type:"SET_PAN",id:e,pan:t}}const at=["#ff006e","#3a86ff","#ffbe0b","#8338ec","#06d6a0","#ef476f","#118ab2","#ffd166","#073b4c","#8ac926"];function hr(e){return e<0&&(console.error(`Invalid trackId: ${e}. Using default color.`),e=0),at[e%at.length]}function fs(e){return e&&typeof e.colorIndex=="number"?hr(e.colorIndex):(console.error(`Invalid sequencer colorIndex: ${e==null?void 0:e.colorIndex}. Using default color.`),hr(0))}function nt(e,t,i,a=0){const n=e.getContext("2d");if(!n)return;n.imageSmoothingEnabled=!1;const r=e.width,s=e.height;if(n.clearRect(0,0,r,s),!t.length)return;const d=at[a%at.length];n.fillStyle=d;const o=K(),c=t.map(y=>P(y.pitch)).filter(y=>y!==null);if(!c.length)return;let l=Math.min(...c),u=Math.max(...c),_=Math.max(1,u-l);for(;s%_!==0;)u++,_=u-l;const f=s/_;for(const y of t){const g=P(y.pitch);if(g==null)continue;const v=y.start/o*r,b=y.duration/o*r,N=(g-l)/_,S=s-N*s-f/2,G=Math.round(v),M=Math.max(1,Math.round(b)),w=Math.round(S);n.fillRect(G,w,M,f)}const p=Ft(),h=Pt();n.save();let m=1;h>256?m=16:h>128?m=8:h>32&&(m=4);for(let y=0;y<=h;y++){if(y%m!==0)continue;const v=y*p/o*r,b=Math.round(v)+.5;n.beginPath(),n.moveTo(b,0),n.lineTo(b,s);const N=m===1||y%(m*2)===0;n.strokeStyle=N?"rgba(255, 255, 255, 0.12)":"rgba(255, 255, 255, 0.04)",n.lineWidth=.2,n.stroke()}n.restore()}function re(e,t){const i=e.getContext("2d");if(!i)return;const a=e.width,n=e.height;i.clearRect(0,0,a,n);const r=K();for(const s of t){const{notes:d,config:o}=s;if(!(d!=null&&d.length))continue;const c=at[t.indexOf(s)%at.length];i.fillStyle=c;const l=P(o.noteRange[0]),u=P(o.noteRange[1]);if(l==null||u==null)continue;const _=u-l||1,f=Math.max(2,n/_);for(const p of d){const h=P(p.pitch);if(h==null)continue;const m=p.start/r*a,y=Math.max(1,p.duration/r*a),g=(h-l)/_,v=n-g*n-f/2;i.fillRect(m,v,y,f)}}}function _s(e,t){re(e,t)}function ps(e,t){const i=structuredClone(e),a=i.sequencers.find(r=>r.id===t.sequencerId);if(!a)return e;a.notes.push(...t.notes);const n=document.getElementById("global-mini-contour");return n&&re(n,A),i}function ms(e,t){return{type:"PLACE_NOTES",sequencerId:e,notes:structuredClone(t)}}function ys(e,t){return{type:"DELETE_NOTES",sequencerId:e,notes:structuredClone(t)}}function hs(e,t){const i=structuredClone(e),a=i.sequencers.find(s=>s.id===t.sequencerId);if(!a)return e;const n=new Set(t.notes.map(s=>`${s.pitch}|${s.start}|${s.duration}`));a.notes=a.notes.filter(s=>{const d=`${s.pitch}|${s.start}|${s.duration}`;return!n.has(d)});const r=document.getElementById("global-mini-contour");return r&&re(r,A),i}function Ji(e,t){return{type:"DELETE_NOTES",sequencerId:e,notes:structuredClone(t)}}function xi(e,t){return{type:"PLACE_NOTES",sequencerId:e,notes:structuredClone(t)}}function bs(e,t){const i=structuredClone(e),a=i.sequencers.find(s=>s.id===t.sequencerId);if(!a)return e;const n=t.from,r=t.to;for(let s=0;s<n.length;s++){const d=n[s],o=r[s],c=a.notes.findIndex(l=>l.pitch===d.pitch&&l.start===d.start&&l.duration===d.duration);c!==-1&&(a.notes[c].pitch=o.pitch,a.notes[c].start=o.start)}return i}function qi(e,t,i){return{type:"MOVE_NOTES",sequencerId:e,from:structuredClone(t),to:structuredClone(i)}}function fa(e,t,i){return qi(e,i,t)}function gs(e,t){const i=structuredClone(e),a=i.sequencers.find(r=>r.id===t.sequencerId);if(!a)return e;const n=new Set(t.notes.map(r=>`${r.pitch}|${r.start}|${r.duration}`));return a.notes=a.notes.filter(r=>{const s=`${r.pitch}|${r.start}|${r.duration}`;return!n.has(s)}),i}function vs(e,t){return{type:"CUT_NOTES",sequencerId:e,notes:structuredClone(t)}}function Ss(e,t){return{type:"PLACE_NOTES",sequencerId:e,notes:structuredClone(t)}}function Ns(e,t){const i=structuredClone(e),a=i.sequencers.find(n=>n.id===t.sequencerId);return a?(a.notes.push(...t.notes),i):e}function Bs(e,t){return{type:"PASTE_NOTES",sequencerId:e,notes:structuredClone(t)}}function Cs(e,t){return{type:"DELETE_NOTES",sequencerId:e,notes:structuredClone(t)}}function Gs(e,t){return structuredClone(e)}function Ls(e,t){const i=structuredClone(e),a=i.sequencers.find(s=>s.id===t.sequencerId);if(!a)return e;const n=t.resizes;for(const s of n){const d=a.notes.find(o=>o.pitch===s.pitch&&o.start===s.start);d&&(d.duration=s.newDuration)}const r=document.getElementById("global-mini-contour");return r&&re(r,A),i}function Ms(e,t){return{type:"RESIZE_NOTES",sequencerId:e,resizes:structuredClone(t)}}function ws(e,t){const i=t.map(a=>({pitch:a.pitch,start:a.start,newDuration:a.oldDuration}));return{type:"RESIZE_NOTES",sequencerId:e,resizes:i}}function Es(e,t){return structuredClone(e)}function Hi(e=""){return{type:"CHECKPOINT",label:e}}function _a(e=""){return Hi(e)}const Fs=Object.freeze(Object.defineProperty({__proto__:null,CHANGE_TEMPO:Xn,CHECKPOINT:Es,CREATE_SEQUENCER:Zn,CUT_NOTES:gs,DELETE_NOTES:hs,DELETE_SEQUENCER:es,MOVE_NOTES:bs,PASTE_NOTES:Ns,PLACE_NOTES:ps,RESIZE_NOTES:Ls,SET_INSTRUMENT:rs,SET_PAN:ds,SET_TIME_SIGNATURE:jn,SET_TOTAL_MEASURES:Yn,SET_VOLUME:ss,UPDATE_NOTE_VELOCITY:Gs},Symbol.toStringTag,{value:"Module"}));function $i(e){const t=Fs[e.type];if(!t)throw new Error(`Unknown diff type: ${e.type}`);const i=t(ot(),e);pa(i)}const Ni=new Set;function Ps(e){return Ni.add(e),()=>Ni.delete(e)}function Et(e){for(const t of Ni)t(e)}const he=[];let ue=-1;const As=100;function ks({forwardDiff:e,reverseDiff:t}){he.splice(ue+1),he.push({forwardDiff:e,reverseDiff:t}),ue=he.length-1,he.length>As&&(he.shift(),ue--)}function Is(){var e;if(ue<0)return null;for(let t=ue;t>=0;t--){const i=he[t];if(((e=i==null?void 0:i.forwardDiff)==null?void 0:e.type)==="CHECKPOINT")return null;if(i!=null&&i.reverseDiff)return ue=t-1,$i(i.reverseDiff),Et(ot()),i.reverseDiff}return null}function Os(){if(ue>=he.length-1)return null;ue++;const e=he[ue];return!e||!e.forwardDiff?null:($i(e.forwardDiff),Et(ot()),e.forwardDiff)}function Ts(){he.length=0,ue=-1}let Yt={tempo:120,timeSignature:[4,4],totalMeasures:8,sequencers:[]};function ot(){return Yt}function pa(e){Yt=structuredClone(e),Et(Yt)}function x(e,t){$i(e),ks({forwardDiff:e,reverseDiff:t}),Et(Yt)}let ie=null,ge=500,ve=null,Qt=!1,br=1/0,Qe=[],Wt=null,ma=0,ya=4,ha=8;function Bi(e){return Qe.push(e),()=>{const t=Qe.indexOf(e);t!==-1&&Qe.splice(t,1)}}function Rs(){Qe=[]}function Se(e){ma=e}function ba(){return ma}function K(){return Pt()*Ft()}function Ki(e,t=!0){if(t){const r=xe();x(oa(e),zn(r));return}const i=performance.now(),a=(i-(ve??i))/ge;ge=60/e*1e3,ve!==null&&(ve=i-a*ge);const n=document.getElementById("tempo-input");n&&n.value!==String(e)&&(n.value=String(e))}function xe(){return 60/(ge/1e3)}function Wi(e,t=!0){if(t){const a=Ft();x(da(e),Vn(a));return}ya=e;const i=document.getElementById("beats-per-measure-input");i&&i.value!==String(e)&&(i.value=String(e)),Ee().forEach(a=>{var n,r;(n=a.grid)!=null&&n.resizeAndRedraw?a.grid.resizeAndRedraw():(r=a.grid)==null||r.scheduleRedraw()})}function Ft(){return ya}function Xi(e,t=!0){if(t){const a=Pt();x(ca(e),Qn(a));return}ha=e;const i=document.getElementById("measures-input");i&&i.value!==String(e)&&(i.value=String(e)),Ee().forEach(a=>{var n;(n=a.grid)==null||n.scheduleRedraw()})}function Pt(){return ha}function Us(e){Qt=e}function Ds(e){Wt=e}function Js(){return Q.snapResolution}function xs(e,t={}){ge=60/e*1e3,Qt=t.loop??!1,br=t.endBeat??K();const i=t.startBeat??0;ve=performance.now()-i*ge,Se(i);const a=t.onLoop;function n(r){const d=(r-(ve??r))/ge;if(Se(d),Qe.forEach(o=>o(d)),d>=br)if(Qt)ve=performance.now(),Se(0),a&&a();else{Zt();return}ie=requestAnimationFrame(n)}ie=requestAnimationFrame(n)}function Zt(){ie!==null&&cancelAnimationFrame(ie),ie=null,Rs(),Wt&&(Wt(),Wt=null)}function qs(){return ie!==null}function ga(){ie!==null&&cancelAnimationFrame(ie),ie=null}function va(){if(ie!==null)return;ve=performance.now()-ba()*ge;function t(i){const n=(i-(ve??i))/ge;if(Se(n),Qe.forEach(r=>r(n)),n>=K())if(Qt)ve=performance.now(),Se(0);else{Zt();return}ie=requestAnimationFrame(t)}ie=requestAnimationFrame(t)}const gr={Midnight:{whiteKey:"#1e1e1e",blackKey:"#2a103b",labelWhite:"#2c2c2c",labelBlack:"#3a1d4d",textWhite:"#cfcfcf",textBlack:"#e6d9ff",gridLine:"#333",beatLine:"#4e3d63",measureLine:"#8561c2"},Seashell:{whiteKey:"#fefefe",blackKey:"#f1e7dc",labelWhite:"#dddddd",labelBlack:"#d4cfc9",textWhite:"#444",textBlack:"#663300",gridLine:"#ccc",beatLine:"#bbb",measureLine:"#999"},Cyberpunk:{whiteKey:"#1b1b2f",blackKey:"#162447",labelWhite:"#1f4068",labelBlack:"#1f4068",textWhite:"#e43f5a",textBlack:"#e43f5a",gridLine:"#1f4068",beatLine:"#e43f5a",measureLine:"#ffcc00"},"Classic Blue":{whiteKey:"#f5faff",blackKey:"#dceeff",labelWhite:"#aaccee",labelBlack:"#88bbdd",textWhite:"#002244",textBlack:"#001122",gridLine:"#99bbdd",beatLine:"#88aacc",measureLine:"#336699"},Darkroom:{whiteKey:"#2c2c2c",blackKey:"#1e1e1e",labelWhite:"#383838",labelBlack:"#2a2a2a",textWhite:"#a0a0a0",textBlack:"#e0e0e0",gridLine:"#404040",beatLine:"#606060",measureLine:"#808080"}},Hs=Array.from({length:47},(e,t)=>35+t),$s={B1:"kick2",C2:"kick1","C#2":"rim",D2:"snare1","D#2":"clap",E2:"snare2",F2:"lowtom2","F#2":"hh_closed",G2:"lowtom1","G#2":"hh_pedal",A2:"midtom2","A#2":"hh_open",B2:"midtom1",C3:"hitom2","C#3":"crash1",D3:"hitom1","D#3":"ride1",E3:"china",F3:"ride_bell","F#3":"tamb",G3:"splash","G#3":"cowbell",A3:"crash2","A#3":"vibraslap",B3:"ride2",C4:"bongo_hi","C#4":"bongo_lo",D4:"conga_hi_mute","D#4":"conga_hi_open",E4:"conga_lo",F4:"timbale_hi","F#4":"timbale_lo",G4:"agogo_hi","G#4":"agogo_lo",A4:"cabasa","A#4":"maracas",B4:"whistle_short",C5:"whistle_long","C#5":"guiro_short",D5:"guiro_long","D#5":"claves",E5:"woodblock_hi",F5:"woodblock_lo","F#5":"cuica_mute",G5:"cuica_open","G#5":"triangle_mute",A5:"triangle_open"};function Ks(e,t,i,a,n,r,s=!1){const{gridColorScheme:d}=lt(),o=gr[d]||gr.Darkroom,c=Ft(),l=K(),u=l*a,_=i*n;e.font=`${Math.floor(n*.6)}px sans-serif`,e.textAlign="right",e.textBaseline="middle";for(let f=0;f<i;f++){const p=f*n,h=r(f),m=Wn(h);if(e.fillStyle=m?o.blackKey:o.whiteKey,e.fillRect(0,p,u,n),e.fillStyle=m?o.labelBlack:o.labelWhite,e.fillRect(-64,p,ne,n),s){const y=$s[h]||h;e.fillStyle=m?o.textBlack:o.textWhite,e.fillText(y,-8,p+n/2)}else e.fillStyle=m?o.textBlack:o.textWhite,e.fillText(h,-8,p+n/2)}e.strokeStyle=o.gridLine,e.lineWidth=1;for(let f=0;f<i;f++){const p=f*n;e.beginPath(),e.moveTo(0,p),e.lineTo(u,p),e.stroke()}for(let f=0;f<=l;f++){const p=f*a,h=f%c===0;e.strokeStyle=h?o.measureLine:o.beatLine,e.lineWidth=h?2:1,e.beginPath(),e.moveTo(p,0),e.lineTo(p,_),e.stroke()}}const Ws={Scriabin:(e,{getPitchClass:t}={})=>{const i=t?t(e.pitch):0;return kn[i]||"#999"},"Track Color":(e,{getTrackColor:t}={})=>(t==null?void 0:t())||"#999","Octave Bands":e=>{const t=P(e.pitch);return t==null?"#999":`hsl(${t*3%360}, 100%, 60%)`},"Pitch Class Contrast":(e,{getPitchClass:t}={})=>{const i=P(e.pitch);if(i==null)return"#999";const a=i%12;return["#ff0000","#ff7f00","#ffff00","#7fff00","#00ff00","#00ff7f","#00ffff","#007fff","#0000ff","#7f00ff","#ff00ff","#ff007f"][a]||"#999"}};function Xs(e,t=1){if(e.startsWith("#")){const i=parseInt(e.slice(1),16),a=i>>16&255,n=i>>8&255,r=i&255;return`rgba(${a}, ${n}, ${r}, ${t})`}if(e.startsWith("hsl(")){const[i,a,n]=e.slice(4,-1).split(",").map(o=>parseFloat(o.trim())),[r,s,d]=zs(i,a/100,n/100);return`rgba(${r}, ${s}, ${d}, ${t})`}return e}function zs(e,t,i){const a=(1-Math.abs(2*i-1))*t,n=a*(1-Math.abs(e/60%2-1)),r=i-a/2;let s=0,d=0,o=0;return 0<=e&&e<60?[s,d,o]=[a,n,0]:60<=e&&e<120?[s,d,o]=[n,a,0]:120<=e&&e<180?[s,d,o]=[0,a,n]:180<=e&&e<240?[s,d,o]=[0,n,a]:240<=e&&e<300?[s,d,o]=[n,0,a]:300<=e&&e<360&&([s,d,o]=[a,0,n]),[Math.round((s+r)*255),Math.round((d+r)*255),Math.round((o+r)*255)]}function js(e,t,{previewNotes:i=null,hoveredNote:a,selectedNote:n,selectedNotes:r=[],highlightedNotes:s=[],cellWidth:d,cellHeight:o,visibleStartBeat:c,visibleEndBeat:l,getPitchRow:u,getPitchClass:_,getTrackColor:f,drawRoundedRect:p}){const{noteColorScheme:m}=lt(),y=Ws[m]||(()=>"#999");for(const g of t){if(g.start+g.duration<c-2||g.start>l)continue;const v=g.start*d,b=u(g.pitch)*o,N=g.duration*d,S=o-1,G=y(g,{getPitchClass:_,getTrackColor:f});e.shadowColor="rgba(0,0,0,0.3)",e.shadowBlur=4,e.shadowOffsetX=1,e.shadowOffsetY=2,e.fillStyle=s.includes(g)?"rgba(96, 165, 250, 0.6)":G,p(e,v,b,N,S),e.fill();const M=e.createLinearGradient(v,b,v,b+S);M.addColorStop(0,"rgba(255,255,255,0.4)"),M.addColorStop(.2,"rgba(255,255,255,0.15)"),M.addColorStop(.5,"rgba(255,255,255,0.05)"),M.addColorStop(1,"rgba(255,255,255,0)"),e.shadowColor="transparent",e.fillStyle=M,p(e,v,b,N,S),e.fill();const w=r.includes(g),F=g===a,L=s.includes(g);(w||F||L)&&(e.lineWidth=w?3:2,e.strokeStyle=w?"rgba(0, 255, 255, 1.0)":F?"rgba(255, 255, 255, 0.9)":"rgba(255, 200, 50, 0.7)",p(e,v,b,N,S),e.stroke())}if(i)for(const g of i){const v=g.start*d,b=u(g.pitch)*o,N=g.duration*d,S=o-1,G=y(g,{getPitchClass:_,getTrackColor:f});e.fillStyle=Xs(G,.4),p(e,v,b,N,S),e.fill()}}function Vs(e,t,i,a){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.save(),e.strokeStyle="red",e.lineWidth=2,e.beginPath(),e.moveTo(t+i,0),e.lineTo(t+i,a),e.stroke(),e.restore()}function Ys(e,t,i,a=ne){const n=e.getBoundingClientRect(),r=parseFloat(e.style.width||`${n.width}`),s=parseFloat(e.style.height||`${n.height}`),d=e.width/r,o=e.height/s,c=(t.clientX-n.left)*d-a,l=(t.clientY-n.top)*o;return{x:c,y:l}}function Qs(e,t,i,a,n,r){const s=Math.floor(t/n),d=e/r;return i.find(o=>d>=o.start&&d<o.start+o.duration&&a(o.pitch)===s)}function Ci(e,t){const i=P(e),a=P(t);if(i===null||a===null)throw new Error(`Invalid pitches provided: ${e}, ${t}`);return i-a}function Zs(e,t,i,a){const n=e.querySelector(".zoom-in-btn"),r=e.querySelector(".zoom-out-btn"),s=e.querySelector(".zoom-reset-btn");!n||!r||!s||(n.addEventListener("click",t),r.addEventListener("click",i),s.addEventListener("click",a))}let ni=!1,ei=null,X=null;function el(e){ni=!0,ei=e,X=null}function zi(){var e;if(X){if(!X.gridContext.setPastePreviewNotes)return;X.gridContext.setPastePreviewNotes(null),X.scheduleRedraw(),(e=X.setCursor)==null||e.call(X,"default")}ni=!1,ei=null,X=null,document.body.style.cursor="default"}function ji(){return ni}function tl(e,t){!ni||!ei||(ei(e,t),zi())}function il(e){if(X&&X!==e){if(!X.gridContext.setPastePreviewNotes)return;X.gridContext.setPastePreviewNotes(null),X.scheduleRedraw()}X=e}const Ne={NOTE_PLACEMENT:"note-placement",SELECT:"select"};let Sa=Ne.NOTE_PLACEMENT;const Gi=new Set;function Na(){return Sa}function se(e){zi(),Sa=e;for(const t of Gi)t(e)}function rl(e){return Gi.add(e),()=>Gi.delete(e)}let Vi=!1;function al(){Vi=!0,se(Ne.SELECT)}function Ze(){Vi=!1}function et(){return Vi}let Yi=!1;function St(e=!0){Yi=e}function vr(){return Yi}function Sr(){Yi=!1}let Ba={notes:[],anchorBeat:0,anchorMidi:0};function Ca(e){if(e.length===0)return;const t=e[0],i=t.start,a=P(t.pitch)??0;Ba={notes:e.map(n=>({pitch:n.pitch,start:n.start,duration:n.duration})),anchorBeat:i,anchorMidi:a}}function Li(){return Ba}let Qi=null,Zi=null;function nl(e){Qi=e}function Mi(){return Qi}function Nr(){Qi=null}function Br(e,t,i){Zi={anchorNote:e,startX:t,startY:i,originalDuration:e.duration}}function ui(){return Zi}function sl(){Zi=null}function Ga(e,t,i){if(!e.setPastePreviewNotes)return;if(!ji()){e.setPastePreviewNotes(null);return}const{notes:a,anchorBeat:n,anchorMidi:r}=Li(),s=e.getSnappedBeatFromX(t),d=e.getPitchFromRow(Math.floor(i/e.getCellHeight())),o=P(d);if(o===null)return;const c=s-n,l=o-r,u=a.map(_=>{const f=P(_.pitch);return f===null?{..._}:{pitch:Me(f+l)??_.pitch,start:_.start+c,duration:_.duration}});e.setPastePreviewNotes(u),e.scheduleRedraw()}function La(e){e.setPastePreviewNotes&&ji()&&e.setPastePreviewNotes(null)}function Ma(e,t){return ji()?(tl(e.grid,t),t.preventDefault(),t.stopPropagation(),!0):!1}let Nt=null;const ll=8;function Cr(){Nt=null}function ol(e,t){Nt={x:e,y:t}}function dl(e,t){if(!Nt)return!1;const i=e-Nt.x,a=t-Nt.y;return Math.sqrt(i*i+a*a)>=ll}let je=null;function mt(e){je&&je!==e&&je.clearSelection(),je=e}function cl(){je=null}function er(){return je}function ul(e,t,{getPitchRow:i,cellWidth:a,cellHeight:n,labelWidth:r}){const s=t.start*a+r,d=i(t.pitch)*n,o=t.duration*a,c=n-1,l=s+o/2,u=d+c/2,_=P(t.pitch);if(_===null)return;const f=_*5%360,p=e.animationCtx,h=performance.now(),m=500,y=3,g=60;function v(S,G,M){const w=Math.sin(S*Math.PI),F=1+G*w,L=(1-S)*M;p.globalAlpha=L,p.strokeStyle=`hsl(${f}, 100%, 65%)`,p.lineWidth=2;const I=o*F,R=c*F;p.beginPath(),p.roundRect(l-I/2,u-R/2,I,R,4),p.stroke()}function b(S){const G=Math.sin(S*Math.PI),w=`hsla(${f}, 100%, 80%, ${.4*G})`;p.globalAlpha=1,p.fillStyle=w,p.beginPath(),p.roundRect(s,d,o,c,3),p.fill()}function N(S){const G=S-h,M=G/m;if(M>1){p.clearRect(0,0,p.canvas.width,p.canvas.height);return}p.clearRect(0,0,p.canvas.width,p.canvas.height),p.save(),b(M);for(let w=0;w<y;w++){const F=w*g,L=Math.max(0,Math.min(1,(G-F)/(m-F)));v(L,.1+w*.1,.2)}p.restore(),requestAnimationFrame(N)}requestAnimationFrame(N)}function fl(e,t,{getPitchRow:i,cellWidth:a,cellHeight:n,labelWidth:r}){const s=t.start*a+r,d=i(t.pitch)*n,o=t.duration*a,c=n-1,l=s+o/2,u=d+c/2,_=P(t.pitch);if(_===null)return;const f=_*5%360,p=e.animationCtx,h=performance.now(),m=300;function y(g){const b=(g-h)/m;if(b>1){p.clearRect(0,0,p.canvas.width,p.canvas.height);return}p.clearRect(0,0,p.canvas.width,p.canvas.height),p.save();const N=1-.4*b,S=1-b,G=o*N,M=c*N;p.globalAlpha=S,p.fillStyle=`hsl(${f}, 100%, 70%)`,p.beginPath(),p.roundRect(l-G/2,u-M/2,G,M,3),p.fill(),p.restore(),requestAnimationFrame(y)}requestAnimationFrame(y)}function fi(e,t,i,a){if(!e||typeof e.getCellWidth!="function"||typeof e.getCellHeight!="function"||typeof e.getPitchRow!="function")return console.error("Invalid ctx object passed to isOnResizeHandle"),!1;const n=e.getCellWidth(),r=e.getCellHeight(),s=e.getPitchRow,d=Math.min(10,r*.8),c=(t.start+t.duration)*n+6,l=s(t.pitch)*r+(r-d)/2,u=4,_=c-u,f=c+d+u,p=l-u,h=l+d+u;return i>=_&&i<=f&&a>=p&&a<=h}function Gr(e){let t=null,i=null,a=!1;function n(l){var g;if(mt(e.grid),vr()){Sr(),e.scheduleRedraw();return}const{x:u,y:_}=e.getCanvasPos(l);if(u<0){const v=e.getPitchFromRow(Math.floor(_/e.getCellHeight()));e.sequencer.playNote(v,.5);return}const f=e.getSnappedBeatFromX(u),p=e.getPitchFromRow(Math.floor(_/e.getCellHeight())),h=K();if(f+e.config.currentDuration>h||e.notes.some(v=>v.pitch===p&&v.start===f))return;e.sequencer.playNote(p,.5);const y={pitch:p,start:f,duration:e.config.currentDuration};x(ms(e.sequencer.id,[y]),ys(e.sequencer.id,[y])),e.setSelectedNote(null),ul(e,y,{getPitchRow:e.getPitchRow,cellWidth:e.getCellWidth(),cellHeight:e.getCellHeight(),labelWidth:ne}),e.scheduleRedraw(),(g=e.onNotesChanged)==null||g.call(e)}function r(l){l.preventDefault();const{x:u,y:_}=e.getCanvasPos(l),f=e.findNoteAt(u,_);if(!f||e.notes.indexOf(f)===-1)return;fl(e,f,{getPitchRow:e.getPitchRow,cellWidth:e.getCellWidth(),cellHeight:e.getCellHeight(),labelWidth:ne});const h=[f];x(Ji(e.sequencer.id,h),xi(e.sequencer.id,h)),Sr(),e.setSelectedNote(null),e.scheduleRedraw()}function s(l){if(Ma(e,l))return;const{x:u,y:_}=e.getCanvasPos(l),f=e.findNoteAt(u,_),p=Mi();if(p&&fi(e,p,u,_)){Br(p,u,_);return}if(f){if(fi(e,f,u,_)){Br(f,u,_);return}mt(e.grid),e.setSelectedNote(f),mt(e.grid),e.setSelectedNote(f),t={startX:u,startY:_,anchorNote:f,initialNotes:[{note:f,start:f.start,midi:P(f.pitch)??0}],lastPreviewPitch:void 0};return}ol(u,_),a=!1}function d(l){var y,g,v;e.grid.setCursor("default");const{x:u,y:_}=e.getCanvasPos(l);if(u<0){e.clearPreview();return}const f=ui();if(f){e.grid.setCursor("ew-resize");const b=u-f.startX,N=e.getSnappedBeatFromX(b)-e.getSnappedBeatFromX(0),S=Math.max(Js(),f.originalDuration+N);f.anchorNote.duration=S,e.scheduleRedraw(),(y=e.onNotesChanged)==null||y.call(e);return}Ga(e,u,_),Nr(),e.grid.setCursor("default");const p=((g=e.getSelectedNotes)==null?void 0:g.call(e))??[];for(const b of p)if(fi(e,b,u,_)){nl(b),e.grid.setCursor("ew-resize");break}if(!f&&!a&&dl(u,_)){al(),e.selectionBox={active:!0,startX:u,startY:_,currentX:u,currentY:_},a=!0,mt(e.grid),Cr();return}const h=e.findNoteAt(u,_);e.setHoveredNote(h??null);const m=e.getSelectedNote();if(ui()||(t&&m?e.grid.setCursor("grabbing"):h&&e.grid.setCursor("grab")),!h&&!t&&!vr()&&!Mi()){const b=e.getSnappedBeatFromX(u),N=e.getPitchFromRow(Math.floor(_/e.getCellHeight())),S=K();b+e.config.currentDuration<=S?e.updatePreview({pitch:N,start:b,duration:e.config.currentDuration}):e.clearPreview()}else e.clearPreview();if(t&&m){const b=u-t.startX,N=e.getSnappedBeatFromX(b)-e.getSnappedBeatFromX(0),S=_-t.startY,G=Math.round(S/e.getCellHeight()),M=Math.max(0,t.initialNotes[0].start+N),w=K();M+m.duration<=w&&(m.start=M);const F=t.initialNotes[0].midi-G,L=P(e.config.noteRange[0])??0,I=P(e.config.noteRange[1])??127,R=Math.max(L,Math.min(I,F)),q=Me(R)??m.pitch;q!==m.pitch&&(m.pitch=q,i!==q&&(i=q,e.sequencer.playNote(q,.5))),e.scheduleRedraw(),(v=e.onNotesChanged)==null||v.call(e),St();return}e.scheduleRedraw()}function o(l){Cr(),a=!1;const u=ui();if(u){const{anchorNote:m,originalDuration:y}=u,g=m.duration;y!==g&&x(Ms(e.sequencer.id,[{pitch:m.pitch,start:m.start,newDuration:g}]),ws(e.sequencer.id,[{pitch:m.pitch,start:m.start,oldDuration:y}])),sl(),St();return}if(!t||!e.getSelectedNote()){t=null;return}const{anchorNote:_}=t,f=t.initialNotes.find(m=>m.note===_);if(!f)return;const p={pitch:f.note.pitch,start:f.note.start,duration:f.note.duration};(f.start!==f.note.start||f.midi!==P(f.note.pitch))&&x(qi(e.sequencer.id,[{pitch:Me(f.midi)??f.note.pitch,start:f.start,duration:f.note.duration}],[p]),fa(e.sequencer.id,[{pitch:Me(f.midi)??f.note.pitch,start:f.start,duration:f.note.duration}],[p])),St(),t=null}function c(){e.clearPreview(),e.setHoveredNote(null),Nr(),La(e),e.scheduleRedraw()}return{attach(l){l.addEventListener("click",n),l.addEventListener("contextmenu",r),l.addEventListener("mousemove",d),l.addEventListener("mouseleave",c),l.addEventListener("mousedown",s),l.addEventListener("mouseup",o)},detach(l){l.removeEventListener("click",n),l.removeEventListener("contextmenu",r),l.removeEventListener("mousemove",d),l.removeEventListener("mouseleave",c),l.removeEventListener("mousedown",s),l.removeEventListener("mouseup",o)}}}function Lr(e,{startX:t,currentX:i,startY:a,currentY:n,getCellHeight:r,getSnappedBeatFromX:s,getPitchFromRow:d}){const o=Math.min(t,i),c=Math.min(a,n),l=Math.max(t,i),u=Math.max(a,n),_=Math.floor(c/r()),f=Math.floor(u/r()),p=s(o),h=s(l),m=P(d(_)),y=P(d(f));return e.filter(g=>{const v=P(g.pitch);if(v===null||m===null||y===null)return!1;const b=g.start,S=g.start+g.duration>p&&b<h,G=v>=y-1&&v<=m+1;return S&&G})}function Mr(e){let t=null;function i(d){d.preventDefault();const{x:o,y:c}=e.getCanvasPos(d),l=e.findNoteAt(o,c);if(!l)return;const u=e.getSelectedNotes(),_=u.includes(l)?u:[l];_.length&&(e.setSelectedNotes([]),x(Ji(e.sequencer.id,_),xi(e.sequencer.id,_)),et()&&(Ze(),se(Ne.NOTE_PLACEMENT)))}function a(d){if(!e.grid||Ma(e,d))return;const{x:o,y:c}=e.getCanvasPos(d);if(o<0)return;const l=e.findNoteAt(o,c);e.setHoveredNote(l??null),mt(e.grid);const u=e.getSelectedNotes();if(l&&u.includes(l)){t={startX:o,startY:c,anchorNote:l,initialNotes:u.map(_=>({note:_,start:_.start,midi:P(_.pitch)??0}))};return}e.selectionBox={active:!0,startX:o,startY:c,currentX:o,currentY:c},e.clearPreview(),e.setSelectedNote(null)}function n(d){var b,N;if(!e.grid)return;il(e.grid);const{x:o,y:c}=e.getCanvasPos(d),l=e.findNoteAt(o,c);if(e.setHoveredNote(l??null),Ga(e,o,c),(b=e.selectionBox)!=null&&b.active){if(!e.setHighlightedNotes)return;e.selectionBox.currentX=o,e.selectionBox.currentY=c;const S=e.selectionBox,G=Lr(e.notes,{startX:S.startX,currentX:S.currentX,startY:S.startY,currentY:S.currentY,getCellHeight:e.getCellHeight,getSnappedBeatFromX:e.getSnappedBeatFromX,getPitchFromRow:e.getPitchFromRow});e.setHighlightedNotes(G),e.scheduleRedraw();return}if(!t)return;const u=t,_=o-u.startX,f=e.getSnappedBeatFromX(_)-e.getSnappedBeatFromX(0),p=c-u.startY,h=Math.round(p/e.getCellHeight()),m=K(),y=P(e.config.noteRange[0])??0,g=P(e.config.noteRange[1])??127;for(const{note:S,start:G,midi:M}of u.initialNotes){const w=Math.max(0,G+f),F=Math.max(y,Math.min(g,M-h)),L=Me(F)??S.pitch;w+S.duration<=m&&(S.start=w,S.pitch=L)}const v=u.initialNotes.find(S=>S.note===u.anchorNote);if(v){const S=v.note.pitch;u.lastPreviewPitch!==S&&(u.lastPreviewPitch=S,e.sequencer.playNote(S,.5))}e.scheduleRedraw(),(N=e.onNotesChanged)==null||N.call(e)}function r(d){var o,c;if((o=t==null?void 0:t.initialNotes)!=null&&o.length){const{initialNotes:l}=t,u=l.map(({start:p,midi:h,note:m})=>({pitch:Me(h)??m.pitch,start:p,duration:m.duration})),_=l.map(({note:p})=>({pitch:p.pitch,start:p.start,duration:p.duration}));u.some((p,h)=>p.pitch!==_[h].pitch||p.start!==_[h].start)&&(x(qi(e.sequencer.id,u,_),fa(e.sequencer.id,u,_)),et()&&(Ze(),se(Ne.NOTE_PLACEMENT)))}if(t=null,(c=e.selectionBox)!=null&&c.active){if(!e.setHighlightedNotes)return;const{x:l,y:u}=e.getCanvasPos(d);e.selectionBox.currentX=l,e.selectionBox.currentY=u,e.selectionBox.active=!1;const _=Lr(e.notes,{startX:e.selectionBox.startX,currentX:e.selectionBox.currentX,startY:e.selectionBox.startY,currentY:e.selectionBox.currentY,getCellHeight:e.getCellHeight,getSnappedBeatFromX:e.getSnappedBeatFromX,getPitchFromRow:e.getPitchFromRow});e.setHighlightedNotes([]),e.setSelectedNotes(_),e.scheduleRedraw(),et()&&e.getSelectedNotes().length===0&&(d.stopPropagation(),Ze(),se(Ne.NOTE_PLACEMENT),St()),St()}}function s(){e.setHighlightedNotes&&(e.setHoveredNote(null),e.setHighlightedNotes([]),La(e),e.scheduleRedraw())}return{attach(d){d.addEventListener("mousedown",a),d.addEventListener("mousemove",n),d.addEventListener("mouseup",r),d.addEventListener("mouseleave",s),d.addEventListener("contextmenu",i)},detach(d){d.removeEventListener("mousedown",a),d.removeEventListener("mousemove",n),d.removeEventListener("mouseup",r),d.removeEventListener("mouseleave",s),d.removeEventListener("contextmenu",i)}}}function _l(e,t){const i=t.selectionBox;if(!i)return;const a=i.startX,n=i.startY,r=i.currentX,s=i.currentY,d=Math.min(a,r),o=Math.min(n,s),c=Math.abs(r-a),l=Math.abs(s-n);e.save(),e.strokeStyle="rgba(128, 90, 213, 1.0)",e.lineWidth=2,e.setLineDash([5,5]),la(e,d,o,c,l,3),e.stroke(),e.restore()}function pl(e,t,{cellWidth:i,cellHeight:a,getPitchRow:n,isHovered:r=!1}){const s=Math.min(10,a*.8),o=(t.start+t.duration)*i+6,c=n(t.pitch)*a+(a-s)/2;e.save(),e.shadowColor="rgba(0,0,0,0.4)",e.shadowBlur=3,e.shadowOffsetX=1,e.shadowOffsetY=2,e.fillStyle=r?"rgba(0, 255, 255, 0.95)":"rgba(255, 255, 255, 0.85)",e.beginPath(),e.moveTo(o,c),e.lineTo(o+s,c+s/2),e.lineTo(o,c+s),e.closePath(),e.fill();const l=e.createLinearGradient(o,c,o,c+s);l.addColorStop(0,"rgba(255,255,255,0.9)"),l.addColorStop(.5,"rgba(255,255,255,0.5)"),l.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=l,e.beginPath(),e.moveTo(o,c),e.lineTo(o+s,c+s/2),e.lineTo(o,c+s),e.closePath(),e.fill(),e.restore()}function ml(e,t,i,a,n,r,s){let d=null,o=null,c=null,l=null,u=[],_=2;const f=e.getContext("2d"),p=t.getContext("2d"),h=i.getContext("2d");if(!f||!p||!h)throw new Error("Failed to acquire required canvas contexts");const m=f,y=p,g=h;let v=Rt[_].cellWidth,b=Rt[_].cellHeight;const N=Ci(r.noteRange[1],r.noteRange[0])+1,S=N*b,M=K()*v+ne;e.width=M,e.height=S,e.style.width=`${M}px`,e.style.height=`${S}px`,t.width=M,t.height=S,t.style.width=`${M}px`,t.style.height=`${S}px`,i.width=M,i.height=S,i.style.width=`${M}px`,i.style.height=`${S}px`;let w=null;function F(){w!==null&&cancelAnimationFrame(w),w=requestAnimationFrame(L)}function L(){var D,ee,z;m.clearRect(0,0,e.width,e.height),m.save(),m.translate(ne,0);let E=((D=s.instrumentName)==null?void 0:D.toLowerCase().includes("drum kit "))??!1;Ks(m,r,N,v,b,Fe,E),js(m,n,{previewNotes:o??(d?[d]:null),hoveredNote:c,selectedNote:l,selectedNotes:u,highlightedNotes:((ee=B.getHighlightedNotes)==null?void 0:ee.call(B))??[],cellWidth:v,cellHeight:b,visibleStartBeat:0,visibleEndBeat:e.width/v,getPitchRow:oe,getPitchClass:Kn,getTrackColor:()=>fs(s),drawRoundedRect:la});for(const Tt of u)pl(m,Tt,{cellWidth:v,cellHeight:b,getPitchRow:oe,isHovered:Tt===Mi()});(z=B.selectionBox)!=null&&z.active&&_l(m,B),m.restore()}function I(){_<Rt.length-1&&(_++,H())}function R(){_>0&&(_--,H())}function q(){_=2,H()}function H(){const E=Rt[_];v=E.cellWidth,b=E.cellHeight,O()}function O(){const D=K()*v+ne,z=(Ci(r.noteRange[1],r.noteRange[0])+1)*b;e.width=D,e.height=z,e.style.width=`${D}px`,e.style.height=`${z}px`,t.width=D,t.height=z,t.style.width=`${D}px`,t.style.height=`${z}px`,i.width=D,i.height=z,i.style.width=`${D}px`,i.style.height=`${z}px`,g.clearRect(0,0,i.width,i.height),F()}function U(E){Vs(y,E,ne,e.height)}Zs(s.container,I,R,q);function oe(E){const D=P(r.noteRange[1]),ee=P(E);return D===null||ee===null?(console.warn(`Invalid pitch encountered: ${E}`),0):D-ee}function Fe(E){const D=P(r.noteRange[1]),ee=P(r.noteRange[0]);if(D===null||ee===null)return console.warn(`Invalid pitch range configured: ${r.noteRange}`),"C4";const z=D-E,Tt=Math.max(ee,Math.min(D,z));return Me(Tt)??"C4"}function V(){const E=document.getElementById("global-mini-contour");E instanceof HTMLCanvasElement&&re(E,A)}let Z=null;const B={sequencer:s,grid:null,config:r,notes:n,canvas:e,animationCtx:g,getCellHeight:()=>b,getCellWidth:()=>v,getCanvasPos:E=>Ys(e,E,a,ne),findNoteAt:(E,D)=>Qs(E,D,n,oe,b,v),scheduleRedraw:F,getPitchFromRow:Fe,getPitchRow:oe,getSnappedBeatFromX:E=>xn(E,r,()=>v),updatePreview:E=>d=E,clearPreview:()=>d=null,getSelectedNote:()=>l,setSelectedNote:E=>{l=E,u=E?[E]:[]},getSelectedNotes:()=>u,setSelectedNotes:E=>{u=E,l=E.length===1?E[0]:null},setHoveredNote:E=>c=E,onNotesChanged:V};function T(E){Z==null||Z.detach(e),Z=E,Z==null||Z.attach(e)}function k(){l=null,u=[],c=null,Ot=[],F()}const W={"note-placement":()=>T(Gr(B)),select:()=>T(Mr(B)),none:()=>T(null)};let fe=rl(E=>{var D,ee,z;d=null,o=null,Ot=[],(D=B.clearPreview)==null||D.call(B),(ee=B.setPastePreviewNotes)==null||ee.call(B,null),B.selectionBox&&(B.selectionBox.active=!1,B.selectionBox=null),k(),(z=W[E])==null||z.call(W),F()});function It(){return l}function pn(){return d}function mn(E){return E*v}function yn(E){e.style.cursor=E}function hn(){return u}function bn(E){u=E,l=E.length===1?E[0]:null}function gn(){fe(),cl()}const dr={canvas:e,scheduleRedraw:F,drawPlayhead:U,getSelectedNote:It,clearSelection:k,getPreviewNote:pn,zoomIn:I,zoomOut:R,getXForBeat:mn,setMouseHandler:T,setCursor:yn,gridContext:B,getSelectedNotes:hn,setSelectedNotes:bn,destroy:gn,resizeAndRedraw:O},cr=Na();let ur=null,fr=null;cr==="note-placement"?(ur=Gr(B),T(ur)):cr==="select"?(fr=Mr(B),T(fr)):T(null),B.setPastePreviewNotes=E=>{o=E};let Ot=[];return B.getHighlightedNotes=()=>Ot,B.setHighlightedNotes=E=>{Ot=E},B.grid=dr,dr}const wt=[{id:"0000_Aspirin_sf2_file",library:"Aspirin",displayName:"Acoustic Grand Piano"},{id:"0000_Chaos_sf2_file",library:"Chaos",displayName:"Acoustic Grand Piano"},{id:"0000_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Acoustic Grand Piano"},{id:"0000_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Acoustic Grand Piano"},{id:"0000_JCLive_sf2_file",library:"JCLive",displayName:"Acoustic Grand Piano"},{id:"0000_SBLive_sf2",library:"SBLive",displayName:"Acoustic Grand Piano"},{id:"0000_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Acoustic Grand Piano"},{id:"0010_Aspirin_sf2_file",library:"Aspirin",displayName:"Bright Acoustic Piano"},{id:"0010_Chaos_sf2_file",library:"Chaos",displayName:"Bright Acoustic Piano"},{id:"0010_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Bright Acoustic Piano"},{id:"0010_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Bright Acoustic Piano"},{id:"0010_JCLive_sf2_file",library:"JCLive",displayName:"Bright Acoustic Piano"},{id:"0010_SBLive_sf2",library:"SBLive",displayName:"Bright Acoustic Piano"},{id:"0010_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Bright Acoustic Piano"},{id:"0020_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Grand Piano"},{id:"0020_Chaos_sf2_file",library:"Chaos",displayName:"Electric Grand Piano"},{id:"0020_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Grand Piano"},{id:"0020_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Grand Piano"},{id:"0020_JCLive_sf2_file",library:"JCLive",displayName:"Electric Grand Piano"},{id:"0020_SBLive_sf2",library:"SBLive",displayName:"Electric Grand Piano"},{id:"0020_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Grand Piano"},{id:"0050_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Piano 2"},{id:"0050_Chaos_sf2_file",library:"Chaos",displayName:"Electric Piano 2"},{id:"0050_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Piano 2"},{id:"0050_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Piano 2"},{id:"0050_JCLive_sf2_file",library:"JCLive",displayName:"Electric Piano 2"},{id:"0050_SBLive_sf2",library:"SBLive",displayName:"Electric Piano 2"},{id:"0050_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Piano 2"},{id:"0060_Aspirin_sf2_file",library:"Aspirin",displayName:"Harpsichord"},{id:"0060_Chaos_sf2_file",library:"Chaos",displayName:"Harpsichord"},{id:"0060_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Harpsichord"},{id:"0060_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Harpsichord"},{id:"0060_JCLive_sf2_file",library:"JCLive",displayName:"Harpsichord"},{id:"0060_SBLive_sf2",library:"SBLive",displayName:"Harpsichord"},{id:"0060_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Harpsichord"},{id:"0070_Aspirin_sf2_file",library:"Aspirin",displayName:"Clavinet"},{id:"0070_Chaos_sf2_file",library:"Chaos",displayName:"Clavinet"},{id:"0070_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Clavinet"},{id:"0070_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Clavinet"},{id:"0070_JCLive_sf2_file",library:"JCLive",displayName:"Clavinet"},{id:"0070_SBLive_sf2",library:"SBLive",displayName:"Clavinet"},{id:"0070_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Clavinet"},{id:"0080_Aspirin_sf2_file",library:"Aspirin",displayName:"Celesta"},{id:"0080_Chaos_sf2_file",library:"Chaos",displayName:"Celesta"},{id:"0080_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Celesta"},{id:"0080_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Celesta"},{id:"0080_JCLive_sf2_file",library:"JCLive",displayName:"Celesta"},{id:"0080_SBLive_sf2",library:"SBLive",displayName:"Celesta"},{id:"0080_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Celesta"},{id:"0090_Aspirin_sf2_file",library:"Aspirin",displayName:"Glockenspiel"},{id:"0090_Chaos_sf2_file",library:"Chaos",displayName:"Glockenspiel"},{id:"0090_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Glockenspiel"},{id:"0090_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Glockenspiel"},{id:"0090_JCLive_sf2_file",library:"JCLive",displayName:"Glockenspiel"},{id:"0090_SBLive_sf2",library:"SBLive",displayName:"Glockenspiel"},{id:"0090_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Glockenspiel"},{id:"0100_Aspirin_sf2_file",library:"Aspirin",displayName:"Music Box"},{id:"0100_Chaos_sf2_file",library:"Chaos",displayName:"Music Box"},{id:"0100_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Music Box"},{id:"0100_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Music Box"},{id:"0100_JCLive_sf2_file",library:"JCLive",displayName:"Music Box"},{id:"0100_SBLive_sf2",library:"SBLive",displayName:"Music Box"},{id:"0100_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Music Box"},{id:"0110_Aspirin_sf2_file",library:"Aspirin",displayName:"Vibraphone"},{id:"0110_Chaos_sf2_file",library:"Chaos",displayName:"Vibraphone"},{id:"0110_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Vibraphone"},{id:"0110_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Vibraphone"},{id:"0110_JCLive_sf2_file",library:"JCLive",displayName:"Vibraphone"},{id:"0110_SBLive_sf2",library:"SBLive",displayName:"Vibraphone"},{id:"0110_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Vibraphone"},{id:"0120_Aspirin_sf2_file",library:"Aspirin",displayName:"Marimba"},{id:"0120_Chaos_sf2_file",library:"Chaos",displayName:"Marimba"},{id:"0120_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Marimba"},{id:"0120_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Marimba"},{id:"0120_JCLive_sf2_file",library:"JCLive",displayName:"Marimba"},{id:"0120_SBLive_sf2",library:"SBLive",displayName:"Marimba"},{id:"0120_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Marimba"},{id:"0130_Aspirin_sf2_file",library:"Aspirin",displayName:"Xylophone"},{id:"0130_Chaos_sf2_file",library:"Chaos",displayName:"Xylophone"},{id:"0130_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Xylophone"},{id:"0130_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Xylophone"},{id:"0130_JCLive_sf2_file",library:"JCLive",displayName:"Xylophone"},{id:"0130_SBLive_sf2",library:"SBLive",displayName:"Xylophone"},{id:"0130_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Xylophone"},{id:"0140_Aspirin_sf2_file",library:"Aspirin",displayName:"Tubular Bells"},{id:"0140_Chaos_sf2_file",library:"Chaos",displayName:"Tubular Bells"},{id:"0140_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tubular Bells"},{id:"0140_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tubular Bells"},{id:"0140_JCLive_sf2_file",library:"JCLive",displayName:"Tubular Bells"},{id:"0140_SBLive_sf2",library:"SBLive",displayName:"Tubular Bells"},{id:"0140_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tubular Bells"},{id:"0150_Aspirin_sf2_file",library:"Aspirin",displayName:"Dulcimer"},{id:"0150_Chaos_sf2_file",library:"Chaos",displayName:"Dulcimer"},{id:"0150_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Dulcimer"},{id:"0150_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Dulcimer"},{id:"0150_JCLive_sf2_file",library:"JCLive",displayName:"Dulcimer"},{id:"0150_SBLive_sf2",library:"SBLive",displayName:"Dulcimer"},{id:"0150_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Dulcimer"},{id:"0160_Aspirin_sf2_file",library:"Aspirin",displayName:"Drawbar Organ"},{id:"0160_Chaos_sf2_file",library:"Chaos",displayName:"Drawbar Organ"},{id:"0160_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drawbar Organ"},{id:"0160_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Drawbar Organ"},{id:"0160_JCLive_sf2_file",library:"JCLive",displayName:"Drawbar Organ"},{id:"0160_SBLive_sf2",library:"SBLive",displayName:"Drawbar Organ"},{id:"0160_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Drawbar Organ"},{id:"0170_Aspirin_sf2_file",library:"Aspirin",displayName:"Percussive Organ"},{id:"0170_Chaos_sf2_file",library:"Chaos",displayName:"Percussive Organ"},{id:"0170_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Percussive Organ"},{id:"0170_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Percussive Organ"},{id:"0170_JCLive_sf2_file",library:"JCLive",displayName:"Percussive Organ"},{id:"0170_SBLive_sf2",library:"SBLive",displayName:"Percussive Organ"},{id:"0170_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Percussive Organ"},{id:"0180_Aspirin_sf2_file",library:"Aspirin",displayName:"Rock Organ"},{id:"0180_Chaos_sf2_file",library:"Chaos",displayName:"Rock Organ"},{id:"0180_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Rock Organ"},{id:"0180_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Rock Organ"},{id:"0180_JCLive_sf2_file",library:"JCLive",displayName:"Rock Organ"},{id:"0180_SBLive_sf2",library:"SBLive",displayName:"Rock Organ"},{id:"0180_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Rock Organ"},{id:"0190_Aspirin_sf2_file",library:"Aspirin",displayName:"Church Organ"},{id:"0190_Chaos_sf2_file",library:"Chaos",displayName:"Church Organ"},{id:"0190_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Church Organ"},{id:"0190_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Church Organ"},{id:"0190_JCLive_sf2_file",library:"JCLive",displayName:"Church Organ"},{id:"0190_SBLive_sf2",library:"SBLive",displayName:"Church Organ"},{id:"0190_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Church Organ"},{id:"0200_Aspirin_sf2_file",library:"Aspirin",displayName:"Reed Organ"},{id:"0200_Chaos_sf2_file",library:"Chaos",displayName:"Reed Organ"},{id:"0200_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Reed Organ"},{id:"0200_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Reed Organ"},{id:"0200_JCLive_sf2_file",library:"JCLive",displayName:"Reed Organ"},{id:"0200_SBLive_sf2",library:"SBLive",displayName:"Reed Organ"},{id:"0200_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Reed Organ"},{id:"0210_Aspirin_sf2_file",library:"Aspirin",displayName:"Accordion"},{id:"0210_Chaos_sf2_file",library:"Chaos",displayName:"Accordion"},{id:"0210_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Accordion"},{id:"0210_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Accordion"},{id:"0210_JCLive_sf2_file",library:"JCLive",displayName:"Accordion"},{id:"0210_SBLive_sf2",library:"SBLive",displayName:"Accordion"},{id:"0210_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Accordion"},{id:"0220_Aspirin_sf2_file",library:"Aspirin",displayName:"Harmonica"},{id:"0220_Chaos_sf2_file",library:"Chaos",displayName:"Harmonica"},{id:"0220_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Harmonica"},{id:"0220_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Harmonica"},{id:"0220_JCLive_sf2_file",library:"JCLive",displayName:"Harmonica"},{id:"0220_SBLive_sf2",library:"SBLive",displayName:"Harmonica"},{id:"0220_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Harmonica"},{id:"0230_Aspirin_sf2_file",library:"Aspirin",displayName:"Tango Accordion"},{id:"0230_Chaos_sf2_file",library:"Chaos",displayName:"Tango Accordion"},{id:"0230_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tango Accordion"},{id:"0230_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tango Accordion"},{id:"0230_JCLive_sf2_file",library:"JCLive",displayName:"Tango Accordion"},{id:"0230_SBLive_sf2",library:"SBLive",displayName:"Tango Accordion"},{id:"0230_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tango Accordion"},{id:"0240_Aspirin_sf2_file",library:"Aspirin",displayName:"Acoustic Guitar (nylon)"},{id:"0240_Chaos_sf2_file",library:"Chaos",displayName:"Acoustic Guitar (nylon)"},{id:"0240_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Acoustic Guitar (nylon)"},{id:"0240_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Acoustic Guitar (nylon)"},{id:"0240_JCLive_sf2_file",library:"JCLive",displayName:"Acoustic Guitar (nylon)"},{id:"0240_SBLive_sf2",library:"SBLive",displayName:"Acoustic Guitar (nylon)"},{id:"0240_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Acoustic Guitar (nylon)"},{id:"0250_Aspirin_sf2_file",library:"Aspirin",displayName:"Acoustic Guitar (steel)"},{id:"0250_Chaos_sf2_file",library:"Chaos",displayName:"Acoustic Guitar (steel)"},{id:"0250_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Acoustic Guitar (steel)"},{id:"0250_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Acoustic Guitar (steel)"},{id:"0250_JCLive_sf2_file",library:"JCLive",displayName:"Acoustic Guitar (steel)"},{id:"0250_SBLive_sf2",library:"SBLive",displayName:"Acoustic Guitar (steel)"},{id:"0250_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Acoustic Guitar (steel)"},{id:"0260_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Guitar (jazz)"},{id:"0260_Chaos_sf2_file",library:"Chaos",displayName:"Electric Guitar (jazz)"},{id:"0260_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Guitar (jazz)"},{id:"0260_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Guitar (jazz)"},{id:"0260_JCLive_sf2_file",library:"JCLive",displayName:"Electric Guitar (jazz)"},{id:"0260_SBLive_sf2",library:"SBLive",displayName:"Electric Guitar (jazz)"},{id:"0260_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Guitar (jazz)"},{id:"0270_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Guitar (clean)"},{id:"0270_Chaos_sf2_file",library:"Chaos",displayName:"Electric Guitar (clean)"},{id:"0270_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Guitar (clean)"},{id:"0270_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Guitar (clean)"},{id:"0270_JCLive_sf2_file",library:"JCLive",displayName:"Electric Guitar (clean)"},{id:"0270_SBLive_sf2",library:"SBLive",displayName:"Electric Guitar (clean)"},{id:"0270_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Guitar (clean)"},{id:"0280_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Guitar (muted)"},{id:"0280_Chaos_sf2_file",library:"Chaos",displayName:"Electric Guitar (muted)"},{id:"0280_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Guitar (muted)"},{id:"0280_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Guitar (muted)"},{id:"0280_JCLive_sf2_file",library:"JCLive",displayName:"Electric Guitar (muted)"},{id:"0280_SBLive_sf2",library:"SBLive",displayName:"Electric Guitar (muted)"},{id:"0280_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Guitar (muted)"},{id:"0290_Aspirin_sf2_file",library:"Aspirin",displayName:"Overdriven Guitar"},{id:"0290_Chaos_sf2_file",library:"Chaos",displayName:"Overdriven Guitar"},{id:"0290_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Overdriven Guitar"},{id:"0290_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Overdriven Guitar"},{id:"0290_JCLive_sf2_file",library:"JCLive",displayName:"Overdriven Guitar"},{id:"0290_SBLive_sf2",library:"SBLive",displayName:"Overdriven Guitar"},{id:"0290_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Overdriven Guitar"},{id:"0300_Aspirin_sf2_file",library:"Aspirin",displayName:"Distortion Guitar"},{id:"0300_Chaos_sf2_file",library:"Chaos",displayName:"Distortion Guitar"},{id:"0300_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Distortion Guitar"},{id:"0300_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Distortion Guitar"},{id:"0300_JCLive_sf2_file",library:"JCLive",displayName:"Distortion Guitar"},{id:"0300_SBLive_sf2",library:"SBLive",displayName:"Distortion Guitar"},{id:"0300_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Distortion Guitar"},{id:"0310_Aspirin_sf2_file",library:"Aspirin",displayName:"Guitar Harmonics"},{id:"0310_Chaos_sf2_file",library:"Chaos",displayName:"Guitar Harmonics"},{id:"0310_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Guitar Harmonics"},{id:"0310_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Guitar Harmonics"},{id:"0310_JCLive_sf2_file",library:"JCLive",displayName:"Guitar Harmonics"},{id:"0310_SBLive_sf2",library:"SBLive",displayName:"Guitar Harmonics"},{id:"0310_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Guitar Harmonics"},{id:"0320_Aspirin_sf2_file",library:"Aspirin",displayName:"Acoustic Bass"},{id:"0320_Chaos_sf2_file",library:"Chaos",displayName:"Acoustic Bass"},{id:"0320_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Acoustic Bass"},{id:"0320_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Acoustic Bass"},{id:"0320_JCLive_sf2_file",library:"JCLive",displayName:"Acoustic Bass"},{id:"0320_SBLive_sf2",library:"SBLive",displayName:"Acoustic Bass"},{id:"0320_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Acoustic Bass"},{id:"0330_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Bass (finger)"},{id:"0330_Chaos_sf2_file",library:"Chaos",displayName:"Electric Bass (finger)"},{id:"0330_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Bass (finger)"},{id:"0330_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Bass (finger)"},{id:"0330_JCLive_sf2_file",library:"JCLive",displayName:"Electric Bass (finger)"},{id:"0330_SBLive_sf2",library:"SBLive",displayName:"Electric Bass (finger)"},{id:"0330_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Bass (finger)"},{id:"0340_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Bass (pick)"},{id:"0340_Chaos_sf2_file",library:"Chaos",displayName:"Electric Bass (pick)"},{id:"0340_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Bass (pick)"},{id:"0340_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Bass (pick)"},{id:"0340_JCLive_sf2_file",library:"JCLive",displayName:"Electric Bass (pick)"},{id:"0340_SBLive_sf2",library:"SBLive",displayName:"Electric Bass (pick)"},{id:"0340_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Bass (pick)"},{id:"0350_Aspirin_sf2_file",library:"Aspirin",displayName:"Fretless Bass"},{id:"0350_Chaos_sf2_file",library:"Chaos",displayName:"Fretless Bass"},{id:"0350_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Fretless Bass"},{id:"0350_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Fretless Bass"},{id:"0350_JCLive_sf2_file",library:"JCLive",displayName:"Fretless Bass"},{id:"0350_SBLive_sf2",library:"SBLive",displayName:"Fretless Bass"},{id:"0350_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Fretless Bass"},{id:"0360_Aspirin_sf2_file",library:"Aspirin",displayName:"Slap Bass 1"},{id:"0360_Chaos_sf2_file",library:"Chaos",displayName:"Slap Bass 1"},{id:"0360_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Slap Bass 1"},{id:"0360_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Slap Bass 1"},{id:"0360_JCLive_sf2_file",library:"JCLive",displayName:"Slap Bass 1"},{id:"0360_SBLive_sf2",library:"SBLive",displayName:"Slap Bass 1"},{id:"0360_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Slap Bass 1"},{id:"0370_Aspirin_sf2_file",library:"Aspirin",displayName:"Slap Bass 2"},{id:"0370_Chaos_sf2_file",library:"Chaos",displayName:"Slap Bass 2"},{id:"0370_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Slap Bass 2"},{id:"0370_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Slap Bass 2"},{id:"0370_JCLive_sf2_file",library:"JCLive",displayName:"Slap Bass 2"},{id:"0370_SBLive_sf2",library:"SBLive",displayName:"Slap Bass 2"},{id:"0370_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Slap Bass 2"},{id:"0380_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Bass 1"},{id:"0380_Chaos_sf2_file",library:"Chaos",displayName:"Synth Bass 1"},{id:"0380_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Bass 1"},{id:"0380_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Bass 1"},{id:"0380_JCLive_sf2_file",library:"JCLive",displayName:"Synth Bass 1"},{id:"0380_SBLive_sf2",library:"SBLive",displayName:"Synth Bass 1"},{id:"0380_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Bass 1"},{id:"0390_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Bass 2"},{id:"0390_Chaos_sf2_file",library:"Chaos",displayName:"Synth Bass 2"},{id:"0390_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Bass 2"},{id:"0390_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Bass 2"},{id:"0390_JCLive_sf2_file",library:"JCLive",displayName:"Synth Bass 2"},{id:"0390_SBLive_sf2",library:"SBLive",displayName:"Synth Bass 2"},{id:"0390_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Bass 2"},{id:"0400_Aspirin_sf2_file",library:"Aspirin",displayName:"Violin"},{id:"0400_Chaos_sf2_file",library:"Chaos",displayName:"Violin"},{id:"0400_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Violin"},{id:"0400_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Violin"},{id:"0400_JCLive_sf2_file",library:"JCLive",displayName:"Violin"},{id:"0400_SBLive_sf2",library:"SBLive",displayName:"Violin"},{id:"0400_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Violin"},{id:"0410_Aspirin_sf2_file",library:"Aspirin",displayName:"Viola"},{id:"0410_Chaos_sf2_file",library:"Chaos",displayName:"Viola"},{id:"0410_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Viola"},{id:"0410_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Viola"},{id:"0410_JCLive_sf2_file",library:"JCLive",displayName:"Viola"},{id:"0410_SBLive_sf2",library:"SBLive",displayName:"Viola"},{id:"0410_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Viola"},{id:"0420_Aspirin_sf2_file",library:"Aspirin",displayName:"Cello"},{id:"0420_Chaos_sf2_file",library:"Chaos",displayName:"Cello"},{id:"0420_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Cello"},{id:"0420_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Cello"},{id:"0420_JCLive_sf2_file",library:"JCLive",displayName:"Cello"},{id:"0420_SBLive_sf2",library:"SBLive",displayName:"Cello"},{id:"0420_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Cello"},{id:"0430_Aspirin_sf2_file",library:"Aspirin",displayName:"Contrabass"},{id:"0430_Chaos_sf2_file",library:"Chaos",displayName:"Contrabass"},{id:"0430_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Contrabass"},{id:"0430_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Contrabass"},{id:"0430_JCLive_sf2_file",library:"JCLive",displayName:"Contrabass"},{id:"0430_SBLive_sf2",library:"SBLive",displayName:"Contrabass"},{id:"0430_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Contrabass"},{id:"0440_Aspirin_sf2_file",library:"Aspirin",displayName:"Tremolo Strings"},{id:"0440_Chaos_sf2_file",library:"Chaos",displayName:"Tremolo Strings"},{id:"0440_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tremolo Strings"},{id:"0440_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tremolo Strings"},{id:"0440_JCLive_sf2_file",library:"JCLive",displayName:"Tremolo Strings"},{id:"0440_SBLive_sf2",library:"SBLive",displayName:"Tremolo Strings"},{id:"0440_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tremolo Strings"},{id:"0450_Aspirin_sf2_file",library:"Aspirin",displayName:"Pizzicato Strings"},{id:"0450_Chaos_sf2_file",library:"Chaos",displayName:"Pizzicato Strings"},{id:"0450_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pizzicato Strings"},{id:"0450_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pizzicato Strings"},{id:"0450_JCLive_sf2_file",library:"JCLive",displayName:"Pizzicato Strings"},{id:"0450_SBLive_sf2",library:"SBLive",displayName:"Pizzicato Strings"},{id:"0450_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pizzicato Strings"},{id:"0460_Aspirin_sf2_file",library:"Aspirin",displayName:"Orchestral Harp"},{id:"0460_Chaos_sf2_file",library:"Chaos",displayName:"Orchestral Harp"},{id:"0460_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Orchestral Harp"},{id:"0460_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Orchestral Harp"},{id:"0460_JCLive_sf2_file",library:"JCLive",displayName:"Orchestral Harp"},{id:"0460_SBLive_sf2",library:"SBLive",displayName:"Orchestral Harp"},{id:"0460_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Orchestral Harp"},{id:"0470_Aspirin_sf2_file",library:"Aspirin",displayName:"Timpani"},{id:"0470_Chaos_sf2_file",library:"Chaos",displayName:"Timpani"},{id:"0470_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Timpani"},{id:"0470_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Timpani"},{id:"0470_JCLive_sf2_file",library:"JCLive",displayName:"Timpani"},{id:"0470_SBLive_sf2",library:"SBLive",displayName:"Timpani"},{id:"0470_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Timpani"},{id:"0480_Aspirin_sf2_file",library:"Aspirin",displayName:"String Ensemble 1"},{id:"0480_Chaos_sf2_file",library:"Chaos",displayName:"String Ensemble 1"},{id:"0480_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"String Ensemble 1"},{id:"0480_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"String Ensemble 1"},{id:"0480_JCLive_sf2_file",library:"JCLive",displayName:"String Ensemble 1"},{id:"0480_SBLive_sf2",library:"SBLive",displayName:"String Ensemble 1"},{id:"0480_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"String Ensemble 1"},{id:"0490_Aspirin_sf2_file",library:"Aspirin",displayName:"String Ensemble 2"},{id:"0490_Chaos_sf2_file",library:"Chaos",displayName:"String Ensemble 2"},{id:"0490_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"String Ensemble 2"},{id:"0490_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"String Ensemble 2"},{id:"0490_JCLive_sf2_file",library:"JCLive",displayName:"String Ensemble 2"},{id:"0490_SBLive_sf2",library:"SBLive",displayName:"String Ensemble 2"},{id:"0490_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"String Ensemble 2"},{id:"0500_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Strings 1"},{id:"0500_Chaos_sf2_file",library:"Chaos",displayName:"Synth Strings 1"},{id:"0500_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Strings 1"},{id:"0500_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Strings 1"},{id:"0500_JCLive_sf2_file",library:"JCLive",displayName:"Synth Strings 1"},{id:"0500_SBLive_sf2",library:"SBLive",displayName:"Synth Strings 1"},{id:"0500_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Strings 1"},{id:"0510_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Strings 2"},{id:"0510_Chaos_sf2_file",library:"Chaos",displayName:"Synth Strings 2"},{id:"0510_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Strings 2"},{id:"0510_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Strings 2"},{id:"0510_JCLive_sf2_file",library:"JCLive",displayName:"Synth Strings 2"},{id:"0510_SBLive_sf2",library:"SBLive",displayName:"Synth Strings 2"},{id:"0510_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Strings 2"},{id:"0520_Aspirin_sf2_file",library:"Aspirin",displayName:"Choir Aahs"},{id:"0520_Chaos_sf2_file",library:"Chaos",displayName:"Choir Aahs"},{id:"0520_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Choir Aahs"},{id:"0520_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Choir Aahs"},{id:"0520_JCLive_sf2_file",library:"JCLive",displayName:"Choir Aahs"},{id:"0520_SBLive_sf2",library:"SBLive",displayName:"Choir Aahs"},{id:"0520_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Choir Aahs"},{id:"0530_Aspirin_sf2_file",library:"Aspirin",displayName:"Voice Oohs"},{id:"0530_Chaos_sf2_file",library:"Chaos",displayName:"Voice Oohs"},{id:"0530_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Voice Oohs"},{id:"0530_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Voice Oohs"},{id:"0530_JCLive_sf2_file",library:"JCLive",displayName:"Voice Oohs"},{id:"0530_SBLive_sf2",library:"SBLive",displayName:"Voice Oohs"},{id:"0530_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Voice Oohs"},{id:"0540_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Choir"},{id:"0540_Chaos_sf2_file",library:"Chaos",displayName:"Synth Choir"},{id:"0540_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Choir"},{id:"0540_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Choir"},{id:"0540_JCLive_sf2_file",library:"JCLive",displayName:"Synth Choir"},{id:"0540_SBLive_sf2",library:"SBLive",displayName:"Synth Choir"},{id:"0540_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Choir"},{id:"0550_Aspirin_sf2_file",library:"Aspirin",displayName:"Orchestra Hit"},{id:"0550_Chaos_sf2_file",library:"Chaos",displayName:"Orchestra Hit"},{id:"0550_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Orchestra Hit"},{id:"0550_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Orchestra Hit"},{id:"0550_JCLive_sf2_file",library:"JCLive",displayName:"Orchestra Hit"},{id:"0550_SBLive_sf2",library:"SBLive",displayName:"Orchestra Hit"},{id:"0550_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Orchestra Hit"},{id:"0560_Aspirin_sf2_file",library:"Aspirin",displayName:"Trumpet"},{id:"0560_Chaos_sf2_file",library:"Chaos",displayName:"Trumpet"},{id:"0560_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Trumpet"},{id:"0560_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Trumpet"},{id:"0560_JCLive_sf2_file",library:"JCLive",displayName:"Trumpet"},{id:"0560_SBLive_sf2",library:"SBLive",displayName:"Trumpet"},{id:"0560_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Trumpet"},{id:"0570_Aspirin_sf2_file",library:"Aspirin",displayName:"Trombone"},{id:"0570_Chaos_sf2_file",library:"Chaos",displayName:"Trombone"},{id:"0570_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Trombone"},{id:"0570_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Trombone"},{id:"0570_JCLive_sf2_file",library:"JCLive",displayName:"Trombone"},{id:"0570_SBLive_sf2",library:"SBLive",displayName:"Trombone"},{id:"0570_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Trombone"},{id:"0580_Aspirin_sf2_file",library:"Aspirin",displayName:"Tuba"},{id:"0580_Chaos_sf2_file",library:"Chaos",displayName:"Tuba"},{id:"0580_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tuba"},{id:"0580_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tuba"},{id:"0580_JCLive_sf2_file",library:"JCLive",displayName:"Tuba"},{id:"0580_SBLive_sf2",library:"SBLive",displayName:"Tuba"},{id:"0580_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tuba"},{id:"0590_Aspirin_sf2_file",library:"Aspirin",displayName:"Muted Trumpet"},{id:"0590_Chaos_sf2_file",library:"Chaos",displayName:"Muted Trumpet"},{id:"0590_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Muted Trumpet"},{id:"0590_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Muted Trumpet"},{id:"0590_JCLive_sf2_file",library:"JCLive",displayName:"Muted Trumpet"},{id:"0590_SBLive_sf2",library:"SBLive",displayName:"Muted Trumpet"},{id:"0590_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Muted Trumpet"},{id:"0600_Aspirin_sf2_file",library:"Aspirin",displayName:"French Horn"},{id:"0600_Chaos_sf2_file",library:"Chaos",displayName:"French Horn"},{id:"0600_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"French Horn"},{id:"0600_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"French Horn"},{id:"0600_JCLive_sf2_file",library:"JCLive",displayName:"French Horn"},{id:"0600_SBLive_sf2",library:"SBLive",displayName:"French Horn"},{id:"0600_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"French Horn"},{id:"0610_Aspirin_sf2_file",library:"Aspirin",displayName:"Brass Section"},{id:"0610_Chaos_sf2_file",library:"Chaos",displayName:"Brass Section"},{id:"0610_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Brass Section"},{id:"0610_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Brass Section"},{id:"0610_JCLive_sf2_file",library:"JCLive",displayName:"Brass Section"},{id:"0610_SBLive_sf2",library:"SBLive",displayName:"Brass Section"},{id:"0610_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Brass Section"},{id:"0620_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Brass 1"},{id:"0620_Chaos_sf2_file",library:"Chaos",displayName:"Synth Brass 1"},{id:"0620_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Brass 1"},{id:"0620_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Brass 1"},{id:"0620_JCLive_sf2_file",library:"JCLive",displayName:"Synth Brass 1"},{id:"0620_SBLive_sf2",library:"SBLive",displayName:"Synth Brass 1"},{id:"0620_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Brass 1"},{id:"0630_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Brass 2"},{id:"0630_Chaos_sf2_file",library:"Chaos",displayName:"Synth Brass 2"},{id:"0630_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Brass 2"},{id:"0630_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Brass 2"},{id:"0630_JCLive_sf2_file",library:"JCLive",displayName:"Synth Brass 2"},{id:"0630_SBLive_sf2",library:"SBLive",displayName:"Synth Brass 2"},{id:"0630_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Brass 2"},{id:"0640_Aspirin_sf2_file",library:"Aspirin",displayName:"Soprano Sax"},{id:"0640_Chaos_sf2_file",library:"Chaos",displayName:"Soprano Sax"},{id:"0640_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Soprano Sax"},{id:"0640_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Soprano Sax"},{id:"0640_JCLive_sf2_file",library:"JCLive",displayName:"Soprano Sax"},{id:"0640_SBLive_sf2",library:"SBLive",displayName:"Soprano Sax"},{id:"0640_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Soprano Sax"},{id:"0650_Aspirin_sf2_file",library:"Aspirin",displayName:"Alto Sax"},{id:"0650_Chaos_sf2_file",library:"Chaos",displayName:"Alto Sax"},{id:"0650_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Alto Sax"},{id:"0650_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Alto Sax"},{id:"0650_JCLive_sf2_file",library:"JCLive",displayName:"Alto Sax"},{id:"0650_SBLive_sf2",library:"SBLive",displayName:"Alto Sax"},{id:"0650_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Alto Sax"},{id:"0660_Aspirin_sf2_file",library:"Aspirin",displayName:"Tenor Sax"},{id:"0660_Chaos_sf2_file",library:"Chaos",displayName:"Tenor Sax"},{id:"0660_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tenor Sax"},{id:"0660_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tenor Sax"},{id:"0660_JCLive_sf2_file",library:"JCLive",displayName:"Tenor Sax"},{id:"0660_SBLive_sf2",library:"SBLive",displayName:"Tenor Sax"},{id:"0660_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tenor Sax"},{id:"0670_Aspirin_sf2_file",library:"Aspirin",displayName:"Baritone Sax"},{id:"0670_Chaos_sf2_file",library:"Chaos",displayName:"Baritone Sax"},{id:"0670_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Baritone Sax"},{id:"0670_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Baritone Sax"},{id:"0670_JCLive_sf2_file",library:"JCLive",displayName:"Baritone Sax"},{id:"0670_SBLive_sf2",library:"SBLive",displayName:"Baritone Sax"},{id:"0670_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Baritone Sax"},{id:"0680_Aspirin_sf2_file",library:"Aspirin",displayName:"Oboe"},{id:"0680_Chaos_sf2_file",library:"Chaos",displayName:"Oboe"},{id:"0680_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Oboe"},{id:"0680_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Oboe"},{id:"0680_JCLive_sf2_file",library:"JCLive",displayName:"Oboe"},{id:"0680_SBLive_sf2",library:"SBLive",displayName:"Oboe"},{id:"0680_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Oboe"},{id:"0690_Aspirin_sf2_file",library:"Aspirin",displayName:"English Horn"},{id:"0690_Chaos_sf2_file",library:"Chaos",displayName:"English Horn"},{id:"0690_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"English Horn"},{id:"0690_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"English Horn"},{id:"0690_JCLive_sf2_file",library:"JCLive",displayName:"English Horn"},{id:"0690_SBLive_sf2",library:"SBLive",displayName:"English Horn"},{id:"0690_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"English Horn"},{id:"0700_Aspirin_sf2_file",library:"Aspirin",displayName:"Bassoon"},{id:"0700_Chaos_sf2_file",library:"Chaos",displayName:"Bassoon"},{id:"0700_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Bassoon"},{id:"0700_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Bassoon"},{id:"0700_JCLive_sf2_file",library:"JCLive",displayName:"Bassoon"},{id:"0700_SBLive_sf2",library:"SBLive",displayName:"Bassoon"},{id:"0700_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Bassoon"},{id:"0710_Aspirin_sf2_file",library:"Aspirin",displayName:"Clarinet"},{id:"0710_Chaos_sf2_file",library:"Chaos",displayName:"Clarinet"},{id:"0710_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Clarinet"},{id:"0710_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Clarinet"},{id:"0710_JCLive_sf2_file",library:"JCLive",displayName:"Clarinet"},{id:"0710_SBLive_sf2",library:"SBLive",displayName:"Clarinet"},{id:"0710_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Clarinet"},{id:"0720_Aspirin_sf2_file",library:"Aspirin",displayName:"Piccolo"},{id:"0720_Chaos_sf2_file",library:"Chaos",displayName:"Piccolo"},{id:"0720_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Piccolo"},{id:"0720_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Piccolo"},{id:"0720_JCLive_sf2_file",library:"JCLive",displayName:"Piccolo"},{id:"0720_SBLive_sf2",library:"SBLive",displayName:"Piccolo"},{id:"0720_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Piccolo"},{id:"0730_Aspirin_sf2_file",library:"Aspirin",displayName:"Flute"},{id:"0730_Chaos_sf2_file",library:"Chaos",displayName:"Flute"},{id:"0730_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Flute"},{id:"0730_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Flute"},{id:"0730_JCLive_sf2_file",library:"JCLive",displayName:"Flute"},{id:"0730_SBLive_sf2",library:"SBLive",displayName:"Flute"},{id:"0730_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Flute"},{id:"0740_Aspirin_sf2_file",library:"Aspirin",displayName:"Recorder"},{id:"0740_Chaos_sf2_file",library:"Chaos",displayName:"Recorder"},{id:"0740_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Recorder"},{id:"0740_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Recorder"},{id:"0740_JCLive_sf2_file",library:"JCLive",displayName:"Recorder"},{id:"0740_SBLive_sf2",library:"SBLive",displayName:"Recorder"},{id:"0740_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Recorder"},{id:"0750_Aspirin_sf2_file",library:"Aspirin",displayName:"Pan Flute"},{id:"0750_Chaos_sf2_file",library:"Chaos",displayName:"Pan Flute"},{id:"0750_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pan Flute"},{id:"0750_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pan Flute"},{id:"0750_JCLive_sf2_file",library:"JCLive",displayName:"Pan Flute"},{id:"0750_SBLive_sf2",library:"SBLive",displayName:"Pan Flute"},{id:"0750_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pan Flute"},{id:"0760_Aspirin_sf2_file",library:"Aspirin",displayName:"Blown Bottle"},{id:"0760_Chaos_sf2_file",library:"Chaos",displayName:"Blown Bottle"},{id:"0760_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Blown Bottle"},{id:"0760_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Blown Bottle"},{id:"0760_JCLive_sf2_file",library:"JCLive",displayName:"Blown Bottle"},{id:"0760_SBLive_sf2",library:"SBLive",displayName:"Blown Bottle"},{id:"0760_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Blown Bottle"},{id:"0770_Aspirin_sf2_file",library:"Aspirin",displayName:"Shakuhachi"},{id:"0770_Chaos_sf2_file",library:"Chaos",displayName:"Shakuhachi"},{id:"0770_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Shakuhachi"},{id:"0770_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Shakuhachi"},{id:"0770_JCLive_sf2_file",library:"JCLive",displayName:"Shakuhachi"},{id:"0770_SBLive_sf2",library:"SBLive",displayName:"Shakuhachi"},{id:"0770_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Shakuhachi"},{id:"0780_Aspirin_sf2_file",library:"Aspirin",displayName:"Whistle"},{id:"0780_Chaos_sf2_file",library:"Chaos",displayName:"Whistle"},{id:"0780_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Whistle"},{id:"0780_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Whistle"},{id:"0780_JCLive_sf2_file",library:"JCLive",displayName:"Whistle"},{id:"0780_SBLive_sf2",library:"SBLive",displayName:"Whistle"},{id:"0780_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Whistle"},{id:"0790_Aspirin_sf2_file",library:"Aspirin",displayName:"Ocarina"},{id:"0790_Chaos_sf2_file",library:"Chaos",displayName:"Ocarina"},{id:"0790_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Ocarina"},{id:"0790_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Ocarina"},{id:"0790_JCLive_sf2_file",library:"JCLive",displayName:"Ocarina"},{id:"0790_SBLive_sf2",library:"SBLive",displayName:"Ocarina"},{id:"0790_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Ocarina"},{id:"0800_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 1 (square)"},{id:"0800_Chaos_sf2_file",library:"Chaos",displayName:"Lead 1 (square)"},{id:"0800_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 1 (square)"},{id:"0800_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 1 (square)"},{id:"0800_JCLive_sf2_file",library:"JCLive",displayName:"Lead 1 (square)"},{id:"0800_SBLive_sf2",library:"SBLive",displayName:"Lead 1 (square)"},{id:"0800_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 1 (square)"},{id:"0810_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 2 (sawtooth)"},{id:"0810_Chaos_sf2_file",library:"Chaos",displayName:"Lead 2 (sawtooth)"},{id:"0810_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 2 (sawtooth)"},{id:"0810_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 2 (sawtooth)"},{id:"0810_JCLive_sf2_file",library:"JCLive",displayName:"Lead 2 (sawtooth)"},{id:"0810_SBLive_sf2",library:"SBLive",displayName:"Lead 2 (sawtooth)"},{id:"0810_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 2 (sawtooth)"},{id:"0820_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 3 (calliope)"},{id:"0820_Chaos_sf2_file",library:"Chaos",displayName:"Lead 3 (calliope)"},{id:"0820_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 3 (calliope)"},{id:"0820_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 3 (calliope)"},{id:"0820_JCLive_sf2_file",library:"JCLive",displayName:"Lead 3 (calliope)"},{id:"0820_SBLive_sf2",library:"SBLive",displayName:"Lead 3 (calliope)"},{id:"0820_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 3 (calliope)"},{id:"0830_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 4 (chiff)"},{id:"0830_Chaos_sf2_file",library:"Chaos",displayName:"Lead 4 (chiff)"},{id:"0830_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 4 (chiff)"},{id:"0830_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 4 (chiff)"},{id:"0830_JCLive_sf2_file",library:"JCLive",displayName:"Lead 4 (chiff)"},{id:"0830_SBLive_sf2",library:"SBLive",displayName:"Lead 4 (chiff)"},{id:"0830_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 4 (chiff)"},{id:"0840_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 5 (charang)"},{id:"0840_Chaos_sf2_file",library:"Chaos",displayName:"Lead 5 (charang)"},{id:"0840_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 5 (charang)"},{id:"0840_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 5 (charang)"},{id:"0840_JCLive_sf2_file",library:"JCLive",displayName:"Lead 5 (charang)"},{id:"0840_SBLive_sf2",library:"SBLive",displayName:"Lead 5 (charang)"},{id:"0840_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 5 (charang)"},{id:"0850_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 6 (voice)"},{id:"0850_Chaos_sf2_file",library:"Chaos",displayName:"Lead 6 (voice)"},{id:"0850_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 6 (voice)"},{id:"0850_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 6 (voice)"},{id:"0850_JCLive_sf2_file",library:"JCLive",displayName:"Lead 6 (voice)"},{id:"0850_SBLive_sf2",library:"SBLive",displayName:"Lead 6 (voice)"},{id:"0850_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 6 (voice)"},{id:"0860_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 7 (fifths)"},{id:"0860_Chaos_sf2_file",library:"Chaos",displayName:"Lead 7 (fifths)"},{id:"0860_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 7 (fifths)"},{id:"0860_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 7 (fifths)"},{id:"0860_JCLive_sf2_file",library:"JCLive",displayName:"Lead 7 (fifths)"},{id:"0860_SBLive_sf2",library:"SBLive",displayName:"Lead 7 (fifths)"},{id:"0860_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 7 (fifths)"},{id:"0870_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 8 (bass + lead)"},{id:"0870_Chaos_sf2_file",library:"Chaos",displayName:"Lead 8 (bass + lead)"},{id:"0870_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 8 (bass + lead)"},{id:"0870_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 8 (bass + lead)"},{id:"0870_JCLive_sf2_file",library:"JCLive",displayName:"Lead 8 (bass + lead)"},{id:"0870_SBLive_sf2",library:"SBLive",displayName:"Lead 8 (bass + lead)"},{id:"0870_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 8 (bass + lead)"},{id:"0880_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 1 (new age)"},{id:"0880_Chaos_sf2_file",library:"Chaos",displayName:"Pad 1 (new age)"},{id:"0880_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 1 (new age)"},{id:"0880_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 1 (new age)"},{id:"0880_JCLive_sf2_file",library:"JCLive",displayName:"Pad 1 (new age)"},{id:"0880_SBLive_sf2",library:"SBLive",displayName:"Pad 1 (new age)"},{id:"0880_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 1 (new age)"},{id:"0890_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 2 (warm)"},{id:"0890_Chaos_sf2_file",library:"Chaos",displayName:"Pad 2 (warm)"},{id:"0890_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 2 (warm)"},{id:"0890_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 2 (warm)"},{id:"0890_JCLive_sf2_file",library:"JCLive",displayName:"Pad 2 (warm)"},{id:"0890_SBLive_sf2",library:"SBLive",displayName:"Pad 2 (warm)"},{id:"0890_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 2 (warm)"},{id:"0900_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 3 (polysynth)"},{id:"0900_Chaos_sf2_file",library:"Chaos",displayName:"Pad 3 (polysynth)"},{id:"0900_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 3 (polysynth)"},{id:"0900_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 3 (polysynth)"},{id:"0900_JCLive_sf2_file",library:"JCLive",displayName:"Pad 3 (polysynth)"},{id:"0900_SBLive_sf2",library:"SBLive",displayName:"Pad 3 (polysynth)"},{id:"0900_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 3 (polysynth)"},{id:"0910_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 4 (choir)"},{id:"0910_Chaos_sf2_file",library:"Chaos",displayName:"Pad 4 (choir)"},{id:"0910_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 4 (choir)"},{id:"0910_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 4 (choir)"},{id:"0910_JCLive_sf2_file",library:"JCLive",displayName:"Pad 4 (choir)"},{id:"0910_SBLive_sf2",library:"SBLive",displayName:"Pad 4 (choir)"},{id:"0910_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 4 (choir)"},{id:"0920_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 5 (bowed)"},{id:"0920_Chaos_sf2_file",library:"Chaos",displayName:"Pad 5 (bowed)"},{id:"0920_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 5 (bowed)"},{id:"0920_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 5 (bowed)"},{id:"0920_JCLive_sf2_file",library:"JCLive",displayName:"Pad 5 (bowed)"},{id:"0920_SBLive_sf2",library:"SBLive",displayName:"Pad 5 (bowed)"},{id:"0920_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 5 (bowed)"},{id:"0930_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 6 (metallic)"},{id:"0930_Chaos_sf2_file",library:"Chaos",displayName:"Pad 6 (metallic)"},{id:"0930_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 6 (metallic)"},{id:"0930_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 6 (metallic)"},{id:"0930_JCLive_sf2_file",library:"JCLive",displayName:"Pad 6 (metallic)"},{id:"0930_SBLive_sf2",library:"SBLive",displayName:"Pad 6 (metallic)"},{id:"0930_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 6 (metallic)"},{id:"0940_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 7 (halo)"},{id:"0940_Chaos_sf2_file",library:"Chaos",displayName:"Pad 7 (halo)"},{id:"0940_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 7 (halo)"},{id:"0940_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 7 (halo)"},{id:"0940_JCLive_sf2_file",library:"JCLive",displayName:"Pad 7 (halo)"},{id:"0940_SBLive_sf2",library:"SBLive",displayName:"Pad 7 (halo)"},{id:"0940_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 7 (halo)"},{id:"0950_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 8 (sweep)"},{id:"0950_Chaos_sf2_file",library:"Chaos",displayName:"Pad 8 (sweep)"},{id:"0950_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 8 (sweep)"},{id:"0950_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 8 (sweep)"},{id:"0950_JCLive_sf2_file",library:"JCLive",displayName:"Pad 8 (sweep)"},{id:"0950_SBLive_sf2",library:"SBLive",displayName:"Pad 8 (sweep)"},{id:"0950_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 8 (sweep)"},{id:"0960_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 1 (rain)"},{id:"0960_Chaos_sf2_file",library:"Chaos",displayName:"FX 1 (rain)"},{id:"0960_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 1 (rain)"},{id:"0960_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 1 (rain)"},{id:"0960_JCLive_sf2_file",library:"JCLive",displayName:"FX 1 (rain)"},{id:"0960_SBLive_sf2",library:"SBLive",displayName:"FX 1 (rain)"},{id:"0960_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 1 (rain)"},{id:"0970_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 2 (soundtrack)"},{id:"0970_Chaos_sf2_file",library:"Chaos",displayName:"FX 2 (soundtrack)"},{id:"0970_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 2 (soundtrack)"},{id:"0970_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 2 (soundtrack)"},{id:"0970_JCLive_sf2_file",library:"JCLive",displayName:"FX 2 (soundtrack)"},{id:"0970_SBLive_sf2",library:"SBLive",displayName:"FX 2 (soundtrack)"},{id:"0970_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 2 (soundtrack)"},{id:"0980_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 3 (crystal)"},{id:"0980_Chaos_sf2_file",library:"Chaos",displayName:"FX 3 (crystal)"},{id:"0980_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 3 (crystal)"},{id:"0980_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 3 (crystal)"},{id:"0980_JCLive_sf2_file",library:"JCLive",displayName:"FX 3 (crystal)"},{id:"0980_SBLive_sf2",library:"SBLive",displayName:"FX 3 (crystal)"},{id:"0980_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 3 (crystal)"},{id:"0990_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 4 (atmosphere)"},{id:"0990_Chaos_sf2_file",library:"Chaos",displayName:"FX 4 (atmosphere)"},{id:"0990_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 4 (atmosphere)"},{id:"0990_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 4 (atmosphere)"},{id:"0990_JCLive_sf2_file",library:"JCLive",displayName:"FX 4 (atmosphere)"},{id:"0990_SBLive_sf2",library:"SBLive",displayName:"FX 4 (atmosphere)"},{id:"0990_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 4 (atmosphere)"},{id:"1000_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 5 (brightness)"},{id:"1000_Chaos_sf2_file",library:"Chaos",displayName:"FX 5 (brightness)"},{id:"1000_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 5 (brightness)"},{id:"1000_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 5 (brightness)"},{id:"1000_JCLive_sf2_file",library:"JCLive",displayName:"FX 5 (brightness)"},{id:"1000_SBLive_sf2",library:"SBLive",displayName:"FX 5 (brightness)"},{id:"1000_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 5 (brightness)"},{id:"1010_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 6 (goblins)"},{id:"1010_Chaos_sf2_file",library:"Chaos",displayName:"FX 6 (goblins)"},{id:"1010_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 6 (goblins)"},{id:"1010_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 6 (goblins)"},{id:"1010_JCLive_sf2_file",library:"JCLive",displayName:"FX 6 (goblins)"},{id:"1010_SBLive_sf2",library:"SBLive",displayName:"FX 6 (goblins)"},{id:"1010_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 6 (goblins)"},{id:"1020_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 7 (echoes)"},{id:"1020_Chaos_sf2_file",library:"Chaos",displayName:"FX 7 (echoes)"},{id:"1020_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 7 (echoes)"},{id:"1020_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 7 (echoes)"},{id:"1020_JCLive_sf2_file",library:"JCLive",displayName:"FX 7 (echoes)"},{id:"1020_SBLive_sf2",library:"SBLive",displayName:"FX 7 (echoes)"},{id:"1020_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 7 (echoes)"},{id:"1030_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 8 (sci-fi)"},{id:"1030_Chaos_sf2_file",library:"Chaos",displayName:"FX 8 (sci-fi)"},{id:"1030_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 8 (sci-fi)"},{id:"1030_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 8 (sci-fi)"},{id:"1030_JCLive_sf2_file",library:"JCLive",displayName:"FX 8 (sci-fi)"},{id:"1030_SBLive_sf2",library:"SBLive",displayName:"FX 8 (sci-fi)"},{id:"1030_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 8 (sci-fi)"},{id:"1040_Aspirin_sf2_file",library:"Aspirin",displayName:"Sitar"},{id:"1040_Chaos_sf2_file",library:"Chaos",displayName:"Sitar"},{id:"1040_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Sitar"},{id:"1040_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Sitar"},{id:"1040_JCLive_sf2_file",library:"JCLive",displayName:"Sitar"},{id:"1040_SBLive_sf2",library:"SBLive",displayName:"Sitar"},{id:"1040_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Sitar"},{id:"1050_Aspirin_sf2_file",library:"Aspirin",displayName:"Banjo"},{id:"1050_Chaos_sf2_file",library:"Chaos",displayName:"Banjo"},{id:"1050_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Banjo"},{id:"1050_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Banjo"},{id:"1050_JCLive_sf2_file",library:"JCLive",displayName:"Banjo"},{id:"1050_SBLive_sf2",library:"SBLive",displayName:"Banjo"},{id:"1050_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Banjo"},{id:"1060_Aspirin_sf2_file",library:"Aspirin",displayName:"Shamisen"},{id:"1060_Chaos_sf2_file",library:"Chaos",displayName:"Shamisen"},{id:"1060_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Shamisen"},{id:"1060_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Shamisen"},{id:"1060_JCLive_sf2_file",library:"JCLive",displayName:"Shamisen"},{id:"1060_SBLive_sf2",library:"SBLive",displayName:"Shamisen"},{id:"1060_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Shamisen"},{id:"1070_Aspirin_sf2_file",library:"Aspirin",displayName:"Koto"},{id:"1070_Chaos_sf2_file",library:"Chaos",displayName:"Koto"},{id:"1070_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Koto"},{id:"1070_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Koto"},{id:"1070_JCLive_sf2_file",library:"JCLive",displayName:"Koto"},{id:"1070_SBLive_sf2",library:"SBLive",displayName:"Koto"},{id:"1070_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Koto"},{id:"1080_Aspirin_sf2_file",library:"Aspirin",displayName:"Kalimba"},{id:"1080_Chaos_sf2_file",library:"Chaos",displayName:"Kalimba"},{id:"1080_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Kalimba"},{id:"1080_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Kalimba"},{id:"1080_JCLive_sf2_file",library:"JCLive",displayName:"Kalimba"},{id:"1080_SBLive_sf2",library:"SBLive",displayName:"Kalimba"},{id:"1080_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Kalimba"},{id:"1090_Aspirin_sf2_file",library:"Aspirin",displayName:"Bagpipe"},{id:"1090_Chaos_sf2_file",library:"Chaos",displayName:"Bagpipe"},{id:"1090_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Bagpipe"},{id:"1090_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Bagpipe"},{id:"1090_JCLive_sf2_file",library:"JCLive",displayName:"Bagpipe"},{id:"1090_SBLive_sf2",library:"SBLive",displayName:"Bagpipe"},{id:"1090_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Bagpipe"},{id:"1100_Aspirin_sf2_file",library:"Aspirin",displayName:"Fiddle"},{id:"1100_Chaos_sf2_file",library:"Chaos",displayName:"Fiddle"},{id:"1100_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Fiddle"},{id:"1100_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Fiddle"},{id:"1100_JCLive_sf2_file",library:"JCLive",displayName:"Fiddle"},{id:"1100_SBLive_sf2",library:"SBLive",displayName:"Fiddle"},{id:"1100_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Fiddle"},{id:"1110_Aspirin_sf2_file",library:"Aspirin",displayName:"Shanai"},{id:"1110_Chaos_sf2_file",library:"Chaos",displayName:"Shanai"},{id:"1110_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Shanai"},{id:"1110_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Shanai"},{id:"1110_JCLive_sf2_file",library:"JCLive",displayName:"Shanai"},{id:"1110_SBLive_sf2",library:"SBLive",displayName:"Shanai"},{id:"1110_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Shanai"},{id:"1120_Aspirin_sf2_file",library:"Aspirin",displayName:"Tinkle Bell"},{id:"1120_Chaos_sf2_file",library:"Chaos",displayName:"Tinkle Bell"},{id:"1120_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tinkle Bell"},{id:"1120_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tinkle Bell"},{id:"1120_JCLive_sf2_file",library:"JCLive",displayName:"Tinkle Bell"},{id:"1120_SBLive_sf2",library:"SBLive",displayName:"Tinkle Bell"},{id:"1120_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tinkle Bell"},{id:"1130_Aspirin_sf2_file",library:"Aspirin",displayName:"Agogo"},{id:"1130_Chaos_sf2_file",library:"Chaos",displayName:"Agogo"},{id:"1130_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Agogo"},{id:"1130_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Agogo"},{id:"1130_JCLive_sf2_file",library:"JCLive",displayName:"Agogo"},{id:"1130_SBLive_sf2",library:"SBLive",displayName:"Agogo"},{id:"1130_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Agogo"},{id:"1140_Aspirin_sf2_file",library:"Aspirin",displayName:"Steel Drums"},{id:"1140_Chaos_sf2_file",library:"Chaos",displayName:"Steel Drums"},{id:"1140_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Steel Drums"},{id:"1140_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Steel Drums"},{id:"1140_JCLive_sf2_file",library:"JCLive",displayName:"Steel Drums"},{id:"1140_SBLive_sf2",library:"SBLive",displayName:"Steel Drums"},{id:"1140_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Steel Drums"},{id:"1150_Aspirin_sf2_file",library:"Aspirin",displayName:"Woodblock"},{id:"1150_Chaos_sf2_file",library:"Chaos",displayName:"Woodblock"},{id:"1150_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Woodblock"},{id:"1150_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Woodblock"},{id:"1150_JCLive_sf2_file",library:"JCLive",displayName:"Woodblock"},{id:"1150_SBLive_sf2",library:"SBLive",displayName:"Woodblock"},{id:"1150_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Woodblock"},{id:"1160_Aspirin_sf2_file",library:"Aspirin",displayName:"Taiko Drum"},{id:"1160_Chaos_sf2_file",library:"Chaos",displayName:"Taiko Drum"},{id:"1160_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Taiko Drum"},{id:"1160_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Taiko Drum"},{id:"1160_JCLive_sf2_file",library:"JCLive",displayName:"Taiko Drum"},{id:"1160_SBLive_sf2",library:"SBLive",displayName:"Taiko Drum"},{id:"1160_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Taiko Drum"},{id:"1170_Aspirin_sf2_file",library:"Aspirin",displayName:"Melodic Tom"},{id:"1170_Chaos_sf2_file",library:"Chaos",displayName:"Melodic Tom"},{id:"1170_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Melodic Tom"},{id:"1170_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Melodic Tom"},{id:"1170_JCLive_sf2_file",library:"JCLive",displayName:"Melodic Tom"},{id:"1170_SBLive_sf2",library:"SBLive",displayName:"Melodic Tom"},{id:"1170_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Melodic Tom"},{id:"1180_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Drum"},{id:"1180_Chaos_sf2_file",library:"Chaos",displayName:"Synth Drum"},{id:"1180_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Drum"},{id:"1180_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Drum"},{id:"1180_JCLive_sf2_file",library:"JCLive",displayName:"Synth Drum"},{id:"1180_SBLive_sf2",library:"SBLive",displayName:"Synth Drum"},{id:"1180_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Drum"},{id:"1190_Aspirin_sf2_file",library:"Aspirin",displayName:"Reverse Cymbal"},{id:"1190_Chaos_sf2_file",library:"Chaos",displayName:"Reverse Cymbal"},{id:"1190_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Reverse Cymbal"},{id:"1190_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Reverse Cymbal"},{id:"1190_JCLive_sf2_file",library:"JCLive",displayName:"Reverse Cymbal"},{id:"1190_SBLive_sf2",library:"SBLive",displayName:"Reverse Cymbal"},{id:"1190_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Reverse Cymbal"},{id:"1200_Aspirin_sf2_file",library:"Aspirin",displayName:"Guitar Fret Noise"},{id:"1200_Chaos_sf2_file",library:"Chaos",displayName:"Guitar Fret Noise"},{id:"1200_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Guitar Fret Noise"},{id:"1200_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Guitar Fret Noise"},{id:"1200_JCLive_sf2_file",library:"JCLive",displayName:"Guitar Fret Noise"},{id:"1200_SBLive_sf2",library:"SBLive",displayName:"Guitar Fret Noise"},{id:"1200_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Guitar Fret Noise"},{id:"1210_Aspirin_sf2_file",library:"Aspirin",displayName:"Breath Noise"},{id:"1210_Chaos_sf2_file",library:"Chaos",displayName:"Breath Noise"},{id:"1210_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Breath Noise"},{id:"1210_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Breath Noise"},{id:"1210_JCLive_sf2_file",library:"JCLive",displayName:"Breath Noise"},{id:"1210_SBLive_sf2",library:"SBLive",displayName:"Breath Noise"},{id:"1210_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Breath Noise"},{id:"1220_Aspirin_sf2_file",library:"Aspirin",displayName:"Seashore"},{id:"1220_Chaos_sf2_file",library:"Chaos",displayName:"Seashore"},{id:"1220_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Seashore"},{id:"1220_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Seashore"},{id:"1220_JCLive_sf2_file",library:"JCLive",displayName:"Seashore"},{id:"1220_SBLive_sf2",library:"SBLive",displayName:"Seashore"},{id:"1220_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Seashore"},{id:"1230_Aspirin_sf2_file",library:"Aspirin",displayName:"Bird Tweet"},{id:"1230_Chaos_sf2_file",library:"Chaos",displayName:"Bird Tweet"},{id:"1230_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Bird Tweet"},{id:"1230_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Bird Tweet"},{id:"1230_JCLive_sf2_file",library:"JCLive",displayName:"Bird Tweet"},{id:"1230_SBLive_sf2",library:"SBLive",displayName:"Bird Tweet"},{id:"1230_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Bird Tweet"},{id:"1240_Aspirin_sf2_file",library:"Aspirin",displayName:"Telephone Ring"},{id:"1240_Chaos_sf2_file",library:"Chaos",displayName:"Telephone Ring"},{id:"1240_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Telephone Ring"},{id:"1240_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Telephone Ring"},{id:"1240_JCLive_sf2_file",library:"JCLive",displayName:"Telephone Ring"},{id:"1240_SBLive_sf2",library:"SBLive",displayName:"Telephone Ring"},{id:"1240_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Telephone Ring"},{id:"1250_Aspirin_sf2_file",library:"Aspirin",displayName:"Helicopter"},{id:"1250_Chaos_sf2_file",library:"Chaos",displayName:"Helicopter"},{id:"1250_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Helicopter"},{id:"1250_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Helicopter"},{id:"1250_JCLive_sf2_file",library:"JCLive",displayName:"Helicopter"},{id:"1250_SBLive_sf2",library:"SBLive",displayName:"Helicopter"},{id:"1250_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Helicopter"},{id:"1260_Aspirin_sf2_file",library:"Aspirin",displayName:"Applause"},{id:"1260_Chaos_sf2_file",library:"Chaos",displayName:"Applause"},{id:"1260_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Applause"},{id:"1260_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Applause"},{id:"1260_JCLive_sf2_file",library:"JCLive",displayName:"Applause"},{id:"1260_SBLive_sf2",library:"SBLive",displayName:"Applause"},{id:"1260_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Applause"},{id:"1270_Aspirin_sf2_file",library:"Aspirin",displayName:"Gunshot"},{id:"1270_Chaos_sf2_file",library:"Chaos",displayName:"Gunshot"},{id:"1270_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Gunshot"},{id:"1270_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Gunshot"},{id:"1270_JCLive_sf2_file",library:"JCLive",displayName:"Gunshot"},{id:"1270_SBLive_sf2",library:"SBLive",displayName:"Gunshot"},{id:"1270_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Gunshot"},{id:"12835_1_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 1"},{id:"12835_1_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 1"},{id:"12835_1_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 1"},{id:"12835_1_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 1"},{id:"12835_2_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 2"},{id:"12835_2_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 2"},{id:"12835_2_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 2"},{id:"12835_2_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 2"},{id:"12835_3_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 3"},{id:"12835_3_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 3"},{id:"12835_3_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 3"},{id:"12835_3_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 3"},{id:"12835_4_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 4"},{id:"12835_4_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 4"},{id:"12835_4_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 4"},{id:"12835_4_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 4"},{id:"12835_5_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 5"},{id:"12835_5_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 5"},{id:"12835_5_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 5"},{id:"12835_5_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 5"},{id:"12835_6_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 6"},{id:"12835_6_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 6"},{id:"12835_6_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 6"},{id:"12835_6_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 6"},{id:"12835_7_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 7"},{id:"12835_7_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 7"},{id:"12835_7_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 7"},{id:"12835_7_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 7"},{id:"12835_8_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 8"},{id:"12835_8_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 8"},{id:"12835_8_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 8"},{id:"12835_8_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 8"},{id:"12835_9_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 9"},{id:"12835_9_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 9"},{id:"12835_9_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 9"},{id:"12835_10_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 10"},{id:"12835_10_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 10"},{id:"12835_10_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 10"},{id:"12835_11_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 11"},{id:"12835_11_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 11"},{id:"12835_11_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 11"},{id:"12835_12_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 12"},{id:"12835_12_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 12"},{id:"12835_13_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 13"},{id:"12835_13_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 13"},{id:"12835_14_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 14"},{id:"12835_14_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 14"},{id:"12835_15_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 15"},{id:"12835_15_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 15"},{id:"12835_16_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 16"},{id:"12835_16_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 16"},{id:"12835_17_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 17"},{id:"12835_17_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 17"},{id:"12835_18_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 18"},{id:"12835_18_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 18"}];function yl(e){const t=1+e%18,i=wt.find(n=>n.id.startsWith(`12835_${t}_`)&&n.library==="FluidR3_GM");if(i)return{library:i.library,displayName:i.displayName};const a=wt.find(n=>n.id.startsWith(`12835_${t}_`));return a?{library:a.library,displayName:a.displayName}:null}const _i=new Map;let Ve=null;function wr(e){return Math.max(e,1e-4)}async function wi(e){return new Promise((t,i)=>{const a=document.createElement("script");a.src=e,a.onload=()=>t(),a.onerror=()=>i(new Error(`Failed to load script: ${e}`)),document.body.appendChild(a)})}async function hl(){Ve||(await wi("https://surikov.github.io/webaudiofont/npm/dist/WebAudioFontPlayer.js"),Ve=new window.WebAudioFontPlayer)}async function tr(e,t=ae(),i=null,a,n){const[r,s]=e.split("/"),d=`${r}/${s}`;_i.has(t)||_i.set(t,new Map);const o=_i.get(t);if(o.has(d))return o.get(d);await hl();const c=wt.find(g=>g.library===r&&g.displayName===s);if(!c)throw new Error(`Could not find WebAudioFont entry for library=${r} and instrument=${s}`);const l=t.createStereoPanner();l.pan.value=n??0,l.connect(i||tt());const u=c.displayName.startsWith("Drum Kit");if(console.log("Is drum kit: ",u),!u){const g=`_tone_${c.id}`,v=`https://surikov.github.io/webaudiofontdata/sound/${c.id}.js`;await Er(wi(v));const b=window[g];if(!b)throw new Error(`Missing preset: ${g}`);if(Ve.loader.decodeAfterLoading(t,g),t instanceof OfflineAudioContext){const S=(b==null?void 0:b.zones)??[];for(const G of S)if(G.file&&!G.buffer){const M=atob(G.file),w=new ArrayBuffer(M.length),F=new Uint8Array(w);for(let L=0;L<M.length;L++)F[L]=M.charCodeAt(L);G.buffer=await new Promise((L,I)=>t.decodeAudioData(w,L,I))}}const N={_preset:b,_volume:a??1,start({note:S,duration:G=1,velocity:M=100,time:w}){const F=typeof S=="string"?P(S):S;if(F==null||typeof F!="number")return;const L=typeof w=="number"?w:0;Ve.queueWaveTable(t,l||tt(),b,L,F,G,wr(N._volume))},stop(){},load:Promise.resolve(),setVolume(S){N._volume=Math.max(0,Math.min(1,S))},setPan(S){l.pan.value=Math.max(-1,Math.min(1,S))}};return o.set(d,N),N}const _=c.id.match(/^12835_(\d+)_([A-Za-z0-9_]+)_sf2_file$/);if(!_)throw new Error(`Invalid drum ID format in catalogue: ${c.id}`);const[,f,p]=_,h=parseInt(f,10);console.log("Regex got kit number: ",h);const m={};await Er((async()=>{for(const g of Hs){const v=`_drum_${g}_${h}_${p}_sf2_file`;console.log("varName is: ",v);const b=`https://surikov.github.io/webaudiofontdata/sound/${12800+g}_${h}_${p}_sf2_file.js`;try{await wi(b);const N=window[v];if(!N){console.warn(`Missing drum preset: ${v}`);continue}Ve.loader.decodeAfterLoading(t,v),m[g]=N}catch(N){console.warn(`Failed to load drum preset ${g}: ${N}`)}}})());const y={_preset:m,_volume:a??1,start({note:g,duration:v=1,velocity:b=100,time:N}){const S=typeof g=="string"?P(g):g;if(S==null||typeof S!="number"){console.warn(`Invalid MIDI pitch: ${g}`);return}const G=m[S];if(!G){console.warn(`No drum preset loaded for MIDI ${S}`);return}const M=typeof N=="number"?N:0;Ve.queueWaveTable(t,l||tt(),G,M,S,v,wr(y._volume))},stop(){},load:Promise.resolve(),setVolume(g){y._volume=Math.max(0,Math.min(1,g))},setPan(g){l.pan.value=Math.max(-1,Math.min(1,g))}};return o.set(d,y),y}async function bl(){const e=new Set;for(const t of wt)e.add(t.library);return Array.from(e)}async function gl(e){return wt.filter(t=>t.library===e).map(t=>t.displayName)}async function Er(e){Ta();try{return await e}finally{Ra()}}function vl(){return{name:"webaudiofont",loadInstrument:tr,getAvailableLibraries:bl,getAvailableInstruments:gl}}const si={sf2:ed(),webaudiofont:vl()},wa="sf2";async function Fr(e,t,i,a,n){const r=e.split("/");if(r.length!==3)throw new Error(`Invalid instrument fullName format: "${e}". Expected format "engine/library/instrument"`);const[s,d,o]=r,c=si[s];if(!c)throw new Error(`Engine "${s}" not available`);return console.log("Calling loadInstrument with ",`engine: ${s} at ${d}/${o}`),await c.loadInstrument(`${d}/${o}`,t,i,a,n)}async function Sl(e=wa){const t=si[e];if(!t)throw new Error(`Engine "${e}" not available`);return await t.getAvailableLibraries()}async function Nl(e,t=wa){const i=si[t];if(!i)throw new Error(`Engine "${t}" not available`);return await i.getAvailableInstruments(e)}function Bl(){return Object.keys(si)}function Cl(e,t,{getPitchRow:i,cellWidth:a,cellHeight:n,labelWidth:r}){if(!(e!=null&&e.animationCtx)){console.warn("Missing animationCtx in animateNotePlay");return}const s=t.start*a+r,d=i(t.pitch)*n,o=t.duration*a,c=n-1,l=s+o/2,u=d+c/2,f=(P(t.pitch)||0)*5%360,p=e.animationCtx,h=document.createElement("canvas");h.width=p.canvas.width,h.height=p.canvas.height;let m=h.getContext("2d");if(!m){console.warn("Could not get animation context from offscreen canvas");return}const y=performance.now(),g=xe();let v=t.duration*6e4/g;v=Math.max(100,Math.min(v,1600));const b=2,N=50;function S(w){const F=Math.sin(w*Math.PI),L=`hsla(${f}, 100%, 70%, ${.4*F})`;m&&(m.globalAlpha=1,m.fillStyle=L,m.beginPath(),m.roundRect(s,d,o,c,3),m.fill())}function G(w,F,L){const I=Math.sin(w*Math.PI),R=1+F*I,q=(1-w)*L;if(m){m.globalAlpha=q,m.strokeStyle=`hsl(${f}, 100%, 65%)`,m.lineWidth=1.5;const H=o*R,O=c*R;m.beginPath(),m.roundRect(l-H/2,u-O/2,H,O,4),m.stroke()}}function M(w){const F=w-y,L=F/v;if(L>1){m=null,h.width=0,h.height=0;return}if(m){m.clearRect(0,0,h.width,h.height),m.save(),S(L);for(let H=0;H<b;H++){const O=H*N,U=Math.max(0,Math.min(1,(F-O)/(v-O)));G(U,.1+H*.1,.3)}m.restore(),p.save();const I=1.5,R=o*I+8,q=c*I+8;p.clearRect(l-R/2,u-q/2,R,q),p.globalAlpha=1,p.drawImage(h,0,0),p.restore()}requestAnimationFrame(M)}requestAnimationFrame(M)}class Ea{constructor(t,i,a=ae(),n=tt(),r="sf2/fluidr3-gm/acoustic_grand_piano"){this.notes=[],this.colorIndex=0,this.id=0,this.mute=!1,this.solo=!1,this.shouldPlay=!0,this._activeNoteKeys=new Set,this._noteHandlers=new Map,this._beatHandler=null,this._unsub=null,this._volume=100/127,this._pan=0,this._instrument=null,this.container=t,this.config={...i},this.context=a,this.destination=n,this.instrumentName=r,this.container&&(this.pianoRollCanvas=this.container.querySelector(".piano-roll"),this.gridCanvas=this.container.querySelector(".note-grid"),this.animationCanvas=this.container.querySelector(".note-animate-canvas"),this._initCanvases())}_noteKey(t){return`${t.pitch}:${t.start}:${t.duration}`}async initInstrument(){try{this._instrument=await Fr(this.instrumentName,this.context,this.destination,this._volume,this._pan),this.updateToDrumNoteRange()}catch(t){console.warn(`[SEQ:${this.id}] Failed to load instrument '${this.instrumentName}':`,t)}}get volume(){return this._volume}set volume(t){var i;this._volume=Math.max(0,Math.min(1,t)),(i=this._instrument)!=null&&i.setVolume&&this._instrument.setVolume(this._volume)}get pan(){return this._pan}set pan(t){var i;this._pan=Math.max(-1,Math.min(1,t)),(i=this._instrument)!=null&&i.setPan&&this._instrument.setPan(this._pan)}updateTrackLabel(){var i;const t=(i=this.container)==null?void 0:i.querySelector(".track-name");t&&(t.textContent=`${this.id+1}: ${this.instrumentName}`)}setInstrument(t){this.instrumentName=t,this.updateTrackLabel(),this.initInstrument()}playNote(t,i,a=100,n=!1){return md(this.instrumentName,t,i,a,n,null,this.context,this.destination,this.volume,this.pan)}_initCanvases(){if(!this.container)return;const t=this.container.querySelector("canvas.note-grid"),i=this.container.querySelector("canvas.playhead-canvas"),a=this.container.querySelector("#grid-scroll-container"),n=this.container.querySelector("canvas.note-animate-canvas");this.grid=ml(t,i,n,a,this.notes,this.config,this),this.grid.scheduleRedraw()}onTransportLoop(){this._activeNoteKeys.clear()}updateTotalMeasures(){var s,d,o;const t=K();this.clampNotesToGrid();const i=t*this.config.cellWidth+ne,a=(s=this.container)==null?void 0:s.querySelector("canvas.note-grid"),n=(d=this.container)==null?void 0:d.querySelector(".playhead-canvas"),r=(o=this.container)==null?void 0:o.querySelector(".mini-contour");a&&(a.width=i,a.style.width=`${i}px`),n&&(n.width=i,n.style.width=`${i}px`),r&&nt(r,this.notes,this.config,this.colorIndex),this.redraw()}clampNotesToGrid(){const t=K(),i=this.notes.filter(a=>a.start<t);i.forEach(a=>{a.start+a.duration>t&&(a.duration=t-a.start)}),this.notes.splice(0,this.notes.length,...i)}play(){this.stop(),this.clampNotesToGrid(),this._noteHandlers.clear(),this._activeNoteKeys.clear();const i=60/xe();this._beatHandler=a=>{var n,r;if((n=this.grid)==null||n.drawPlayhead(this.grid.getXForBeat(a)),!!this.shouldPlay)for(const s of this.notes){const d=s.start,o=s.start+s.duration,c=this._noteKey(s);if(!this._activeNoteKeys.has(c)&&d<a&&a<=o){const l=s.duration*i;if(this.playNote(s.pitch,l),(r=this.grid)!=null&&r.gridContext){const u=this.grid.gridContext;Cl(u,s,{getPitchRow:u.getPitchRow,cellWidth:u.getCellWidth(),cellHeight:u.getCellHeight(),labelWidth:ne})}this._activeNoteKeys.add(c)}}},this._unsub=Bi(this._beatHandler),this._beatHandler(0)}stop(){var t,i,a;this._unsub&&(this._unsub(),this._unsub=null),this._beatHandler=null;for(const n of this._noteHandlers.values())(t=n==null?void 0:n.forceStop)==null||t.call(n),(i=n==null?void 0:n.stop)==null||i.call(n);this._activeNoteKeys.clear(),this._noteHandlers.clear(),(a=this.grid)==null||a.drawPlayhead(0),this.redraw()}pause(){var t;for(const i of this._activeNoteKeys){const a=this._noteHandlers.get(i);(t=a==null?void 0:a.stop)==null||t.call(a)}this._activeNoteKeys.clear(),this._unsub&&(this._unsub(),this._unsub=null)}resume(){this._beatHandler&&!this._unsub&&(this._unsub=Bi(this._beatHandler))}seekTo(t){this.stop(),this.play()}toggleMute(){this.mute=!this.mute,this.mute&&(this.solo=!1),this.updateTrackStyle()}toggleSolo(){this.solo=!this.solo,this.solo&&(this.mute=!1),this.updateTrackStyle()}updateTrackStyle(){if(!this.container)return;const t=this.container.querySelector(".mute-btn"),i=this.container.querySelector(".solo-btn");t==null||t.classList.toggle("bg-red-600",this.mute),t==null||t.classList.toggle("bg-gray-700",!this.mute),i==null||i.classList.toggle("bg-yellow-200",this.solo),i==null||i.classList.toggle("bg-gray-700",!this.solo),this.container.classList.toggle("opacity-40",this.mute&&!this.solo),this.container.classList.toggle("opacity-100",!(this.mute&&!this.solo))}redraw(){var t;(t=this.grid)==null||t.scheduleRedraw()}destroy(){var t;this.stop(),(t=this.container)==null||t.remove()}getState(){return{notes:[...this.notes],config:{...this.config},instrument:this.instrumentName}}setState({notes:t,config:i,instrument:a,volume:n,pan:r}){this.notes.length=0,this.notes.push(...t),Object.assign(this.config,i),typeof n=="number"&&(this.volume=n),typeof r=="number"&&(this.pan=r),a&&(this.instrumentName=a),this.redraw()}updateNotesFromTrackMap(t){this.notes.splice(0,this.notes.length,...t.n.map(([i,a,n])=>({pitch:i,start:a,duration:n})))}async exportToOffline(){const t=60/xe(),i=await Fr(this.instrumentName,this.context,this.destination,this._volume,this._pan);for(const a of this.notes){const n=a.start*t,r=Math.max(.01,n),s=a.duration*t,d=P(a.pitch);if(d==null)continue;const o=this.instrumentName.split("/");if((o.length>=3?o[1]:o[0])==="drummachines"&&i.__midiMap){const l=i.__midiMap.get(d);l&&i.start({note:l,duration:s,velocity:100,time:r,loop:!1})}else i.start({note:d,duration:s,velocity:100,time:r,loop:!1})}}updateNoteRange(t){var l,u,_,f;const[i,a]=t,n=P(i),r=P(a);if(n===null||r===null){console.warn(`Invalid note range: ${t}`);return}if(n>=r){console.warn("Invalid note range: low note must be lower than high note");return}this.config.noteRange=t,this.config.visibleNotes=Ci(a,i)+1;const s=(l=this.container)==null?void 0:l.querySelector("canvas.note-grid"),d=(u=this.container)==null?void 0:u.querySelector(".playhead-canvas"),o=(_=this.container)==null?void 0:_.querySelector(".note-animate-canvas"),c=(f=this.container)==null?void 0:f.querySelector(".mini-contour");if(s&&d&&o){const p=this.config.visibleNotes*this.config.cellHeight;[s,d,o].forEach(h=>{h.height=p,h.style.height=`${p}px`}),c&&nt(c,this.notes,this.config,this.colorIndex),this.redraw()}this.notes.forEach(p=>{const h=P(p.pitch);h!==null&&(h<n?p.pitch=i:h>r&&(p.pitch=a))})}updateToDrumNoteRange(){this.instrumentName.toLowerCase().includes("drum kit")?this.updateNoteRange(["B1","A5"]):this.updateNoteRange(["C1","B9"])}}let Le,Ye,Fa,Pa,Je,ce,be="sf2";function Gl(){Le=document.getElementById("instrument-select-modal"),Ye=document.getElementById("instrument-select"),Fa=document.getElementById("instrument-select-confirm"),Pa=document.getElementById("instrument-cancel-btn"),Je=document.getElementById("instrument-engine-select"),ce=document.getElementById("instrument-library-select"),Ll(),Ml()}function Ll(){const e=Bl();Je.innerHTML="",e.forEach(t=>{const i=document.createElement("option");i.value=t,i.textContent=t.toUpperCase(),Je.appendChild(i)}),Je.value=be}function Ml(){Je.addEventListener("change",async()=>{be=Je.value,await Aa()}),ce.addEventListener("change",()=>{const e=new CustomEvent("instrument-library-change",{detail:{preselect:null}});ce.dispatchEvent(e)}),ce.addEventListener("instrument-library-change",async e=>{var n;const t=e,i=ce.value,a=((n=t.detail)==null?void 0:n.preselect)??null;try{const r=await Nl(i,be);Ye.innerHTML="",r.forEach(s=>{const d=document.createElement("option");d.value=`${be}/${i}/${s}`,d.textContent=s.split("_").map(o=>o?o[0].toUpperCase()+o.slice(1):"").join(" "),Ye.appendChild(d)}),a?Ye.value=a:r.length>0&&(Ye.value=`${be}/${i}/${r[0]}`)}catch(r){console.error(`Failed to load instruments for library: ${i}`,r)}}),Fa.addEventListener("click",wl),Pa.addEventListener("click",El)}async function Aa(e=null,t=null){try{const i=await Sl(be);ce.innerHTML="",i.forEach(n=>{const r=document.createElement("option");r.value=n,r.textContent=n.replace(/_/g," ").replace(/\b\w/g,s=>s.toUpperCase()),ce.appendChild(r)}),e&&i.includes(e)?ce.value=e:i.length>0&&(ce.value=i[0]);const a=new CustomEvent("instrument-library-change",{detail:{preselect:t}});ce.dispatchEvent(a)}catch(i){console.error("Failed to refresh libraries for engine:",be,i)}}async function ka(e,t){const[i,a,n]=e.split("/");be=i||"sf2",Je.value=be,t!==void 0?Le.dataset.currentSequencer=String(t):delete Le.dataset.currentSequencer,await Aa(a,e)}async function wl(){const e=Ye.value;Le.classList.add("hidden");const t=Number(Le.dataset.currentSequencer);if(Le.dataset.currentSequencer!==void 0&&!isNaN(t)){const i=Il(t);if(i){x(as(i.id,e),ns(i.id,i.instrumentName)),i.setInstrument(e);return}console.warn(`Failed to find sequencer with ID ${t}`);return}if(Le.dataset.currentSequencer===void 0)try{return await Ya(e),window.dispatchEvent(new CustomEvent("global-instrument-selected",{detail:{fullName:e}})),e}catch(i){console.error("Failed to load global instrument:",e,i)}}function El(){Le.classList.add("hidden")}function Fl(e,t){var _;const i=(_=e.querySelector(".volume-fill"))==null?void 0:_.parentElement,a=e.querySelector(".volume-fill"),n=e.querySelector(".volume-thumb");let r=!1,s=!1,d=!1,o=null;if(!i||!a){console.warn("[setupVolumeBar] Volume bar or fill element missing.");return}function c(){const f=Math.max(0,Math.min(1,t.volume)),p=100/127,h=i.clientWidth,m=14,y=0,g=h-m,v=f*h,b=Math.max(y,Math.min(g,v-m/2)),N=Math.round(f*100);a.style.width=`${N}%`,n.style.left=`${b}px`;const S=Math.round(f/p*100);i.setAttribute("title",`Volume: ${S}%`),f>p?(a.classList.add("overdrive"),n.classList.add("overdrive")):(a.classList.remove("overdrive"),n.classList.remove("overdrive"))}function l(){s?(a.classList.add("precise"),n.classList.add("precise")):(a.classList.remove("precise"),n.classList.remove("precise"))}t.refreshVolumeUI=c,requestAnimationFrame(c);function u(f){const p=i.getBoundingClientRect(),h=f-p.left,m=100/127,y=.1;let g=Math.max(0,Math.min(1,h/p.width));return!s&&Math.abs(g-m)<y?(g=m,!r&&navigator.vibrate&&navigator.vibrate(10),r=!0):r=!1,t.volume=g,c(),g}i.addEventListener("mousedown",f=>{d=!0,s=f.shiftKey,o=t.volume,l(),u(f.clientX),f.preventDefault()}),window.addEventListener("mousemove",f=>{d&&(s=f.shiftKey,l(),u(f.clientX))}),window.addEventListener("mouseup",f=>{if(!d)return;d=!1;const p=u(f.clientX);o!==null&&p!==o&&x(ls(t.id,p),os(t.id,o)),s=!1,l(),a.classList.remove("precise"),n.classList.remove("precise"),c(),o=null})}function Pl(e,t){var _;const i=(_=e.querySelector(".pan-fill"))==null?void 0:_.parentElement,a=e.querySelector(".pan-fill"),n=e.querySelector(".pan-thumb");let r=!1,s=!1,d=!1,o=null;if(!i||!a){console.warn("[setupPanBar] Pan bar or fill element missing.");return}function c(){const f=Math.max(-1,Math.min(1,t.pan)),p=(f+1)/2,h=i.clientWidth,m=14,y=0,g=h-m,v=p*h,b=Math.max(y,Math.min(g,v-m/2)),N=Math.round(p*100);a.style.width=`${N}%`,n.style.left=`${b}px`;const S=Math.round(f*100);i.setAttribute("title",`Pan: ${S}%`)}t.refreshPanUI=c;function l(){s?(a.classList.add("precise"),n.classList.add("precise")):(a.classList.remove("precise"),n.classList.remove("precise"))}requestAnimationFrame(c);function u(f){const p=i.getBoundingClientRect(),h=f-p.left;let y=Math.max(0,Math.min(1,h/p.width))*2-1;const g=0;return!s&&Math.abs(y-g)<.05?(y=g,!r&&navigator.vibrate&&navigator.vibrate(10),r=!0):r=!1,t.pan=y,c(),y}i.addEventListener("mousedown",f=>{d=!0,s=f.shiftKey,o=t.pan,l(),u(f.clientX),f.preventDefault()}),window.addEventListener("mouseup",f=>{if(!d)return;d=!1;const p=u(f.clientX);o!==null&&p!==o&&x(cs(t.id,p),us(t.id,o)),s=!1,l(),a.classList.remove("precise"),n.classList.remove("precise"),c(),o=null}),window.addEventListener("mousemove",f=>{d&&(s=f.shiftKey,l(),u(f.clientX))})}const A=[],Al=document.getElementById("sequencers-container"),kl=document.getElementById("sequencer-template"),Ia=document.getElementById("add-sequencer");function Oa(e){const i=kl.content.cloneNode(!0).querySelector(".sequencer");Al.insertBefore(i,Ia);const a=A.length,n={id:a,...Q},r=(e==null?void 0:e.instrument)||"sf2/fluidr3-gm/acoustic_grand_piano",s=new Ea(i,n,ae(),tt(),r);s.id=a,s.colorIndex=a,s.mute=!1,s.solo=!1,s.shouldPlay=!0,s.volume=100/127;const d=i.querySelector("canvas.mini-contour");e&&s.setState({notes:e.notes,config:{},instrument:e.instrument,volume:e.volume,pan:e.pan}),nt(d,s.notes,s.config,s.colorIndex),s.updateTrackLabel(),s.initInstrument(),Fl(i,s),Pl(i,s);const o=i.querySelector(".collapse-btn"),c=o.querySelector("use"),l=i.querySelector(".sequencer-body");o.addEventListener("click",()=>{const m=l.classList.toggle("hidden");c.setAttribute("href",m?"#icon-caret-up":"#icon-caret-down"),d.classList.toggle("hidden",!m),At(i,!m),m&&nt(d,s.notes,s.config,s.colorIndex)}),i.querySelector(".delete-btn").addEventListener("click",()=>{const m=document.getElementById("delete-confirm-modal"),y=document.getElementById("delete-confirm"),g=document.getElementById("delete-cancel");m.classList.remove("hidden");const v=()=>{const S=ts(s.id,s.instrumentName,s.notes,s.volume,s.pan),G=is(s.id,s.instrumentName,s.notes,s.volume,s.pan);x(S,G),N()},b=()=>{N()},N=()=>{m.classList.add("hidden"),y.removeEventListener("click",v),g.removeEventListener("click",b)};y.addEventListener("click",v),g.addEventListener("click",b)});const _=i.querySelector(".mute-btn"),f=i.querySelector(".solo-btn"),p=i.querySelector(".instrument-select-btn");function h(m,y){m.classList.toggle("side-button-activated",y)}return _.addEventListener("click",()=>{s.mute=!s.mute,s.mute&&(s.solo=!1),h(_,s.mute),h(f,s.solo),Pr()}),f.addEventListener("click",()=>{s.solo=!s.solo,s.solo&&(s.mute=!1),h(f,s.solo),h(_,s.mute),Pr()}),p.addEventListener("click",async()=>{const m=s.instrumentName||"sf2/fluidr3-gm/acoustic_grand_piano";await ka(m,s.id),document.getElementById("instrument-select-modal").classList.remove("hidden")}),Hl(i),A.push(s),{seq:s,wrapper:i}}function At(e,t){var i,a,n,r,s;(i=e.querySelector(".zoom-in-btn"))==null||i.classList.toggle("hidden",!t),(a=e.querySelector(".zoom-out-btn"))==null||a.classList.toggle("hidden",!t),(n=e.querySelector(".zoom-reset-btn"))==null||n.classList.toggle("hidden",!t),(r=e.querySelector(".zoom-button-divider"))==null||r.classList.toggle("hidden",!t),(s=e.querySelector(".grip-handle"))==null||s.classList.toggle("hidden",!t)}function Ee(){return A}function Il(e){const t=e;return A.find(i=>i.id===t)}function Pr(){const e=A.some(t=>t.solo);A.forEach(t=>{t.shouldPlay=e?t.solo:!t.mute})}function Ol(){A.slice().forEach(i=>i.destroy()),A.length=0;const e=ot(),t=structuredClone(e);t.sequencers=[],Ts(),pa(t),Et(t)}function Tl(){document.getElementById("global-mini-contour"),Ia.addEventListener("click",()=>{const e=A.length;x(ua(e,"sf2/fluidr3-gm/acoustic_grand_piano"),Di(e))})}const Rl=["Darkroom","Seashell","Cyberpunk","Classic Blue","Midnight"],Ul=["Track Color","Pitch Class Contrast","Scriabin","Octave Bands"];function Dl(){const e=document.getElementById("grid-color-select"),t=document.getElementById("note-color-select");if(!e||!t)return;for(const a of Rl){const n=document.createElement("option");n.value=a,n.textContent=a,e.appendChild(n)}for(const a of Ul){const n=document.createElement("option");n.value=a,n.textContent=a,t.appendChild(n)}const i=lt();e.value=i.gridColorScheme,t.value=i.noteColorScheme,e.addEventListener("change",a=>{const n=a.target;Mt({gridColorScheme:n.value}),Ee().forEach(r=>{var s;return(s=r.grid)==null?void 0:s.scheduleRedraw()})}),t.addEventListener("change",a=>{const n=a.target;Mt({noteColorScheme:n.value}),Ee().forEach(r=>{var s;return(s=r.grid)==null?void 0:s.scheduleRedraw()})})}function Jl(){const e=document.getElementById("userconfig-modal"),t=document.querySelectorAll(".settings-tab"),i=document.querySelectorAll(".settings-section");if(!e)return;function a(){t.forEach(n=>{const r=n.dataset.tab;if(!r)return;const s=document.getElementById(r),d=s!==null&&!s.classList.contains("hidden");n.classList.toggle("text-purple-500",d),n.classList.toggle("opacity-100",d),n.classList.toggle("text-gray-500",!d),n.classList.toggle("opacity-50",!d)})}t.forEach(n=>{n.addEventListener("click",()=>{const r=n.dataset.tab;if(!r)return;i.forEach(d=>d.classList.add("hidden"));const s=document.getElementById(r);s&&s.classList.remove("hidden"),a()})}),a(),Dn(),Dl()}let Ar=!1,Ie=!1,Oe=!1;function xl({getSequencers:e,onPlay:t,onStop:i,onPause:a,onResume:n,onDurationChange:r,onSnapChange:s,onToggleLoop:d,onTempoChange:o,onSave:c,onLoad:l,onMeasuresChange:u,onBeatsPerMeasureChange:_}){if(Ar)return;Ar=!0;const f=document.getElementById("play-button"),p=f.querySelector("use"),h=document.getElementById("stop-button"),m=document.getElementById("note-duration"),y=document.getElementById("dotted-note-btn"),g=document.getElementById("triplet-note-btn"),v=document.getElementById("snap-resolution"),b=document.getElementById("loop-toggle"),N=document.getElementById("tempo-input"),S=document.getElementById("save-button"),G=document.getElementById("load-button"),M=document.getElementById("measures-input"),w=document.getElementById("beats-per-measure-input"),F=document.getElementById("config-button"),L=document.getElementById("export-modal"),I=document.getElementById("export-json"),R=document.getElementById("export-wav"),q=document.getElementById("export-midi"),H=document.getElementById("export-cancel");m.value=String(Q.currentDuration||1),v.value=String(Q.snapResolution||.25);const O=document.getElementById("import-modal"),U=document.getElementById("import-json"),oe=document.getElementById("import-midi"),Fe=document.getElementById("import-cancel"),V=document.getElementById("load-input");G.addEventListener("click",()=>{O==null||O.classList.remove("hidden")}),V&&V.addEventListener("change",B=>{var W;const T=B.target,k=(W=T.files)==null?void 0:W[0];k&&l(k),T.value=""}),U&&U.addEventListener("click",()=>{O==null||O.classList.add("hidden"),V&&(V.setAttribute("accept",".json"),V.click())}),oe&&oe.addEventListener("click",()=>{O==null||O.classList.add("hidden"),V&&(V.setAttribute("accept",".mid,.midi"),V.click())}),Fe&&Fe.addEventListener("click",()=>{O==null||O.classList.add("hidden")}),p.setAttribute("href","#icon-play"),f.addEventListener("click",()=>{!Ie&&!Oe?(Ie=!0,Oe=!1,t(),p.setAttribute("href","#icon-pause")):Ie?(Ie=!1,Oe=!0,a(),p.setAttribute("href","#icon-play")):Oe&&(Ie=!0,Oe=!1,n(),p.setAttribute("href","#icon-pause"))}),h.addEventListener("click",()=>{i(),Ie=!1,Oe=!1,p.setAttribute("href","#icon-play")}),window.addEventListener("keydown",B=>{var W;if(document.querySelector(".ai-modal:not(.hidden)"))return;const k=(W=document.activeElement)==null?void 0:W.tagName;if(!(k==="INPUT"||k==="TEXTAREA")){if(B.code==="Space"){B.preventDefault(),f.click();return}if((B.metaKey||B.ctrlKey)&&(B.key==="z"&&Is(),B.key==="y"&&Os()),(B.metaKey||B.ctrlKey)&&B.key.toLowerCase()==="r"){B.preventDefault();return}if(Na()===Ne.NOTE_PLACEMENT){if(Object.prototype.hasOwnProperty.call(pr,B.code)){B.preventDefault();const fe=pr[B.code];m.value=String(fe),m.dispatchEvent(new Event("change"))}if(B.key==="."){B.preventDefault(),y==null||y.click();return}if(B.key==="/"){B.preventDefault(),g==null||g.click();return}}}}),m.addEventListener("change",B=>{const T=B.target,k=parseFloat(T.value);Z(k),r(k),e().forEach(W=>{const fe=W.grid;if(fe!=null&&fe.getPreviewNote){const It=fe.getPreviewNote();It&&(It.duration=k,fe.scheduleRedraw())}})});function Z(B){document.querySelectorAll(".note-duration-btn").forEach(k=>{const W=parseFloat(k.dataset.value??"0");k.classList.remove("bg-purple-700","bg-gray-800"),W===B?k.classList.add("bg-purple-700"):k.classList.add("bg-gray-800")})}v.addEventListener("change",B=>{const k=B.target.value;Object.prototype.hasOwnProperty.call(In,k)&&(Q.snapResolution=parseFloat(k),v.value=String(k),s(Q.snapResolution))}),b.addEventListener("change",B=>{const T=B.target;d(T.checked)}),N.addEventListener("change",B=>{const T=B.target,k=parseInt(T.value,10);isNaN(k)||o(k)}),S.addEventListener("click",()=>{L?L.classList.remove("hidden"):c("json")}),I&&I.addEventListener("click",()=>{L==null||L.classList.add("hidden"),c==null||c("json")}),R&&R.addEventListener("click",()=>{L==null||L.classList.add("hidden"),c==null||c("wav")}),q&&q.addEventListener("click",()=>{L==null||L.classList.add("hidden"),c==null||c("midi")}),H&&H.addEventListener("click",()=>{L==null||L.classList.add("hidden")}),F==null||F.addEventListener("click",()=>{const B=document.getElementById("userconfig-modal");B==null||B.classList.remove("hidden")}),Jl(),M&&(M.value=String(Pt())),w&&(w.value=String(Ft())),M==null||M.addEventListener("change",B=>{const T=B.target,k=parseInt(T.value,10);!isNaN(k)&&k>0&&(u==null||u(k))}),w==null||w.addEventListener("change",B=>{const T=B.target,k=parseInt(T.value,10);!isNaN(k)&&k>0&&(_==null||_(k))}),Z(parseFloat(m.value))}function ql(){Ie=!1,Oe=!1;const e=document.getElementById("play-button"),t=e==null?void 0:e.querySelector("use");t&&t.setAttribute("href","#icon-play")}function Ta(){var e;Bn()||(e=document.getElementById("loading-modal"))==null||e.classList.remove("hidden")}function Ra(){var e;(e=document.getElementById("loading-modal"))==null||e.classList.add("hidden")}function Hl(e){const t=e.querySelector(".cursor-grab");if(!t)return;const i=e.querySelector(".sequencer-body");if(!i)return;let a=!1,n=0,r=0;const s=150,d=1e3;t.addEventListener("mousedown",o=>{a=!0,n=o.clientY,r=i.offsetHeight,t.classList.replace("cursor-grab","cursor-grabbing"),document.body.style.userSelect="none"}),window.addEventListener("mousemove",o=>{if(!a)return;const c=o.clientY-n;let l=r+c;l=Math.max(s,Math.min(d,l)),i.style.height=`${l}px`}),window.addEventListener("mouseup",()=>{a&&(a=!1,t.classList.replace("cursor-grabbing","cursor-grab"),document.body.style.userSelect="")})}var $l=Object.defineProperty,Kl=Object.defineProperties,Wl=Object.getOwnPropertyDescriptors,kr=Object.getOwnPropertySymbols,Xl=Object.prototype.hasOwnProperty,zl=Object.prototype.propertyIsEnumerable,Ua=e=>{throw TypeError(e)},Ir=(e,t,i)=>t in e?$l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,le=(e,t)=>{for(var i in t||(t={}))Xl.call(t,i)&&Ir(e,i,t[i]);if(kr)for(var i of kr(t))zl.call(t,i)&&Ir(e,i,t[i]);return e},we=(e,t)=>Kl(e,Wl(t)),ir=(e,t,i)=>t.has(e)||Ua("Cannot "+i),C=(e,t,i)=>(ir(e,t,"read from private field"),i?i.call(e):t.get(e)),$=(e,t,i)=>t.has(e)?Ua("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,i),J=(e,t,i,a)=>(ir(e,t,"write to private field"),t.set(e,i),i),Xt=(e,t,i)=>(ir(e,t,"access private method"),i),j=(e,t,i)=>new Promise((a,n)=>{var r=o=>{try{d(i.next(o))}catch(c){n(c)}},s=o=>{try{d(i.throw(o))}catch(c){n(c)}},d=o=>o.done?a(o.value):Promise.resolve(o.value).then(r,s);d((i=i.apply(e,t)).next())});function zt(e){const t=e.filter(i=>!!i);return t.reduce((i,a)=>{const n="output"in i?i.output:i,r="input"in a?a.input:a;return n.connect(r),a}),()=>{t.reduce((i,a)=>{const n="output"in i?i.output:i,r="input"in a?a.input:a;return n.disconnect(r),a})}}function jl(e){let t=e;const i=new Set;function a(s){return i.add(s),s(t),()=>{i.delete(s)}}function n(s){t=s,i.forEach(d=>d(t))}function r(){return t}return{subscribe:a,set:n,get:r}}function Vl(){const e=new Set;function t(a){return e.add(a),()=>{e.delete(a)}}function i(a){e.forEach(n=>n(a))}return{subscribe:t,trigger:i}}function Yl(e){let t=!1;return()=>{t||(t=!0,e.forEach(i=>i==null?void 0:i()))}}function Da(e){return e*e/16129}function Ql(e){return Math.pow(10,e/20)}var Te,Ce,$e,Ke,jt,Re,Ue,Ja=class{constructor(e,t){this.context=e,$(this,Te),$(this,Ce),$(this,$e),$(this,Ke),$(this,jt),$(this,Re),$(this,Ue,!1);var i,a,n;J(this,Re,{destination:(i=t==null?void 0:t.destination)!=null?i:e.destination,volume:(a=t==null?void 0:t.volume)!=null?a:100,volumeToGain:(n=t==null?void 0:t.volumeToGain)!=null?n:Da}),this.input=e.createGain(),J(this,Te,e.createGain()),J(this,Ke,zt([this.input,C(this,Te),C(this,Re).destination]));const r=jl(C(this,Re).volume);this.setVolume=r.set,J(this,jt,r.subscribe(s=>{C(this,Te).gain.value=C(this,Re).volumeToGain(s)}))}addInsert(e){var t;if(C(this,Ue))throw Error("Can't add insert to disconnected channel");(t=C(this,$e))!=null||J(this,$e,[]),C(this,$e).push(e),C(this,Ke).call(this),J(this,Ke,zt([this.input,...C(this,$e),C(this,Te),C(this,Re).destination]))}addEffect(e,t,i){var a;if(C(this,Ue))throw Error("Can't add effect to disconnected channel");const n=this.context.createGain();n.gain.value=i;const r="input"in t?t.input:t,s=zt([C(this,Te),n,r]);(a=C(this,Ce))!=null||J(this,Ce,[]),C(this,Ce).push({name:e,mix:n,disconnect:s})}sendEffect(e,t){var i;if(C(this,Ue))throw Error("Can't send effect to disconnected channel");const a=(i=C(this,Ce))==null?void 0:i.find(n=>n.name===e);a?a.mix.gain.value=t:console.warn("Send bus not found: "+e)}disconnect(){var e;C(this,Ue)||(J(this,Ue,!0),C(this,Ke).call(this),C(this,jt).call(this),(e=C(this,Ce))==null||e.forEach(t=>t.disconnect()),J(this,Ce,void 0))}};Te=new WeakMap;Ce=new WeakMap;$e=new WeakMap;Ke=new WeakMap;jt=new WeakMap;Re=new WeakMap;Ue=new WeakMap;var Y,Zl=class{constructor(e){this.compare=e,$(this,Y,[])}push(e){const t=C(this,Y).length;let i=0,a=t-1,n=t;for(;i<=a;){const r=Math.floor((i+a)/2);this.compare(e,C(this,Y)[r])<0?(n=r,a=r-1):i=r+1}C(this,Y).splice(n,0,e)}pop(){return C(this,Y).shift()}peek(){return C(this,Y)[0]}removeAll(e){const t=C(this,Y).length;return J(this,Y,C(this,Y).filter(i=>!e(i))),C(this,Y).length!==t}clear(){J(this,Y,[])}size(){return C(this,Y).length}};Y=new WeakMap;function Or(e,t){return e&&t?i=>{e(i),t(i)}:e??t}function eo(e){var t,i,a;const n={disableScheduler:(t=e.disableScheduler)!=null?t:!1,scheduleLookaheadMs:(i=e.scheduleLookaheadMs)!=null?i:200,scheduleIntervalMs:(a=e.scheduleIntervalMs)!=null?a:50,onStart:e.onStart,onEnded:e.onEnded};if(n.scheduleLookaheadMs<1)throw Error("scheduleLookaheadMs must be greater than 0");if(n.scheduleIntervalMs<1)throw Error("scheduleIntervalMs must be greater than 0");if(n.scheduleLookaheadMs<n.scheduleIntervalMs)throw Error("scheduleLookaheadMs must be greater than scheduleIntervalMs");return n}var pe,te,De,xa=class{constructor(e,t={}){$(this,pe),$(this,te),$(this,De),J(this,pe,eo(t)),J(this,te,new Zl((i,a)=>i.time-a.time)),this.player=e}get context(){return this.player.context}get buffers(){return this.player.buffers}get isRunning(){return C(this,De)!==void 0}start(e){var t;if(C(this,pe).disableScheduler)return this.player.start(e);const i=this.player.context,a=i.currentTime,n=(t=e.time)!=null?t:a,r=C(this,pe).scheduleLookaheadMs/1e3;return e.onStart=Or(e.onStart,C(this,pe).onStart),e.onEnded=Or(e.onEnded,C(this,pe).onEnded),n<a+r?this.player.start(e):(C(this,te).push(we(le({},e),{time:n})),C(this,De)||J(this,De,setInterval(()=>{const s=i.currentTime+r;for(;C(this,te).size()&&C(this,te).peek().time<=s;){const d=C(this,te).pop();d&&this.player.start(d)}C(this,te).size()||(clearInterval(C(this,De)),J(this,De,void 0))},C(this,pe).scheduleIntervalMs)),s=>{!s||s<n?C(this,te).removeAll(d=>d===e)||this.player.stop(we(le({},e),{time:s})):this.player.stop(we(le({},e),{time:s}))})}stop(e){var t;if(C(this,pe).disableScheduler)return this.player.stop(e);if(this.player.stop(e),!e){C(this,te).clear();return}const i=(t=e==null?void 0:e.time)!=null?t:0,a=e==null?void 0:e.stopId;a?C(this,te).removeAll(n=>n.time>=i&&n.stopId?n.stopId===a:n.note===a):C(this,te).removeAll(n=>n.time>=i)}disconnect(){this.player.disconnect()}};pe=new WeakMap;te=new WeakMap;De=new WeakMap;var yt,We,ht,qa=class{constructor(e,t){this.context=e,this.options=t,$(this,yt),$(this,We,!1),$(this,ht);var i,a;J(this,yt,{velocityToGain:(i=t.velocityToGain)!=null?i:Da,destination:(a=t.destination)!=null?a:e.destination}),this.buffers={},J(this,ht,Vl())}start(e){var t,i,a,n,r,s,d,o,c,l,u,_,f,p;if(C(this,We))throw new Error("Can't start a sample on disconnected player");const h=this.context,m=e.name&&this.buffers[e.name]||this.buffers[e.note];if(!m)return console.warn(`Sample not found: '${e.note}'`),()=>{};const y=h.createBufferSource();y.buffer=m;const g=(i=(t=e.detune)!=null?t:this.options.detune)!=null?i:0;y.detune?y.detune.value=g:y.playbackRate&&(y.playbackRate.value=Math.pow(2,g/1200));const v=(a=e.lpfCutoffHz)!=null?a:this.options.lpfCutoffHz,b=v?h.createBiquadFilter():void 0;v&&b&&(b.type="lowpass",b.frequency.value=v);const N=h.createGain(),S=(r=(n=e.velocity)!=null?n:this.options.velocity)!=null?r:100;N.gain.value=C(this,yt).velocityToGain(S),((s=e.loop)!=null?s:this.options.loop)&&(y.loop=!0,y.loopStart=(d=e.loopStart)!=null?d:0,y.loopEnd=(o=e.loopEnd)!=null?o:m.duration);const M=(c=e.decayTime)!=null?c:this.options.decayTime,[w,F]=to(h,M);function L(U){if(U??(U=h.currentTime),U<=H)y.stop(U);else{const oe=F(U);y.stop(oe)}}const I=e.gainOffset?h.createGain():void 0;I&&e.gainOffset&&(I.gain.value=e.gainOffset);const R=(l=e.stopId)!=null?l:e.note,q=Yl([zt([y,b,N,w,I,C(this,yt).destination]),(u=e.stop)==null?void 0:u.call(e,L),C(this,ht).subscribe(U=>{(!U||U.stopId===void 0||U.stopId===R)&&L(U==null?void 0:U.time)})]);y.onended=()=>{var U;q(),(U=e.onEnded)==null||U.call(e,e)},(_=e.onStart)==null||_.call(e,e);const H=Math.max((f=e.time)!=null?f:0,h.currentTime);y.start(e.time);let O=(p=e.duration)!=null?p:m.duration;return typeof e.duration=="number"&&L(H+O),L}stop(e){C(this,ht).trigger(e)}disconnect(){C(this,We)||(J(this,We,!0),this.stop(),Object.keys(this.buffers).forEach(e=>{delete this.buffers[e]}))}get connected(){return!C(this,We)}};yt=new WeakMap;We=new WeakMap;ht=new WeakMap;function to(e,t=.2){let i=0;const a=e.createGain();a.gain.value=1;function n(r){if(i)return i;a.gain.cancelScheduledValues(r);const s=r||e.currentTime;return i=s+t,a.gain.setValueAtTime(1,s),a.gain.linearRampToValueAtTime(0,i),i}return[a,n]}var li=class{constructor(e,t){this.context=e;const i=new Ja(e,t);this.player=new xa(new qa(e,we(le({},t),{destination:i.input})),t),this.output=i}get buffers(){return this.player.buffers}start(e){return this.player.start(e)}stop(e){this.player.stop(typeof e=="object"?e:e!==void 0?{stopId:e}:void 0)}disconnect(){this.output.disconnect(),this.player.disconnect()}};function rr(e,t,i){return j(this,null,function*(){t=t.replace(/#/g,"%23").replace(/([^:]\/)\/+/g,"$1");const a=yield i.fetch(t);if(a.status!==200){console.warn("Error loading buffer. Invalid status: ",a.status,t);return}try{const n=yield a.arrayBuffer();return yield e.decodeAudioData(n)}catch(n){console.warn("Error loading buffer",n,t)}})}function oi(e){if(typeof document>"u")return null;const t=document.createElement("audio");for(let i=0;i<e.length;i++){const a=e[i],n=t.canPlayType(`audio/${a}`);if(n==="probably"||n==="maybe")return a;if(a==="m4a"){const r=t.canPlayType("audio/aac");if(r==="probably"||r==="maybe")return a}}return null}function io(){var e;return"."+((e=oi(["ogg","m4a"]))!=null?e:"ogg")}var kt={fetch(e){return fetch(e)}};function Ha(e){return typeof e=="object"&&typeof e.baseUrl=="string"&&typeof e.name=="string"&&Array.isArray(e.samples)&&Array.isArray(e.groupNames)&&typeof e.nameToSampleName=="object"&&typeof e.sampleGroupVariations=="object"}var ro={baseUrl:"",name:"",samples:[],groupNames:[],nameToSampleName:{},sampleGroupVariations:{}};function ao(e,t){return j(this,null,function*(){var i,a,n,r;const d=yield(yield t.fetch(e)).json();d.baseUrl=e.replace("/dm.json",""),d.groupNames=[],d.nameToSampleName={},d.sampleGroupVariations={};for(const o of d.samples){d.nameToSampleName[o]=o;const c=o.indexOf("/")!==-1?"/":"-",[l,u]=o.split(c);d.groupNames.includes(l)||d.groupNames.push(l),(a=(i=d.nameToSampleName)[l])!=null||(i[l]=o),(r=(n=d.sampleGroupVariations)[l])!=null||(n[l]=[]),u&&d.sampleGroupVariations[l].push(`${l}${c}${u}`)}return d})}function $a(){return Object.keys(Ka)}var Ka={"TR-808":"https://smpldsnds.github.io/drum-machines/TR-808/dm.json","Casio-RZ1":"https://smpldsnds.github.io/drum-machines/Casio-RZ1/dm.json","LM-2":"https://smpldsnds.github.io/drum-machines/LM-2/dm.json","MFB-512":"https://smpldsnds.github.io/drum-machines/MFB-512/dm.json","Roland CR-8000":"https://smpldsnds.github.io/drum-machines/Roland-CR-8000/dm.json"};function no(e){var t,i,a;const n={instrument:(t=e==null?void 0:e.instrument)!=null?t:"TR-808",storage:(i=e==null?void 0:e.storage)!=null?i:kt,url:(a=e==null?void 0:e.url)!=null?a:""};if(typeof n.instrument=="string"){if(n.url||(n.url=Ka[n.instrument]),!n.url)throw new Error("Invalid instrument: "+n.instrument)}else if(!Ha(n.instrument))throw new Error("Invalid instrument: "+n.instrument);return n}var me,so=class{constructor(e,t){$(this,me,ro);const i=no(t),a=Ha(i.instrument)?Promise.resolve(i.instrument):ao(i.url,i.storage);this.player=new li(e,t),this.output=this.player.output,this.load=lo(e,this.player.buffers,a,i.storage).then(()=>this),a.then(n=>{J(this,me,n)})}getSampleNames(){return C(this,me).samples.slice()}getGroupNames(){return C(this,me).groupNames.slice()}getSampleNamesForGroup(e){var t;return(t=C(this,me).sampleGroupVariations[e])!=null?t:[]}start(e){var t;const i=C(this,me).nameToSampleName[e.note];return this.player.start(we(le({},e),{note:i||e.note,stopId:(t=e.stopId)!=null?t:e.note}))}stop(e){return this.player.stop(e)}loaded(){return j(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}get sampleNames(){return console.log("deprecated: Use getGroupNames instead"),C(this,me).groupNames.slice()}getVariations(e){var t;return console.warn("deprecated: use getSampleNamesForGroup"),(t=C(this,me).sampleGroupVariations[e])!=null?t:[]}};me=new WeakMap;function lo(e,t,i,a){var n;const r=(n=oi(["ogg","m4a"]))!=null?n:"ogg";return i.then(s=>Promise.all(s.samples.map(d=>j(this,null,function*(){const o=`${s.baseUrl}/${d}.${r}`,c=yield rr(e,o,a);c&&(t[d]=c)}))))}function oo(e){const i=/^([a-gA-G]?)(#{1,}|b{1,}|)(-?\d+)$/.exec(e);if(!i)return;const a=i[1].toUpperCase();if(!a)return;const n=i[2],r=n[0]==="b"?-n.length:n.length,s=i[3]?+i[3]:4,d=(a.charCodeAt(0)+3)%7;return[0,2,4,5,7,9,11][d]+r+12*(s+1)}function Be(e){return e===void 0?void 0:typeof e=="number"?e:oo(e)}function co(e={}){return{groups:[],options:e}}function ar(){return{regions:[]}}function Wa(e,t,i,a){const n=[],r=Be(t.note);if(r===void 0)return n;for(const s of e.regions){const d=Xa(r,i??0,t,s,a);d&&n.push(d)}return n}function uo(e,t,i,a){const n=Be(t.note);if(n!==void 0)for(const r of e.regions){const s=Xa(n,0,t,r,a);if(s)return s}}function Xa(e,t,i,a,n){var r,s,d,o,c,l,u,_,f,p,h,m,y,g,v,b,N,S,G,M,w,F,L,I,R,q,H,O;if(!(e>=((r=a.midiLow)!=null?r:0)&&e<((s=a.midiHigh)!=null?s:127)+1)||!(i.velocity===void 0||i.velocity>=((d=a.velLow)!=null?d:0)&&i.velocity<=((o=a.velHigh)!=null?o:127)))return;if(a.seqLength){const k=t%a.seqLength,W=((c=a.seqPosition)!=null?c:1)-1;if(k!==W)return}const Fe=e-a.midiPitch,V=(l=i.velocity)!=null?l:n==null?void 0:n.velocity,Z=a.volume?Ql(a.volume):0,B=(_=(u=i.gainOffset)!=null?u:void 0)!=null?_:0,T=(f=i.detune)!=null?f:0;return{decayTime:(m=(h=i==null?void 0:i.decayTime)!=null?h:(p=a.sample)==null?void 0:p.decayTime)!=null?m:n==null?void 0:n.decayTime,detune:100*(Fe+((y=a.tune)!=null?y:0))+T,duration:(b=(v=i==null?void 0:i.duration)!=null?v:(g=a.sample)==null?void 0:g.duration)!=null?b:n==null?void 0:n.duration,gainOffset:B+Z||void 0,loop:(G=(S=i==null?void 0:i.loop)!=null?S:(N=a.sample)==null?void 0:N.loop)!=null?G:n==null?void 0:n.loop,loopEnd:(F=(w=i==null?void 0:i.loopEnd)!=null?w:(M=a.sample)==null?void 0:M.loopEnd)!=null?F:n==null?void 0:n.loopEnd,loopStart:(R=(I=i==null?void 0:i.loopStart)!=null?I:(L=a.sample)==null?void 0:L.loopStart)!=null?R:n==null?void 0:n.loopStart,lpfCutoffHz:(O=(H=i==null?void 0:i.lpfCutoffHz)!=null?H:(q=a.sample)==null?void 0:q.lpfCutoffHz)!=null?O:n==null?void 0:n.lpfCutoffHz,name:a.sampleName,note:e,onEnded:i.onEnded,onStart:i.onStart,stopId:i.name,time:i.time,velocity:V??void 0}}function fo(e){if(e.length===0)return[];if(e.sort((t,i)=>t.midiPitch-i.midiPitch),e[0].midiLow=0,e[0].midiHigh=127,e.length===1)return e;for(let t=1;t<e.length;t++){const i=e[t-1],a=e[t],n=Math.floor((i.midiPitch+a.midiPitch)/2);i.midiHigh=n,a.midiLow=n+1}return e[e.length-1].midiHigh=127,e}var _o=class{constructor(e,t){this.context=e,this.seqNum=0;const i=new Ja(e,t);this.instrument=co(t),this.player=new xa(new qa(e,we(le({},t),{destination:i.input})),t),this.output=i}get buffers(){return this.player.buffers}start(e){const t=[],i=typeof e=="object"?e:{note:e};for(const a of this.instrument.groups){const n=Wa(a,i,this.seqNum);this.seqNum++;for(const r of n){let s=this.player.start(r);t.push(s)}}return a=>t.forEach(n=>n(a))}stop(e){if(e==null){this.player.stop();return}const t=typeof e=="object"?e:{stopId:e},i=Be(t.stopId);i&&(t.stopId=i,this.player.stop(t))}disconnect(){this.output.disconnect(),this.player.disconnect()}};function za(e,t){const i=io();return(a,n)=>j(this,null,function*(){const r=yield fetch(e).then(o=>o.text()),s=po(r,t.group);s.length&&console.warn("Problems converting sfz",s);const d=new Set;return t.group.regions.forEach(o=>d.add(o.sampleName)),Promise.all(Array.from(d).map(o=>j(this,null,function*(){const c=t.urlFromSampleName(o,i),l=yield rr(a,c,n);t.buffers[o]=l}))).then(()=>t.group)})}function po(e,t){let i="global";const a=e.split(`
`).map(go).filter(s=>!!s),n=new vo;let r=[];for(const s of a)switch(s.type){case"mode":r.push(n.closeScope(i,t)),i=s.value;break;case"prop:num":case"prop:str":case"prop:num_arr":n.push(s.key,s.value);break;case"unknown":console.warn("Unknown SFZ token",s.value);break}return r.filter(s=>!!s)}var mo=/^<([^>]+)>$/,yo=/^([^=]+)=([-\.\d]+)$/,ho=/^([^=]+)=(.+)$/,bo=/^([^=]+)_(\d+)=(\d+)$/;function go(e){if(e=e.trim(),e===""||e.startsWith("//"))return;const t=e.match(mo);if(t)return{type:"mode",value:t[1]};const i=e.match(bo);if(i)return{type:"prop:num_arr",key:i[1],value:[Number(i[2]),Number(i[3])]};const a=e.match(yo);if(a)return{type:"prop:num",key:a[1],value:Number(a[2])};const n=e.match(ho);return n?{type:"prop:str",key:n[1],value:n[2]}:{type:"unknown",value:e}}var bt,Vt,vo=class{constructor(){$(this,bt),this.values={},this.global={},this.group={}}closeScope(e,t){if(e==="global")Xt(this,bt,Vt).call(this,this.global);else if(e==="group")this.group=Xt(this,bt,Vt).call(this,{});else if(e==="region"){const i=Xt(this,bt,Vt).call(this,le(le({sampleName:"",midiPitch:-1},this.global),this.group));if(i.sampleName==="")return"Missing sample name";if(i.midiPitch===-1)if(i.midiLow!==void 0)i.midiPitch=i.midiLow;else return"Missing pitch_keycenter";i.seqLength&&i.seqPosition===void 0&&(i.seqPosition=1),i.ampRelease&&(i.sample={decayTime:i.ampRelease},delete i.ampRelease),t.regions.push(i)}}get empty(){return Object.keys(this.values).length===0}get keys(){return Object.keys(this.values)}push(e,t){this.values[e]=t}popNum(e,t,i){return typeof this.values[e]!="number"?!1:(t[i]=this.values[e],delete this.values[e],!0)}popStr(e,t,i){return typeof this.values[e]!="string"?!1:(t[i]=this.values[e],delete this.values[e],!0)}popNumArr(e,t,i){return Array.isArray(this.values[e])?(t[i]=this.values[e],delete this.values[e],!0):!1}};bt=new WeakSet;Vt=function(e){return this.popStr("sample",e,"sampleName"),this.popNum("pitch_keycenter",e,"midiPitch"),this.popNum("ampeg_attack",e,"ampAttack"),this.popNum("ampeg_release",e,"ampRelease"),this.popNum("bend_down",e,"bendDown"),this.popNum("bend_up",e,"bendUp"),this.popNum("group",e,"group"),this.popNum("hikey",e,"midiHigh"),this.popNum("hivel",e,"velHigh"),this.popNum("lokey",e,"midiLow"),this.popNum("offset",e,"offset"),this.popNum("lovel",e,"velLow"),this.popNum("off_by",e,"groupOffBy"),this.popNum("pitch_keytrack",e,"ignore"),this.popNum("seq_length",e,"seqLength"),this.popNum("seq_position",e,"seqPosition"),this.popNum("tune",e,"tune"),this.popNum("volume",e,"volume"),this.popNumArr("amp_velcurve",e,"ampVelCurve"),this.values={},e};var So="https://smpldsnds.github.io/sgossner-vcsl/";function No(e){return So+e+".sfz"}function Bo(e,t){const i=No(e),n=`https://smpldsnds.github.io/sgossner-vcsl/${e.slice(0,e.lastIndexOf("/")+1)}`,r=ar();return za(i,{buffers:t,group:r,urlFromSampleName:(s,d)=>n+"/"+s.replace(".wav",d)})}var Co=class{constructor(e,t={}){var i,a;this.config={instrument:(i=t.instrument)!=null?i:"Arco",storage:(a=t.storage)!=null?a:kt},this.player=new _o(e,t);const n=Bo(this.config.instrument,this.player.buffers);this.load=n(e,this.config.storage).then(r=>(this.player.instrument.groups.push(r),this))}get output(){return this.player.output}get buffers(){return this.player.buffers}get context(){return this.player.context}start(e){return this.player.start(e)}stop(e){return this.player.stop(e)}disconnect(){this.player.disconnect()}};function Go(){return Object.keys(ja)}var Lo=class extends Co{constructor(e,t){var i;super(e,we(le({},t),{instrument:ja[(i=t.instrument)!=null?i:""]}))}},ja={"Balafon - Hard Mallet":"Idiophones/Struck Idiophones/Balafon - Hard Mallet","Balafon - Keyswitch":"Idiophones/Struck Idiophones/Balafon - Keyswitch","Balafon - Soft Mallet":"Idiophones/Struck Idiophones/Balafon - Soft Mallet","Balafon - Traditional Mallet":"Idiophones/Struck Idiophones/Balafon - Traditional Mallet","Tubular Bells 1":"Idiophones/Struck Idiophones/Tubular Bells 1","Tubular Bells 2":"Idiophones/Struck Idiophones/Tubular Bells 2","Vibraphone - Bowed":"Idiophones/Struck Idiophones/Vibraphone - Bowed","Vibraphone - Hard Mallets":"Idiophones/Struck Idiophones/Vibraphone - Hard Mallets","Vibraphone - Keyswitch":"Idiophones/Struck Idiophones/Vibraphone - Keyswitch","Vibraphone - Soft Mallets":"Idiophones/Struck Idiophones/Vibraphone - Soft Mallets","Xylophone - Hard Mallets":"Idiophones/Struck Idiophones/Xylophone - Hard Mallets","Xylophone - Keyswitch":"Idiophones/Struck Idiophones/Xylophone - Keyswitch","Xylophone - Medium Mallets":"Idiophones/Struck Idiophones/Xylophone - Medium Mallets","Xylophone - Soft Mallets":"Idiophones/Struck Idiophones/Xylophone - Soft Mallets"};function Mo(){return["Pizzicato","Arco","Switched"]}function wo(e){return`https://smpldsnds.github.io/sfzinstruments-dsmolken-double-bass/d_smolken_rubner_bass_${{Arco:"arco",Pizzicato:"pizz",Switched:"switched"}[e]}.sfz`}var Eo=class{constructor(e,t={}){this.seqNum=0;var i,a;this.config={instrument:(i=t.instrument)!=null?i:"Arco",storage:(a=t.storage)!=null?a:kt},this.player=new li(e,t),this.group=ar();const n=wo(this.config.instrument),r=za(n,{buffers:this.player.buffers,group:this.group,urlFromSampleName:(s,d)=>`https://smpldsnds.github.io/sfzinstruments-dsmolken-double-bass/${s.replace("\\","/").replace(".wav",d)}`});this.load=r(e,this.config.storage).then(()=>this)}get output(){return this.player.output}get buffers(){return this.player.buffers}get context(){return this.player.context}start(e){const t=Wa(this.group,typeof e=="object"?e:{note:e},this.seqNum);this.seqNum++;const i=t.map(a=>this.player.start(a));return a=>i.forEach(n=>n(a))}stop(e){if(e==null){this.player.stop();return}const t=typeof e=="object"?e:{stopId:e},i=Be(t.stopId);i&&(t.stopId=i,this.player.stop(t))}disconnect(){this.player.disconnect()}};function Fo(e,t){var i;const a=(i=oi(["ogg","mp3"]))!=null?i:"mp3";return`https://gleitz.github.io/midi-js-soundfonts/${t}/${e}-${a}.js`}function Po(e,t,i){return(a,n)=>j(this,null,function*(){const r=yield(yield n.fetch(e)).text(),s=Ao(r),d=Object.keys(s);yield Promise.all(d.map(o=>j(this,null,function*(){const c=Be(o);if(!c)return;const l=Io(ko(s[o])),u=yield a.decodeAudioData(l);t[o]=u,i.regions.push({sampleName:o,midiPitch:c})}))),fo(i.regions)})}function Ao(e){const t=e.indexOf("MIDI.Soundfont.");if(t<0)throw Error("Invalid MIDI.js Soundfont format");const i=e.indexOf("=",t)+2,a=e.lastIndexOf(",");return JSON.parse(e.slice(i,a)+"}")}function ko(e){return e.slice(e.indexOf(",")+1)}function Io(e){const t=window.atob(e),i=t.length,a=new Uint8Array(i);for(let n=0;n<i;n++)a[n]=t.charCodeAt(n);return a.buffer}var Oo=["MusyngKite","FluidR3_GM"],To=["accordion","acoustic_bass","acoustic_grand_piano","acoustic_guitar_nylon","acoustic_guitar_steel","agogo","alto_sax","applause","bagpipe","banjo","baritone_sax","bassoon","bird_tweet","blown_bottle","brass_section","breath_noise","bright_acoustic_piano","celesta","cello","choir_aahs","church_organ","clarinet","clavinet","contrabass","distortion_guitar","drawbar_organ","dulcimer","electric_bass_finger","electric_bass_pick","electric_grand_piano","electric_guitar_clean","electric_guitar_jazz","electric_guitar_muted","electric_piano_1","electric_piano_2","english_horn","fiddle","flute","french_horn","fretless_bass","fx_1_rain","fx_2_soundtrack","fx_3_crystal","fx_4_atmosphere","fx_5_brightness","fx_6_goblins","fx_7_echoes","fx_8_scifi","glockenspiel","guitar_fret_noise","guitar_harmonics","gunshot","harmonica","harpsichord","helicopter","honkytonk_piano","kalimba","koto","lead_1_square","lead_2_sawtooth","lead_3_calliope","lead_4_chiff","lead_5_charang","lead_6_voice","lead_7_fifths","lead_8_bass__lead","marimba","melodic_tom","music_box","muted_trumpet","oboe","ocarina","orchestra_hit","orchestral_harp","overdriven_guitar","pad_1_new_age","pad_2_warm","pad_3_polysynth","pad_4_choir","pad_5_bowed","pad_6_metallic","pad_7_halo","pad_8_sweep","pan_flute","percussive_organ","piccolo","pizzicato_strings","recorder","reed_organ","reverse_cymbal","rock_organ","seashore","shakuhachi","shamisen","shanai","sitar","slap_bass_1","slap_bass_2","soprano_sax","steel_drums","string_ensemble_1","string_ensemble_2","synth_bass_1","synth_bass_2","synth_brass_1","synth_brass_2","synth_choir","synth_drum","synth_strings_1","synth_strings_2","taiko_drum","tango_accordion","telephone_ring","tenor_sax","timpani","tinkle_bell","tremolo_strings","trombone","trumpet","tuba","tubular_bells","vibraphone","viola","violin","voice_oohs","whistle","woodblock","xylophone"];function Ro(e,t){if(!e.startsWith("http"))return`https://goldst.dev/midi-js-soundfonts/${t}/${e}-loop.json`}function Uo(e,t=44100){return j(this,null,function*(){if(e)try{const i=yield fetch(e);if(i.status!==200)return;const a=yield i.json(),n={};return Object.keys(a).forEach(r=>{const s=Be(r);if(s){const d=a[r];n[s]=[d[0]/t,d[1]/t]}}),n}catch{return}})}function Do(){return Oo}function Jo(){return To}var gt,xo=class{constructor(e,t){this.context=e,$(this,gt),this.config=Ho(t),this.player=new li(e,t),this.group=ar(),J(this,gt,!1);const i=qo(this.config.instrumentUrl,this.config.loopDataUrl,this.player.buffers,this.group);this.load=i(e,this.config.storage).then(n=>(J(this,gt,n),this));const a=e.createGain();a.gain.value=this.config.extraGain,this.player.output.addInsert(a)}get output(){return this.player.output}get hasLoops(){return C(this,gt)}loaded(){return j(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}disconnect(){this.player.disconnect()}start(e){const t=uo(this.group,typeof e=="object"?e:{note:e});return t?this.player.start(t):()=>{}}stop(e){return this.player.stop(e)}};gt=new WeakMap;function qo(e,t,i,a){const n=Po(e,i,a);return(r,s)=>j(this,null,function*(){const[d,o]=yield Promise.all([n(r,s),Uo(t)]);return o&&a.regions.forEach(c=>{var l;const u=o[c.midiPitch];u&&((l=c.sample)!=null||(c.sample={}),c.sample.loop=!0,c.sample.loopStart=u[0],c.sample.loopEnd=u[1])}),!!o})}function Ho(e){var t,i,a,n;if(!e.instrument&&!e.instrumentUrl)throw Error("Soundfont: instrument or instrumentUrl is required");const r={kit:"MusyngKite",instrument:e.instrument,storage:(t=e.storage)!=null?t:kt,extraGain:(i=e.extraGain)!=null?i:5,loadLoopData:(a=e.loadLoopData)!=null?a:!1,loopDataUrl:e.loopDataUrl,instrumentUrl:(n=e.instrumentUrl)!=null?n:""};if(r.instrument&&r.instrument.startsWith("http")&&(console.warn("Use 'instrumentUrl' instead of 'instrument' to load from a URL"),r.instrumentUrl=r.instrument,r.instrument=void 0),r.instrumentUrl)(r.kit||r.instrument)&&console.warn("Soundfont: 'kit' and 'instrument' config parameters are ignored because 'instrumentUrl' is explicitly set.");else if(r.instrument)r.instrumentUrl=Fo(r.instrument,r.kit);else throw Error("Soundfont: 'instrument' or 'instrumentUrl' configuration parameter is required");return r.loadLoopData&&r.instrument&&!r.loopDataUrl&&(r.loopDataUrl=Ro(r.instrument,r.kit)),r}var $o="https://danigb.github.io/samples/splendid-grand-piano",Ei,Va,Ko=class{constructor(e,t){this.context=e,$(this,Ei),this.options=Object.assign({baseUrl:$o,storage:kt,detune:0,volume:100,velocity:100,decayTime:.5},t),this.player=new li(e,this.options);const i=Xo(this.options.baseUrl,this.options.storage,this.options.notesToLoad);this.load=i(e,this.player.buffers).then(()=>this)}get output(){return this.player.output}get buffers(){return this.player.buffers}loaded(){return j(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}start(e){var t,i;const a=typeof e=="object"?le({},e):{note:e},n=Xt(this,Ei,Va).call(this,a);return n?(a.note=n[0],a.stopId=(t=a.stopId)!=null?t:n[1],a.detune=n[2]+((i=a.detune)!=null?i:this.options.detune),this.player.start(a)):()=>{}}stop(e){var t;if(typeof e=="string")return this.player.stop((t=Be(e))!=null?t:e);if(typeof e=="object"){const i=Be(e.stopId);return this.player.stop(i!==void 0?we(le({},e),{stopId:i}):e)}else return this.player.stop(e)}};Ei=new WeakSet;Va=function(e){var t;const i=Be(e.note);if(!i)return;const a=(t=e.velocity)!=null?t:this.options.velocity,n=ti.findIndex(s=>a>=s.vel_range[0]&&a<=s.vel_range[1]),r=ti[n];if(r)return Wo(r.name,i,this.player.buffers)};function Wo(e,t,i){let a=0;for(;i[e+(t+a)]===void 0&&a<128;)a>0?a=-a:a=-a+1;return a===127?[e+t,t,0]:[e+(t+a),t,-a*100]}function Xo(e,t,i){var a;const n=(a=oi(["ogg","m4a"]))!=null?a:"ogg";let r=i?ti.filter(s=>s.vel_range[0]<=i.velocityRange[1]&&s.vel_range[1]>=i.velocityRange[0]):ti;return(s,d)=>j(this,null,function*(){for(const o of r){const c=i?o.samples.filter(l=>i.notes.includes(l[0])):o.samples;yield Promise.all(c.map(l=>j(this,[l],function*([u,_]){const f=`${e}/${_}.${n}`,p=yield rr(s,f,t);p&&(d[o.name+u]=p)})))}})}var ti=[{name:"PPP",vel_range:[1,40],cutoff:1e3,samples:[[23,"PP-B-1"],[27,"PP-D#0"],[29,"PP-F0"],[31,"PP-G0"],[33,"PP-A0"],[35,"PP-B0"],[37,"PP-C#1"],[38,"PP-D1"],[40,"PP-E1"],[41,"PP-F1"],[43,"PP-G1"],[45,"PP-A1"],[47,"PP-B1"],[48,"PP-C2"],[50,"PP-D2"],[52,"PP-E2"],[53,"PP-F2"],[55,"PP-G2"],[56,"PP-G#2"],[57,"PP-A2"],[58,"PP-A#2"],[59,"PP-B2"],[60,"PP-C3"],[62,"PP-D3"],[64,"PP-E3"],[65,"PP-F3"],[67,"PP-G3"],[69,"PP-A3"],[71,"PP-B3"],[72,"PP-C4"],[74,"PP-D4"],[76,"PP-E4"],[77,"PP-F4"],[79,"PP-G4"],[80,"PP-G#4"],[81,"PP-A4"],[82,"PP-A#4"],[83,"PP-B4"],[85,"PP-C#5"],[86,"PP-D5"],[87,"PP-D#5"],[89,"PP-F5"],[90,"PP-F#5"],[91,"PP-G5"],[92,"PP-G#5"],[93,"PP-A5"],[94,"PP-A#5"],[95,"PP-B5"],[96,"PP-C6"],[97,"PP-C#6"],[98,"PP-D6"],[99,"PP-D#6"],[100,"PP-E6"],[101,"PP-F6"],[102,"PP-F#6"],[103,"PP-G6"],[104,"PP-G#6"],[105,"PP-A6"],[106,"PP-A#6"],[107,"PP-B6"],[108,"PP-C7"]]},{name:"PP",vel_range:[41,67],samples:[[23,"PP-B-1"],[27,"PP-D#0"],[29,"PP-F0"],[31,"PP-G0"],[33,"PP-A0"],[35,"PP-B0"],[37,"PP-C#1"],[38,"PP-D1"],[40,"PP-E1"],[41,"PP-F1"],[43,"PP-G1"],[45,"PP-A1"],[47,"PP-B1"],[48,"PP-C2"],[50,"PP-D2"],[52,"PP-E2"],[53,"PP-F2"],[55,"PP-G2"],[56,"PP-G#2"],[57,"PP-A2"],[58,"PP-A#2"],[59,"PP-B2"],[60,"PP-C3"],[62,"PP-D3"],[64,"PP-E3"],[65,"PP-F3"],[67,"PP-G3"],[69,"PP-A3"],[71,"PP-B3"],[72,"PP-C4"],[74,"PP-D4"],[76,"PP-E4"],[77,"PP-F4"],[79,"PP-G4"],[80,"PP-G#4"],[81,"PP-A4"],[82,"PP-A#4"],[83,"PP-B4"],[85,"PP-C#5"],[86,"PP-D5"],[87,"PP-D#5"],[89,"PP-F5"],[90,"PP-F#5"],[91,"PP-G5"],[92,"PP-G#5"],[93,"PP-A5"],[94,"PP-A#5"],[95,"PP-B5"],[96,"PP-C6"],[97,"PP-C#6"],[98,"PP-D6"],[99,"PP-D#6"],[100,"PP-E6"],[101,"PP-F6"],[102,"PP-F#6"],[103,"PP-G6"],[104,"PP-G#6"],[105,"PP-A6"],[106,"PP-A#6"],[107,"PP-B6"],[108,"PP-C7"]]},{name:"MP",vel_range:[68,84],samples:[[23,"Mp-B-1"],[27,"Mp-D#0"],[29,"Mp-F0"],[31,"Mp-G0"],[33,"Mp-A0"],[35,"Mp-B0"],[37,"Mp-C#1"],[38,"Mp-D1"],[40,"Mp-E1"],[41,"Mp-F1"],[43,"Mp-G1"],[45,"Mp-A1"],[47,"Mp-B1"],[48,"Mp-C2"],[50,"Mp-D2"],[52,"Mp-E2"],[53,"Mp-F2"],[55,"Mp-G2"],[56,"Mp-G#2"],[57,"Mp-A2"],[58,"Mp-A#2"],[59,"Mp-B2"],[60,"Mp-C3"],[62,"Mp-D3"],[64,"Mp-E3"],[65,"Mp-F3"],[67,"Mp-G3"],[69,"Mp-A3"],[71,"Mp-B3"],[72,"Mp-C4"],[74,"Mp-D4"],[76,"Mp-E4"],[77,"Mp-F4"],[79,"Mp-G4"],[80,"Mp-G#4"],[81,"Mp-A4"],[82,"Mp-A#4"],[83,"Mp-B4"],[85,"Mp-C#5"],[86,"Mp-D5"],[87,"Mp-D#5"],[88,"Mp-E5"],[89,"Mp-F5"],[90,"Mp-F#5"],[91,"Mp-G5"],[92,"Mp-G#5"],[93,"Mp-A5"],[94,"Mp-A#5"],[95,"Mp-B5"],[96,"Mp-C6"],[97,"Mp-C#6"],[98,"Mp-D6"],[99,"Mp-D#6"],[100,"PP-E6"],[101,"Mp-F6"],[102,"Mp-F#6"],[103,"Mp-G6"],[104,"Mp-G#6"],[105,"Mp-A6"],[106,"Mp-A#6"],[107,"PP-B6"],[108,"PP-C7"]]},{name:"MF",vel_range:[85,100],samples:[[23,"Mf-B-1"],[27,"Mf-D#0"],[29,"Mf-F0"],[31,"Mf-G0"],[33,"Mf-A0"],[35,"Mf-B0"],[37,"Mf-C#1"],[38,"Mf-D1"],[40,"Mf-E1"],[41,"Mf-F1"],[43,"Mf-G1"],[45,"Mf-A1"],[47,"Mf-B1"],[48,"Mf-C2"],[50,"Mf-D2"],[52,"Mf-E2"],[53,"Mf-F2"],[55,"Mf-G2"],[56,"Mf-G#2"],[57,"Mf-A2"],[58,"Mf-A#2"],[59,"Mf-B2"],[60,"Mf-C3"],[62,"Mf-D3"],[64,"Mf-E3"],[65,"Mf-F3"],[67,"Mf-G3"],[69,"Mf-A3"],[71,"Mf-B3"],[72,"Mf-C4"],[74,"Mf-D4"],[76,"Mf-E4"],[77,"Mf-F4"],[79,"Mf-G4"],[80,"Mf-G#4"],[81,"Mf-A4"],[82,"Mf-A#4"],[83,"Mf-B4"],[85,"Mf-C#5"],[86,"Mf-D5"],[87,"Mf-D#5"],[88,"Mf-E5"],[89,"Mf-F5"],[90,"Mf-F#5"],[91,"Mf-G5"],[92,"Mf-G#5"],[93,"Mf-A5"],[94,"Mf-A#5"],[95,"Mf-B5"],[96,"Mf-C6"],[97,"Mf-C#6"],[98,"Mf-D6"],[99,"Mf-D#6"],[100,"Mf-E6"],[101,"Mf-F6"],[102,"Mf-F#6"],[103,"Mf-G6"],[104,"Mf-G#6"],[105,"Mf-A6"],[106,"Mf-A#6"],[107,"Mf-B6"],[108,"PP-C7"]]},{name:"FF",vel_range:[101,127],samples:[[23,"FF-B-1"],[27,"FF-D#0"],[29,"FF-F0"],[31,"FF-G0"],[33,"FF-A0"],[35,"FF-B0"],[37,"FF-C#1"],[38,"FF-D1"],[40,"FF-E1"],[41,"FF-F1"],[43,"FF-G1"],[45,"FF-A1"],[47,"FF-B1"],[48,"FF-C2"],[50,"FF-D2"],[52,"FF-E2"],[53,"FF-F2"],[55,"FF-G2"],[56,"FF-G#2"],[57,"FF-A2"],[58,"FF-A#2"],[59,"FF-B2"],[60,"FF-C3"],[62,"FF-D3"],[64,"FF-E3"],[65,"FF-F3"],[67,"FF-G3"],[69,"FF-A3"],[71,"FF-B3"],[72,"FF-C4"],[74,"FF-D4"],[76,"FF-E4"],[77,"FF-F4"],[79,"FF-G4"],[80,"FF-G#4"],[81,"FF-A4"],[82,"FF-A#4"],[83,"FF-B4"],[85,"FF-C#5"],[86,"FF-D5"],[88,"FF-E5"],[89,"FF-F5"],[91,"FF-G5"],[93,"FF-A5"],[95,"Mf-B5"],[96,"Mf-C6"],[97,"Mf-C#6"],[98,"Mf-D6"],[99,"Mf-D#6"],[100,"Mf-E6"],[102,"Mf-F#6"],[103,"Mf-G6"],[104,"Mf-G#6"],[105,"Mf-A6"],[106,"Mf-A#6"],[107,"Mf-B6"],[108,"Mf-C7"]]}];let Bt=0;const pi=new Map;async function di(e,t=ae(),i=null,a,n){var g;const r=e.split("/");let s="sf2",d="musyngkite",o="acoustic_grand_piano";r.length===3?[s,d,o]=r:r.length===2?[d,o]=r:r.length===1&&(o=r[0]);const c=t instanceof OfflineAudioContext;pi.has(t)||pi.set(t,new Map);const l=pi.get(t),u=`${d}/${o}`;if(l.has(u))return l.get(u);const _=Math.max(0,Math.min(127,Math.round((a??1)*127))),f=t.createStereoPanner();n!==void 0&&(f.pan.value=n);const p=t.createGain();p.connect(f),f.connect(i||tt());const h={instrument:o,volume:_,destination:p,disableScheduler:c};let m;if(d==="smolken")m=new Eo(t,h),await dt(m.load);else if(d==="splendidgrandpiano")m=new Ko(t,{...h}),await dt(m.load);else if(d==="mallets")m=new Lo(t,h),await dt(m.load);else if(d==="drummachines"){m=new so(t,h),await dt(m.load);const v=((g=m.getSampleNames)==null?void 0:g.call(m))??[],b=new Map;v.forEach((N,S)=>{const G=36+S;b.set(G,N)}),m.__midiMap=b}else{const b={"fluidr3-gm":"FluidR3_GM",fatboy:"FatBoy",musyngkite:"MusyngKite"}[d.toLowerCase()]||"MusyngKite",S=`https://gleitz.github.io/midi-js-soundfonts/${b}/${o}-ogg.js`;m=new xo(t,{...h,instrumentUrl:S,kit:b}),await dt(m.load)}const y=m;return y.setVolume=v=>{var N;const b=Math.max(0,Math.min(127,Math.round(v*127)));"output"in y&&typeof((N=y.output)==null?void 0:N.setVolume)=="function"&&y.output.setVolume(b)},y.setPan=v=>{f.pan.value=Math.max(-1,Math.min(1,v))},l.set(u,y),y}async function zo(){const t=jo().map(a=>{switch(a){case"FluidR3_GM":return"fluidr3-gm";case"FatBoy":return"fatboy";case"MusyngKite":return"musyngkite";default:return a.toLowerCase()}}),i=["splendidgrandpiano","mallets","drummachines","smolken"];return[...new Set([...t,...i])]}function jo(){const t=[...Do()];return t.includes("FatBoy")||t.push("FatBoy"),t}async function Vo(e){const t=e.toLowerCase();return t==="splendidgrandpiano"?["splendidgrandpiano"]:t==="mallets"?Go():t==="drummachines"?$a():t==="smolken"?Mo():(await di(`${e}/acoustic_grand_piano`),Jo()??[])}function Yo(){return $a()}function Qo(){Bt++,Bt===1&&Ta()}function Zo(){Bt--,Bt<=0&&(Bt=0,Ra())}async function dt(e){Qo();try{await e}finally{Zo()}}function ed(){return{name:"sf2",loadInstrument:di,getAvailableLibraries:zo,getAvailableInstruments:Vo}}let de=null,Fi=null;async function td(e){if(Fi===e)return;de=await di(e),Fi=e}function id(){return Fi}function rd(e,t=100,i=!1){var d;if(!de)return null;const n=ae().currentTime,r=P(e);if(r===null)return null;const s=((d=de.__midiMap)==null?void 0:d.get(r))??r;return de.start({note:s,stopId:s,velocity:t,time:n,loop:i}),()=>{de==null||de.stop({stopId:s})}}function ad(e){var a;if(!de)return;const t=P(e);if(t===null)return;const i=((a=de.__midiMap)==null?void 0:a.get(t))??t;de.stop({stopId:i})}async function nd(e,t,i,a=100,n=!1,r=null,s=null,d=null,o,c){var p;const l=s||ae(),u=await di(e,l,d,o,c);o!==void 0&&u.setVolume&&u.setVolume(o),c!==void 0&&u.setPan&&u.setPan(c);const _=P(t);if(_===null)return null;const f=((p=u.__midiMap)==null?void 0:p.get(_))??_;return u.start({note:f,duration:i,velocity:a,loop:n,time:r??l.currentTime}),null}function sd(){return{name:"sf2",setActiveInstrument:td,getActiveInstrumentName:id,playNote:rd,stopNoteByPitch:ad,loadAndPlayNote:nd}}let Pi=null,Ai=null;async function ld(e){if(Ai===e)return;const[,t,i]=e.split("/");Pi=await tr(`${t}/${i}`),Ai=e}function od(){return Ai}function dd(e,t=100,i=!1){if(!Pi)return null;const n=ae().currentTime,r=P(e);return r===null?null:(Pi.start({note:r,velocity:t,time:n,duration:1.5,loop:i}),()=>{})}function cd(e){}async function ud(e,t,i,a=100,n=!1,r=null,s=null,d=null,o,c){const l=s||ae(),[,u,_]=e.split("/"),f=await tr(`${u}/${_}`,l,d,o,c);o!==void 0&&f.setVolume&&f.setVolume(o),c!==void 0&&f.setPan&&f.setPan(c);const p=P(t);return p===null||f.start({note:p,duration:i,velocity:a,loop:n,time:r??l.currentTime}),null}function fd(){return{name:"webaudiofont",setActiveInstrument:ld,getActiveInstrumentName:od,playNote:dd,stopNoteByPitch:cd,loadAndPlayNote:ud}}const ci={sf2:sd(),webaudiofont:fd()};let st=null;async function Ya(e){if(!e.includes("/"))throw new Error(`Invalid instrument name: "${e}". Expected "<engine>/<library>/<instrument>"`);const t=e.split("/")[0],i=ci[t];if(!i)throw new Error(`Engine "${t}" not available`);await i.setActiveInstrument(e),st=e}function _d(){return st}function Qa(e,t=100,i=!1){if(!st)return null;const a=st.split("/")[0],n=ci[a];if(!n)throw new Error(`Engine "${a}" not available`);return n.playNote(e,t,i)}function pd(e){if(!st)return;const t=st.split("/")[0],i=ci[t];if(!i)throw new Error(`Engine "${t}" not available`);i.stopNoteByPitch(e)}async function md(e,t,i,a=100,n=!1,r=null,s=null,d=null,o,c){const l=e.split("/")[0],u=ci[l];if(!u)throw new Error(`Engine "${l}" not available`);return await u.loadAndPlayNote(e,t,i,a,n,r,s,d,o,c)}let mi=null;function ae(){return mi||(mi=new(window.AudioContext||window.webkitAudioContext)),mi}let Ut=null,Dt=null;function ki(){return Ut||(Ut=ae().createAnalyser(),Ut.fftSize=2048),Ut}function tt(){return Dt||(Dt=ae().createGain(),ki().connect(ae().destination),Dt.connect(ki())),Dt}function yd(e){ae().resume();try{const t=Qa(e,100,!1);return t?{stop:t,forceStop:t}:null}catch(t){return console.error("[playNote] Failed to play note",e,t),null}}let Tr=!1,Jt=null;function Za(e,t){if(Tr)return;Tr=!0,Jt=t;const i=e.getContext("2d");if(!i)return;const a=new Map,n=new Set;function r(l,u){const _=Jt();for(const f of Object.values(_))if(f.isBlack&&l>=f.x&&l<=f.x+f.width&&u>=0&&u<=f.height)return f.note;for(const f of Object.values(_))if(!f.isBlack&&l>=f.x&&l<=f.x+f.width&&u>=0&&u<=f.height)return f.note;return null}function s(l){if(!l||n.has(l))return;const u=yd(l);u&&(a.set(l,u),n.add(l),i&&rt(i,Jt(),n))}function d(l){if(!n.has(l))return;const u=a.get(l);u&&(u.stop(),a.delete(l)),n.delete(l),i&&rt(i,Jt(),n)}function o(){for(const l of n)d(l)}let c=!1;e.addEventListener("mousedown",l=>{c=!0;const u=e.getBoundingClientRect(),_=l.clientX-u.left,f=l.clientY-u.top,p=r(_,f);s(p)}),e.addEventListener("mousemove",l=>{if(!c)return;const u=e.getBoundingClientRect(),_=l.clientX-u.left,f=l.clientY-u.top,p=r(_,f);s(p)}),e.addEventListener("mouseup",()=>{c=!1,o()}),e.addEventListener("mouseleave",()=>{c=!1,o()})}const nr=[..."qwertyuiop[zxcvbnm,./"],sr=["2","3","5","6","7","9","0","=","s","d","g","h","k","l",";"];function hd(){const e=document.getElementById("instrument-loop-toggle");return(e==null?void 0:e.checked)??!1}let Ii=!1,xt=null,Ct=null,Gt=null;function en(e,t){if(Ii)return;Ii=!0;const i=e.getContext("2d");if(!i)throw new Error("Canvas 2D context not available.");const a=new Set,n=new Set,r=new Map,s=nr,d=sr;xt=t;function o(){const u=xt(),_=Object.values(u).filter(h=>!h.isBlack).sort((h,m)=>h.x-m.x).map(h=>h.note),f=Object.values(u).filter(h=>h.isBlack).sort((h,m)=>h.x-m.x).map(h=>h.note),p={};return s.forEach((h,m)=>{_[m]&&(p[h]=_[m])}),d.forEach((h,m)=>{f[m]&&(p[h]=f[m])}),p}function c(u){const _=o(),f=_[u];if(!(!f||a.has(u))){if(a.add(u),!n.has(f)){const p=Qa(f,100,hd());p&&(r.set(f,{stop:p}),n.add(f))}i&&rt(i,xt(),n,_)}}function l(u){const _=o(),f=_[u];f&&(a.delete(u),n.has(f)&&(pd(f),r.delete(f),n.delete(f)),i&&rt(i,xt(),n,_))}Ct=u=>{u.repeat||c(u.key)},Gt=u=>{l(u.key)},window.addEventListener("keydown",Ct),window.addEventListener("keyup",Gt)}function tn(){Ct&&(window.removeEventListener("keydown",Ct),Ct=null),Gt&&(window.removeEventListener("keyup",Gt),Gt=null),Ii=!1}let Xe=3,qe=ai(Xe),qt=!1;async function bd(e){var r,s;const t=e.getContext("2d");if(!t)throw new Error("Failed to get 2D context for keyboard canvas");function i(){const d=Object.values(qe).filter(l=>!l.isBlack).sort((l,u)=>l.x-u.x).map(l=>l.note),o=Object.values(qe).filter(l=>l.isBlack).sort((l,u)=>l.x-u.x).map(l=>l.note),c={};return nr.forEach((l,u)=>{d[u]&&(c[l]=d[u])}),sr.forEach((l,u)=>{o[u]&&(c[l]=o[u])}),c}function a(){if(!t)return;qe=ai(Xe);const d=qt?i():null;rt(t,qe,new Set,d)}Za(e,()=>qe),a(),(r=document.getElementById("octave-up"))==null||r.addEventListener("click",()=>{Xe<7&&(Xe++,a())}),(s=document.getElementById("octave-down"))==null||s.addEventListener("click",()=>{Xe>1&&(Xe--,a())});const n=document.getElementById("disable-keyboard-inputs");return n.classList.remove("bg-purple-600"),n.classList.add("bg-gray-700"),n.addEventListener("click",()=>{qt=!qt,qt?(en(e,()=>qe),n.classList.remove("bg-gray-700"),n.classList.add("bg-purple-600")):(tn(),n.classList.remove("bg-purple-600"),n.classList.add("bg-gray-700")),a()}),{refreshKeyboard:a}}let ze=3,He=ai(ze),Ht=!1,$t=null;async function gd(e){var r,s;if($t=e.getContext("2d"),!$t)throw new Error("Failed to get 2D context for keyboard canvas.");await Ya("sf2/fluidr3-gm/acoustic_grand_piano");function t(){const d=Object.values(He).filter(l=>!l.isBlack).sort((l,u)=>l.x-u.x).map(l=>l.note),o=Object.values(He).filter(l=>l.isBlack).sort((l,u)=>l.x-u.x).map(l=>l.note),c={};return nr.forEach((l,u)=>{d[u]&&(c[l]=d[u])}),sr.forEach((l,u)=>{o[u]&&(c[l]=o[u])}),c}function i(){He=ai(ze);const d=Ht?t():null;$t&&rt($t,He,new Set,d)}Za(e,()=>He),i(),(r=document.getElementById("octave-up"))==null||r.addEventListener("click",()=>{ze<7&&(ze++,i())}),(s=document.getElementById("octave-down"))==null||s.addEventListener("click",()=>{ze>1&&(ze--,i())});const a=document.getElementById("disable-keyboard-inputs");a.classList.remove("bg-purple-600"),a.classList.add("bg-gray-700"),a.addEventListener("click",()=>{Ht=!Ht,Ht?(en(e,()=>He),a.classList.remove("bg-gray-700"),a.classList.add("bg-purple-600")):(tn(),a.classList.remove("bg-purple-600"),a.classList.add("bg-gray-700")),i()}),document.getElementById("global-instrument-select-btn").addEventListener("click",async()=>{const d=_d()||"sf2/fluidr3-gm/acoustic_grand_piano",o=document.getElementById("instrument-select-modal");delete o.dataset.currentSequencer,await ka(d),o.classList.remove("hidden")})}async function vd(e){await gd(e);const{refreshKeyboard:t}=await bd(e)}function Sd(e,t){const i=t.getContext("2d");if(!i)throw new Error("Canvas 2D context not available");const a=t.width,n=t.height,r=new Uint8Array(e.fftSize),s=new Uint8Array(e.frequencyBinCount),d=document.createElement("canvas");d.width=a,d.height=n;const o=d.getContext("2d");if(!o)throw new Error("Offscreen canvas 2D context not available");let c="frequency";function l(){if(!i)return;e.getByteTimeDomainData(r),i.fillStyle="#000",i.fillRect(0,0,a,n),i.lineWidth=2,i.strokeStyle="#00ffcc",i.beginPath();const p=a/r.length;let h=0;for(let m=0;m<r.length;m++){const g=r[m]/128*n/2;m===0?i.moveTo(h,g):i.lineTo(h,g),h+=p}i.lineTo(a,n/2),i.stroke()}function u(){if(e.getByteFrequencyData(s),!i)return;i.fillStyle="#000",i.fillRect(0,0,a,n),i.fillStyle="rgba(255,255,255,0.2)",i.fillRect(0,0,1,n),i.fillRect(a-1,0,1,n);const p=128,h=2,m=[];for(let y=0;y<p;y++)m.push(y*a/(p-1));m[m.length-1]=a-1;for(let y=0;y<p;y++){const g=m[y],v=y<p-1?m[y+1]:a,b=Math.max(1,v-g-h),N=20,S=2e4,G=y/(p-1),M=N*Math.pow(S/N,G),F=Math.min(s.length-1,Math.floor(M/22050*s.length)),L=s[F]/255,I=Math.max(1,L*n),R=240-G*240;i.fillStyle=`hsl(${R}, ${80+L*20}%, ${40+L*40}%)`,i.fillRect(g,n-I,b,I)}}function _(){if(e.getByteFrequencyData(s),!o)return;d.initialized||(o.fillStyle="#000",o.fillRect(0,0,a,n),d.initialized=!0),o.drawImage(d,-1,0),o.fillStyle="#000",o.fillRect(a-1,0,1,n);const p=128,h=20,m=2e4;for(let y=0;y<p;y++){const g=y/(p-1),v=h*Math.pow(m/h,g),N=Math.min(s.length-1,Math.floor(v/22050*s.length)),S=s[N]/255,G=n-1-Math.floor(y*n/p);if(S<.05)continue;const M=Math.floor(S*255),w=Math.floor(S*(255-g*200)),F=Math.floor(S*(100+g*155));o.fillStyle=`rgb(${M}, ${w}, ${F})`,o.fillRect(a-1,G,1,1)}i&&(i.fillStyle="#000",i.fillRect(0,0,a,n),i.drawImage(d,0,0))}function f(){switch(requestAnimationFrame(f),c){case"frequency":u();break;case"spectrogram":_();break;case"waveform":default:l()}}return f(),{setMode(p){["waveform","frequency","spectrogram"].includes(p)&&(c=p,i.clearRect(0,0,a,n),c==="spectrogram"&&o.clearRect(0,0,a,n))}}}function Nd(e,t){const i=Sd(ki(),e),a=[{name:"waveform",emoji:"ðŸŒŠ"},{name:"frequency",emoji:"ðŸ“Š"},{name:"spectrogram",emoji:"ðŸŒˆ"}];let n=0;function r(){n=(n+1)%a.length;const{name:s,emoji:d}=a[n];i.setMode(s),t.textContent=d,t.title=`Mode: ${s}`}t.addEventListener("click",r),r()}function Bd(){var u;const e=document.getElementById("global-mini-expand-btn"),t=document.getElementById("global-mini-contour"),i=document.getElementById("global-mini-playhead"),a=(u=t==null?void 0:t.parentElement)==null?void 0:u.parentElement,n=t==null?void 0:t.parentElement,r=e==null?void 0:e.querySelector("svg use"),s=document.querySelector(".footer-spacer"),d=40;let o=!1;function c(_,f){const p=_.offsetWidth;_.style.height=`${f}px`,_.height=f,_.width=p}if(!e||!t||!i||!a||!n||!r||!s){console.warn("FooterUI: One or more elements not found.");return}a.style.height=`${d}px`,n.style.height=`${d}px`,c(t,d),c(i,d),re(t,Ee());function l(){o=!o;const _=o?200:40;!a||!n||!t||!i||!r||!s||(a.style.height=`${_}px`,n.style.height=`${_}px`,c(t,_),c(i,_),r.setAttribute("href",o?"#icon-caret-down":"#icon-caret-up"),s.style.height=`${_-40+140}px`,re(t,Ee()))}e.addEventListener("click",l)}function Cd(e){if(!e.sequencers.length)throw new Error("No tracks to export.");const t=e.tempo,i=e.timeSignature[0],a=e.totalMeasures,n={v:3,t:new Date().toISOString(),c:{b:t,bpm:i,tm:a},i:e.sequencers.map(s=>s.instrument||"sf2/fluidr3-gm/acoustic_grand_piano"),vlm:e.sequencers.map(s=>s.volume??100/127),pan:e.sequencers.map(s=>s.pan??0),tr:e.sequencers.map(s=>({n:s.notes.map(d=>[d.pitch,d.start,d.duration])}))},r=new Blob([JSON.stringify(n)],{type:"application/json"});return{url:URL.createObjectURL(r),filename:`session-${Date.now()}.json`}}async function Gd(e){if(!e.tracks||e.tracks.length===0)throw new Error("No tracks to export.");const i=60/xe(),a=Math.max(...e.tracks.flatMap(l=>l.notes.map(u=>(u.start+u.duration)*i+.2))),n=44100,r=new OfflineAudioContext(2,Math.ceil(n*a),n);for(const l of e.tracks){const u=l.instrument||"sf2/fluidr3-gm/acoustic_grand_piano",_=new Ea(null,l.config,r,r.destination,u);_.setState(l),await _.exportToOffline()}const s=await r.startRendering(),d=Ld(s),o=URL.createObjectURL(d),c=document.createElement("a");c.href=o,c.download=`session-${Date.now()}.wav`,c.click(),URL.revokeObjectURL(o)}function Ld(e){const t=e.numberOfChannels,i=e.length*t*2,a=new DataView(new ArrayBuffer(44+i)),n=(s,d)=>{for(let o=0;o<d.length;o++)a.setUint8(s+o,d.charCodeAt(o))};n(0,"RIFF"),a.setUint32(4,36+i,!0),n(8,"WAVE"),n(12,"fmt "),a.setUint32(16,16,!0),a.setUint16(20,1,!0),a.setUint16(22,t,!0),a.setUint32(24,e.sampleRate,!0),a.setUint32(28,e.sampleRate*t*2,!0),a.setUint16(32,t*2,!0),a.setUint16(34,16,!0),n(36,"data"),a.setUint32(40,i,!0);let r=44;for(let s=0;s<e.length;s++)for(let d=0;d<t;d++){const o=e.getChannelData(d)[s],c=Math.max(-1,Math.min(1,o));a.setInt16(r,c*32767,!0),r+=2}return new Blob([a.buffer],{type:"audio/wav"})}function Md(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var i=function a(){return this instanceof a?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};i.prototype=t.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(e).forEach(function(a){var n=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(i,a,n.get?n:{enumerable:!0,get:function(){return e[a]}})}),i}var Pe={},Kt={},yi,Rr;function wd(){if(Rr)return yi;Rr=1;function e(n){var r=new a(n),s=r.readChunk();if(s.id!="MThd")throw"Bad MIDI file.  Expected 'MHdr', got: '"+s.id+"'";for(var d=t(s.data),o=[],c=0;!r.eof()&&c<d.numTracks;c++){var l=r.readChunk();if(l.id!="MTrk")throw"Bad MIDI file.  Expected 'MTrk', got: '"+l.id+"'";var u=i(l.data);o.push(u)}return{header:d,tracks:o}}function t(n){var r=new a(n),s=r.readUInt16(),d=r.readUInt16(),o={format:s,numTracks:d},c=r.readUInt16();return c&32768?(o.framesPerSecond=256-(c>>8),o.ticksPerFrame=c&255):o.ticksPerBeat=c,o}function i(n){for(var r=new a(n),s=[];!r.eof();){var d=c();s.push(d)}return s;var o;function c(){var l={};l.deltaTime=r.readVarInt();var u=r.readUInt8();if((u&240)===240)if(u===255){l.meta=!0;var _=r.readUInt8(),f=r.readVarInt();switch(_){case 0:if(l.type="sequenceNumber",f!==2)throw"Expected length for sequenceNumber event is 2, got "+f;return l.number=r.readUInt16(),l;case 1:return l.type="text",l.text=r.readString(f),l;case 2:return l.type="copyrightNotice",l.text=r.readString(f),l;case 3:return l.type="trackName",l.text=r.readString(f),l;case 4:return l.type="instrumentName",l.text=r.readString(f),l;case 5:return l.type="lyrics",l.text=r.readString(f),l;case 6:return l.type="marker",l.text=r.readString(f),l;case 7:return l.type="cuePoint",l.text=r.readString(f),l;case 32:if(l.type="channelPrefix",f!=1)throw"Expected length for channelPrefix event is 1, got "+f;return l.channel=r.readUInt8(),l;case 33:if(l.type="portPrefix",f!=1)throw"Expected length for portPrefix event is 1, got "+f;return l.port=r.readUInt8(),l;case 47:if(l.type="endOfTrack",f!=0)throw"Expected length for endOfTrack event is 0, got "+f;return l;case 81:if(l.type="setTempo",f!=3)throw"Expected length for setTempo event is 3, got "+f;return l.microsecondsPerBeat=r.readUInt24(),l;case 84:if(l.type="smpteOffset",f!=5)throw"Expected length for smpteOffset event is 5, got "+f;var p=r.readUInt8(),h={0:24,32:25,64:29,96:30};return l.frameRate=h[p&96],l.hour=p&31,l.min=r.readUInt8(),l.sec=r.readUInt8(),l.frame=r.readUInt8(),l.subFrame=r.readUInt8(),l;case 88:if(l.type="timeSignature",f!=2&&f!=4)throw"Expected length for timeSignature event is 4 or 2, got "+f;return l.numerator=r.readUInt8(),l.denominator=1<<r.readUInt8(),f===4?(l.metronome=r.readUInt8(),l.thirtyseconds=r.readUInt8()):(l.metronome=36,l.thirtyseconds=8),l;case 89:if(l.type="keySignature",f!=2)throw"Expected length for keySignature event is 2, got "+f;return l.key=r.readInt8(),l.scale=r.readUInt8(),l;case 127:return l.type="sequencerSpecific",l.data=r.readBytes(f),l;default:return l.type="unknownMeta",l.data=r.readBytes(f),l.metatypeByte=_,l}}else if(u==240){l.type="sysEx";var f=r.readVarInt();return l.data=r.readBytes(f),l}else if(u==247){l.type="endSysEx";var f=r.readVarInt();return l.data=r.readBytes(f),l}else throw"Unrecognised MIDI event type byte: "+u;else{var m;if((u&128)===0){if(o===null)throw"Running status byte encountered before status byte";m=u,u=o,l.running=!0}else m=r.readUInt8(),o=u;var y=u>>4;switch(l.channel=u&15,y){case 8:return l.type="noteOff",l.noteNumber=m,l.velocity=r.readUInt8(),l;case 9:var g=r.readUInt8();return l.type=g===0?"noteOff":"noteOn",l.noteNumber=m,l.velocity=g,g===0&&(l.byte9=!0),l;case 10:return l.type="noteAftertouch",l.noteNumber=m,l.amount=r.readUInt8(),l;case 11:return l.type="controller",l.controllerType=m,l.value=r.readUInt8(),l;case 12:return l.type="programChange",l.programNumber=m,l;case 13:return l.type="channelAftertouch",l.amount=m,l;case 14:return l.type="pitchBend",l.value=m+(r.readUInt8()<<7)-8192,l;default:throw"Unrecognised MIDI event type: "+y}}}}function a(n){this.buffer=n,this.bufferLen=this.buffer.length,this.pos=0}return a.prototype.eof=function(){return this.pos>=this.bufferLen},a.prototype.readUInt8=function(){var n=this.buffer[this.pos];return this.pos+=1,n},a.prototype.readInt8=function(){var n=this.readUInt8();return n&128?n-256:n},a.prototype.readUInt16=function(){var n=this.readUInt8(),r=this.readUInt8();return(n<<8)+r},a.prototype.readInt16=function(){var n=this.readUInt16();return n&32768?n-65536:n},a.prototype.readUInt24=function(){var n=this.readUInt8(),r=this.readUInt8(),s=this.readUInt8();return(n<<16)+(r<<8)+s},a.prototype.readInt24=function(){var n=this.readUInt24();return n&8388608?n-16777216:n},a.prototype.readUInt32=function(){var n=this.readUInt8(),r=this.readUInt8(),s=this.readUInt8(),d=this.readUInt8();return(n<<24)+(r<<16)+(s<<8)+d},a.prototype.readBytes=function(n){var r=this.buffer.slice(this.pos,this.pos+n);return this.pos+=n,r},a.prototype.readString=function(n){var r=this.readBytes(n);return String.fromCharCode.apply(null,r)},a.prototype.readVarInt=function(){for(var n=0;!this.eof();){var r=this.readUInt8();if(r&128)n+=r&127,n<<=7;else return n+r}return n},a.prototype.readChunk=function(){var n=this.readString(4),r=this.readUInt32(),s=this.readBytes(r);return{id:n,length:r,data:s}},yi=e,yi}var hi,Ur;function Ed(){if(Ur)return hi;Ur=1;function e(r,s){if(typeof r!="object")throw"Invalid MIDI data";s=s||{};var d=r.header||{},o=r.tracks||[],c,l=o.length,u=new n;for(t(u,d,l),c=0;c<l;c++)i(u,o[c],s);return u.buffer}function t(r,s,d){var o=s.format==null?1:s.format,c=128;s.timeDivision?c=s.timeDivision:s.ticksPerFrame&&s.framesPerSecond?c=-(s.framesPerSecond&255)<<8|s.ticksPerFrame&255:s.ticksPerBeat&&(c=s.ticksPerBeat&32767);var l=new n;l.writeUInt16(o),l.writeUInt16(d),l.writeUInt16(c),r.writeChunk("MThd",l.buffer)}function i(r,s,d){var o=new n,c,l=s.length,u=null;for(c=0;c<l;c++)(d.running===!1||!d.running&&!s[c].running)&&(u=null),u=a(o,s[c],u,d.useByte9ForNoteOff);r.writeChunk("MTrk",o.buffer)}function a(r,s,d,o){var c=s.type,l=s.deltaTime,u=s.text||"",_=s.data||[],f=null;switch(r.writeVarInt(l),c){case"sequenceNumber":r.writeUInt8(255),r.writeUInt8(0),r.writeVarInt(2),r.writeUInt16(s.number);break;case"text":r.writeUInt8(255),r.writeUInt8(1),r.writeVarInt(u.length),r.writeString(u);break;case"copyrightNotice":r.writeUInt8(255),r.writeUInt8(2),r.writeVarInt(u.length),r.writeString(u);break;case"trackName":r.writeUInt8(255),r.writeUInt8(3),r.writeVarInt(u.length),r.writeString(u);break;case"instrumentName":r.writeUInt8(255),r.writeUInt8(4),r.writeVarInt(u.length),r.writeString(u);break;case"lyrics":r.writeUInt8(255),r.writeUInt8(5),r.writeVarInt(u.length),r.writeString(u);break;case"marker":r.writeUInt8(255),r.writeUInt8(6),r.writeVarInt(u.length),r.writeString(u);break;case"cuePoint":r.writeUInt8(255),r.writeUInt8(7),r.writeVarInt(u.length),r.writeString(u);break;case"channelPrefix":r.writeUInt8(255),r.writeUInt8(32),r.writeVarInt(1),r.writeUInt8(s.channel);break;case"portPrefix":r.writeUInt8(255),r.writeUInt8(33),r.writeVarInt(1),r.writeUInt8(s.port);break;case"endOfTrack":r.writeUInt8(255),r.writeUInt8(47),r.writeVarInt(0);break;case"setTempo":r.writeUInt8(255),r.writeUInt8(81),r.writeVarInt(3),r.writeUInt24(s.microsecondsPerBeat);break;case"smpteOffset":r.writeUInt8(255),r.writeUInt8(84),r.writeVarInt(5);var p={24:0,25:32,29:64,30:96},h=s.hour&31|p[s.frameRate];r.writeUInt8(h),r.writeUInt8(s.min),r.writeUInt8(s.sec),r.writeUInt8(s.frame),r.writeUInt8(s.subFrame);break;case"timeSignature":r.writeUInt8(255),r.writeUInt8(88),r.writeVarInt(4),r.writeUInt8(s.numerator);var m=Math.floor(Math.log(s.denominator)/Math.LN2)&255;r.writeUInt8(m),r.writeUInt8(s.metronome),r.writeUInt8(s.thirtyseconds||8);break;case"keySignature":r.writeUInt8(255),r.writeUInt8(89),r.writeVarInt(2),r.writeInt8(s.key),r.writeUInt8(s.scale);break;case"sequencerSpecific":r.writeUInt8(255),r.writeUInt8(127),r.writeVarInt(_.length),r.writeBytes(_);break;case"unknownMeta":s.metatypeByte!=null&&(r.writeUInt8(255),r.writeUInt8(s.metatypeByte),r.writeVarInt(_.length),r.writeBytes(_));break;case"sysEx":r.writeUInt8(240),r.writeVarInt(_.length),r.writeBytes(_);break;case"endSysEx":r.writeUInt8(247),r.writeVarInt(_.length),r.writeBytes(_);break;case"noteOff":var y=o!==!1&&s.byte9||o&&s.velocity==0?144:128;f=y|s.channel,f!==d&&r.writeUInt8(f),r.writeUInt8(s.noteNumber),r.writeUInt8(s.velocity);break;case"noteOn":f=144|s.channel,f!==d&&r.writeUInt8(f),r.writeUInt8(s.noteNumber),r.writeUInt8(s.velocity);break;case"noteAftertouch":f=160|s.channel,f!==d&&r.writeUInt8(f),r.writeUInt8(s.noteNumber),r.writeUInt8(s.amount);break;case"controller":f=176|s.channel,f!==d&&r.writeUInt8(f),r.writeUInt8(s.controllerType),r.writeUInt8(s.value);break;case"programChange":f=192|s.channel,f!==d&&r.writeUInt8(f),r.writeUInt8(s.programNumber);break;case"channelAftertouch":f=208|s.channel,f!==d&&r.writeUInt8(f),r.writeUInt8(s.amount);break;case"pitchBend":f=224|s.channel,f!==d&&r.writeUInt8(f);var g=8192+s.value,v=g&127,b=g>>7&127;r.writeUInt8(v),r.writeUInt8(b);break;default:throw"Unrecognized event type: "+c}return f}function n(){this.buffer=[]}return n.prototype.writeUInt8=function(r){this.buffer.push(r&255)},n.prototype.writeInt8=n.prototype.writeUInt8,n.prototype.writeUInt16=function(r){var s=r>>8&255,d=r&255;this.writeUInt8(s),this.writeUInt8(d)},n.prototype.writeInt16=n.prototype.writeUInt16,n.prototype.writeUInt24=function(r){var s=r>>16&255,d=r>>8&255,o=r&255;this.writeUInt8(s),this.writeUInt8(d),this.writeUInt8(o)},n.prototype.writeInt24=n.prototype.writeUInt24,n.prototype.writeUInt32=function(r){var s=r>>24&255,d=r>>16&255,o=r>>8&255,c=r&255;this.writeUInt8(s),this.writeUInt8(d),this.writeUInt8(o),this.writeUInt8(c)},n.prototype.writeInt32=n.prototype.writeUInt32,n.prototype.writeBytes=function(r){this.buffer=this.buffer.concat(Array.prototype.slice.call(r,0))},n.prototype.writeString=function(r){var s,d=r.length,o=[];for(s=0;s<d;s++)o.push(r.codePointAt(s));this.writeBytes(o)},n.prototype.writeVarInt=function(r){if(r<0)throw"Cannot write negative variable-length integer";if(r<=127)this.writeUInt8(r);else{var s=r,d=[];for(d.push(s&127),s>>=7;s;){var o=s&127|128;d.push(o),s>>=7}this.writeBytes(d.reverse())}},n.prototype.writeChunk=function(r,s){this.writeString(r),this.writeUInt32(s.length),this.writeBytes(s)},hi=e,hi}var Dr;function rn(){return Dr||(Dr=1,Kt.parseMidi=wd(),Kt.writeMidi=Ed()),Kt}var bi={},Ae={},Jr;function an(){if(Jr)return Ae;Jr=1,Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.insert=Ae.search=void 0;function e(i,a,n){n===void 0&&(n="ticks");var r=0,s=i.length,d=s;if(s>0&&i[s-1][n]<=a)return s-1;for(;r<d;){var o=Math.floor(r+(d-r)/2),c=i[o],l=i[o+1];if(c[n]===a){for(var u=o;u<i.length;u++){var _=i[u];_[n]===a&&(o=u)}return o}else{if(c[n]<a&&l[n]>a)return o;c[n]>a?d=o:c[n]<a&&(r=o+1)}}return-1}Ae.search=e;function t(i,a,n){if(n===void 0&&(n="ticks"),i.length){var r=e(i,a[n],n);i.splice(r+1,0,a)}else i.push(a)}return Ae.insert=t,Ae}var xr;function Oi(){return xr||(xr=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Header=e.keySignatureKeys=void 0;var t=an(),i=new WeakMap;e.keySignatureKeys=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];var a=function(){function n(r){var s=this;if(this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",i.set(this,480),r){i.set(this,r.header.ticksPerBeat),r.tracks.forEach(function(o){o.forEach(function(c){c.meta&&(c.type==="timeSignature"?s.timeSignatures.push({ticks:c.absoluteTime,timeSignature:[c.numerator,c.denominator]}):c.type==="setTempo"?s.tempos.push({bpm:6e7/c.microsecondsPerBeat,ticks:c.absoluteTime}):c.type==="keySignature"&&s.keySignatures.push({key:e.keySignatureKeys[c.key+7],scale:c.scale===0?"major":"minor",ticks:c.absoluteTime}))})});var d=0;r.tracks[0].forEach(function(o){d+=o.deltaTime,o.meta&&(o.type==="trackName"?s.name=o.text:(o.type==="text"||o.type==="cuePoint"||o.type==="marker"||o.type==="lyrics")&&s.meta.push({text:o.text,ticks:d,type:o.type}))}),this.update()}}return n.prototype.update=function(){var r=this,s=0,d=0;this.tempos.sort(function(o,c){return o.ticks-c.ticks}),this.tempos.forEach(function(o,c){var l=c>0?r.tempos[c-1].bpm:r.tempos[0].bpm,u=o.ticks/r.ppq-d,_=60/l*u;o.time=_+s,s=o.time,d+=u}),this.timeSignatures.sort(function(o,c){return o.ticks-c.ticks}),this.timeSignatures.forEach(function(o,c){var l=c>0?r.timeSignatures[c-1]:r.timeSignatures[0],u=(o.ticks-l.ticks)/r.ppq,_=u/l.timeSignature[0]/(l.timeSignature[1]/4);l.measures=l.measures||0,o.measures=_+l.measures})},n.prototype.ticksToSeconds=function(r){var s=(0,t.search)(this.tempos,r);if(s!==-1){var d=this.tempos[s],o=d.time,c=(r-d.ticks)/this.ppq;return o+60/d.bpm*c}else{var l=r/this.ppq;return 60/120*l}},n.prototype.ticksToMeasures=function(r){var s=(0,t.search)(this.timeSignatures,r);if(s!==-1){var d=this.timeSignatures[s],o=(r-d.ticks)/this.ppq;return d.measures+o/(d.timeSignature[0]/d.timeSignature[1])/4}else return r/this.ppq/4},Object.defineProperty(n.prototype,"ppq",{get:function(){return i.get(this)},enumerable:!1,configurable:!0}),n.prototype.secondsToTicks=function(r){var s=(0,t.search)(this.tempos,r,"time");if(s!==-1){var d=this.tempos[s],o=d.time,c=r-o,l=c/(60/d.bpm);return Math.round(d.ticks+l*this.ppq)}else{var u=r/.5;return Math.round(u*this.ppq)}},n.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map(function(r){return{bpm:r.bpm,ticks:r.ticks}}),timeSignatures:this.timeSignatures}},n.prototype.fromJSON=function(r){this.name=r.name,this.tempos=r.tempos.map(function(s){return Object.assign({},s)}),this.timeSignatures=r.timeSignatures.map(function(s){return Object.assign({},s)}),this.keySignatures=r.keySignatures.map(function(s){return Object.assign({},s)}),this.meta=r.meta.map(function(s){return Object.assign({},s)}),i.set(this,r.ppq),this.update()},n.prototype.setTempo=function(r){this.tempos=[{bpm:r,ticks:0}],this.update()},n}();e.Header=a}(bi)),bi}var ct={},gi={},qr;function nn(){return qr||(qr=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ControlChange=e.controlChangeIds=e.controlChangeNames=void 0,e.controlChangeNames={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"},e.controlChangeIds=Object.keys(e.controlChangeNames).reduce(function(n,r){return n[e.controlChangeNames[r]]=r,n},{});var t=new WeakMap,i=new WeakMap,a=function(){function n(r,s){t.set(this,s),i.set(this,r.controllerType),this.ticks=r.absoluteTime,this.value=r.value}return Object.defineProperty(n.prototype,"number",{get:function(){return i.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"name",{get:function(){return e.controlChangeNames[this.number]?e.controlChangeNames[this.number]:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"time",{get:function(){var r=t.get(this);return r.ticksToSeconds(this.ticks)},set:function(r){var s=t.get(this);this.ticks=s.secondsToTicks(r)},enumerable:!1,configurable:!0}),n.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},n}();e.ControlChange=a}(gi)),gi}var ut={},Hr;function Fd(){if(Hr)return ut;Hr=1,Object.defineProperty(ut,"__esModule",{value:!0}),ut.createControlChanges=void 0;var e=nn();function t(){return new Proxy({},{get:function(i,a){if(i[a])return i[a];if(e.controlChangeIds.hasOwnProperty(a))return i[e.controlChangeIds[a]]},set:function(i,a,n){return e.controlChangeIds.hasOwnProperty(a)?i[e.controlChangeIds[a]]=n:i[a]=n,!0}})}return ut.createControlChanges=t,ut}var ft={},$r;function Pd(){if($r)return ft;$r=1,Object.defineProperty(ft,"__esModule",{value:!0}),ft.PitchBend=void 0;var e=new WeakMap,t=function(){function i(a,n){e.set(this,n),this.ticks=a.absoluteTime,this.value=a.value}return Object.defineProperty(i.prototype,"time",{get:function(){var a=e.get(this);return a.ticksToSeconds(this.ticks)},set:function(a){var n=e.get(this);this.ticks=n.secondsToTicks(a)},enumerable:!1,configurable:!0}),i.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},i}();return ft.PitchBend=t,ft}var _t={},_e={},Kr;function Ad(){return Kr||(Kr=1,Object.defineProperty(_e,"__esModule",{value:!0}),_e.DrumKitByPatchID=_e.InstrumentFamilyByID=_e.instrumentByPatchID=void 0,_e.instrumentByPatchID=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"],_e.InstrumentFamilyByID=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"],_e.DrumKitByPatchID={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"}),_e}var Wr;function kd(){if(Wr)return _t;Wr=1,Object.defineProperty(_t,"__esModule",{value:!0}),_t.Instrument=void 0;var e=Ad(),t=new WeakMap,i=function(){function a(n,r){if(this.number=0,t.set(this,r),this.number=0,n){var s=n.find(function(d){return d.type==="programChange"});s&&(this.number=s.programNumber)}}return Object.defineProperty(a.prototype,"name",{get:function(){return this.percussion?e.DrumKitByPatchID[this.number]:e.instrumentByPatchID[this.number]},set:function(n){var r=e.instrumentByPatchID.indexOf(n);r!==-1&&(this.number=r)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"family",{get:function(){return this.percussion?"drums":e.InstrumentFamilyByID[Math.floor(this.number/8)]},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"percussion",{get:function(){var n=t.get(this);return n.channel===9},enumerable:!1,configurable:!0}),a.prototype.toJSON=function(){return{family:this.family,number:this.number,name:this.name}},a.prototype.fromJSON=function(n){this.number=n.number},a}();return _t.Instrument=i,_t}var pt={},Xr;function Id(){if(Xr)return pt;Xr=1,Object.defineProperty(pt,"__esModule",{value:!0}),pt.Note=void 0;function e(s){var d=Math.floor(s/12)-1;return t(s)+d.toString()}function t(s){var d=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],o=s%12;return d[o]}function i(s){var d=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return d.indexOf(s)}var a=function(){var s=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,d={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13};return function(o){var c=s.exec(o),l=c[1],u=c[2],_=d[l.toLowerCase()];return _+(parseInt(u,10)+1)*12}}(),n=new WeakMap,r=function(){function s(d,o,c){n.set(this,c),this.midi=d.midi,this.velocity=d.velocity,this.noteOffVelocity=o.velocity,this.ticks=d.ticks,this.durationTicks=o.ticks-d.ticks}return Object.defineProperty(s.prototype,"name",{get:function(){return e(this.midi)},set:function(d){this.midi=a(d)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(d){var o=d-this.octave;this.midi+=o*12},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"pitch",{get:function(){return t(this.midi)},set:function(d){this.midi=12*(this.octave+1)+i(d)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"duration",{get:function(){var d=n.get(this);return d.ticksToSeconds(this.ticks+this.durationTicks)-d.ticksToSeconds(this.ticks)},set:function(d){var o=n.get(this),c=o.secondsToTicks(this.time+d);this.durationTicks=c-this.ticks},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"time",{get:function(){var d=n.get(this);return d.ticksToSeconds(this.ticks)},set:function(d){var o=n.get(this);this.ticks=o.secondsToTicks(d)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"bars",{get:function(){var d=n.get(this);return d.ticksToMeasures(this.ticks)},enumerable:!1,configurable:!0}),s.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},s}();return pt.Note=r,pt}var zr;function jr(){if(zr)return ct;zr=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.Track=void 0;var e=an(),t=nn(),i=Fd(),a=Pd(),n=kd(),r=Id(),s=new WeakMap,d=function(){function o(c,l){var u=this;if(this.name="",this.notes=[],this.controlChanges=(0,i.createControlChanges)(),this.pitchBends=[],s.set(this,l),c){var _=c.find(function(b){return b.type==="trackName"});this.name=_?_.text:""}if(this.instrument=new n.Instrument(c,this),this.channel=0,c){for(var f=c.filter(function(b){return b.type==="noteOn"}),p=c.filter(function(b){return b.type==="noteOff"}),h=function(){var b=f.shift();m.channel=b.channel;var N=p.findIndex(function(G){return G.noteNumber===b.noteNumber&&G.absoluteTime>=b.absoluteTime});if(N!==-1){var S=p.splice(N,1)[0];m.addNote({durationTicks:S.absoluteTime-b.absoluteTime,midi:b.noteNumber,noteOffVelocity:S.velocity/127,ticks:b.absoluteTime,velocity:b.velocity/127})}},m=this;f.length;)h();var y=c.filter(function(b){return b.type==="controller"});y.forEach(function(b){u.addCC({number:b.controllerType,ticks:b.absoluteTime,value:b.value/127})});var g=c.filter(function(b){return b.type==="pitchBend"});g.forEach(function(b){u.addPitchBend({ticks:b.absoluteTime,value:b.value/Math.pow(2,13)})});var v=c.find(function(b){return b.type==="endOfTrack"});this.endOfTrackTicks=v!==void 0?v.absoluteTime:void 0}}return o.prototype.addNote=function(c){var l=s.get(this),u=new r.Note({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},l);return Object.assign(u,c),(0,e.insert)(this.notes,u,"ticks"),this},o.prototype.addCC=function(c){var l=s.get(this),u=new t.ControlChange({controllerType:c.number},l);return delete c.number,Object.assign(u,c),Array.isArray(this.controlChanges[u.number])||(this.controlChanges[u.number]=[]),(0,e.insert)(this.controlChanges[u.number],u,"ticks"),this},o.prototype.addPitchBend=function(c){var l=s.get(this),u=new a.PitchBend({},l);return Object.assign(u,c),(0,e.insert)(this.pitchBends,u,"ticks"),this},Object.defineProperty(o.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var c=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,l=0;l<this.notes.length-1;l++){var u=this.notes[l].time+this.notes[l].duration;c<u&&(c=u)}return c},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var c=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,l=0;l<this.notes.length-1;l++){var u=this.notes[l].ticks+this.notes[l].durationTicks;c<u&&(c=u)}return c},enumerable:!1,configurable:!0}),o.prototype.fromJSON=function(c){var l=this;this.name=c.name,this.channel=c.channel,this.instrument=new n.Instrument(void 0,this),this.instrument.fromJSON(c.instrument),c.endOfTrackTicks!==void 0&&(this.endOfTrackTicks=c.endOfTrackTicks);for(var u in c.controlChanges)c.controlChanges[u]&&c.controlChanges[u].forEach(function(_){l.addCC({number:_.number,ticks:_.ticks,value:_.value})});c.notes.forEach(function(_){l.addNote({durationTicks:_.durationTicks,midi:_.midi,ticks:_.ticks,velocity:_.velocity})})},o.prototype.toJSON=function(){for(var c={},l=0;l<127;l++)this.controlChanges.hasOwnProperty(l)&&(c[l]=this.controlChanges[l].map(function(_){return _.toJSON()}));var u={channel:this.channel,controlChanges:c,pitchBends:this.pitchBends.map(function(_){return _.toJSON()}),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map(function(_){return _.toJSON()})};return this.endOfTrackTicks!==void 0&&(u.endOfTrackTicks=this.endOfTrackTicks),u},o}();return ct.Track=d,ct}var ke={};function Od(e){var t=[];return sn(e,t),t}function sn(e,t){for(var i=0;i<e.length;i++){var a=e[i];Array.isArray(a)?sn(a,t):t.push(a)}}const Td=Object.freeze(Object.defineProperty({__proto__:null,flatten:Od},Symbol.toStringTag,{value:"Module"})),Rd=Md(Td);var Vr;function Ud(){if(Vr)return ke;Vr=1;var e=ke&&ke.__spreadArray||function(y,g,v){if(v||arguments.length===2)for(var b=0,N=g.length,S;b<N;b++)(S||!(b in g))&&(S||(S=Array.prototype.slice.call(g,0,b)),S[b]=g[b]);return y.concat(S||Array.prototype.slice.call(g))};Object.defineProperty(ke,"__esModule",{value:!0}),ke.encode=void 0;var t=rn(),i=Oi(),a=Rd;function n(y,g){return[{absoluteTime:y.ticks,channel:g,deltaTime:0,noteNumber:y.midi,type:"noteOn",velocity:Math.floor(y.velocity*127)},{absoluteTime:y.ticks+y.durationTicks,channel:g,deltaTime:0,noteNumber:y.midi,type:"noteOff",velocity:Math.floor(y.noteOffVelocity*127)}]}function r(y){return(0,a.flatten)(y.notes.map(function(g){return n(g,y.channel)}))}function s(y,g){return{absoluteTime:y.ticks,channel:g,controllerType:y.number,deltaTime:0,type:"controller",value:Math.floor(y.value*127)}}function d(y){for(var g=[],v=0;v<127;v++)y.controlChanges.hasOwnProperty(v)&&y.controlChanges[v].forEach(function(b){g.push(s(b,y.channel))});return g}function o(y,g){return{absoluteTime:y.ticks,channel:g,deltaTime:0,type:"pitchBend",value:y.value}}function c(y){var g=[];return y.pitchBends.forEach(function(v){g.push(o(v,y.channel))}),g}function l(y){return{absoluteTime:0,channel:y.channel,deltaTime:0,programNumber:y.instrument.number,type:"programChange"}}function u(y){return{absoluteTime:0,deltaTime:0,meta:!0,text:y,type:"trackName"}}function _(y){return{absoluteTime:y.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/y.bpm),type:"setTempo"}}function f(y){return{absoluteTime:y.ticks,deltaTime:0,denominator:y.timeSignature[1],meta:!0,metronome:24,numerator:y.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}function p(y){var g=i.keySignatureKeys.indexOf(y.key);return{absoluteTime:y.ticks,deltaTime:0,key:g+7,meta:!0,scale:y.scale==="major"?0:1,type:"keySignature"}}function h(y){return{absoluteTime:y.ticks,deltaTime:0,meta:!0,text:y.text,type:y.type}}function m(y){var g={header:{format:1,numTracks:y.tracks.length+1,ticksPerBeat:y.header.ppq},tracks:e([e(e(e(e([{absoluteTime:0,deltaTime:0,meta:!0,text:y.header.name,type:"trackName"}],y.header.keySignatures.map(function(v){return p(v)}),!0),y.header.meta.map(function(v){return h(v)}),!0),y.header.tempos.map(function(v){return _(v)}),!0),y.header.timeSignatures.map(function(v){return f(v)}),!0)],y.tracks.map(function(v){return e(e(e([u(v.name),l(v)],r(v),!0),d(v),!0),c(v),!0)}),!0)};return g.tracks=g.tracks.map(function(v){v=v.sort(function(N,S){return N.absoluteTime-S.absoluteTime});var b=0;return v.forEach(function(N){N.deltaTime=N.absoluteTime-b,b=N.absoluteTime,delete N.absoluteTime}),v.push({deltaTime:0,meta:!0,type:"endOfTrack"}),v}),new Uint8Array((0,t.writeMidi)(g))}return ke.encode=m,ke}var Yr;function Dd(){return Yr||(Yr=1,function(e){var t=Pe&&Pe.__awaiter||function(u,_,f,p){function h(m){return m instanceof f?m:new f(function(y){y(m)})}return new(f||(f=Promise))(function(m,y){function g(N){try{b(p.next(N))}catch(S){y(S)}}function v(N){try{b(p.throw(N))}catch(S){y(S)}}function b(N){N.done?m(N.value):h(N.value).then(g,v)}b((p=p.apply(u,_||[])).next())})},i=Pe&&Pe.__generator||function(u,_){var f={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},p,h,m,y;return y={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function g(b){return function(N){return v([b,N])}}function v(b){if(p)throw new TypeError("Generator is already executing.");for(;f;)try{if(p=1,h&&(m=b[0]&2?h.return:b[0]?h.throw||((m=h.return)&&m.call(h),0):h.next)&&!(m=m.call(h,b[1])).done)return m;switch(h=0,m&&(b=[b[0]&2,m.value]),b[0]){case 0:case 1:m=b;break;case 4:return f.label++,{value:b[1],done:!1};case 5:f.label++,h=b[1],b=[0];continue;case 7:b=f.ops.pop(),f.trys.pop();continue;default:if(m=f.trys,!(m=m.length>0&&m[m.length-1])&&(b[0]===6||b[0]===2)){f=0;continue}if(b[0]===3&&(!m||b[1]>m[0]&&b[1]<m[3])){f.label=b[1];break}if(b[0]===6&&f.label<m[1]){f.label=m[1],m=b;break}if(m&&f.label<m[2]){f.label=m[2],f.ops.push(b);break}m[2]&&f.ops.pop(),f.trys.pop();continue}b=_.call(u,f)}catch(N){b=[6,N],h=0}finally{p=m=0}if(b[0]&5)throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Header=e.Track=e.Midi=void 0;var a=rn(),n=Oi(),r=jr(),s=Ud(),d=function(){function u(_){var f=this,p=null;if(_){var h=_ instanceof ArrayBuffer?new Uint8Array(_):_;p=(0,a.parseMidi)(h),p.tracks.forEach(function(m){var y=0;m.forEach(function(g){y+=g.deltaTime,g.absoluteTime=y})}),p.tracks=l(p.tracks)}this.header=new n.Header(p),this.tracks=[],_&&(this.tracks=p.tracks.map(function(m){return new r.Track(m,f.header)}),p.header.format===1&&this.tracks[0].duration===0&&this.tracks.shift())}return u.fromUrl=function(_){return t(this,void 0,void 0,function(){var f,p;return i(this,function(h){switch(h.label){case 0:return[4,fetch(_)];case 1:return f=h.sent(),f.ok?[4,f.arrayBuffer()]:[3,3];case 2:return p=h.sent(),[2,new u(p)];case 3:throw new Error("Could not load '".concat(_,"'"))}})})},Object.defineProperty(u.prototype,"name",{get:function(){return this.header.name},set:function(_){this.header.name=_},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"duration",{get:function(){var _=this.tracks.map(function(f){return f.duration});return Math.max.apply(Math,_)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"durationTicks",{get:function(){var _=this.tracks.map(function(f){return f.durationTicks});return Math.max.apply(Math,_)},enumerable:!1,configurable:!0}),u.prototype.addTrack=function(){var _=new r.Track(void 0,this.header);return this.tracks.push(_),_},u.prototype.toArray=function(){return(0,s.encode)(this)},u.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map(function(_){return _.toJSON()})}},u.prototype.fromJSON=function(_){var f=this;this.header=new n.Header,this.header.fromJSON(_.header),this.tracks=_.tracks.map(function(p){var h=new r.Track(void 0,f.header);return h.fromJSON(p),h})},u.prototype.clone=function(){var _=new u;return _.fromJSON(this.toJSON()),_},u}();e.Midi=d;var o=jr();Object.defineProperty(e,"Track",{enumerable:!0,get:function(){return o.Track}});var c=Oi();Object.defineProperty(e,"Header",{enumerable:!0,get:function(){return c.Header}});function l(u){for(var _=[],f=0;f<u.length;f++)for(var p=_.length,h=new Map,m=Array(16).fill(0),y=0,g=u[f];y<g.length;y++){var v=g[y],b=p,N=v.channel;if(N!==void 0){v.type==="programChange"&&(m[N]=v.programNumber);var S=m[N],G="".concat(S," ").concat(N);h.has(G)?b=h.get(G):(b=p+h.size,h.set(G,b))}_[b]||_.push([]),_[b].push(v)}return _}}(Pe)),Pe}var ln=Dd();const on=["acoustic_grand_piano","bright_acoustic_piano","electric_grand_piano","honkytonk_piano","electric_piano_1","electric_piano_2","harpsichord","clavinet","celesta","glockenspiel","music_box","vibraphone","marimba","xylophone","tubular_bells","dulcimer","drawbar_organ","percussive_organ","rock_organ","church_organ","reed_organ","accordion","harmonica","tango_accordion","acoustic_guitar_nylon","acoustic_guitar_steel","electric_guitar_jazz","electric_guitar_clean","electric_guitar_muted","overdriven_guitar","distortion_guitar","guitar_harmonics","acoustic_bass","electric_bass_finger","electric_bass_pick","fretless_bass","slap_bass_1","slap_bass_2","synth_bass_1","synth_bass_2","violin","viola","cello","contrabass","tremolo_strings","pizzicato_strings","orchestral_harp","timpani","string_ensemble_1","string_ensemble_2","synth_strings_1","synth_strings_2","choir_aahs","voice_oohs","synth_choir","orchestra_hit","trumpet","trombone","tuba","muted_trumpet","french_horn","brass_section","synth_brass_1","synth_brass_2","soprano_sax","alto_sax","tenor_sax","baritone_sax","oboe","english_horn","bassoon","clarinet","piccolo","flute","recorder","pan_flute","blown_bottle","shakuhachi","whistle","ocarina","lead_1_square","lead_2_sawtooth","lead_3_calliope","lead_4_chiff","lead_5_charang","lead_6_voice","lead_7_fifths","lead_8_bass__lead","pad_1_new_age","pad_2_warm","pad_3_polysynth","pad_4_choir","pad_5_bowed","pad_6_metallic","pad_7_halo","pad_8_sweep","fx_1_rain","fx_2_soundtrack","fx_3_crystal","fx_4_atmosphere","fx_5_brightness","fx_6_goblins","fx_7_echoes","fx_8_scifi","sitar","banjo","shamisen","koto","kalimba","bagpipe","fiddle","shanai","tinkle_bell","agogo","steel_drums","woodblock","taiko_drum","melodic_tom","synth_drum","reverse_cymbal","guitar_fret_noise","breath_noise","seashore","bird_tweet","telephone_ring","helicopter","applause","gunshot"];function Jd(e){const t=e.split("/"),a=t[t.length-1].trim().toLowerCase().replace(/\s+/g,"_"),n=on.findIndex(r=>r===a);return n!==-1?n:(a.includes("drum")||a.includes("drummachine"),0)}async function xd(e){if(!e.sequencers.length)throw new Error("No tracks to export.");const t=new ln.Midi;t.header.setTempo(e.tempo),t.header.timeSignatures.push({ticks:0,timeSignature:e.timeSignature});for(const[n,r]of e.sequencers.entries()){const s=t.addTrack(),d=r.instrument.toLowerCase().includes("drum");s.channel=d?9:n%16;const o=Jd(r.instrument);if(s.instrument.number=o,typeof r.volume=="number"&&s.addCC({number:7,time:0,value:Math.max(0,Math.min(1,r.volume))}),typeof r.pan=="number"){const c=(r.pan+1)/2;s.addCC({number:10,time:0,value:Math.max(0,Math.min(1,c))})}for(const c of r.notes){const l=P(c.pitch);if(l===null)continue;const u=Qr(c.start,e.tempo),_=Qr(c.duration,e.tempo);s.addNote({midi:l,time:u,duration:_,velocity:.8})}}const i=new Blob([t.toArray()],{type:"audio/midi"});return{url:URL.createObjectURL(i),filename:`session-${Date.now()}.mid`}}function Qr(e,t){return 60/t*e}async function qd(e){var o,c,l;const t=await e.text();let i;try{i=JSON.parse(t)}catch{throw new Error("Invalid JSON format.")}if(!Array.isArray(i.tr))throw new Error("Missing or invalid `tr` (tracks) array.");const a={bpm:((o=i.c)==null?void 0:o.b)??120,beatsPerMeasure:((c=i.c)==null?void 0:c.bpm)??4,totalMeasures:((l=i.c)==null?void 0:l.tm)??8},n=Array.isArray(i.i)?i.i:[],r=Array.isArray(i.vlm)?i.vlm:[],s=Array.isArray(i.pan)?i.pan:[],d=i.tr.map((u,_)=>{if(!Array.isArray(u.n))throw new Error(`Track ${_} missing \`n\` (notes) array.`);const f=u.n.map(([y,g,v])=>({pitch:y,start:g,duration:v})),p=n[_]||"sf2/fluidr3-gm/acoustic_grand_piano",h=r[_],m=s[_];return{notes:f,instrument:p,volume:typeof h=="number"?h:void 0,pan:typeof m=="number"?m:void 0,config:{}}});return{globalConfig:a,tracks:d}}async function Hd(e){var f;const t=await e.arrayBuffer(),i=new ln.Midi(t),a=i.header.tempos[0],n=i.header.timeSignatures[0],r=(a==null?void 0:a.bpm)??120,s=((f=n==null?void 0:n.timeSignature)==null?void 0:f[0])??4,o=Math.max(0,...i.tracks.flatMap(p=>p.notes.map(h=>h.time+h.duration)))*(r/60),c=Math.ceil(o/s)||8,l={bpm:r,beatsPerMeasure:s,totalMeasures:c},u=await Yo(),_=i.tracks.map(p=>{const h=p.notes.map(S=>({pitch:S.name,start:S.time*(r/60),duration:S.duration*(r/60)}));let m=p.instrument.number;(m===void 0||m===0)&&(m=p.channel===9?0:p.channel%128);const y=p.controlChanges[7]||[],g=p.controlChanges[10]||[],v=y.length>0?y[0].value:void 0,b=g.length>0?g[0].value*2-1:void 0;let N;if(p.channel===9){const S=yl(m);S?N=`webaudiofont/${S.library}/${S.displayName}`:N=`sf2/drummachines/${u.includes("LM-2")?"LM-2":u[0]??"TR-808"}`}else N=`sf2/fluidr3-gm/${on[m]||"acoustic_grand_piano"}`;return{notes:h,instrument:N,volume:v,pan:b,config:{}}});return{globalConfig:l,tracks:_}}function $d(){for(const e of A){const t=e.container;if(!t)continue;const i=t.querySelector(".sequencer-body"),a=t.querySelector("canvas.mini-contour"),n=t.querySelector(".collapse-btn use");!i||!a||i.classList.contains("hidden")||(i.classList.add("hidden"),a.classList.remove("hidden"),n==null||n.setAttribute("href","#icon-caret-up"),At(t,!1),nt(a,e.notes,e.config,e.colorIndex))}}let ye=null,ii=null;function Kd(e){ii=e,ye=ii.getContext("2d")}function it(e){if(!ye||!ii)return;const{width:t,height:i}=ii;ye.clearRect(0,0,t,i);const a=Math.round(e)+.5;ye.strokeStyle="#ff00ff",ye.lineWidth=1,ye.beginPath(),ye.moveTo(a,0),ye.lineTo(a,i),ye.stroke()}function Zr(e,t){Ki(t.bpm),Wi(t.beatsPerMeasure),Xi(t.totalMeasures);const i=document.getElementById("tempo-input");i&&(i.value=String(xe()));const a=document.getElementById("measures-input");a&&(a.value=String(Pt())),Ol();for(const[r,s]of e.entries()){const d=r,o=s.instrument||"sf2/fluidr3-gm/acoustic_grand_piano",c=s.notes||[];s.volume,s.pan,x({type:"CREATE_SEQUENCER",id:d,instrument:o,notes:structuredClone(c),volume:s.volume,pan:s.pan,config:{...s.config||{}}},Di(d))}x(Hi("Session Loaded"),_a("Session Loaded")),$d();const n=document.getElementById("global-mini-contour");n&&_s(n,A),Se(0),it(0)}function Wd(){const e=document.querySelectorAll(".note-duration-btn"),t=document.getElementById("note-duration"),i=document.getElementById("dotted-note-btn"),a=document.getElementById("triplet-note-btn");let n=!1,r=!1;function s(o){let c=o;n?c=o*1.5:r&&(c=o*(2/3));let l=Array.from(t.options).find(u=>Math.abs(parseFloat(u.value)-c)<1e-4);l||(l=new Option(c.toString(),c.toString()),t.add(l)),t.value=l.value,t.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))}e.forEach(o=>{o.addEventListener("click",()=>{e.forEach(l=>l.classList.remove("bg-purple-600")),o.classList.add("bg-purple-600");const c=parseFloat(o.dataset.value);s(c)})}),i.addEventListener("click",()=>{r&&(r=!1,a.classList.remove("bg-purple-600")),n=!n,i.classList.toggle("bg-purple-600"),d()}),a.addEventListener("click",()=>{n&&(n=!1,i.classList.remove("bg-purple-600")),r=!r,a.classList.toggle("bg-purple-600"),Q.isTripletMode=r,A.forEach(o=>{o.config.isTripletMode=r}),d()});function d(){const o=document.querySelector(".note-duration-btn.bg-purple-600");if(o){const c=parseFloat(o.dataset.value);s(c)}}s(Q.currentDuration||1)}let ri=!1,Ge=null,Ti=null,Ri=!1;function Xd(e,t){Ge=e,Ti=t,Ge.addEventListener("mousedown",zd),window.addEventListener("mousemove",jd),window.addEventListener("mouseup",Vd)}function zd(e){qs()&&(ga(),A.forEach(t=>{var i;return(i=t.pause)==null?void 0:i.call(t)}),Ri=!0),ri=!0,dn(e)}function jd(e){ri&&dn(e)}function Vd(){ri&&(ri=!1,Ri&&(va(),A.forEach(e=>{var t;return(t=e.resume)==null?void 0:t.call(e)}),Ri=!1))}function dn(e){if(!Ge||!Ti)return;const t=Ge.getBoundingClientRect(),i=Ge.width/t.width;let a=(e.clientX-t.left)*i;a=Math.max(0,Math.min(Ge.width,a));const n=K(),r=a/Ge.width*n,s=sa(r,Ti),d=s/n*Ge.width;Se(s),it(d)}const lr={maxBeatsContext:32,extendBeatsAmount:16};function cc(){return lr.maxBeatsContext}function uc(){return lr.extendBeatsAmount}function Ui(e,t,i,a){const n=K(),r=a/n*t;e.clearRect(0,0,t,i);const s=lr.maxBeatsContext,o=Math.max(0,a-s)/n*t,c=r-o;e.fillStyle="rgba(85, 187, 255, 0.55)",e.fillRect(o,0,c,i),e.strokeStyle="#ffffff",e.lineWidth=2,e.beginPath(),e.moveTo(r,0),e.lineTo(r,i),e.stroke()}let ea=!1,vi=!1,Lt=0;function fc(){return Lt}function ta(){if(!ea){ea=!0;const a=document.getElementById("extend-use-tags"),n=document.getElementById("extend-tags");if(a&&n){let c=function(){const _=l.checked;u.disabled=!_,u.classList.toggle("opacity-50",!_),u.classList.toggle("cursor-not-allowed",!_)};const l=a,u=n;c(),l.addEventListener("change",c)}const r=document.getElementById("extend-start-help-btn"),s=document.getElementById("extend-start-help-popup"),d=document.getElementById("extend-start-help-close");r&&s&&d&&(r.addEventListener("click",()=>s.classList.remove("hidden")),d.addEventListener("click",()=>s.classList.add("hidden")),document.addEventListener("click",c=>{c.target instanceof Node&&!s.contains(c.target)&&c.target!==r&&s.classList.add("hidden")}));const o=document.querySelector("#ai-extend-modal .generate-btn");o&&o.addEventListener("click",async()=>{const{extendTracksWithAI:c}=await vn(async()=>{const{extendTracksWithAI:l}=await import("./extendTracks-BOA3q-li.js");return{extendTracksWithAI:l}},__vite__mapDeps([0,1]));await c()})}const e=document.getElementById("extend-track-checkboxes"),t=document.getElementById("extend-select-all"),i=document.getElementById("extend-deselect-all");e&&t&&i&&(e.innerHTML="",Ee().forEach((n,r)=>{const s=`extend-track-${r}`,d=document.createElement("div");d.className="flex items-center gap-2";const o=document.createElement("input");o.type="checkbox",o.id=s,o.dataset.index=r.toString(),o.checked=!0,o.className="w-4 h-4 rounded border-gray-600 bg-gray-700 text-purple-600 focus:ring-purple-500";const c=document.createElement("label");c.htmlFor=s,c.className="text-sm text-gray-200",c.textContent=n.config.name||`Track ${r+1}`,o.addEventListener("change",()=>{vt()}),d.appendChild(o),d.appendChild(c),e.appendChild(d)}),t.addEventListener("click",()=>{e.querySelectorAll('input[type="checkbox"]').forEach(n=>n.checked=!0),vt()}),i.addEventListener("click",()=>{e.querySelectorAll('input[type="checkbox"]').forEach(n=>n.checked=!1),vt()}),vt())}function Yd(){const e=document.getElementById("extend-mini-contour"),t=document.getElementById("extend-mini-playhead");if(!e||!t)return;const i=t.getContext("2d");if(!i)return;const a=e.clientWidth,n=e.clientHeight;e.width=a,e.height=n,t.width=a,t.height=n,vt(),Ui(i,a,n,Lt),t.addEventListener("mousedown",s=>{vi=!0,r(s.offsetX)}),window.addEventListener("mouseup",()=>{vi=!1}),window.addEventListener("mousemove",s=>{if(!vi)return;const d=t.getBoundingClientRect();r(s.clientX-d.left)});function r(s){if(!i)return;const d=K(),o=Math.max(0,Math.min(s,a));Lt=Math.round(o/a*d),Ui(i,a,n,Lt)}}function vt(){const e=document.getElementById("extend-mini-contour"),t=document.getElementById("extend-mini-playhead");if(!e||!t)return;const i=t.getContext("2d");if(!i)return;const a=t.width,n=t.height,r=document.querySelectorAll('#extend-track-checkboxes input[type="checkbox"]'),s=Array.from(r).filter(o=>o.checked).map(o=>parseInt(o.dataset.index||"0",10)),d=Ee().filter((o,c)=>s.includes(c));re(e,d),Ui(i,a,n,Lt)}function Qd(){const e=document.getElementById("note-placement-mode-btn"),t=document.getElementById("select-mode-btn"),i=document.getElementById("velocity-mode-btn"),a=document.getElementById("note-duration-controls"),n=document.getElementById("select-mode-controls"),r=document.getElementById("velocity-mode-controls");if(!e||!t||!i||!a||!n||!r){console.error("Missing essential UI elements for edit mode switching.");return}function s(o){[e,t,i].forEach(c=>{c&&(c.classList.remove("bg-purple-600"),c.classList.add("bg-gray-800"))}),o.classList.remove("bg-gray-800"),o.classList.add("bg-purple-600")}function d(o){[a,n,r].forEach(c=>{c&&c.classList.add("hidden")}),o.classList.remove("hidden")}e.addEventListener("click",()=>{s(e),d(a),se("note-placement")}),t.addEventListener("click",()=>{s(t),d(n),se("select")}),i.addEventListener("click",()=>{s(i),d(r),se("none")}),window.addEventListener("keydown",o=>{var u;const c=(u=document.activeElement)==null?void 0:u.tagName;if(!(c==="INPUT"||c==="TEXTAREA"||document.querySelector(".ai-modal:not(.hidden)")))switch(o.key.toLowerCase()){case"q":e.click();break;case"w":t.click();break;case"e":i.click();break;default:return}}),s(e),d(a),se("note-placement")}function Zd(){var _,f,p;const e=document.getElementById("note-mode-btn"),t=document.getElementById("ai-mode-btn"),i=document.getElementById("note-duration-panel"),a=document.getElementById("ai-control-panel");if(!e||!t||!i||!a){console.error("Missing essential elements for control mode switching.");return}function n(){document.querySelectorAll(".sequencer").forEach(h=>{const m=h.querySelector(".delete-btn"),y=h.querySelector(".collapse-btn"),g=y==null?void 0:y.querySelector("use"),v=h.querySelector(".sequencer-body"),b=h.querySelector(".mini-contour");!m||!y||!g||!v||!b||(m.classList.add("button-locked"),y.classList.add("button-locked"),At(h,!1),v.classList.contains("hidden")||(v.classList.add("hidden"),b.classList.remove("hidden"),g.setAttribute("href","#icon-caret-up")))})}function r(){document.querySelectorAll(".sequencer").forEach(h=>{const m=h.querySelector(".delete-btn"),y=h.querySelector(".collapse-btn");m==null||m.classList.remove("button-locked"),y==null||y.classList.remove("button-locked")})}function s(){!e||!t||!i||!a||(e.classList.replace("bg-gray-800","bg-blue-600"),t.classList.replace("bg-purple-600","bg-gray-800"),i.classList.remove("hidden"),a.classList.add("hidden"),r())}function d(){if(!Si()){const h=document.getElementById("openai-key-not-set-modal");h==null||h.classList.remove("hidden");return}!e||!t||!i||!a||(t.classList.replace("bg-gray-800","bg-purple-600"),e.classList.replace("bg-blue-600","bg-gray-800"),i.classList.add("hidden"),a.classList.remove("hidden"),n())}e.addEventListener("click",s),t.addEventListener("click",d);const o=document.getElementById("ai-inpaint-modal"),c=document.getElementById("ai-extend-modal"),l=document.getElementById("ai-generate-modal");function u(h){if(!h)return;const m=h.querySelector(".cancel-btn");m==null||m.addEventListener("click",()=>{h.classList.add("hidden")})}u(o),u(c),u(l),ta(),(_=document.getElementById("ai-inpaint-btn"))==null||_.addEventListener("click",()=>{o==null||o.classList.remove("hidden")}),(f=document.getElementById("ai-extend-btn"))==null||f.addEventListener("click",()=>{c==null||c.classList.remove("hidden"),Yd(),ta()}),(p=document.getElementById("ai-generate-btn"))==null||p.addEventListener("click",()=>{l==null||l.classList.remove("hidden")}),Qd()}function cn(){const e=er();if(!e)return;const t=e.gridContext,i=t.getSelectedNotes();i.length!==0&&(x(Ji(t.sequencer.id,i),xi(t.sequencer.id,i)),et()&&(Ze(),se(Ne.NOTE_PLACEMENT)),t.setSelectedNotes([]))}function un(){const e=er();if(!e)return;const t=e.getSelectedNotes();t.length!==0&&Ca(t)}function fn(){const e=er();if(!e)return;const t=e.gridContext,i=t.getSelectedNotes();i.length!==0&&(Ca(i),x(vs(t.sequencer.id,i),Ss(t.sequencer.id,i)),et()&&(Ze(),se(Ne.NOTE_PLACEMENT)),t.setSelectedNotes([]))}function _n(){Li().notes.length&&(document.body.style.cursor="crosshair",el((t,i)=>{const a=t.gridContext,{x:n,y:r}=a.getCanvasPos(i),s=a.getSnappedBeatFromX(n),d=a.getPitchFromRow(Math.floor(r/a.getCellHeight())),o=P(d);if(o===null)return;const{notes:c,anchorBeat:l,anchorMidi:u}=Li(),_=s-l,f=o-u,p=c.map(h=>{const m=P(h.pitch);return m===null?{...h}:{pitch:Me(m+f)??h.pitch,start:h.start+_,duration:h.duration}});x(Bs(a.sequencer.id,p),Cs(a.sequencer.id,p)),et()&&(Ze(),se(Ne.NOTE_PLACEMENT)),a.setSelectedNotes(p),document.body.style.cursor="default",zi()}))}function ec(){document.addEventListener("keydown",e=>{const i=navigator.platform.toUpperCase().includes("MAC")?e.metaKey:e.ctrlKey,a=document.activeElement,n=a instanceof HTMLElement?a.tagName:null;if(!(n==="INPUT"||n==="TEXTAREA"))switch(!0){case(i&&e.key==="c"):e.preventDefault(),un();break;case(i&&e.key==="x"):e.preventDefault(),fn();break;case(i&&e.key==="v"):e.preventDefault(),_n();break;case e.key==="Delete":e.preventDefault(),cn();break}})}function tc(){const e=document.querySelector(".select-mode-copy");e&&(e.onclick=un);const t=document.querySelector(".select-mode-cut");t&&(t.onclick=fn);const i=document.querySelector(".select-mode-paste");i&&(i.onclick=_n);const a=document.querySelector(".select-mode-delete");a&&(a.onclick=cn),ec()}function ic(e,t){return e!==void 0&&t!==void 0&&e===t}function rc(e=ot()){var i,a,n;Ki(e.tempo,!1),Wi(e.timeSignature[0],!1),Xi(e.totalMeasures,!1);for(const r of A)r.updateTotalMeasures();for(const r of e.sequencers){const s=A.find(d=>ic(d.id,r.id));if(s){s.instrumentName=r.instrument,typeof r.volume=="number"&&(s.volume=r.volume),typeof r.pan=="number"&&(s.pan=r.pan);const d=(i=s.container)==null?void 0:i.querySelector("canvas.mini-contour");d&&nt(d,s.notes,s.config,s.colorIndex);const o=(a=s.grid)==null?void 0:a.gridContext;if(o){const c=o.getSelectedNotes?o.getSelectedNotes():[],l=o.getSelectedNote?o.getSelectedNote():null,u=c.map(_=>({pitch:_.pitch,start:_.start,duration:_.duration}));if(o.notes.length=0,o.notes.push(...structuredClone(r.notes)),c.length>0){const _=u.map(f=>o.notes.find(p=>p.pitch===f.pitch&&p.start===f.start&&p.duration===f.duration)).filter(Boolean);_.length>0&&(o.setSelectedNotes(_),l&&_.length===1&&o.setSelectedNote(_[0]))}(n=s.grid)==null||n.scheduleRedraw()}}else{const d={id:r.id,instrument:r.instrument,notes:structuredClone(r.notes),volume:r.volume,pan:r.pan},{wrapper:o}=Oa(d),c=o.querySelector(".sequencer");c&&At(c,!0)}}const t=document.getElementById("global-mini-contour");t&&re(t,A)}Sn();Ps(rc);Gl();function ac(){const e=document.getElementById("global-mini-contour");e&&re(e,A)}document.getElementById("global-mini-contour");const or=document.getElementById("global-mini-playhead");Kd(or);Xd(or,Q);it(0);const ia=0,nc="sf2/fluidr3-gm/acoustic_grand_piano";x(ua(ia,nc),Di(ia));const sc=document.getElementById("piano");vd(sc);const lc=document.getElementById("waveform"),oc=document.getElementById("visualizer-mode");Nd(lc,oc);x(Hi("Initial App State"),_a("Initial App State"));tc();ac();Tl();Wd();Zd();Bd();Fn();Pn();Cn();xl({getSequencers:()=>A,onPlay:()=>{Zt();const e=K(),t=ba();xs(xe(),{loop:Q.loopEnabled,endBeat:e,startBeat:t,onLoop:()=>{A.forEach(i=>{var a;return(a=i.onTransportLoop)==null?void 0:a.call(i)})}}),Bi(i=>{const a=i/e*or.width;it(a)}),A.forEach(i=>i.play()),Ds(()=>{ql(),Se(0),it(0)})},onPause:()=>{ga(),A.forEach(e=>e.pause())},onResume:()=>{va(),A.forEach(e=>e.resume())},onStop:()=>{Zt(),Se(0),A.forEach(e=>e.stop()),it(0)},onDurationChange:e=>{Q.currentDuration=e,A.forEach(t=>t.config.currentDuration=e)},onSnapChange:e=>{Q.snapResolution=e,A.forEach(t=>t.config.snapResolution=e)},onToggleLoop:e=>{Q.loopEnabled=e,A.forEach(t=>t.config.loopEnabled=e),Us(e)},onTempoChange:e=>{Ki(e)},onSave:async e=>{const t=ot();if(e==="json"){const{url:i,filename:a}=Cd(t),n=document.createElement("a");n.href=i,n.download=a,n.click(),URL.revokeObjectURL(i)}else if(e==="wav"){const i={globalConfig:{bpm:t.tempo,beatsPerMeasure:t.timeSignature[0],totalMeasures:t.totalMeasures},tracks:A.map(a=>({notes:a.notes,instrument:a.instrumentName,config:a.config,volume:a.volume,pan:a.pan}))};await Gd(i)}else if(e==="midi"){const{url:i,filename:a}=await xd(t),n=document.createElement("a");n.href=i,n.download=a,n.click(),URL.revokeObjectURL(i)}},onLoad:async e=>{var t;try{const i=(t=e.name.split(".").pop())==null?void 0:t.toLowerCase();if(i==="json"){const{tracks:a,globalConfig:n}=await qd(e);Zr(a,n)}else if(i==="mid"||i==="midi"){const{tracks:a,globalConfig:n}=await Hd(e);Zr(a,n)}else throw new Error("Unsupported file type.")}catch(i){i instanceof Error?alert("Failed to load file: "+i.message):alert("Failed to load file: Unknown error")}},onMeasuresChange:e=>{Xi(e);const t=document.getElementById("global-mini-contour");t&&re(t,A)},onBeatsPerMeasureChange:e=>{Wi(e);const t=document.getElementById("global-mini-contour");t&&re(t,A)}});Nn();const _c=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));export{yr as a,Ee as b,fc as c,cc as d,uc as e,Ft as f,Si as g,nt as h,re as i,_c as m,Xi as u};
