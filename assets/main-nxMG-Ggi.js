const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/extendTracks-57MsIfp2.js","assets/index-0fuF-ux_.js"])))=>i.map(i=>d[i]);
import{_ as Ja}from"./index-0fuF-ux_.js";function hn(e){const t=e.startsWith("/")?e.substring(1):e;return(window.location.pathname.startsWith("/sequenzia")?"/sequenzia/":"./")+t}function qa(){const e=document.getElementById("splash-modal"),t=document.getElementById("splash-logo");t&&(t.src=hn("static/logo.png")),e==null||e.classList.remove("hidden")}function $a(e=1e3){const t=document.getElementById("splash-modal"),i=document.getElementById("footer-main"),n=document.getElementById("content-main");t&&setTimeout(()=>{t.style.opacity="0",t.style.transition="opacity 0.5s ease-out",setTimeout(()=>{t.classList.add("hidden"),t.style.opacity="1",i&&(i.classList.remove("content-hidden"),i.classList.add("content-visible")),n&&(n.classList.remove("content-hidden"),n.classList.add("content-visible"))},500)},e)}function Ha(){const e=document.getElementById("splash-modal");return e?!e.classList.contains("hidden"):!1}function Va(){const e=document.getElementById("feature-not-implemented-modal"),t=document.getElementById("feature-modal-close-btn");if(!e||!t){console.warn("Feature modal elements not found");return}function i(){e&&e.classList.remove("hidden")}t.addEventListener("click",()=>{e.classList.add("hidden")});const n=document.getElementById("piano-toggle-btn");n&&n.addEventListener("click",()=>{i()});const a=document.getElementById("mixer-toggle-btn");a&&a.addEventListener("click",()=>{i()});const r=document.getElementById("ai-toggle-btn");r&&r.addEventListener("click",()=>{i()});const s=document.getElementById("quantize-mode-menu-btn");s&&s.addEventListener("click",()=>{i()})}function Wa(e,t){window.addEventListener("keydown",i=>{const n=(i.ctrlKey||i.metaKey)&&i.key.toLowerCase()==="z",a=(i.ctrlKey||i.metaKey)&&(i.key.toLowerCase()==="y"||i.shiftKey&&i.key.toLowerCase()==="z");if(!n&&!a)return;i.preventDefault(),i.target instanceof HTMLElement&&i.target.matches('input, textarea, [contenteditable="true"]')||(n?e():t())},{capture:!0})}function Ka(e,t){return e/t()}function bn(e,t){const i=t.snapResolution||.25,n=t.isTripletMode?i*(2/3):i;return Math.round(e/n)*n}function za(e,t,i){const n=Ka(e,i);return bn(n,t)}const Xa={C:0,"C#":1,Db:1,D:2,"D#":3,Eb:3,E:4,Fb:4,"E#":5,F:5,"F#":6,Gb:6,G:7,"G#":8,Ab:8,A:9,"A#":10,Bb:10,B:11,Cb:11,"B#":0};function P(e){const t=e==null?void 0:e.match(/^([A-Ga-g])([#b]*)(-?\d+)$/);if(!t)return null;const[,i,n,a]=t,r=i.toUpperCase(),s=Xa[r];if(s===void 0)return null;const o=[...n].reduce((c,d)=>d==="#"?c+1:d==="b"?c-1:c,0);return 12*(parseInt(a,10)+1)+(s+o)}const ja=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],Ya=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"];function we(e,t=!1){const n=(t?Ya:ja)[e%12],a=Math.floor(e/12)-1;return`${n}${a}`}function Br(e){return e.replace(/\d+$/,"")}function Qa(e){return e.includes("#")}function Gi(e,t,i,n,a,r=4){e.beginPath(),e.moveTo(t+r,i),e.lineTo(t+n-r,i),e.quadraticCurveTo(t+n,i,t+n,i+r),e.lineTo(t+n,i+a-r),e.quadraticCurveTo(t+n,i+a,t+n-r,i+a),e.lineTo(t+r,i+a),e.quadraticCurveTo(t,i+a,t,i+a-r),e.lineTo(t,i+r),e.quadraticCurveTo(t,i,t+r,i),e.closePath()}const se={cellWidth:40,cellHeight:20,visibleNotes:36,noteRange:["C1","B9"],currentDuration:1,snapResolution:1,isTripletMode:!1,loopEnabled:!1,useEqualTemperament:!0},ie=64,Za={C:"#FF0000","C#":"#9400D3",D:"#FFFF00","D#":"#FF69B4",E:"#0000FF",F:"#00FF00","F#":"#87CEFA",G:"#FFA500","G#":"#800080",A:"#2E8B57","A#":"#FFB6C1",B:"#4B0082"},es={4:"𝅝",2:"𝅗𝅥",1:"𝅘𝅥","0.5":"♪","0.25":"♬","0.125":"𝅘𝅥𝅰"},Cr={Digit1:4,Digit2:2,Digit3:1,Digit4:.5,Digit5:.25,Digit6:.125},Rt=[{cellWidth:20,cellHeight:10},{cellWidth:30,cellHeight:15},{cellWidth:40,cellHeight:20},{cellWidth:60,cellHeight:25},{cellWidth:80,cellHeight:30}];function ts(e,t){const i=structuredClone(e);return i.tempo=t.bpm,i}function gn(e){return{type:"CHANGE_TEMPO",bpm:e}}function is(e){return gn(e)}function rs(e,t){const i=structuredClone(e);return i.timeSignature=[t.beats,4],i}function vn(e){return{type:"SET_TIME_SIGNATURE",beats:e}}function ns(e){return vn(e)}function as(e,t){const i=structuredClone(e);return i.totalMeasures=t.measures,i}function Sn(e){return{type:"SET_TOTAL_MEASURES",measures:e}}function ss(e){return Sn(e)}function ls(e,t){const i=structuredClone(e);if(i.sequencers.push({id:t.id,instrument:t.instrument,notes:t.notes??[],volume:t.volume,pan:t.pan}),!R.find(a=>a.id===t.id)){const a={id:t.id,instrument:t.instrument,notes:t.notes??[],volume:t.volume,pan:t.pan},{wrapper:r}=ua(a);kt(r,!0)}return i}function Nn(e,t,i,n){return{type:"CREATE_SEQUENCER",id:e,instrument:t,volume:i,pan:n}}function Ki(e){return{type:"DELETE_SEQUENCER",id:e}}function os(e,t){const i=structuredClone(e);i.sequencers=i.sequencers.filter(a=>a.id!==t.id);const n=R.findIndex(a=>a.id===t.id);return n!==-1&&(R[n].destroy(),R.splice(n,1)),i}function ds(e,t,i=[],n,a){return{type:"DELETE_SEQUENCER",id:e,instrument:t,notes:structuredClone(i),volume:n,pan:a}}function cs(e,t,i=[],n,a){return{type:"CREATE_SEQUENCER",id:e,instrument:t,notes:structuredClone(i),volume:n,pan:a}}function us(e,t){const i=structuredClone(e),n=i.sequencers.find(a=>a.id===t.sequencerId);return n&&t.instrument&&(n.instrument=t.instrument),i}function fs(e,t){return{type:"SET_INSTRUMENT",sequencerId:e,instrument:t}}function ms(e,t){return{type:"SET_INSTRUMENT",sequencerId:e,instrument:t}}function ps(e,t){var a;const i=structuredClone(e),n=i.sequencers.find(r=>r.id===t.id);if(n&&typeof t.volume=="number"){n.volume=t.volume;const r=R.find(s=>s.id===t.id);r&&(r.volume=t.volume,(a=r.refreshVolumeUI)==null||a.call(r))}return i}function _s(e,t){return{type:"SET_VOLUME",id:e,volume:t}}function ys(e,t){return{type:"SET_VOLUME",id:e,volume:t}}function hs(e,t){var a;const i=structuredClone(e),n=i.sequencers.find(r=>r.id===t.id);if(n&&typeof t.pan=="number"){n.pan=t.pan;const r=R.find(s=>s.id===t.id);r&&(r.pan=t.pan,(a=r.refreshPanUI)==null||a.call(r))}return i}function bs(e,t){return{type:"SET_PAN",id:e,pan:t}}function gs(e,t){return{type:"SET_PAN",id:e,pan:t}}const nt=["#ff006e","#3a86ff","#ffbe0b","#8338ec","#06d6a0","#ef476f","#118ab2","#ffd166","#073b4c","#8ac926"];function Lr(e){return e<0&&(console.error(`Invalid trackId: ${e}. Using default color.`),e=0),nt[e%nt.length]}function Mr(e){return e&&typeof e.colorIndex=="number"?Lr(e.colorIndex):(console.error(`Invalid sequencer colorIndex: ${e==null?void 0:e.colorIndex}. Using default color.`),Lr(0))}function at(e,t,i,n=0){const a=e.getContext("2d");if(!a)return;a.imageSmoothingEnabled=!1;const r=e.width,s=e.height;if(a.clearRect(0,0,r,s),!t.length)return;const o=nt[n%nt.length];a.fillStyle=o;const l=j(),c=t.map(y=>P(y.pitch)).filter(y=>y!==null);if(!c.length)return;let d=Math.min(...c),u=Math.max(...c),p=Math.max(1,u-d);for(;s%p!==0;)u++,p=u-d;const f=s/p;for(const y of t){const g=P(y.pitch);if(g==null)continue;const v=y.start/l*r,b=y.duration/l*r,N=(g-d)/p,S=s-N*s-f/2,B=Math.round(v),L=Math.max(1,Math.round(b)),M=Math.round(S);a.fillRect(B,M,L,f)}const m=Ft(),h=Pt();a.save();let _=1;h>256?_=16:h>128?_=8:h>32&&(_=4);for(let y=0;y<=h;y++){if(y%_!==0)continue;const v=y*m/l*r,b=Math.round(v)+.5;a.beginPath(),a.moveTo(b,0),a.lineTo(b,s);const N=_===1||y%(_*2)===0;a.strokeStyle=N?"rgba(255, 255, 255, 0.12)":"rgba(255, 255, 255, 0.04)",a.lineWidth=.2,a.stroke()}a.restore()}function re(e,t){const i=e.getContext("2d");if(!i)return;const n=e.width,a=e.height;i.clearRect(0,0,n,a);const r=j();for(const s of t){const{notes:o,config:l}=s;if(!(o!=null&&o.length))continue;const c=nt[t.indexOf(s)%nt.length];i.fillStyle=c;const d=P(l.noteRange[0]),u=P(l.noteRange[1]);if(d==null||u==null)continue;const p=u-d||1,f=Math.max(2,a/p);for(const m of o){const h=P(m.pitch);if(h==null)continue;const _=m.start/r*n,y=Math.max(1,m.duration/r*n),g=(h-d)/p,v=a-g*a-f/2;i.fillRect(_,v,y,f)}}}function vs(e,t){re(e,t)}function Ss(e,t){const i=structuredClone(e),n=i.sequencers.find(r=>r.id===t.sequencerId);if(!n)return e;n.notes.push(...t.notes);const a=document.getElementById("global-mini-contour");return a&&re(a,R),i}function Ns(e,t){return{type:"PLACE_NOTES",sequencerId:e,notes:structuredClone(t)}}function Bs(e,t){return{type:"DELETE_NOTES",sequencerId:e,notes:structuredClone(t)}}function Cs(e,t){const i=structuredClone(e),n=i.sequencers.find(s=>s.id===t.sequencerId);if(!n)return e;const a=new Set(t.notes.map(s=>`${s.pitch}|${s.start}|${s.duration}`));n.notes=n.notes.filter(s=>{const o=`${s.pitch}|${s.start}|${s.duration}`;return!a.has(o)});const r=document.getElementById("global-mini-contour");return r&&re(r,R),i}function zi(e,t){return{type:"DELETE_NOTES",sequencerId:e,notes:structuredClone(t)}}function Xi(e,t){return{type:"PLACE_NOTES",sequencerId:e,notes:structuredClone(t)}}function Ls(e,t){const i=structuredClone(e),n=i.sequencers.find(s=>s.id===t.sequencerId);if(!n)return e;const a=t.from,r=t.to;for(let s=0;s<a.length;s++){const o=a[s],l=r[s],c=n.notes.findIndex(d=>d.pitch===o.pitch&&d.start===o.start&&d.duration===o.duration);c!==-1&&(n.notes[c].pitch=l.pitch,n.notes[c].start=l.start)}return i}function ji(e,t,i){return{type:"MOVE_NOTES",sequencerId:e,from:structuredClone(t),to:structuredClone(i)}}function Bn(e,t,i){return ji(e,i,t)}function Ms(e,t){const i=structuredClone(e),n=i.sequencers.find(r=>r.id===t.sequencerId);if(!n)return e;const a=new Set(t.notes.map(r=>`${r.pitch}|${r.start}|${r.duration}`));return n.notes=n.notes.filter(r=>{const s=`${r.pitch}|${r.start}|${r.duration}`;return!a.has(s)}),i}function Gs(e,t){return{type:"CUT_NOTES",sequencerId:e,notes:structuredClone(t)}}function ws(e,t){return{type:"PLACE_NOTES",sequencerId:e,notes:structuredClone(t)}}function Es(e,t){const i=structuredClone(e),n=i.sequencers.find(a=>a.id===t.sequencerId);return n?(n.notes.push(...t.notes),i):e}function Fs(e,t){return{type:"PASTE_NOTES",sequencerId:e,notes:structuredClone(t)}}function Ps(e,t){return{type:"DELETE_NOTES",sequencerId:e,notes:structuredClone(t)}}function As(e,t){return structuredClone(e)}function ks(e,t){const i=structuredClone(e),n=i.sequencers.find(s=>s.id===t.sequencerId);if(!n)return e;const a=t.resizes;for(const s of a){const o=n.notes.find(l=>l.pitch===s.pitch&&l.start===s.start);o&&(o.duration=s.newDuration)}const r=document.getElementById("global-mini-contour");return r&&re(r,R),i}function Is(e,t){return{type:"RESIZE_NOTES",sequencerId:e,resizes:structuredClone(t)}}function Ts(e,t){const i=t.map(n=>({pitch:n.pitch,start:n.start,newDuration:n.oldDuration}));return{type:"RESIZE_NOTES",sequencerId:e,resizes:i}}function Rs(e,t){const i=structuredClone(e),n=i.sequencers.find(s=>s.id===t.sequencerId);if(!n)return e;const a=t.notes;for(const s of a){const o=n.notes.find(l=>l.pitch===s.pitch&&l.start===s.start&&l.duration===s.duration);o&&(o.velocity=s.velocity)}const r=document.getElementById("global-mini-contour");return r&&re(r,R),i}function Os(e,t){return{type:"SET_NOTE_VELOCITY",sequencerId:e,notes:structuredClone(t)}}function Us(e,t){return{type:"SET_NOTE_VELOCITY",sequencerId:e,notes:structuredClone(t)}}function Ds(e,t){return structuredClone(e)}function Yi(e=""){return{type:"CHECKPOINT",label:e}}function Cn(e=""){return Yi(e)}const xs=Object.freeze(Object.defineProperty({__proto__:null,CHANGE_TEMPO:ts,CHECKPOINT:Ds,CREATE_SEQUENCER:ls,CUT_NOTES:Ms,DELETE_NOTES:Cs,DELETE_SEQUENCER:os,MOVE_NOTES:Ls,PASTE_NOTES:Es,PLACE_NOTES:Ss,RESIZE_NOTES:ks,SET_INSTRUMENT:us,SET_NOTE_VELOCITY:Rs,SET_PAN:hs,SET_TIME_SIGNATURE:rs,SET_TOTAL_MEASURES:as,SET_VOLUME:ps,UPDATE_NOTE_VELOCITY:As},Symbol.toStringTag,{value:"Module"}));function Qi(e){const t=xs[e.type];if(!t)throw new Error(`Unknown diff type: ${e.type}`);const i=t(Je(),e);Ln(i)}const wi=new Set;function Js(e){return wi.add(e),()=>wi.delete(e)}function Et(e){for(const t of wi)t(e)}const ge=[];let ce=-1;const qs=100;function $s({forwardDiff:e,reverseDiff:t}){ge.splice(ce+1),ge.push({forwardDiff:e,reverseDiff:t}),ce=ge.length-1,ge.length>qs&&(ge.shift(),ce--)}function Hs(){var e;if(ce<0)return null;for(let t=ce;t>=0;t--){const i=ge[t];if(((e=i==null?void 0:i.forwardDiff)==null?void 0:e.type)==="CHECKPOINT")return null;if(i!=null&&i.reverseDiff)return ce=t-1,Qi(i.reverseDiff),Et(Je()),i.reverseDiff}return null}function Vs(){if(ce>=ge.length-1)return null;ce++;const e=ge[ce];return!e||!e.forwardDiff?null:(Qi(e.forwardDiff),Et(Je()),e.forwardDiff)}function Ws(){ge.length=0,ce=-1}let Qt={tempo:120,timeSignature:[4,4],totalMeasures:8,sequencers:[]};function Je(){return Qt}function Ln(e){Qt=structuredClone(e),Et(Qt)}function $(e,t){Qi(e),$s({forwardDiff:e,reverseDiff:t}),Et(Qt)}let Mn=500,Gn=!1,wn=4,En=8;function j(){return Pt()*Ft()}function Zi(e,t=!0){const i=ve();if(t){$(gn(e),is(i));return}performance.now(),O.getCurrentBeat(),Mn=60/e*1e3,O.isActive()&&O.syncAfterTempoChange(i);const n=document.getElementById("tempo-input");n&&n.value!==String(e)&&(n.value=String(e))}function ve(){return 60/(Mn/1e3)}function er(e,t=!0){if(t){const n=Ft();$(vn(e),ns(n));return}wn=e;const i=document.getElementById("beats-per-measure-input");i&&i.value!==String(e)&&(i.value=String(e)),me().forEach(n=>{var a,r;(a=n.grid)!=null&&a.resizeAndRedraw?n.grid.resizeAndRedraw():(r=n.grid)==null||r.scheduleRedraw()})}function Ft(){return wn}function tr(e,t=!0){if(t){const n=Pt();$(Sn(e),ss(n));return}En=e;const i=document.getElementById("measures-input");i&&i.value!==String(e)&&(i.value=String(e)),me().forEach(n=>{var a;(a=n.grid)==null||a.scheduleRedraw()})}function Pt(){return En}function Ks(e){Gn=e}function zs(){return Gn}function Xs(){return se.snapResolution}const Fn={openaiApiKey:"",openaiModel:"gpt-4o",gridColorScheme:"Darkroom",noteColorScheme:"Track Color"};function qe(){return Fn}function Gt(e){Object.assign(Fn,e)}const Gr={Midnight:{whiteKey:"#1e1e1e",blackKey:"#2a103b",labelWhite:"#2c2c2c",labelBlack:"#3a1d4d",textWhite:"#cfcfcf",textBlack:"#e6d9ff",gridLine:"#333",beatLine:"#4e3d63",measureLine:"#8561c2"},Seashell:{whiteKey:"#fefefe",blackKey:"#f1e7dc",labelWhite:"#dddddd",labelBlack:"#d4cfc9",textWhite:"#444",textBlack:"#663300",gridLine:"#ccc",beatLine:"#bbb",measureLine:"#999"},Cyberpunk:{whiteKey:"#1b1b2f",blackKey:"#162447",labelWhite:"#1f4068",labelBlack:"#1f4068",textWhite:"#e43f5a",textBlack:"#e43f5a",gridLine:"#1f4068",beatLine:"#e43f5a",measureLine:"#ffcc00"},"Classic Blue":{whiteKey:"#f5faff",blackKey:"#dceeff",labelWhite:"#aaccee",labelBlack:"#88bbdd",textWhite:"#002244",textBlack:"#001122",gridLine:"#99bbdd",beatLine:"#88aacc",measureLine:"#336699"},Darkroom:{whiteKey:"#2c2c2c",blackKey:"#1e1e1e",labelWhite:"#383838",labelBlack:"#2a2a2a",textWhite:"#a0a0a0",textBlack:"#e0e0e0",gridLine:"#404040",beatLine:"#606060",measureLine:"#808080"}},js=Array.from({length:47},(e,t)=>35+t),Ys={B1:"kick2",C2:"kick1","C#2":"rim",D2:"snare1","D#2":"clap",E2:"snare2",F2:"lowtom2","F#2":"hh_closed",G2:"lowtom1","G#2":"hh_pedal",A2:"midtom2","A#2":"hh_open",B2:"midtom1",C3:"hitom2","C#3":"crash1",D3:"hitom1","D#3":"ride1",E3:"china",F3:"ride_bell","F#3":"tamb",G3:"splash","G#3":"cowbell",A3:"crash2","A#3":"vibraslap",B3:"ride2",C4:"bongo_hi","C#4":"bongo_lo",D4:"conga_hi_mute","D#4":"conga_hi_open",E4:"conga_lo",F4:"timbale_hi","F#4":"timbale_lo",G4:"agogo_hi","G#4":"agogo_lo",A4:"cabasa","A#4":"maracas",B4:"whistle_short",C5:"whistle_long","C#5":"guiro_short",D5:"guiro_long","D#5":"claves",E5:"woodblock_hi",F5:"woodblock_lo","F#5":"cuica_mute",G5:"cuica_open","G#5":"triangle_mute",A5:"triangle_open"};function Qs(e,t,i,n,a,r,s=!1){const{gridColorScheme:o}=qe(),l=Gr[o]||Gr.Darkroom,c=Ft(),d=j(),u=d*n,p=i*a;e.font=`${Math.floor(a*.6)}px sans-serif`,e.textAlign="right",e.textBaseline="middle";for(let f=0;f<i;f++){const m=f*a,h=r(f),_=Qa(h);if(e.fillStyle=_?l.blackKey:l.whiteKey,e.fillRect(0,m,u,a),e.fillStyle=_?l.labelBlack:l.labelWhite,e.fillRect(-64,m,ie,a),s){const y=Ys[h]||h;e.fillStyle=_?l.textBlack:l.textWhite,e.fillText(y,-8,m+a/2)}else e.fillStyle=_?l.textBlack:l.textWhite,e.fillText(h,-8,m+a/2)}e.strokeStyle=l.gridLine,e.lineWidth=1;for(let f=0;f<i;f++){const m=f*a;e.beginPath(),e.moveTo(0,m),e.lineTo(u,m),e.stroke()}for(let f=0;f<=d;f++){const m=f*n,h=f%c===0;e.strokeStyle=h?l.measureLine:l.beatLine,e.lineWidth=h?2:1,e.beginPath(),e.moveTo(m,0),e.lineTo(m,p),e.stroke()}}function Zs(e,t=1){if(e.startsWith("#")){const i=parseInt(e.slice(1),16),n=i>>16&255,a=i>>8&255,r=i&255;return`rgba(${n}, ${a}, ${r}, ${t})`}if(e.startsWith("hsl(")){const[i,n,a]=e.slice(4,-1).split(",").map(l=>parseFloat(l.trim())),[r,s,o]=el(i,n/100,a/100);return`rgba(${r}, ${s}, ${o}, ${t})`}return e}function el(e,t,i){const n=(1-Math.abs(2*i-1))*t,a=n*(1-Math.abs(e/60%2-1)),r=i-n/2;let s=0,o=0,l=0;return 0<=e&&e<60?[s,o,l]=[n,a,0]:60<=e&&e<120?[s,o,l]=[a,n,0]:120<=e&&e<180?[s,o,l]=[0,n,a]:180<=e&&e<240?[s,o,l]=[0,a,n]:240<=e&&e<300?[s,o,l]=[a,0,n]:300<=e&&e<360&&([s,o,l]=[n,0,a]),[Math.round((s+r)*255),Math.round((o+r)*255),Math.round((l+r)*255)]}function tl(e){const t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,(u,p,f,m)=>p+p+f+f+m+m);const i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(!i)return null;const n=parseInt(i[1],16)/255,a=parseInt(i[2],16)/255,r=parseInt(i[3],16)/255,s=Math.max(n,a,r),o=Math.min(n,a,r);let l=0,c=0,d=(s+o)/2;if(s!==o){const u=s-o;switch(c=d>.5?u/(2-s-o):u/(s+o),s){case n:l=(a-r)/u+(a<r?6:0);break;case a:l=(r-n)/u+2;break;case r:l=(n-a)/u+4;break}l*=60}return{h:Math.round(l),s:Math.round(c*100),l:Math.round(d*100)}}function il(e,t){const i=tl(e);if(!i)return"#999";const a=10+(t??100)/127*50;return`hsl(${i.h}, ${i.s}%, ${a}%)`}function Ot(e){return(t,i)=>{const n=e(t,i);return il(n,t.velocity)}}function rl(e){const t=P(e.pitch);if(t==null)return"#999";const i=t*3%360,n=100,a=60,s=.2+(e.velocity??100)/127*.8;return`hsla(${i}, ${n}%, ${a}%, ${s})`}const Pn={Scriabin:Ot((e,{getPitchClass:t}={})=>{const i=t?t(e.pitch):0;return Za[i]||"#999"}),"Track Color":Ot((e,{getTrackColor:t}={})=>(t==null?void 0:t())||"#999"),"Note Velocity":Ot((e,{getTrackColor:t}={})=>(t==null?void 0:t())||"#ff0000"),"Octave Bands":rl,"Pitch Class Contrast":Ot((e,{getPitchClass:t}={})=>{const i=P(e.pitch);if(i==null)return"#999";const n=i%12;return["#ff0000","#ff7f00","#ffff00","#7fff00","#00ff00","#00ff7f","#00ffff","#007fff","#0000ff","#7f00ff","#ff00ff","#ff007f"][n]||"#999"})};function nl(e,{previewNotes:t=null,hoveredNote:i,selectedNotes:n=[],highlightedNotes:a=[],cellWidth:r,cellHeight:s,getPitchRow:o,getPitchClass:l,getTrackColor:c,drawRoundedRect:d}){const{noteColorScheme:u}=qe(),p=Pn[u]||(()=>"#999"),f=new Set(n),m=new Set(a);if(t)for(const _ of t){const y=_.start*r,g=o(_.pitch)*s,v=_.duration*r,b=s-1,N=p(_,{getPitchClass:l,getTrackColor:c});e.fillStyle=Zs(N,.4),d(e,y,g,v,b),e.fill()}for(const _ of a){const y=_.start*r,g=o(_.pitch)*s,v=_.duration*r,b=s-1;e.fillStyle="rgba(96, 165, 250, 0.6)",d(e,y,g,v,b),e.fill()}const h=new Set([...n,i,...a]);for(const _ of h){if(!_)continue;const y=_.start*r,g=o(_.pitch)*s,v=_.duration*r,b=s-1,N=f.has(_),S=_===i,B=m.has(_);e.lineWidth=N?3:2,e.strokeStyle=N?"rgba(0, 255, 255, 1.0)":S?"rgba(255, 255, 255, 0.9)":B?"rgba(255, 200, 50, 0.7)":"rgba(255, 255, 255, 0.4)",d(e,y,g,v,b),e.stroke()}}function al(e,t,{cellWidth:i,cellHeight:n,visibleStartBeat:a,visibleEndBeat:r,getPitchRow:s,getPitchClass:o,getTrackColor:l,drawRoundedRect:c}){const{noteColorScheme:d}=qe(),u=Pn[d]||(()=>"#999");e.shadowColor="rgba(0,0,0,0.3)",e.shadowBlur=4,e.shadowOffsetX=1,e.shadowOffsetY=2;const p=new Map,f=h=>(p.has(h)||p.set(h,s(h)),p.get(h)),m=t;for(const h of m){const _=h.start*i,y=f(h.pitch)*n,g=h.duration*i,v=n-1;e.fillStyle=u(h,{getPitchClass:o,getTrackColor:l}),c(e,_,y,g,v),e.fill()}e.shadowColor="transparent";for(const h of m){const _=h.start*i,y=f(h.pitch)*n,g=h.duration*i,v=n-1,b=e.createLinearGradient(_,y,_,y+v);b.addColorStop(0,"rgba(255,255,255,0.4)"),b.addColorStop(.2,"rgba(255,255,255,0.15)"),b.addColorStop(.5,"rgba(255,255,255,0.05)"),b.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=b,c(e,_,y,g,v),e.fill()}}function sl(e,t,i,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.save(),e.strokeStyle="red",e.lineWidth=2,e.beginPath(),e.moveTo(t+i,0),e.lineTo(t+i,n),e.stroke(),e.restore()}function ll(e,t,i,n=ie){const a=e.getBoundingClientRect(),r=parseFloat(e.style.width||`${a.width}`),s=parseFloat(e.style.height||`${a.height}`),o=e.width/r,l=e.height/s,c=(t.clientX-a.left)*o-n,d=(t.clientY-a.top)*l;return{x:c,y:d}}function ol(e,t,i,n,a,r){const s=Math.floor(t/a),o=e/r;return i.find(l=>o>=l.start&&o<l.start+l.duration&&n(l.pitch)===s)}function Ei(e,t){const i=P(e),n=P(t);if(i===null||n===null)throw new Error(`Invalid pitches provided: ${e}, ${t}`);return i-n}function dl(e,t,i,n){const a=e.querySelector(".zoom-in-btn"),r=e.querySelector(".zoom-out-btn"),s=e.querySelector(".zoom-reset-btn");!a||!r||!s||(a.addEventListener("click",t),r.addEventListener("click",i),s.addEventListener("click",n))}const _i=new WeakMap;function yi(e){_i.get(e)||(_i.set(e,!0),requestAnimationFrame(()=>{_i.set(e,!1),e.scheduleRedraw()}))}let ai=!1,Zt=null,Y=null;function cl(e){ai=!0,Zt=e,Y=null}function ir(){var e;if(Y){if(!Y.gridContext.setPastePreviewNotes)return;Y.gridContext.setPastePreviewNotes(null),Y.scheduleRedraw(),(e=Y.setCursor)==null||e.call(Y,"default")}ai=!1,Zt=null,Y=null,document.body.style.cursor="default"}function rr(){return ai}function ul(e,t){!ai||!Zt||(Zt(e,t),ir())}function fl(e){if(Y&&Y!==e){if(!Y.gridContext.setPastePreviewNotes)return;Y.gridContext.setPastePreviewNotes(null),Y.scheduleRedraw()}Y=e}const ue={NOTE_PLACEMENT:"note-placement",SELECT:"select"};let An=ue.NOTE_PLACEMENT;const Fi=new Set;function Pi(){return An}function fe(e){ir(),An=e;for(const t of Fi)t(e)}function ml(e){return Fi.add(e),()=>Fi.delete(e)}let nr=!1;function pl(){nr=!0,fe(ue.SELECT)}function tt(){nr=!1}function it(){return nr}let ar=!1;function vt(e=!0){ar=e}function wr(){return ar}function Er(){ar=!1}let kn={notes:[],anchorBeat:0,anchorMidi:0};function In(e){if(e.length===0)return;const t=e[0],i=t.start,n=P(t.pitch)??0;kn={notes:e.map(a=>({pitch:a.pitch,start:a.start,duration:a.duration})),anchorBeat:i,anchorMidi:n}}function Ai(){return kn}let sr=null,lr=null;function _l(e){sr=e}function ki(){return sr}function Fr(){sr=null}function Pr(e,t,i){lr={anchorNote:e,startX:t,startY:i,originalDuration:e.duration}}function hi(){return lr}function yl(){lr=null}function Tn(e,t,i){if(!e.setPastePreviewNotes)return;if(!rr()){e.setPastePreviewNotes(null);return}const{notes:n,anchorBeat:a,anchorMidi:r}=Ai(),s=e.getSnappedBeatFromX(t),o=e.getPitchFromRow(Math.floor(i/e.getCellHeight())),l=P(o);if(l===null)return;const c=s-a,d=l-r,u=n.map(p=>{const f=P(p.pitch);return f===null?{...p}:{pitch:we(f+d)??p.pitch,start:p.start+c,duration:p.duration}});e.setPastePreviewNotes(u),e.scheduleRedraw()}function Rn(e){e.setPastePreviewNotes&&rr()&&e.setPastePreviewNotes(null)}function On(e,t){return rr()?(ul(e.grid,t),t.preventDefault(),t.stopPropagation(),!0):!1}let St=null;const hl=8;function Ar(){St=null}function bl(e,t){St={x:e,y:t}}function gl(e,t){if(!St)return!1;const i=e-St.x,n=t-St.y;return Math.sqrt(i*i+n*n)>=hl}function vl(e,t,{getPitchRow:i,cellWidth:n,cellHeight:a,labelWidth:r}){const s=e.animationCtx;if(!s)return;const o=t.start*n+r,l=i(t.pitch)*a,c=t.duration*n,d=a-1,u=o+c/2,p=l+d/2,f=P(t.pitch);if(f===null)return;const m=f*5%360,h=`hsl(${m}, 100%, 65%)`,_=`hsla(${m}, 100%, 80%, `,y=performance.now(),g=500,v=20,b=M=>M<0?0:M>1?1:M,N=Array.from({length:3},(M,F)=>({radiusScale:.1+F*.1,delay:F*60,alphaScale:.2}));function S(M,{radiusScale:F,alphaScale:w}){if(!s)return;const I=Math.sin(M*Math.PI),T=1+F*I,q=(1-M)*w;s.globalAlpha=q,s.strokeStyle=h,s.lineWidth=2;const D=c*T,k=d*T;s.beginPath(),s.roundRect(u-D/2,p-k/2,D,k,4),s.stroke()}function B(M){if(!s)return;const F=Math.sin(M*Math.PI);s.globalAlpha=1,s.fillStyle=_+.4*F+")",s.beginPath(),s.roundRect(o,l,c,d,3),s.fill()}function L(M){if(!s)return;const F=M-y,w=F/g;if(w>1){s.clearRect(o-v,l-v,c+2*v,d+2*v);return}s.clearRect(o-v,l-v,c+2*v,d+2*v),B(w);for(const I of N){const T=b((F-I.delay)/(g-I.delay));S(T,I)}requestAnimationFrame(L)}requestAnimationFrame(L)}function Sl(e,t,{getPitchRow:i,cellWidth:n,cellHeight:a,labelWidth:r}){const s=t.start*n+r,o=i(t.pitch)*a,l=t.duration*n,c=a-1,d=s+l/2,u=o+c/2,p=P(t.pitch);if(p===null)return;const f=p*5%360,m=e.animationCtx,h=performance.now(),_=300;function y(g){const b=(g-h)/_;if(b>1){m.clearRect(0,0,m.canvas.width,m.canvas.height);return}m.clearRect(0,0,m.canvas.width,m.canvas.height),m.save();const N=1-.4*b,S=1-b,B=l*N,L=c*N;m.globalAlpha=S,m.fillStyle=`hsl(${f}, 100%, 70%)`,m.beginPath(),m.roundRect(d-B/2,u-L/2,B,L,3),m.fill(),m.restore(),requestAnimationFrame(y)}requestAnimationFrame(y)}function bi(e,t,i,n){if(!e||typeof e.getCellWidth!="function"||typeof e.getCellHeight!="function"||typeof e.getPitchRow!="function")return console.error("Invalid ctx object passed to isOnResizeHandle"),!1;const a=e.getCellWidth(),r=e.getCellHeight(),s=e.getPitchRow,o=Math.min(10,r*.8),c=(t.start+t.duration)*a+6,d=s(t.pitch)*r+(r-o)/2,u=4,p=c-u,f=c+o+u,m=d-u,h=d+o+u;return i>=p&&i<=f&&n>=m&&n<=h}function Nl(e,t,i,n,a){const r=e.start*n+ie,s=i*a,o=e.duration*n,l=a-1,{scrollLeft:c,scrollTop:d,clientWidth:u,clientHeight:p}=t,f=r+o>=c&&r<=c+u&&s+l>=d&&s<=d+p,m=o>=2&&l>=2;return f&&m}function kr(e){let t=null,i=null,n=!1,a=0;function r(u){var S;if(bt(e.grid),wr()){Er(),e.scheduleRedraw();return}const{x:p,y:f}=e.getCanvasPos(u);if(p<0){const B=e.getPitchFromRow(Math.floor(f/e.getCellHeight()));e.sequencer.playNote(B,.5);return}const m=e.getSnappedBeatFromX(p),h=e.getPitchFromRow(Math.floor(f/e.getCellHeight())),_=j();if(m+e.config.currentDuration>_||e.notes.some(B=>B.pitch===h&&B.start===m))return;e.sequencer.playNote(h,.5);const g={pitch:h,start:m,duration:e.config.currentDuration};$(Ns(e.sequencer.id,[g]),Bs(e.sequencer.id,[g])),e.setSelectedNote(null);const v=e.getCellWidth(),b=e.getCellHeight(),N=e.getPitchRow(h);e.canvas.parentElement&&Nl(g,e.canvas.parentElement,N,v,b)&&vl(e,g,{getPitchRow:e.getPitchRow,cellWidth:v,cellHeight:b,labelWidth:ie}),e.scheduleRedraw(),(S=e.onNotesChanged)==null||S.call(e)}function s(u){u.preventDefault();const{x:p,y:f}=e.getCanvasPos(u),m=e.findNoteAt(p,f);if(!m||e.notes.indexOf(m)===-1)return;Sl(e,m,{getPitchRow:e.getPitchRow,cellWidth:e.getCellWidth(),cellHeight:e.getCellHeight(),labelWidth:ie});const _=[m];$(zi(e.sequencer.id,_),Xi(e.sequencer.id,_)),Er(),e.setSelectedNote(null),e.scheduleRedraw()}function o(u){if(On(e,u))return;const{x:p,y:f}=e.getCanvasPos(u),m=e.findNoteAt(p,f),h=ki();if(h&&bi(e,h,p,f)){Pr(h,p,f);return}if(m){if(bi(e,m,p,f)){Pr(m,p,f);return}bt(e.grid),e.setSelectedNote(m),bt(e.grid),e.setSelectedNote(m),t={startX:p,startY:f,anchorNote:m,initialNotes:[{note:m,start:m.start,midi:P(m.pitch)??0}],lastPreviewPitch:void 0};return}bl(p,f),n=!1}function l(u){var v,b,N;const p=performance.now();if(p-a<16)return;a=p,e.grid.setCursor("default");const{x:f,y:m}=e.getCanvasPos(u);if(f<0){e.clearPreview();return}const h=hi();if(h){e.grid.setCursor("ew-resize");const S=f-h.startX,B=e.getSnappedBeatFromX(S)-e.getSnappedBeatFromX(0),L=Math.max(Xs(),h.originalDuration+B);h.anchorNote.duration=L,yi(e),(v=e.onNotesChanged)==null||v.call(e);return}Tn(e,f,m),Fr(),e.grid.setCursor("default");const _=((b=e.getSelectedNotes)==null?void 0:b.call(e))??[];for(const S of _)if(bi(e,S,f,m)){_l(S),e.grid.setCursor("ew-resize");break}if(!h&&!n&&gl(f,m)){pl(),e.selectionBox={active:!0,startX:f,startY:m,currentX:f,currentY:m},n=!0,bt(e.grid),Ar();return}const y=e.findNoteAt(f,m);e.setHoveredNote(y??null);const g=e.getSelectedNote();if(hi()||(t&&g?e.grid.setCursor("grabbing"):y&&e.grid.setCursor("grab")),!y&&!t&&!wr()&&!ki()){const S=e.getSnappedBeatFromX(f),B=e.getPitchFromRow(Math.floor(m/e.getCellHeight())),L=j();S+e.config.currentDuration<=L?e.updatePreview({pitch:B,start:S,duration:e.config.currentDuration}):e.clearPreview()}else e.clearPreview();if(t&&g){const S=f-t.startX,B=e.getSnappedBeatFromX(S)-e.getSnappedBeatFromX(0),L=m-t.startY,M=Math.round(L/e.getCellHeight()),F=Math.max(0,t.initialNotes[0].start+B),w=j();F+g.duration<=w&&(g.start=F);const I=t.initialNotes[0].midi-M,T=P(e.config.noteRange[0])??0,q=P(e.config.noteRange[1])??127,D=Math.max(T,Math.min(q,I)),k=we(D)??g.pitch;k!==g.pitch&&(g.pitch=k,i!==k&&(i=k,e.sequencer.playNote(k,.5))),yi(e),(N=e.onNotesChanged)==null||N.call(e),vt();return}yi(e)}function c(u){Ar(),n=!1;const p=hi();if(p){const{anchorNote:y,originalDuration:g}=p,v=y.duration;g!==v&&$(Is(e.sequencer.id,[{pitch:y.pitch,start:y.start,newDuration:v}]),Ts(e.sequencer.id,[{pitch:y.pitch,start:y.start,oldDuration:g}])),yl(),vt();return}if(!t||!e.getSelectedNote()){t=null;return}const{anchorNote:f}=t,m=t.initialNotes.find(y=>y.note===f);if(!m)return;const h={pitch:m.note.pitch,start:m.note.start,duration:m.note.duration};(m.start!==m.note.start||m.midi!==P(m.note.pitch))&&$(ji(e.sequencer.id,[{pitch:we(m.midi)??m.note.pitch,start:m.start,duration:m.note.duration}],[h]),Bn(e.sequencer.id,[{pitch:we(m.midi)??m.note.pitch,start:m.start,duration:m.note.duration}],[h])),vt(),t=null}function d(){e.clearPreview(),e.setHoveredNote(null),Fr(),Rn(e),e.scheduleRedraw()}return{attach(u){u.addEventListener("click",r),u.addEventListener("contextmenu",s),u.addEventListener("mousemove",l),u.addEventListener("mouseleave",d),u.addEventListener("mousedown",o),u.addEventListener("mouseup",c)},detach(u){u.removeEventListener("click",r),u.removeEventListener("contextmenu",s),u.removeEventListener("mousemove",l),u.removeEventListener("mouseleave",d),u.removeEventListener("mousedown",o),u.removeEventListener("mouseup",c)}}}function Ir(e,{startX:t,currentX:i,startY:n,currentY:a,getCellHeight:r,getSnappedBeatFromX:s,getPitchFromRow:o}){const l=Math.min(t,i),c=Math.min(n,a),d=Math.max(t,i),u=Math.max(n,a),p=Math.floor(c/r()),f=Math.floor(u/r()),m=s(l),h=s(d),_=P(o(p)),y=P(o(f));return e.filter(g=>{const v=P(g.pitch);if(v===null||_===null||y===null)return!1;const b=g.start,S=g.start+g.duration>m&&b<h,B=v>=y-1&&v<=_+1;return S&&B})}function Tr(e){let t=null;function i(o){o.preventDefault();const{x:l,y:c}=e.getCanvasPos(o),d=e.findNoteAt(l,c);if(!d)return;const u=e.getSelectedNotes(),p=u.includes(d)?u:[d];p.length&&(e.setSelectedNotes([]),$(zi(e.sequencer.id,p),Xi(e.sequencer.id,p)),it()&&(tt(),fe(ue.NOTE_PLACEMENT)))}function n(o){if(!e.grid||On(e,o))return;const{x:l,y:c}=e.getCanvasPos(o);if(l<0)return;const d=e.findNoteAt(l,c);e.setHoveredNote(d??null),bt(e.grid);const u=e.getSelectedNotes();if(d&&u.includes(d)){t={startX:l,startY:c,anchorNote:d,initialNotes:u.map(p=>({note:p,start:p.start,midi:P(p.pitch)??0}))};return}e.selectionBox={active:!0,startX:l,startY:c,currentX:l,currentY:c},e.clearPreview(),e.setSelectedNote(null)}function a(o){var b,N;if(!e.grid)return;fl(e.grid);const{x:l,y:c}=e.getCanvasPos(o),d=e.findNoteAt(l,c);if(e.setHoveredNote(d??null),Tn(e,l,c),(b=e.selectionBox)!=null&&b.active){if(!e.setHighlightedNotes)return;e.selectionBox.currentX=l,e.selectionBox.currentY=c;const S=e.selectionBox,B=Ir(e.notes,{startX:S.startX,currentX:S.currentX,startY:S.startY,currentY:S.currentY,getCellHeight:e.getCellHeight,getSnappedBeatFromX:e.getSnappedBeatFromX,getPitchFromRow:e.getPitchFromRow});e.setHighlightedNotes(B),e.scheduleRedraw();return}if(!t)return;const u=t,p=l-u.startX,f=e.getSnappedBeatFromX(p)-e.getSnappedBeatFromX(0),m=c-u.startY,h=Math.round(m/e.getCellHeight()),_=j(),y=P(e.config.noteRange[0])??0,g=P(e.config.noteRange[1])??127;for(const{note:S,start:B,midi:L}of u.initialNotes){const M=Math.max(0,B+f),F=Math.max(y,Math.min(g,L-h)),w=we(F)??S.pitch;M+S.duration<=_&&(S.start=M,S.pitch=w)}const v=u.initialNotes.find(S=>S.note===u.anchorNote);if(v){const S=v.note.pitch;u.lastPreviewPitch!==S&&(u.lastPreviewPitch=S,e.sequencer.playNote(S,.5))}e.scheduleRedraw(),(N=e.onNotesChanged)==null||N.call(e)}function r(o){var l,c;if((l=t==null?void 0:t.initialNotes)!=null&&l.length){const{initialNotes:d}=t,u=d.map(({start:m,midi:h,note:_})=>({pitch:we(h)??_.pitch,start:m,duration:_.duration})),p=d.map(({note:m})=>({pitch:m.pitch,start:m.start,duration:m.duration}));u.some((m,h)=>m.pitch!==p[h].pitch||m.start!==p[h].start)&&($(ji(e.sequencer.id,u,p),Bn(e.sequencer.id,u,p)),it()&&(tt(),fe(ue.NOTE_PLACEMENT)))}if(t=null,(c=e.selectionBox)!=null&&c.active){if(!e.setHighlightedNotes)return;const{x:d,y:u}=e.getCanvasPos(o);e.selectionBox.currentX=d,e.selectionBox.currentY=u,e.selectionBox.active=!1;const p=Ir(e.notes,{startX:e.selectionBox.startX,currentX:e.selectionBox.currentX,startY:e.selectionBox.startY,currentY:e.selectionBox.currentY,getCellHeight:e.getCellHeight,getSnappedBeatFromX:e.getSnappedBeatFromX,getPitchFromRow:e.getPitchFromRow});e.setHighlightedNotes([]),e.setSelectedNotes(p),e.scheduleRedraw(),it()&&e.getSelectedNotes().length===0&&(o.stopPropagation(),tt(),fe(ue.NOTE_PLACEMENT),vt()),vt()}}function s(){e.setHighlightedNotes&&(e.setHoveredNote(null),e.setHighlightedNotes([]),Rn(e),e.scheduleRedraw())}return{attach(o){o.addEventListener("mousedown",n),o.addEventListener("mousemove",a),o.addEventListener("mouseup",r),o.addEventListener("mouseleave",s),o.addEventListener("contextmenu",i)},detach(o){o.removeEventListener("mousedown",n),o.removeEventListener("mousemove",a),o.removeEventListener("mouseup",r),o.removeEventListener("mouseleave",s),o.removeEventListener("contextmenu",i)}}}function Bl(e,t){const i=t.selectionBox;if(!i||!i.active)return;const{startX:n,startY:a,currentX:r,currentY:s}=i,o=Math.min(n,r),l=Math.min(a,s),c=Math.abs(r-n),d=Math.abs(s-a);c<1||d<1||(e.save(),e.strokeStyle="rgba(128, 90, 213, 1.0)",e.lineWidth=2,e.setLineDash([5,5]),Gi(e,o,l,c,d,3),e.stroke(),e.restore())}function Cl(e,t,{cellWidth:i,cellHeight:n,getPitchRow:a,isHovered:r=!1}){const s=Math.min(10,n*.8),l=(t.start+t.duration)*i+6,c=a(t.pitch)*n+(n-s)/2;e.save(),e.shadowColor="rgba(0,0,0,0.4)",e.shadowBlur=3,e.shadowOffsetX=1,e.shadowOffsetY=2,e.fillStyle=r?"rgba(0, 255, 255, 0.95)":"rgba(255, 255, 255, 0.85)",e.beginPath(),e.moveTo(l,c),e.lineTo(l+s,c+s/2),e.lineTo(l,c+s),e.closePath(),e.fill();const d=e.createLinearGradient(l,c,l,c+s);d.addColorStop(0,"rgba(255,255,255,0.9)"),d.addColorStop(.5,"rgba(255,255,255,0.5)"),d.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=d,e.beginPath(),e.moveTo(l,c),e.lineTo(l+s,c+s/2),e.lineTo(l,c+s),e.closePath(),e.fill(),e.restore()}function Ll(e,t,i,n,a,r,s){let o=null,l=null,c=null,d=null,u=[],p=2;const f=e.getContext("2d"),m=t.getContext("2d"),h=i.getContext("2d");if(!f||!m||!h)throw new Error("Failed to acquire required canvas contexts");const _=f,y=m,g=h;let v=Rt[p].cellWidth,b=Rt[p].cellHeight;const N=Ei(r.noteRange[1],r.noteRange[0])+1,S=N*b,L=j()*v+ie;e.width=L,e.height=S,e.style.width=`${L}px`,e.style.height=`${S}px`,t.width=L,t.height=S,t.style.width=`${L}px`,t.style.height=`${S}px`,i.width=L,i.height=S,i.style.width=`${L}px`,i.style.height=`${S}px`;let M=null;function F(){M!==null&&cancelAnimationFrame(M),M=requestAnimationFrame(T)}let w=!1;n.addEventListener("scroll",()=>{w||(w=!0,requestAnimationFrame(()=>{w=!1,F()}))});function I(E,J,K,V,ne=2){const ot=J.scrollLeft,Ua=J.clientWidth,Da=Math.floor((ot-K)/V),xa=Math.ceil((ot+Ua-K)/V),Nr=[];for(let pi=0;pi<E.length;pi++){const Tt=E[pi];Tt.start+Tt.duration>=Da-ne&&Tt.start<=xa&&Nr.push(Tt)}return Nr}function T(){var K,V,ne;_.clearRect(0,0,e.width,e.height),_.save(),_.translate(ie,0);const E=I(a,n,ie,v);let J=((K=s.instrumentName)==null?void 0:K.toLowerCase().includes("drum kit "))??!1;Qs(_,r,N,v,b,Fe,J),al(_,E,{cellWidth:v,cellHeight:b,visibleStartBeat:0,visibleEndBeat:e.width/v,getPitchRow:X,getPitchClass:Br,getTrackColor:()=>Mr(s),drawRoundedRect:Gi}),nl(_,{previewNotes:l??(o?[o]:null),hoveredNote:c,selectedNotes:u,highlightedNotes:((V=G.getHighlightedNotes)==null?void 0:V.call(G))??[],cellWidth:v,cellHeight:b,getPitchRow:X,getPitchClass:Br,getTrackColor:()=>Mr(s),drawRoundedRect:Gi});for(const ot of u)Cl(_,ot,{cellWidth:v,cellHeight:b,getPitchRow:X,isHovered:ot===ki()});(ne=G.selectionBox)!=null&&ne.active&&Bl(_,G),_.restore()}function q(){p<Rt.length-1&&(p++,U())}function D(){p>0&&(p--,U())}function k(){p=2,U()}function U(){const E=Rt[p];v=E.cellWidth,b=E.cellHeight,Ce()}function Ce(){const J=j()*v+ie,V=(Ei(r.noteRange[1],r.noteRange[0])+1)*b;e.width=J,e.height=V,e.style.width=`${J}px`,e.style.height=`${V}px`,t.width=J,t.height=V,t.style.width=`${J}px`,t.style.height=`${V}px`,i.width=J,i.height=V,i.style.width=`${J}px`,i.style.height=`${V}px`,g&&g.clearRect(0,0,i.width,i.height),F()}function $e(E){sl(y,E,ie,e.height)}dl(s.container,q,D,k);function X(E){const J=P(r.noteRange[1]),K=P(E);return J===null||K===null?(console.warn(`Invalid pitch encountered: ${E}`),0):J-K}function Fe(E){const J=P(r.noteRange[1]),K=P(r.noteRange[0]);if(J===null||K===null)return console.warn(`Invalid pitch range configured: ${r.noteRange}`),"C4";const V=J-E,ne=Math.max(K,Math.min(J,V));return we(ne)??"C4"}function A(){const E=document.getElementById("global-mini-contour");E instanceof HTMLCanvasElement&&re(E,R)}let x=null;const G={sequencer:s,grid:null,config:r,notes:a,canvas:e,animationCtx:g??null,getCellHeight:()=>b,getCellWidth:()=>v,getCanvasPos:E=>ll(e,E,n,ie),findNoteAt:(E,J)=>ol(E,J,a,X,b,v),scheduleRedraw:F,getPitchFromRow:Fe,getPitchRow:X,getSnappedBeatFromX:E=>za(E,r,()=>v),updatePreview:E=>o=E,clearPreview:()=>o=null,getSelectedNote:()=>d,setSelectedNote:E=>{d=E,u=E?[E]:[]},getSelectedNotes:()=>u,setSelectedNotes:E=>{u=E,d=E.length===1?E[0]:null},setHoveredNote:E=>c=E,onNotesChanged:A};function W(E){x==null||x.detach(e),x=E,x==null||x.attach(e)}function Z(){d=null,u=[],c=null,It=[],F()}const He={"note-placement":()=>W(kr(G)),select:()=>W(Tr(G)),none:()=>W(null)};let Ea=ml(E=>{var J,K,V;o=null,l=null,It=[],(J=G.clearPreview)==null||J.call(G),(K=G.setPastePreviewNotes)==null||K.call(G,null),G.selectionBox&&(G.selectionBox.active=!1,G.selectionBox=null),Z(),(V=He[E])==null||V.call(He),F()});function Fa(){return d}function Pa(){return o}function Aa(E){return E*v}function ka(E){e.style.cursor=E}function Ia(){return u}function Ta(E){u=E,d=E.length===1?E[0]:null}function Ra(E,J,K){var V;for(const ne of E)switch(J){case"set":ne.velocity=Math.max(1,Math.min(127,K));break;case"increase":ne.velocity=Math.max(1,Math.min(127,(ne.velocity??100)+K));break;case"decrease":ne.velocity=Math.max(1,Math.min(127,(ne.velocity??100)-K));break}(V=G.onNotesChanged)==null||V.call(G),F()}function Oa(){Ea(),$d()}const br={canvas:e,scheduleRedraw:F,drawPlayhead:$e,getSelectedNote:Fa,clearSelection:Z,getPreviewNote:Pa,zoomIn:q,zoomOut:D,getXForBeat:Aa,setMouseHandler:W,setCursor:ka,gridContext:G,getSelectedNotes:Ia,setSelectedNotes:Ta,destroy:Oa,resizeAndRedraw:Ce,applyVelocityChange:Ra},gr=Pi();let vr=null,Sr=null;gr==="note-placement"?(vr=kr(G),W(vr)):gr==="select"?(Sr=Tr(G),W(Sr)):W(null),G.setPastePreviewNotes=E=>{l=E};let It=[];return G.getHighlightedNotes=()=>It,G.setHighlightedNotes=E=>{It=E},G.grid=br,br}let Wt=null,Un=!1;function Qe(e="Loading Sounds...",t="Please wait while we dial it in.",i,n){if(Ha()||Dn()&&!n)return;n&&(ei(),Ii(!0));const a=document.getElementById("loading-modal"),r=document.getElementById("loading-modal-title"),s=document.getElementById("loading-modal-subtext"),o=document.getElementById("loading-modal-cancel");r&&(r.textContent=e),s&&(s.textContent=t),o&&(i?(o.classList.remove("hidden"),Wt=()=>{i(),Ii(!1),ei()},o.onclick=Wt):(o.classList.add("hidden"),o.onclick=null,Wt=null)),a&&a.classList.remove("hidden")}function ei(e){if(e&&Ii(!1),Dn())return;const t=document.getElementById("loading-modal"),i=document.getElementById("loading-modal-cancel");t&&t.classList.add("hidden"),i&&(i.classList.add("hidden"),i.onclick=null),Wt=null}function Ii(e){Un=e}function Dn(){return Un}var Ml=Object.defineProperty,Gl=Object.defineProperties,wl=Object.getOwnPropertyDescriptors,Rr=Object.getOwnPropertySymbols,El=Object.prototype.hasOwnProperty,Fl=Object.prototype.propertyIsEnumerable,xn=e=>{throw TypeError(e)},Or=(e,t,i)=>t in e?Ml(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,le=(e,t)=>{for(var i in t||(t={}))El.call(t,i)&&Or(e,i,t[i]);if(Rr)for(var i of Rr(t))Fl.call(t,i)&&Or(e,i,t[i]);return e},Ee=(e,t)=>Gl(e,wl(t)),or=(e,t,i)=>t.has(e)||xn("Cannot "+i),C=(e,t,i)=>(or(e,t,"read from private field"),i?i.call(e):t.get(e)),z=(e,t,i)=>t.has(e)?xn("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,i),H=(e,t,i,n)=>(or(e,t,"write to private field"),t.set(e,i),i),Kt=(e,t,i)=>(or(e,t,"access private method"),i),ee=(e,t,i)=>new Promise((n,a)=>{var r=l=>{try{o(i.next(l))}catch(c){a(c)}},s=l=>{try{o(i.throw(l))}catch(c){a(c)}},o=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,s);o((i=i.apply(e,t)).next())});function zt(e){const t=e.filter(i=>!!i);return t.reduce((i,n)=>{const a="output"in i?i.output:i,r="input"in n?n.input:n;return a.connect(r),n}),()=>{t.reduce((i,n)=>{const a="output"in i?i.output:i,r="input"in n?n.input:n;return a.disconnect(r),n})}}function Pl(e){let t=e;const i=new Set;function n(s){return i.add(s),s(t),()=>{i.delete(s)}}function a(s){t=s,i.forEach(o=>o(t))}function r(){return t}return{subscribe:n,set:a,get:r}}function Al(){const e=new Set;function t(n){return e.add(n),()=>{e.delete(n)}}function i(n){e.forEach(a=>a(n))}return{subscribe:t,trigger:i}}function kl(e){let t=!1;return()=>{t||(t=!0,e.forEach(i=>i==null?void 0:i()))}}function Jn(e){return e*e/16129}function Il(e){return Math.pow(10,e/20)}var Ie,Le,Ke,ze,Xt,Te,Re,qn=class{constructor(e,t){this.context=e,z(this,Ie),z(this,Le),z(this,Ke),z(this,ze),z(this,Xt),z(this,Te),z(this,Re,!1);var i,n,a;H(this,Te,{destination:(i=t==null?void 0:t.destination)!=null?i:e.destination,volume:(n=t==null?void 0:t.volume)!=null?n:100,volumeToGain:(a=t==null?void 0:t.volumeToGain)!=null?a:Jn}),this.input=e.createGain(),H(this,Ie,e.createGain()),H(this,ze,zt([this.input,C(this,Ie),C(this,Te).destination]));const r=Pl(C(this,Te).volume);this.setVolume=r.set,H(this,Xt,r.subscribe(s=>{C(this,Ie).gain.value=C(this,Te).volumeToGain(s)}))}addInsert(e){var t;if(C(this,Re))throw Error("Can't add insert to disconnected channel");(t=C(this,Ke))!=null||H(this,Ke,[]),C(this,Ke).push(e),C(this,ze).call(this),H(this,ze,zt([this.input,...C(this,Ke),C(this,Ie),C(this,Te).destination]))}addEffect(e,t,i){var n;if(C(this,Re))throw Error("Can't add effect to disconnected channel");const a=this.context.createGain();a.gain.value=i;const r="input"in t?t.input:t,s=zt([C(this,Ie),a,r]);(n=C(this,Le))!=null||H(this,Le,[]),C(this,Le).push({name:e,mix:a,disconnect:s})}sendEffect(e,t){var i;if(C(this,Re))throw Error("Can't send effect to disconnected channel");const n=(i=C(this,Le))==null?void 0:i.find(a=>a.name===e);n?n.mix.gain.value=t:console.warn("Send bus not found: "+e)}disconnect(){var e;C(this,Re)||(H(this,Re,!0),C(this,ze).call(this),C(this,Xt).call(this),(e=C(this,Le))==null||e.forEach(t=>t.disconnect()),H(this,Le,void 0))}};Ie=new WeakMap;Le=new WeakMap;Ke=new WeakMap;ze=new WeakMap;Xt=new WeakMap;Te=new WeakMap;Re=new WeakMap;var te,Tl=class{constructor(e){this.compare=e,z(this,te,[])}push(e){const t=C(this,te).length;let i=0,n=t-1,a=t;for(;i<=n;){const r=Math.floor((i+n)/2);this.compare(e,C(this,te)[r])<0?(a=r,n=r-1):i=r+1}C(this,te).splice(a,0,e)}pop(){return C(this,te).shift()}peek(){return C(this,te)[0]}removeAll(e){const t=C(this,te).length;return H(this,te,C(this,te).filter(i=>!e(i))),C(this,te).length!==t}clear(){H(this,te,[])}size(){return C(this,te).length}};te=new WeakMap;function Ur(e,t){return e&&t?i=>{e(i),t(i)}:e??t}function Rl(e){var t,i,n;const a={disableScheduler:(t=e.disableScheduler)!=null?t:!1,scheduleLookaheadMs:(i=e.scheduleLookaheadMs)!=null?i:200,scheduleIntervalMs:(n=e.scheduleIntervalMs)!=null?n:50,onStart:e.onStart,onEnded:e.onEnded};if(a.scheduleLookaheadMs<1)throw Error("scheduleLookaheadMs must be greater than 0");if(a.scheduleIntervalMs<1)throw Error("scheduleIntervalMs must be greater than 0");if(a.scheduleLookaheadMs<a.scheduleIntervalMs)throw Error("scheduleLookaheadMs must be greater than scheduleIntervalMs");return a}var _e,ae,Oe,$n=class{constructor(e,t={}){z(this,_e),z(this,ae),z(this,Oe),H(this,_e,Rl(t)),H(this,ae,new Tl((i,n)=>i.time-n.time)),this.player=e}get context(){return this.player.context}get buffers(){return this.player.buffers}get isRunning(){return C(this,Oe)!==void 0}start(e){var t;if(C(this,_e).disableScheduler)return this.player.start(e);const i=this.player.context,n=i.currentTime,a=(t=e.time)!=null?t:n,r=C(this,_e).scheduleLookaheadMs/1e3;return e.onStart=Ur(e.onStart,C(this,_e).onStart),e.onEnded=Ur(e.onEnded,C(this,_e).onEnded),a<n+r?this.player.start(e):(C(this,ae).push(Ee(le({},e),{time:a})),C(this,Oe)||H(this,Oe,setInterval(()=>{const s=i.currentTime+r;for(;C(this,ae).size()&&C(this,ae).peek().time<=s;){const o=C(this,ae).pop();o&&this.player.start(o)}C(this,ae).size()||(clearInterval(C(this,Oe)),H(this,Oe,void 0))},C(this,_e).scheduleIntervalMs)),s=>{!s||s<a?C(this,ae).removeAll(o=>o===e)||this.player.stop(Ee(le({},e),{time:s})):this.player.stop(Ee(le({},e),{time:s}))})}stop(e){var t;if(C(this,_e).disableScheduler)return this.player.stop(e);if(this.player.stop(e),!e){C(this,ae).clear();return}const i=(t=e==null?void 0:e.time)!=null?t:0,n=e==null?void 0:e.stopId;n?C(this,ae).removeAll(a=>a.time>=i&&a.stopId?a.stopId===n:a.note===n):C(this,ae).removeAll(a=>a.time>=i)}disconnect(){this.player.disconnect()}};_e=new WeakMap;ae=new WeakMap;Oe=new WeakMap;var pt,Xe,_t,Hn=class{constructor(e,t){this.context=e,this.options=t,z(this,pt),z(this,Xe,!1),z(this,_t);var i,n;H(this,pt,{velocityToGain:(i=t.velocityToGain)!=null?i:Jn,destination:(n=t.destination)!=null?n:e.destination}),this.buffers={},H(this,_t,Al())}start(e){var t,i,n,a,r,s,o,l,c,d,u,p,f,m;if(C(this,Xe))throw new Error("Can't start a sample on disconnected player");const h=this.context,_=e.name&&this.buffers[e.name]||this.buffers[e.note];if(!_)return console.warn(`Sample not found: '${e.note}'`),()=>{};const y=h.createBufferSource();y.buffer=_;const g=(i=(t=e.detune)!=null?t:this.options.detune)!=null?i:0;y.detune?y.detune.value=g:y.playbackRate&&(y.playbackRate.value=Math.pow(2,g/1200));const v=(n=e.lpfCutoffHz)!=null?n:this.options.lpfCutoffHz,b=v?h.createBiquadFilter():void 0;v&&b&&(b.type="lowpass",b.frequency.value=v);const N=h.createGain(),S=(r=(a=e.velocity)!=null?a:this.options.velocity)!=null?r:100;N.gain.value=C(this,pt).velocityToGain(S),((s=e.loop)!=null?s:this.options.loop)&&(y.loop=!0,y.loopStart=(o=e.loopStart)!=null?o:0,y.loopEnd=(l=e.loopEnd)!=null?l:_.duration);const L=(c=e.decayTime)!=null?c:this.options.decayTime,[M,F]=Ol(h,L);function w(U){if(U??(U=h.currentTime),U<=D)y.stop(U);else{const Ce=F(U);y.stop(Ce)}}const I=e.gainOffset?h.createGain():void 0;I&&e.gainOffset&&(I.gain.value=e.gainOffset);const T=(d=e.stopId)!=null?d:e.note,q=kl([zt([y,b,N,M,I,C(this,pt).destination]),(u=e.stop)==null?void 0:u.call(e,w),C(this,_t).subscribe(U=>{(!U||U.stopId===void 0||U.stopId===T)&&w(U==null?void 0:U.time)})]);y.onended=()=>{var U;q(),(U=e.onEnded)==null||U.call(e,e)},(p=e.onStart)==null||p.call(e,e);const D=Math.max((f=e.time)!=null?f:0,h.currentTime);y.start(e.time);let k=(m=e.duration)!=null?m:_.duration;return typeof e.duration=="number"&&w(D+k),w}stop(e){C(this,_t).trigger(e)}disconnect(){C(this,Xe)||(H(this,Xe,!0),this.stop(),Object.keys(this.buffers).forEach(e=>{delete this.buffers[e]}))}get connected(){return!C(this,Xe)}};pt=new WeakMap;Xe=new WeakMap;_t=new WeakMap;function Ol(e,t=.2){let i=0;const n=e.createGain();n.gain.value=1;function a(r){if(i)return i;n.gain.cancelScheduledValues(r);const s=r||e.currentTime;return i=s+t,n.gain.setValueAtTime(1,s),n.gain.linearRampToValueAtTime(0,i),i}return[n,a]}var si=class{constructor(e,t){this.context=e;const i=new qn(e,t);this.player=new $n(new Hn(e,Ee(le({},t),{destination:i.input})),t),this.output=i}get buffers(){return this.player.buffers}start(e){return this.player.start(e)}stop(e){this.player.stop(typeof e=="object"?e:e!==void 0?{stopId:e}:void 0)}disconnect(){this.output.disconnect(),this.player.disconnect()}};function dr(e,t,i){return ee(this,null,function*(){t=t.replace(/#/g,"%23").replace(/([^:]\/)\/+/g,"$1");const n=yield i.fetch(t);if(n.status!==200){console.warn("Error loading buffer. Invalid status: ",n.status,t);return}try{const a=yield n.arrayBuffer();return yield e.decodeAudioData(a)}catch(a){console.warn("Error loading buffer",a,t)}})}function li(e){if(typeof document>"u")return null;const t=document.createElement("audio");for(let i=0;i<e.length;i++){const n=e[i],a=t.canPlayType(`audio/${n}`);if(a==="probably"||a==="maybe")return n;if(n==="m4a"){const r=t.canPlayType("audio/aac");if(r==="probably"||r==="maybe")return n}}return null}function Ul(){var e;return"."+((e=li(["ogg","m4a"]))!=null?e:"ogg")}var At={fetch(e){return fetch(e)}};function Vn(e){return typeof e=="object"&&typeof e.baseUrl=="string"&&typeof e.name=="string"&&Array.isArray(e.samples)&&Array.isArray(e.groupNames)&&typeof e.nameToSampleName=="object"&&typeof e.sampleGroupVariations=="object"}var Dl={baseUrl:"",name:"",samples:[],groupNames:[],nameToSampleName:{},sampleGroupVariations:{}};function xl(e,t){return ee(this,null,function*(){var i,n,a,r;const o=yield(yield t.fetch(e)).json();o.baseUrl=e.replace("/dm.json",""),o.groupNames=[],o.nameToSampleName={},o.sampleGroupVariations={};for(const l of o.samples){o.nameToSampleName[l]=l;const c=l.indexOf("/")!==-1?"/":"-",[d,u]=l.split(c);o.groupNames.includes(d)||o.groupNames.push(d),(n=(i=o.nameToSampleName)[d])!=null||(i[d]=l),(r=(a=o.sampleGroupVariations)[d])!=null||(a[d]=[]),u&&o.sampleGroupVariations[d].push(`${d}${c}${u}`)}return o})}function Wn(){return Object.keys(Kn)}var Kn={"TR-808":"https://smpldsnds.github.io/drum-machines/TR-808/dm.json","Casio-RZ1":"https://smpldsnds.github.io/drum-machines/Casio-RZ1/dm.json","LM-2":"https://smpldsnds.github.io/drum-machines/LM-2/dm.json","MFB-512":"https://smpldsnds.github.io/drum-machines/MFB-512/dm.json","Roland CR-8000":"https://smpldsnds.github.io/drum-machines/Roland-CR-8000/dm.json"};function Jl(e){var t,i,n;const a={instrument:(t=e==null?void 0:e.instrument)!=null?t:"TR-808",storage:(i=e==null?void 0:e.storage)!=null?i:At,url:(n=e==null?void 0:e.url)!=null?n:""};if(typeof a.instrument=="string"){if(a.url||(a.url=Kn[a.instrument]),!a.url)throw new Error("Invalid instrument: "+a.instrument)}else if(!Vn(a.instrument))throw new Error("Invalid instrument: "+a.instrument);return a}var ye,ql=class{constructor(e,t){z(this,ye,Dl);const i=Jl(t),n=Vn(i.instrument)?Promise.resolve(i.instrument):xl(i.url,i.storage);this.player=new si(e,t),this.output=this.player.output,this.load=$l(e,this.player.buffers,n,i.storage).then(()=>this),n.then(a=>{H(this,ye,a)})}getSampleNames(){return C(this,ye).samples.slice()}getGroupNames(){return C(this,ye).groupNames.slice()}getSampleNamesForGroup(e){var t;return(t=C(this,ye).sampleGroupVariations[e])!=null?t:[]}start(e){var t;const i=C(this,ye).nameToSampleName[e.note];return this.player.start(Ee(le({},e),{note:i||e.note,stopId:(t=e.stopId)!=null?t:e.note}))}stop(e){return this.player.stop(e)}loaded(){return ee(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}get sampleNames(){return console.log("deprecated: Use getGroupNames instead"),C(this,ye).groupNames.slice()}getVariations(e){var t;return console.warn("deprecated: use getSampleNamesForGroup"),(t=C(this,ye).sampleGroupVariations[e])!=null?t:[]}};ye=new WeakMap;function $l(e,t,i,n){var a;const r=(a=li(["ogg","m4a"]))!=null?a:"ogg";return i.then(s=>Promise.all(s.samples.map(o=>ee(this,null,function*(){const l=`${s.baseUrl}/${o}.${r}`,c=yield dr(e,l,n);c&&(t[o]=c)}))))}function Hl(e){const i=/^([a-gA-G]?)(#{1,}|b{1,}|)(-?\d+)$/.exec(e);if(!i)return;const n=i[1].toUpperCase();if(!n)return;const a=i[2],r=a[0]==="b"?-a.length:a.length,s=i[3]?+i[3]:4,o=(n.charCodeAt(0)+3)%7;return[0,2,4,5,7,9,11][o]+r+12*(s+1)}function Be(e){return e===void 0?void 0:typeof e=="number"?e:Hl(e)}function Vl(e={}){return{groups:[],options:e}}function cr(){return{regions:[]}}function zn(e,t,i,n){const a=[],r=Be(t.note);if(r===void 0)return a;for(const s of e.regions){const o=Xn(r,i??0,t,s,n);o&&a.push(o)}return a}function Wl(e,t,i,n){const a=Be(t.note);if(a!==void 0)for(const r of e.regions){const s=Xn(a,0,t,r,n);if(s)return s}}function Xn(e,t,i,n,a){var r,s,o,l,c,d,u,p,f,m,h,_,y,g,v,b,N,S,B,L,M,F,w,I,T,q,D,k;if(!(e>=((r=n.midiLow)!=null?r:0)&&e<((s=n.midiHigh)!=null?s:127)+1)||!(i.velocity===void 0||i.velocity>=((o=n.velLow)!=null?o:0)&&i.velocity<=((l=n.velHigh)!=null?l:127)))return;if(n.seqLength){const G=t%n.seqLength,W=((c=n.seqPosition)!=null?c:1)-1;if(G!==W)return}const $e=e-n.midiPitch,X=(d=i.velocity)!=null?d:a==null?void 0:a.velocity,Fe=n.volume?Il(n.volume):0,A=(p=(u=i.gainOffset)!=null?u:void 0)!=null?p:0,x=(f=i.detune)!=null?f:0;return{decayTime:(_=(h=i==null?void 0:i.decayTime)!=null?h:(m=n.sample)==null?void 0:m.decayTime)!=null?_:a==null?void 0:a.decayTime,detune:100*($e+((y=n.tune)!=null?y:0))+x,duration:(b=(v=i==null?void 0:i.duration)!=null?v:(g=n.sample)==null?void 0:g.duration)!=null?b:a==null?void 0:a.duration,gainOffset:A+Fe||void 0,loop:(B=(S=i==null?void 0:i.loop)!=null?S:(N=n.sample)==null?void 0:N.loop)!=null?B:a==null?void 0:a.loop,loopEnd:(F=(M=i==null?void 0:i.loopEnd)!=null?M:(L=n.sample)==null?void 0:L.loopEnd)!=null?F:a==null?void 0:a.loopEnd,loopStart:(T=(I=i==null?void 0:i.loopStart)!=null?I:(w=n.sample)==null?void 0:w.loopStart)!=null?T:a==null?void 0:a.loopStart,lpfCutoffHz:(k=(D=i==null?void 0:i.lpfCutoffHz)!=null?D:(q=n.sample)==null?void 0:q.lpfCutoffHz)!=null?k:a==null?void 0:a.lpfCutoffHz,name:n.sampleName,note:e,onEnded:i.onEnded,onStart:i.onStart,stopId:i.name,time:i.time,velocity:X??void 0}}function Kl(e){if(e.length===0)return[];if(e.sort((t,i)=>t.midiPitch-i.midiPitch),e[0].midiLow=0,e[0].midiHigh=127,e.length===1)return e;for(let t=1;t<e.length;t++){const i=e[t-1],n=e[t],a=Math.floor((i.midiPitch+n.midiPitch)/2);i.midiHigh=a,n.midiLow=a+1}return e[e.length-1].midiHigh=127,e}var zl=class{constructor(e,t){this.context=e,this.seqNum=0;const i=new qn(e,t);this.instrument=Vl(t),this.player=new $n(new Hn(e,Ee(le({},t),{destination:i.input})),t),this.output=i}get buffers(){return this.player.buffers}start(e){const t=[],i=typeof e=="object"?e:{note:e};for(const n of this.instrument.groups){const a=zn(n,i,this.seqNum);this.seqNum++;for(const r of a){let s=this.player.start(r);t.push(s)}}return n=>t.forEach(a=>a(n))}stop(e){if(e==null){this.player.stop();return}const t=typeof e=="object"?e:{stopId:e},i=Be(t.stopId);i&&(t.stopId=i,this.player.stop(t))}disconnect(){this.output.disconnect(),this.player.disconnect()}};function jn(e,t){const i=Ul();return(n,a)=>ee(this,null,function*(){const r=yield fetch(e).then(l=>l.text()),s=Xl(r,t.group);s.length&&console.warn("Problems converting sfz",s);const o=new Set;return t.group.regions.forEach(l=>o.add(l.sampleName)),Promise.all(Array.from(o).map(l=>ee(this,null,function*(){const c=t.urlFromSampleName(l,i),d=yield dr(n,c,a);t.buffers[l]=d}))).then(()=>t.group)})}function Xl(e,t){let i="global";const n=e.split(`
`).map(eo).filter(s=>!!s),a=new to;let r=[];for(const s of n)switch(s.type){case"mode":r.push(a.closeScope(i,t)),i=s.value;break;case"prop:num":case"prop:str":case"prop:num_arr":a.push(s.key,s.value);break;case"unknown":console.warn("Unknown SFZ token",s.value);break}return r.filter(s=>!!s)}var jl=/^<([^>]+)>$/,Yl=/^([^=]+)=([-\.\d]+)$/,Ql=/^([^=]+)=(.+)$/,Zl=/^([^=]+)_(\d+)=(\d+)$/;function eo(e){if(e=e.trim(),e===""||e.startsWith("//"))return;const t=e.match(jl);if(t)return{type:"mode",value:t[1]};const i=e.match(Zl);if(i)return{type:"prop:num_arr",key:i[1],value:[Number(i[2]),Number(i[3])]};const n=e.match(Yl);if(n)return{type:"prop:num",key:n[1],value:Number(n[2])};const a=e.match(Ql);return a?{type:"prop:str",key:a[1],value:a[2]}:{type:"unknown",value:e}}var yt,jt,to=class{constructor(){z(this,yt),this.values={},this.global={},this.group={}}closeScope(e,t){if(e==="global")Kt(this,yt,jt).call(this,this.global);else if(e==="group")this.group=Kt(this,yt,jt).call(this,{});else if(e==="region"){const i=Kt(this,yt,jt).call(this,le(le({sampleName:"",midiPitch:-1},this.global),this.group));if(i.sampleName==="")return"Missing sample name";if(i.midiPitch===-1)if(i.midiLow!==void 0)i.midiPitch=i.midiLow;else return"Missing pitch_keycenter";i.seqLength&&i.seqPosition===void 0&&(i.seqPosition=1),i.ampRelease&&(i.sample={decayTime:i.ampRelease},delete i.ampRelease),t.regions.push(i)}}get empty(){return Object.keys(this.values).length===0}get keys(){return Object.keys(this.values)}push(e,t){this.values[e]=t}popNum(e,t,i){return typeof this.values[e]!="number"?!1:(t[i]=this.values[e],delete this.values[e],!0)}popStr(e,t,i){return typeof this.values[e]!="string"?!1:(t[i]=this.values[e],delete this.values[e],!0)}popNumArr(e,t,i){return Array.isArray(this.values[e])?(t[i]=this.values[e],delete this.values[e],!0):!1}};yt=new WeakSet;jt=function(e){return this.popStr("sample",e,"sampleName"),this.popNum("pitch_keycenter",e,"midiPitch"),this.popNum("ampeg_attack",e,"ampAttack"),this.popNum("ampeg_release",e,"ampRelease"),this.popNum("bend_down",e,"bendDown"),this.popNum("bend_up",e,"bendUp"),this.popNum("group",e,"group"),this.popNum("hikey",e,"midiHigh"),this.popNum("hivel",e,"velHigh"),this.popNum("lokey",e,"midiLow"),this.popNum("offset",e,"offset"),this.popNum("lovel",e,"velLow"),this.popNum("off_by",e,"groupOffBy"),this.popNum("pitch_keytrack",e,"ignore"),this.popNum("seq_length",e,"seqLength"),this.popNum("seq_position",e,"seqPosition"),this.popNum("tune",e,"tune"),this.popNum("volume",e,"volume"),this.popNumArr("amp_velcurve",e,"ampVelCurve"),this.values={},e};var io="https://smpldsnds.github.io/sgossner-vcsl/";function ro(e){return io+e+".sfz"}function no(e,t){const i=ro(e),a=`https://smpldsnds.github.io/sgossner-vcsl/${e.slice(0,e.lastIndexOf("/")+1)}`,r=cr();return jn(i,{buffers:t,group:r,urlFromSampleName:(s,o)=>a+"/"+s.replace(".wav",o)})}var ao=class{constructor(e,t={}){var i,n;this.config={instrument:(i=t.instrument)!=null?i:"Arco",storage:(n=t.storage)!=null?n:At},this.player=new zl(e,t);const a=no(this.config.instrument,this.player.buffers);this.load=a(e,this.config.storage).then(r=>(this.player.instrument.groups.push(r),this))}get output(){return this.player.output}get buffers(){return this.player.buffers}get context(){return this.player.context}start(e){return this.player.start(e)}stop(e){return this.player.stop(e)}disconnect(){this.player.disconnect()}};function so(){return Object.keys(Yn)}var lo=class extends ao{constructor(e,t){var i;super(e,Ee(le({},t),{instrument:Yn[(i=t.instrument)!=null?i:""]}))}},Yn={"Balafon - Hard Mallet":"Idiophones/Struck Idiophones/Balafon - Hard Mallet","Balafon - Keyswitch":"Idiophones/Struck Idiophones/Balafon - Keyswitch","Balafon - Soft Mallet":"Idiophones/Struck Idiophones/Balafon - Soft Mallet","Balafon - Traditional Mallet":"Idiophones/Struck Idiophones/Balafon - Traditional Mallet","Tubular Bells 1":"Idiophones/Struck Idiophones/Tubular Bells 1","Tubular Bells 2":"Idiophones/Struck Idiophones/Tubular Bells 2","Vibraphone - Bowed":"Idiophones/Struck Idiophones/Vibraphone - Bowed","Vibraphone - Hard Mallets":"Idiophones/Struck Idiophones/Vibraphone - Hard Mallets","Vibraphone - Keyswitch":"Idiophones/Struck Idiophones/Vibraphone - Keyswitch","Vibraphone - Soft Mallets":"Idiophones/Struck Idiophones/Vibraphone - Soft Mallets","Xylophone - Hard Mallets":"Idiophones/Struck Idiophones/Xylophone - Hard Mallets","Xylophone - Keyswitch":"Idiophones/Struck Idiophones/Xylophone - Keyswitch","Xylophone - Medium Mallets":"Idiophones/Struck Idiophones/Xylophone - Medium Mallets","Xylophone - Soft Mallets":"Idiophones/Struck Idiophones/Xylophone - Soft Mallets"};function oo(){return["Pizzicato","Arco","Switched"]}function co(e){return`https://smpldsnds.github.io/sfzinstruments-dsmolken-double-bass/d_smolken_rubner_bass_${{Arco:"arco",Pizzicato:"pizz",Switched:"switched"}[e]}.sfz`}var uo=class{constructor(e,t={}){this.seqNum=0;var i,n;this.config={instrument:(i=t.instrument)!=null?i:"Arco",storage:(n=t.storage)!=null?n:At},this.player=new si(e,t),this.group=cr();const a=co(this.config.instrument),r=jn(a,{buffers:this.player.buffers,group:this.group,urlFromSampleName:(s,o)=>`https://smpldsnds.github.io/sfzinstruments-dsmolken-double-bass/${s.replace("\\","/").replace(".wav",o)}`});this.load=r(e,this.config.storage).then(()=>this)}get output(){return this.player.output}get buffers(){return this.player.buffers}get context(){return this.player.context}start(e){const t=zn(this.group,typeof e=="object"?e:{note:e},this.seqNum);this.seqNum++;const i=t.map(n=>this.player.start(n));return n=>i.forEach(a=>a(n))}stop(e){if(e==null){this.player.stop();return}const t=typeof e=="object"?e:{stopId:e},i=Be(t.stopId);i&&(t.stopId=i,this.player.stop(t))}disconnect(){this.player.disconnect()}};function fo(e,t){var i;const n=(i=li(["ogg","mp3"]))!=null?i:"mp3";return`https://gleitz.github.io/midi-js-soundfonts/${t}/${e}-${n}.js`}function mo(e,t,i){return(n,a)=>ee(this,null,function*(){const r=yield(yield a.fetch(e)).text(),s=po(r),o=Object.keys(s);yield Promise.all(o.map(l=>ee(this,null,function*(){const c=Be(l);if(!c)return;const d=yo(_o(s[l])),u=yield n.decodeAudioData(d);t[l]=u,i.regions.push({sampleName:l,midiPitch:c})}))),Kl(i.regions)})}function po(e){const t=e.indexOf("MIDI.Soundfont.");if(t<0)throw Error("Invalid MIDI.js Soundfont format");const i=e.indexOf("=",t)+2,n=e.lastIndexOf(",");return JSON.parse(e.slice(i,n)+"}")}function _o(e){return e.slice(e.indexOf(",")+1)}function yo(e){const t=window.atob(e),i=t.length,n=new Uint8Array(i);for(let a=0;a<i;a++)n[a]=t.charCodeAt(a);return n.buffer}var ho=["MusyngKite","FluidR3_GM"],bo=["accordion","acoustic_bass","acoustic_grand_piano","acoustic_guitar_nylon","acoustic_guitar_steel","agogo","alto_sax","applause","bagpipe","banjo","baritone_sax","bassoon","bird_tweet","blown_bottle","brass_section","breath_noise","bright_acoustic_piano","celesta","cello","choir_aahs","church_organ","clarinet","clavinet","contrabass","distortion_guitar","drawbar_organ","dulcimer","electric_bass_finger","electric_bass_pick","electric_grand_piano","electric_guitar_clean","electric_guitar_jazz","electric_guitar_muted","electric_piano_1","electric_piano_2","english_horn","fiddle","flute","french_horn","fretless_bass","fx_1_rain","fx_2_soundtrack","fx_3_crystal","fx_4_atmosphere","fx_5_brightness","fx_6_goblins","fx_7_echoes","fx_8_scifi","glockenspiel","guitar_fret_noise","guitar_harmonics","gunshot","harmonica","harpsichord","helicopter","honkytonk_piano","kalimba","koto","lead_1_square","lead_2_sawtooth","lead_3_calliope","lead_4_chiff","lead_5_charang","lead_6_voice","lead_7_fifths","lead_8_bass__lead","marimba","melodic_tom","music_box","muted_trumpet","oboe","ocarina","orchestra_hit","orchestral_harp","overdriven_guitar","pad_1_new_age","pad_2_warm","pad_3_polysynth","pad_4_choir","pad_5_bowed","pad_6_metallic","pad_7_halo","pad_8_sweep","pan_flute","percussive_organ","piccolo","pizzicato_strings","recorder","reed_organ","reverse_cymbal","rock_organ","seashore","shakuhachi","shamisen","shanai","sitar","slap_bass_1","slap_bass_2","soprano_sax","steel_drums","string_ensemble_1","string_ensemble_2","synth_bass_1","synth_bass_2","synth_brass_1","synth_brass_2","synth_choir","synth_drum","synth_strings_1","synth_strings_2","taiko_drum","tango_accordion","telephone_ring","tenor_sax","timpani","tinkle_bell","tremolo_strings","trombone","trumpet","tuba","tubular_bells","vibraphone","viola","violin","voice_oohs","whistle","woodblock","xylophone"];function go(e,t){if(!e.startsWith("http"))return`https://goldst.dev/midi-js-soundfonts/${t}/${e}-loop.json`}function vo(e,t=44100){return ee(this,null,function*(){if(e)try{const i=yield fetch(e);if(i.status!==200)return;const n=yield i.json(),a={};return Object.keys(n).forEach(r=>{const s=Be(r);if(s){const o=n[r];a[s]=[o[0]/t,o[1]/t]}}),a}catch{return}})}function So(){return ho}function No(){return bo}var ht,Bo=class{constructor(e,t){this.context=e,z(this,ht),this.config=Lo(t),this.player=new si(e,t),this.group=cr(),H(this,ht,!1);const i=Co(this.config.instrumentUrl,this.config.loopDataUrl,this.player.buffers,this.group);this.load=i(e,this.config.storage).then(a=>(H(this,ht,a),this));const n=e.createGain();n.gain.value=this.config.extraGain,this.player.output.addInsert(n)}get output(){return this.player.output}get hasLoops(){return C(this,ht)}loaded(){return ee(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}disconnect(){this.player.disconnect()}start(e){const t=Wl(this.group,typeof e=="object"?e:{note:e});return t?this.player.start(t):()=>{}}stop(e){return this.player.stop(e)}};ht=new WeakMap;function Co(e,t,i,n){const a=mo(e,i,n);return(r,s)=>ee(this,null,function*(){const[o,l]=yield Promise.all([a(r,s),vo(t)]);return l&&n.regions.forEach(c=>{var d;const u=l[c.midiPitch];u&&((d=c.sample)!=null||(c.sample={}),c.sample.loop=!0,c.sample.loopStart=u[0],c.sample.loopEnd=u[1])}),!!l})}function Lo(e){var t,i,n,a;if(!e.instrument&&!e.instrumentUrl)throw Error("Soundfont: instrument or instrumentUrl is required");const r={kit:"MusyngKite",instrument:e.instrument,storage:(t=e.storage)!=null?t:At,extraGain:(i=e.extraGain)!=null?i:5,loadLoopData:(n=e.loadLoopData)!=null?n:!1,loopDataUrl:e.loopDataUrl,instrumentUrl:(a=e.instrumentUrl)!=null?a:""};if(r.instrument&&r.instrument.startsWith("http")&&(console.warn("Use 'instrumentUrl' instead of 'instrument' to load from a URL"),r.instrumentUrl=r.instrument,r.instrument=void 0),r.instrumentUrl)(r.kit||r.instrument)&&console.warn("Soundfont: 'kit' and 'instrument' config parameters are ignored because 'instrumentUrl' is explicitly set.");else if(r.instrument)r.instrumentUrl=fo(r.instrument,r.kit);else throw Error("Soundfont: 'instrument' or 'instrumentUrl' configuration parameter is required");return r.loadLoopData&&r.instrument&&!r.loopDataUrl&&(r.loopDataUrl=go(r.instrument,r.kit)),r}var Mo="https://danigb.github.io/samples/splendid-grand-piano",Ti,Qn,Go=class{constructor(e,t){this.context=e,z(this,Ti),this.options=Object.assign({baseUrl:Mo,storage:At,detune:0,volume:100,velocity:100,decayTime:.5},t),this.player=new si(e,this.options);const i=Eo(this.options.baseUrl,this.options.storage,this.options.notesToLoad);this.load=i(e,this.player.buffers).then(()=>this)}get output(){return this.player.output}get buffers(){return this.player.buffers}loaded(){return ee(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}start(e){var t,i;const n=typeof e=="object"?le({},e):{note:e},a=Kt(this,Ti,Qn).call(this,n);return a?(n.note=a[0],n.stopId=(t=n.stopId)!=null?t:a[1],n.detune=a[2]+((i=n.detune)!=null?i:this.options.detune),this.player.start(n)):()=>{}}stop(e){var t;if(typeof e=="string")return this.player.stop((t=Be(e))!=null?t:e);if(typeof e=="object"){const i=Be(e.stopId);return this.player.stop(i!==void 0?Ee(le({},e),{stopId:i}):e)}else return this.player.stop(e)}};Ti=new WeakSet;Qn=function(e){var t;const i=Be(e.note);if(!i)return;const n=(t=e.velocity)!=null?t:this.options.velocity,a=ti.findIndex(s=>n>=s.vel_range[0]&&n<=s.vel_range[1]),r=ti[a];if(r)return wo(r.name,i,this.player.buffers)};function wo(e,t,i){let n=0;for(;i[e+(t+n)]===void 0&&n<128;)n>0?n=-n:n=-n+1;return n===127?[e+t,t,0]:[e+(t+n),t,-n*100]}function Eo(e,t,i){var n;const a=(n=li(["ogg","m4a"]))!=null?n:"ogg";let r=i?ti.filter(s=>s.vel_range[0]<=i.velocityRange[1]&&s.vel_range[1]>=i.velocityRange[0]):ti;return(s,o)=>ee(this,null,function*(){for(const l of r){const c=i?l.samples.filter(d=>i.notes.includes(d[0])):l.samples;yield Promise.all(c.map(d=>ee(this,[d],function*([u,p]){const f=`${e}/${p}.${a}`,m=yield dr(s,f,t);m&&(o[l.name+u]=m)})))}})}var ti=[{name:"PPP",vel_range:[1,40],cutoff:1e3,samples:[[23,"PP-B-1"],[27,"PP-D#0"],[29,"PP-F0"],[31,"PP-G0"],[33,"PP-A0"],[35,"PP-B0"],[37,"PP-C#1"],[38,"PP-D1"],[40,"PP-E1"],[41,"PP-F1"],[43,"PP-G1"],[45,"PP-A1"],[47,"PP-B1"],[48,"PP-C2"],[50,"PP-D2"],[52,"PP-E2"],[53,"PP-F2"],[55,"PP-G2"],[56,"PP-G#2"],[57,"PP-A2"],[58,"PP-A#2"],[59,"PP-B2"],[60,"PP-C3"],[62,"PP-D3"],[64,"PP-E3"],[65,"PP-F3"],[67,"PP-G3"],[69,"PP-A3"],[71,"PP-B3"],[72,"PP-C4"],[74,"PP-D4"],[76,"PP-E4"],[77,"PP-F4"],[79,"PP-G4"],[80,"PP-G#4"],[81,"PP-A4"],[82,"PP-A#4"],[83,"PP-B4"],[85,"PP-C#5"],[86,"PP-D5"],[87,"PP-D#5"],[89,"PP-F5"],[90,"PP-F#5"],[91,"PP-G5"],[92,"PP-G#5"],[93,"PP-A5"],[94,"PP-A#5"],[95,"PP-B5"],[96,"PP-C6"],[97,"PP-C#6"],[98,"PP-D6"],[99,"PP-D#6"],[100,"PP-E6"],[101,"PP-F6"],[102,"PP-F#6"],[103,"PP-G6"],[104,"PP-G#6"],[105,"PP-A6"],[106,"PP-A#6"],[107,"PP-B6"],[108,"PP-C7"]]},{name:"PP",vel_range:[41,67],samples:[[23,"PP-B-1"],[27,"PP-D#0"],[29,"PP-F0"],[31,"PP-G0"],[33,"PP-A0"],[35,"PP-B0"],[37,"PP-C#1"],[38,"PP-D1"],[40,"PP-E1"],[41,"PP-F1"],[43,"PP-G1"],[45,"PP-A1"],[47,"PP-B1"],[48,"PP-C2"],[50,"PP-D2"],[52,"PP-E2"],[53,"PP-F2"],[55,"PP-G2"],[56,"PP-G#2"],[57,"PP-A2"],[58,"PP-A#2"],[59,"PP-B2"],[60,"PP-C3"],[62,"PP-D3"],[64,"PP-E3"],[65,"PP-F3"],[67,"PP-G3"],[69,"PP-A3"],[71,"PP-B3"],[72,"PP-C4"],[74,"PP-D4"],[76,"PP-E4"],[77,"PP-F4"],[79,"PP-G4"],[80,"PP-G#4"],[81,"PP-A4"],[82,"PP-A#4"],[83,"PP-B4"],[85,"PP-C#5"],[86,"PP-D5"],[87,"PP-D#5"],[89,"PP-F5"],[90,"PP-F#5"],[91,"PP-G5"],[92,"PP-G#5"],[93,"PP-A5"],[94,"PP-A#5"],[95,"PP-B5"],[96,"PP-C6"],[97,"PP-C#6"],[98,"PP-D6"],[99,"PP-D#6"],[100,"PP-E6"],[101,"PP-F6"],[102,"PP-F#6"],[103,"PP-G6"],[104,"PP-G#6"],[105,"PP-A6"],[106,"PP-A#6"],[107,"PP-B6"],[108,"PP-C7"]]},{name:"MP",vel_range:[68,84],samples:[[23,"Mp-B-1"],[27,"Mp-D#0"],[29,"Mp-F0"],[31,"Mp-G0"],[33,"Mp-A0"],[35,"Mp-B0"],[37,"Mp-C#1"],[38,"Mp-D1"],[40,"Mp-E1"],[41,"Mp-F1"],[43,"Mp-G1"],[45,"Mp-A1"],[47,"Mp-B1"],[48,"Mp-C2"],[50,"Mp-D2"],[52,"Mp-E2"],[53,"Mp-F2"],[55,"Mp-G2"],[56,"Mp-G#2"],[57,"Mp-A2"],[58,"Mp-A#2"],[59,"Mp-B2"],[60,"Mp-C3"],[62,"Mp-D3"],[64,"Mp-E3"],[65,"Mp-F3"],[67,"Mp-G3"],[69,"Mp-A3"],[71,"Mp-B3"],[72,"Mp-C4"],[74,"Mp-D4"],[76,"Mp-E4"],[77,"Mp-F4"],[79,"Mp-G4"],[80,"Mp-G#4"],[81,"Mp-A4"],[82,"Mp-A#4"],[83,"Mp-B4"],[85,"Mp-C#5"],[86,"Mp-D5"],[87,"Mp-D#5"],[88,"Mp-E5"],[89,"Mp-F5"],[90,"Mp-F#5"],[91,"Mp-G5"],[92,"Mp-G#5"],[93,"Mp-A5"],[94,"Mp-A#5"],[95,"Mp-B5"],[96,"Mp-C6"],[97,"Mp-C#6"],[98,"Mp-D6"],[99,"Mp-D#6"],[100,"PP-E6"],[101,"Mp-F6"],[102,"Mp-F#6"],[103,"Mp-G6"],[104,"Mp-G#6"],[105,"Mp-A6"],[106,"Mp-A#6"],[107,"PP-B6"],[108,"PP-C7"]]},{name:"MF",vel_range:[85,100],samples:[[23,"Mf-B-1"],[27,"Mf-D#0"],[29,"Mf-F0"],[31,"Mf-G0"],[33,"Mf-A0"],[35,"Mf-B0"],[37,"Mf-C#1"],[38,"Mf-D1"],[40,"Mf-E1"],[41,"Mf-F1"],[43,"Mf-G1"],[45,"Mf-A1"],[47,"Mf-B1"],[48,"Mf-C2"],[50,"Mf-D2"],[52,"Mf-E2"],[53,"Mf-F2"],[55,"Mf-G2"],[56,"Mf-G#2"],[57,"Mf-A2"],[58,"Mf-A#2"],[59,"Mf-B2"],[60,"Mf-C3"],[62,"Mf-D3"],[64,"Mf-E3"],[65,"Mf-F3"],[67,"Mf-G3"],[69,"Mf-A3"],[71,"Mf-B3"],[72,"Mf-C4"],[74,"Mf-D4"],[76,"Mf-E4"],[77,"Mf-F4"],[79,"Mf-G4"],[80,"Mf-G#4"],[81,"Mf-A4"],[82,"Mf-A#4"],[83,"Mf-B4"],[85,"Mf-C#5"],[86,"Mf-D5"],[87,"Mf-D#5"],[88,"Mf-E5"],[89,"Mf-F5"],[90,"Mf-F#5"],[91,"Mf-G5"],[92,"Mf-G#5"],[93,"Mf-A5"],[94,"Mf-A#5"],[95,"Mf-B5"],[96,"Mf-C6"],[97,"Mf-C#6"],[98,"Mf-D6"],[99,"Mf-D#6"],[100,"Mf-E6"],[101,"Mf-F6"],[102,"Mf-F#6"],[103,"Mf-G6"],[104,"Mf-G#6"],[105,"Mf-A6"],[106,"Mf-A#6"],[107,"Mf-B6"],[108,"PP-C7"]]},{name:"FF",vel_range:[101,127],samples:[[23,"FF-B-1"],[27,"FF-D#0"],[29,"FF-F0"],[31,"FF-G0"],[33,"FF-A0"],[35,"FF-B0"],[37,"FF-C#1"],[38,"FF-D1"],[40,"FF-E1"],[41,"FF-F1"],[43,"FF-G1"],[45,"FF-A1"],[47,"FF-B1"],[48,"FF-C2"],[50,"FF-D2"],[52,"FF-E2"],[53,"FF-F2"],[55,"FF-G2"],[56,"FF-G#2"],[57,"FF-A2"],[58,"FF-A#2"],[59,"FF-B2"],[60,"FF-C3"],[62,"FF-D3"],[64,"FF-E3"],[65,"FF-F3"],[67,"FF-G3"],[69,"FF-A3"],[71,"FF-B3"],[72,"FF-C4"],[74,"FF-D4"],[76,"FF-E4"],[77,"FF-F4"],[79,"FF-G4"],[80,"FF-G#4"],[81,"FF-A4"],[82,"FF-A#4"],[83,"FF-B4"],[85,"FF-C#5"],[86,"FF-D5"],[88,"FF-E5"],[89,"FF-F5"],[91,"FF-G5"],[93,"FF-A5"],[95,"Mf-B5"],[96,"Mf-C6"],[97,"Mf-C#6"],[98,"Mf-D6"],[99,"Mf-D#6"],[100,"Mf-E6"],[102,"Mf-F#6"],[103,"Mf-G6"],[104,"Mf-G#6"],[105,"Mf-A6"],[106,"Mf-A#6"],[107,"Mf-B6"],[108,"Mf-C7"]]}];let Nt=0;const gi=new Map;async function Fo(e,t){t?await e.load:await Oo(e.load)}async function oi(e,t=Q(),i=null,n,a,r){var v;const s=e.split("/");let o="sf2",l="musyngkite",c="acoustic_grand_piano";s.length===3?[o,l,c]=s:s.length===2?[l,c]=s:s.length===1&&(c=s[0]);const d=t instanceof OfflineAudioContext;gi.has(t)||gi.set(t,new Map);const u=gi.get(t),p=`${l}/${c}`;if(u.has(p))return u.get(p);const f=Math.max(0,Math.min(127,Math.round((n??1)*127))),m=t.createStereoPanner();a!==void 0&&(m.pan.value=a);const h=t.createGain();h.connect(m),m.connect(i||rt());const _={instrument:c,volume:f,destination:h,disableScheduler:d};let y;if(l==="smolken")y=new uo(t,_);else if(l==="splendidgrandpiano")y=new Go(t,_);else if(l==="mallets")y=new lo(t,_);else if(l==="drummachines")y=new ql(t,_);else{const N={"fluidr3-gm":"FluidR3_GM",fatboy:"FatBoy",musyngkite:"MusyngKite"}[l.toLowerCase()]||"MusyngKite",B=`https://gleitz.github.io/midi-js-soundfonts/${N}/${c}-ogg.js`;y=new Bo(t,{..._,instrumentUrl:B,kit:N})}if(await Fo(y,r??!1),l==="drummachines"){const b=((v=y.getSampleNames)==null?void 0:v.call(y))??[],N=new Map;b.forEach((S,B)=>{const L=36+B;N.set(L,S)}),y.__midiMap=N}const g=y;return g.setVolume=b=>{var S;const N=Math.max(0,Math.min(127,Math.round(b*127)));"output"in g&&typeof((S=g.output)==null?void 0:S.setVolume)=="function"&&g.output.setVolume(N)},g.setPan=b=>{m.pan.value=Math.max(-1,Math.min(1,b))},u.set(p,g),g}async function Po(){const t=Ao().map(n=>{switch(n){case"FluidR3_GM":return"fluidr3-gm";case"FatBoy":return"fatboy";case"MusyngKite":return"musyngkite";default:return n.toLowerCase()}}),i=["splendidgrandpiano","mallets","drummachines","smolken"];return[...new Set([...t,...i])]}function Ao(){const t=[...So()];return t.includes("FatBoy")||t.push("FatBoy"),t}async function ko(e){const t=e.toLowerCase();return t==="splendidgrandpiano"?["splendidgrandpiano"]:t==="mallets"?so():t==="drummachines"?Wn():t==="smolken"?oo():(await oi(`${e}/acoustic_grand_piano`),No()??[])}function Io(){return Wn()}function To(){Nt++,Nt===1&&Qe()}function Ro(){Nt--,Nt<=0&&(Nt=0)}async function Oo(e){To();try{await e}finally{Ro()}}function Uo(){return{name:"sf2",loadInstrument:oi,getAvailableLibraries:Po,getAvailableInstruments:ko}}let oe=null,Ri=null;async function Do(e){if(Ri===e)return;oe=await oi(e),Ri=e}function xo(){return Ri}function Jo(e,t=100,i=!1){var o;if(!oe)return null;const a=Q().currentTime,r=P(e);if(r===null)return null;const s=((o=oe.__midiMap)==null?void 0:o.get(r))??r;return oe.start({note:s,stopId:s,velocity:t,time:a,loop:i}),()=>{oe==null||oe.stop({stopId:s})}}function qo(e){var n;if(!oe)return;const t=P(e);if(t===null)return;const i=((n=oe.__midiMap)==null?void 0:n.get(t))??t;oe.stop({stopId:i})}async function $o(e,t,i,n=100,a=!1,r=null,s=null,o=null,l,c){var m;const d=s||Q(),u=await oi(e,d,o,l,c);l!==void 0&&u.setVolume&&u.setVolume(l),c!==void 0&&u.setPan&&u.setPan(c);const p=P(t);if(p===null)return null;const f=((m=u.__midiMap)==null?void 0:m.get(p))??p;return u.start({note:f,duration:i,velocity:n,loop:a,time:r??d.currentTime}),null}function Ho(){return{name:"sf2",setActiveInstrument:Do,getActiveInstrumentName:xo,playNote:Jo,stopNoteByPitch:qo,loadAndPlayNote:$o}}const wt=[{id:"0000_Aspirin_sf2_file",library:"Aspirin",displayName:"Acoustic Grand Piano"},{id:"0000_Chaos_sf2_file",library:"Chaos",displayName:"Acoustic Grand Piano"},{id:"0000_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Acoustic Grand Piano"},{id:"0000_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Acoustic Grand Piano"},{id:"0000_JCLive_sf2_file",library:"JCLive",displayName:"Acoustic Grand Piano"},{id:"0000_SBLive_sf2",library:"SBLive",displayName:"Acoustic Grand Piano"},{id:"0000_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Acoustic Grand Piano"},{id:"0010_Aspirin_sf2_file",library:"Aspirin",displayName:"Bright Acoustic Piano"},{id:"0010_Chaos_sf2_file",library:"Chaos",displayName:"Bright Acoustic Piano"},{id:"0010_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Bright Acoustic Piano"},{id:"0010_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Bright Acoustic Piano"},{id:"0010_JCLive_sf2_file",library:"JCLive",displayName:"Bright Acoustic Piano"},{id:"0010_SBLive_sf2",library:"SBLive",displayName:"Bright Acoustic Piano"},{id:"0010_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Bright Acoustic Piano"},{id:"0020_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Grand Piano"},{id:"0020_Chaos_sf2_file",library:"Chaos",displayName:"Electric Grand Piano"},{id:"0020_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Grand Piano"},{id:"0020_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Grand Piano"},{id:"0020_JCLive_sf2_file",library:"JCLive",displayName:"Electric Grand Piano"},{id:"0020_SBLive_sf2",library:"SBLive",displayName:"Electric Grand Piano"},{id:"0020_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Grand Piano"},{id:"0050_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Piano 2"},{id:"0050_Chaos_sf2_file",library:"Chaos",displayName:"Electric Piano 2"},{id:"0050_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Piano 2"},{id:"0050_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Piano 2"},{id:"0050_JCLive_sf2_file",library:"JCLive",displayName:"Electric Piano 2"},{id:"0050_SBLive_sf2",library:"SBLive",displayName:"Electric Piano 2"},{id:"0050_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Piano 2"},{id:"0060_Aspirin_sf2_file",library:"Aspirin",displayName:"Harpsichord"},{id:"0060_Chaos_sf2_file",library:"Chaos",displayName:"Harpsichord"},{id:"0060_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Harpsichord"},{id:"0060_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Harpsichord"},{id:"0060_JCLive_sf2_file",library:"JCLive",displayName:"Harpsichord"},{id:"0060_SBLive_sf2",library:"SBLive",displayName:"Harpsichord"},{id:"0060_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Harpsichord"},{id:"0070_Aspirin_sf2_file",library:"Aspirin",displayName:"Clavinet"},{id:"0070_Chaos_sf2_file",library:"Chaos",displayName:"Clavinet"},{id:"0070_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Clavinet"},{id:"0070_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Clavinet"},{id:"0070_JCLive_sf2_file",library:"JCLive",displayName:"Clavinet"},{id:"0070_SBLive_sf2",library:"SBLive",displayName:"Clavinet"},{id:"0070_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Clavinet"},{id:"0080_Aspirin_sf2_file",library:"Aspirin",displayName:"Celesta"},{id:"0080_Chaos_sf2_file",library:"Chaos",displayName:"Celesta"},{id:"0080_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Celesta"},{id:"0080_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Celesta"},{id:"0080_JCLive_sf2_file",library:"JCLive",displayName:"Celesta"},{id:"0080_SBLive_sf2",library:"SBLive",displayName:"Celesta"},{id:"0080_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Celesta"},{id:"0090_Aspirin_sf2_file",library:"Aspirin",displayName:"Glockenspiel"},{id:"0090_Chaos_sf2_file",library:"Chaos",displayName:"Glockenspiel"},{id:"0090_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Glockenspiel"},{id:"0090_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Glockenspiel"},{id:"0090_JCLive_sf2_file",library:"JCLive",displayName:"Glockenspiel"},{id:"0090_SBLive_sf2",library:"SBLive",displayName:"Glockenspiel"},{id:"0090_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Glockenspiel"},{id:"0100_Aspirin_sf2_file",library:"Aspirin",displayName:"Music Box"},{id:"0100_Chaos_sf2_file",library:"Chaos",displayName:"Music Box"},{id:"0100_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Music Box"},{id:"0100_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Music Box"},{id:"0100_JCLive_sf2_file",library:"JCLive",displayName:"Music Box"},{id:"0100_SBLive_sf2",library:"SBLive",displayName:"Music Box"},{id:"0100_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Music Box"},{id:"0110_Aspirin_sf2_file",library:"Aspirin",displayName:"Vibraphone"},{id:"0110_Chaos_sf2_file",library:"Chaos",displayName:"Vibraphone"},{id:"0110_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Vibraphone"},{id:"0110_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Vibraphone"},{id:"0110_JCLive_sf2_file",library:"JCLive",displayName:"Vibraphone"},{id:"0110_SBLive_sf2",library:"SBLive",displayName:"Vibraphone"},{id:"0110_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Vibraphone"},{id:"0120_Aspirin_sf2_file",library:"Aspirin",displayName:"Marimba"},{id:"0120_Chaos_sf2_file",library:"Chaos",displayName:"Marimba"},{id:"0120_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Marimba"},{id:"0120_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Marimba"},{id:"0120_JCLive_sf2_file",library:"JCLive",displayName:"Marimba"},{id:"0120_SBLive_sf2",library:"SBLive",displayName:"Marimba"},{id:"0120_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Marimba"},{id:"0130_Aspirin_sf2_file",library:"Aspirin",displayName:"Xylophone"},{id:"0130_Chaos_sf2_file",library:"Chaos",displayName:"Xylophone"},{id:"0130_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Xylophone"},{id:"0130_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Xylophone"},{id:"0130_JCLive_sf2_file",library:"JCLive",displayName:"Xylophone"},{id:"0130_SBLive_sf2",library:"SBLive",displayName:"Xylophone"},{id:"0130_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Xylophone"},{id:"0140_Aspirin_sf2_file",library:"Aspirin",displayName:"Tubular Bells"},{id:"0140_Chaos_sf2_file",library:"Chaos",displayName:"Tubular Bells"},{id:"0140_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tubular Bells"},{id:"0140_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tubular Bells"},{id:"0140_JCLive_sf2_file",library:"JCLive",displayName:"Tubular Bells"},{id:"0140_SBLive_sf2",library:"SBLive",displayName:"Tubular Bells"},{id:"0140_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tubular Bells"},{id:"0150_Aspirin_sf2_file",library:"Aspirin",displayName:"Dulcimer"},{id:"0150_Chaos_sf2_file",library:"Chaos",displayName:"Dulcimer"},{id:"0150_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Dulcimer"},{id:"0150_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Dulcimer"},{id:"0150_JCLive_sf2_file",library:"JCLive",displayName:"Dulcimer"},{id:"0150_SBLive_sf2",library:"SBLive",displayName:"Dulcimer"},{id:"0150_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Dulcimer"},{id:"0160_Aspirin_sf2_file",library:"Aspirin",displayName:"Drawbar Organ"},{id:"0160_Chaos_sf2_file",library:"Chaos",displayName:"Drawbar Organ"},{id:"0160_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drawbar Organ"},{id:"0160_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Drawbar Organ"},{id:"0160_JCLive_sf2_file",library:"JCLive",displayName:"Drawbar Organ"},{id:"0160_SBLive_sf2",library:"SBLive",displayName:"Drawbar Organ"},{id:"0160_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Drawbar Organ"},{id:"0170_Aspirin_sf2_file",library:"Aspirin",displayName:"Percussive Organ"},{id:"0170_Chaos_sf2_file",library:"Chaos",displayName:"Percussive Organ"},{id:"0170_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Percussive Organ"},{id:"0170_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Percussive Organ"},{id:"0170_JCLive_sf2_file",library:"JCLive",displayName:"Percussive Organ"},{id:"0170_SBLive_sf2",library:"SBLive",displayName:"Percussive Organ"},{id:"0170_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Percussive Organ"},{id:"0180_Aspirin_sf2_file",library:"Aspirin",displayName:"Rock Organ"},{id:"0180_Chaos_sf2_file",library:"Chaos",displayName:"Rock Organ"},{id:"0180_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Rock Organ"},{id:"0180_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Rock Organ"},{id:"0180_JCLive_sf2_file",library:"JCLive",displayName:"Rock Organ"},{id:"0180_SBLive_sf2",library:"SBLive",displayName:"Rock Organ"},{id:"0180_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Rock Organ"},{id:"0190_Aspirin_sf2_file",library:"Aspirin",displayName:"Church Organ"},{id:"0190_Chaos_sf2_file",library:"Chaos",displayName:"Church Organ"},{id:"0190_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Church Organ"},{id:"0190_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Church Organ"},{id:"0190_JCLive_sf2_file",library:"JCLive",displayName:"Church Organ"},{id:"0190_SBLive_sf2",library:"SBLive",displayName:"Church Organ"},{id:"0190_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Church Organ"},{id:"0200_Aspirin_sf2_file",library:"Aspirin",displayName:"Reed Organ"},{id:"0200_Chaos_sf2_file",library:"Chaos",displayName:"Reed Organ"},{id:"0200_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Reed Organ"},{id:"0200_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Reed Organ"},{id:"0200_JCLive_sf2_file",library:"JCLive",displayName:"Reed Organ"},{id:"0200_SBLive_sf2",library:"SBLive",displayName:"Reed Organ"},{id:"0200_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Reed Organ"},{id:"0210_Aspirin_sf2_file",library:"Aspirin",displayName:"Accordion"},{id:"0210_Chaos_sf2_file",library:"Chaos",displayName:"Accordion"},{id:"0210_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Accordion"},{id:"0210_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Accordion"},{id:"0210_JCLive_sf2_file",library:"JCLive",displayName:"Accordion"},{id:"0210_SBLive_sf2",library:"SBLive",displayName:"Accordion"},{id:"0210_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Accordion"},{id:"0220_Aspirin_sf2_file",library:"Aspirin",displayName:"Harmonica"},{id:"0220_Chaos_sf2_file",library:"Chaos",displayName:"Harmonica"},{id:"0220_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Harmonica"},{id:"0220_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Harmonica"},{id:"0220_JCLive_sf2_file",library:"JCLive",displayName:"Harmonica"},{id:"0220_SBLive_sf2",library:"SBLive",displayName:"Harmonica"},{id:"0220_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Harmonica"},{id:"0230_Aspirin_sf2_file",library:"Aspirin",displayName:"Tango Accordion"},{id:"0230_Chaos_sf2_file",library:"Chaos",displayName:"Tango Accordion"},{id:"0230_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tango Accordion"},{id:"0230_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tango Accordion"},{id:"0230_JCLive_sf2_file",library:"JCLive",displayName:"Tango Accordion"},{id:"0230_SBLive_sf2",library:"SBLive",displayName:"Tango Accordion"},{id:"0230_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tango Accordion"},{id:"0240_Aspirin_sf2_file",library:"Aspirin",displayName:"Acoustic Guitar (nylon)"},{id:"0240_Chaos_sf2_file",library:"Chaos",displayName:"Acoustic Guitar (nylon)"},{id:"0240_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Acoustic Guitar (nylon)"},{id:"0240_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Acoustic Guitar (nylon)"},{id:"0240_JCLive_sf2_file",library:"JCLive",displayName:"Acoustic Guitar (nylon)"},{id:"0240_SBLive_sf2",library:"SBLive",displayName:"Acoustic Guitar (nylon)"},{id:"0240_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Acoustic Guitar (nylon)"},{id:"0250_Aspirin_sf2_file",library:"Aspirin",displayName:"Acoustic Guitar (steel)"},{id:"0250_Chaos_sf2_file",library:"Chaos",displayName:"Acoustic Guitar (steel)"},{id:"0250_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Acoustic Guitar (steel)"},{id:"0250_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Acoustic Guitar (steel)"},{id:"0250_JCLive_sf2_file",library:"JCLive",displayName:"Acoustic Guitar (steel)"},{id:"0250_SBLive_sf2",library:"SBLive",displayName:"Acoustic Guitar (steel)"},{id:"0250_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Acoustic Guitar (steel)"},{id:"0260_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Guitar (jazz)"},{id:"0260_Chaos_sf2_file",library:"Chaos",displayName:"Electric Guitar (jazz)"},{id:"0260_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Guitar (jazz)"},{id:"0260_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Guitar (jazz)"},{id:"0260_JCLive_sf2_file",library:"JCLive",displayName:"Electric Guitar (jazz)"},{id:"0260_SBLive_sf2",library:"SBLive",displayName:"Electric Guitar (jazz)"},{id:"0260_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Guitar (jazz)"},{id:"0270_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Guitar (clean)"},{id:"0270_Chaos_sf2_file",library:"Chaos",displayName:"Electric Guitar (clean)"},{id:"0270_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Guitar (clean)"},{id:"0270_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Guitar (clean)"},{id:"0270_JCLive_sf2_file",library:"JCLive",displayName:"Electric Guitar (clean)"},{id:"0270_SBLive_sf2",library:"SBLive",displayName:"Electric Guitar (clean)"},{id:"0270_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Guitar (clean)"},{id:"0280_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Guitar (muted)"},{id:"0280_Chaos_sf2_file",library:"Chaos",displayName:"Electric Guitar (muted)"},{id:"0280_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Guitar (muted)"},{id:"0280_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Guitar (muted)"},{id:"0280_JCLive_sf2_file",library:"JCLive",displayName:"Electric Guitar (muted)"},{id:"0280_SBLive_sf2",library:"SBLive",displayName:"Electric Guitar (muted)"},{id:"0280_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Guitar (muted)"},{id:"0290_Aspirin_sf2_file",library:"Aspirin",displayName:"Overdriven Guitar"},{id:"0290_Chaos_sf2_file",library:"Chaos",displayName:"Overdriven Guitar"},{id:"0290_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Overdriven Guitar"},{id:"0290_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Overdriven Guitar"},{id:"0290_JCLive_sf2_file",library:"JCLive",displayName:"Overdriven Guitar"},{id:"0290_SBLive_sf2",library:"SBLive",displayName:"Overdriven Guitar"},{id:"0290_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Overdriven Guitar"},{id:"0300_Aspirin_sf2_file",library:"Aspirin",displayName:"Distortion Guitar"},{id:"0300_Chaos_sf2_file",library:"Chaos",displayName:"Distortion Guitar"},{id:"0300_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Distortion Guitar"},{id:"0300_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Distortion Guitar"},{id:"0300_JCLive_sf2_file",library:"JCLive",displayName:"Distortion Guitar"},{id:"0300_SBLive_sf2",library:"SBLive",displayName:"Distortion Guitar"},{id:"0300_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Distortion Guitar"},{id:"0310_Aspirin_sf2_file",library:"Aspirin",displayName:"Guitar Harmonics"},{id:"0310_Chaos_sf2_file",library:"Chaos",displayName:"Guitar Harmonics"},{id:"0310_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Guitar Harmonics"},{id:"0310_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Guitar Harmonics"},{id:"0310_JCLive_sf2_file",library:"JCLive",displayName:"Guitar Harmonics"},{id:"0310_SBLive_sf2",library:"SBLive",displayName:"Guitar Harmonics"},{id:"0310_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Guitar Harmonics"},{id:"0320_Aspirin_sf2_file",library:"Aspirin",displayName:"Acoustic Bass"},{id:"0320_Chaos_sf2_file",library:"Chaos",displayName:"Acoustic Bass"},{id:"0320_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Acoustic Bass"},{id:"0320_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Acoustic Bass"},{id:"0320_JCLive_sf2_file",library:"JCLive",displayName:"Acoustic Bass"},{id:"0320_SBLive_sf2",library:"SBLive",displayName:"Acoustic Bass"},{id:"0320_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Acoustic Bass"},{id:"0330_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Bass (finger)"},{id:"0330_Chaos_sf2_file",library:"Chaos",displayName:"Electric Bass (finger)"},{id:"0330_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Bass (finger)"},{id:"0330_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Bass (finger)"},{id:"0330_JCLive_sf2_file",library:"JCLive",displayName:"Electric Bass (finger)"},{id:"0330_SBLive_sf2",library:"SBLive",displayName:"Electric Bass (finger)"},{id:"0330_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Bass (finger)"},{id:"0340_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Bass (pick)"},{id:"0340_Chaos_sf2_file",library:"Chaos",displayName:"Electric Bass (pick)"},{id:"0340_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Bass (pick)"},{id:"0340_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Bass (pick)"},{id:"0340_JCLive_sf2_file",library:"JCLive",displayName:"Electric Bass (pick)"},{id:"0340_SBLive_sf2",library:"SBLive",displayName:"Electric Bass (pick)"},{id:"0340_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Bass (pick)"},{id:"0350_Aspirin_sf2_file",library:"Aspirin",displayName:"Fretless Bass"},{id:"0350_Chaos_sf2_file",library:"Chaos",displayName:"Fretless Bass"},{id:"0350_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Fretless Bass"},{id:"0350_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Fretless Bass"},{id:"0350_JCLive_sf2_file",library:"JCLive",displayName:"Fretless Bass"},{id:"0350_SBLive_sf2",library:"SBLive",displayName:"Fretless Bass"},{id:"0350_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Fretless Bass"},{id:"0360_Aspirin_sf2_file",library:"Aspirin",displayName:"Slap Bass 1"},{id:"0360_Chaos_sf2_file",library:"Chaos",displayName:"Slap Bass 1"},{id:"0360_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Slap Bass 1"},{id:"0360_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Slap Bass 1"},{id:"0360_JCLive_sf2_file",library:"JCLive",displayName:"Slap Bass 1"},{id:"0360_SBLive_sf2",library:"SBLive",displayName:"Slap Bass 1"},{id:"0360_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Slap Bass 1"},{id:"0370_Aspirin_sf2_file",library:"Aspirin",displayName:"Slap Bass 2"},{id:"0370_Chaos_sf2_file",library:"Chaos",displayName:"Slap Bass 2"},{id:"0370_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Slap Bass 2"},{id:"0370_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Slap Bass 2"},{id:"0370_JCLive_sf2_file",library:"JCLive",displayName:"Slap Bass 2"},{id:"0370_SBLive_sf2",library:"SBLive",displayName:"Slap Bass 2"},{id:"0370_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Slap Bass 2"},{id:"0380_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Bass 1"},{id:"0380_Chaos_sf2_file",library:"Chaos",displayName:"Synth Bass 1"},{id:"0380_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Bass 1"},{id:"0380_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Bass 1"},{id:"0380_JCLive_sf2_file",library:"JCLive",displayName:"Synth Bass 1"},{id:"0380_SBLive_sf2",library:"SBLive",displayName:"Synth Bass 1"},{id:"0380_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Bass 1"},{id:"0390_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Bass 2"},{id:"0390_Chaos_sf2_file",library:"Chaos",displayName:"Synth Bass 2"},{id:"0390_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Bass 2"},{id:"0390_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Bass 2"},{id:"0390_JCLive_sf2_file",library:"JCLive",displayName:"Synth Bass 2"},{id:"0390_SBLive_sf2",library:"SBLive",displayName:"Synth Bass 2"},{id:"0390_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Bass 2"},{id:"0400_Aspirin_sf2_file",library:"Aspirin",displayName:"Violin"},{id:"0400_Chaos_sf2_file",library:"Chaos",displayName:"Violin"},{id:"0400_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Violin"},{id:"0400_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Violin"},{id:"0400_JCLive_sf2_file",library:"JCLive",displayName:"Violin"},{id:"0400_SBLive_sf2",library:"SBLive",displayName:"Violin"},{id:"0400_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Violin"},{id:"0410_Aspirin_sf2_file",library:"Aspirin",displayName:"Viola"},{id:"0410_Chaos_sf2_file",library:"Chaos",displayName:"Viola"},{id:"0410_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Viola"},{id:"0410_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Viola"},{id:"0410_JCLive_sf2_file",library:"JCLive",displayName:"Viola"},{id:"0410_SBLive_sf2",library:"SBLive",displayName:"Viola"},{id:"0410_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Viola"},{id:"0420_Aspirin_sf2_file",library:"Aspirin",displayName:"Cello"},{id:"0420_Chaos_sf2_file",library:"Chaos",displayName:"Cello"},{id:"0420_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Cello"},{id:"0420_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Cello"},{id:"0420_JCLive_sf2_file",library:"JCLive",displayName:"Cello"},{id:"0420_SBLive_sf2",library:"SBLive",displayName:"Cello"},{id:"0420_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Cello"},{id:"0430_Aspirin_sf2_file",library:"Aspirin",displayName:"Contrabass"},{id:"0430_Chaos_sf2_file",library:"Chaos",displayName:"Contrabass"},{id:"0430_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Contrabass"},{id:"0430_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Contrabass"},{id:"0430_JCLive_sf2_file",library:"JCLive",displayName:"Contrabass"},{id:"0430_SBLive_sf2",library:"SBLive",displayName:"Contrabass"},{id:"0430_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Contrabass"},{id:"0440_Aspirin_sf2_file",library:"Aspirin",displayName:"Tremolo Strings"},{id:"0440_Chaos_sf2_file",library:"Chaos",displayName:"Tremolo Strings"},{id:"0440_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tremolo Strings"},{id:"0440_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tremolo Strings"},{id:"0440_JCLive_sf2_file",library:"JCLive",displayName:"Tremolo Strings"},{id:"0440_SBLive_sf2",library:"SBLive",displayName:"Tremolo Strings"},{id:"0440_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tremolo Strings"},{id:"0450_Aspirin_sf2_file",library:"Aspirin",displayName:"Pizzicato Strings"},{id:"0450_Chaos_sf2_file",library:"Chaos",displayName:"Pizzicato Strings"},{id:"0450_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pizzicato Strings"},{id:"0450_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pizzicato Strings"},{id:"0450_JCLive_sf2_file",library:"JCLive",displayName:"Pizzicato Strings"},{id:"0450_SBLive_sf2",library:"SBLive",displayName:"Pizzicato Strings"},{id:"0450_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pizzicato Strings"},{id:"0460_Aspirin_sf2_file",library:"Aspirin",displayName:"Orchestral Harp"},{id:"0460_Chaos_sf2_file",library:"Chaos",displayName:"Orchestral Harp"},{id:"0460_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Orchestral Harp"},{id:"0460_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Orchestral Harp"},{id:"0460_JCLive_sf2_file",library:"JCLive",displayName:"Orchestral Harp"},{id:"0460_SBLive_sf2",library:"SBLive",displayName:"Orchestral Harp"},{id:"0460_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Orchestral Harp"},{id:"0470_Aspirin_sf2_file",library:"Aspirin",displayName:"Timpani"},{id:"0470_Chaos_sf2_file",library:"Chaos",displayName:"Timpani"},{id:"0470_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Timpani"},{id:"0470_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Timpani"},{id:"0470_JCLive_sf2_file",library:"JCLive",displayName:"Timpani"},{id:"0470_SBLive_sf2",library:"SBLive",displayName:"Timpani"},{id:"0470_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Timpani"},{id:"0480_Aspirin_sf2_file",library:"Aspirin",displayName:"String Ensemble 1"},{id:"0480_Chaos_sf2_file",library:"Chaos",displayName:"String Ensemble 1"},{id:"0480_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"String Ensemble 1"},{id:"0480_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"String Ensemble 1"},{id:"0480_JCLive_sf2_file",library:"JCLive",displayName:"String Ensemble 1"},{id:"0480_SBLive_sf2",library:"SBLive",displayName:"String Ensemble 1"},{id:"0480_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"String Ensemble 1"},{id:"0490_Aspirin_sf2_file",library:"Aspirin",displayName:"String Ensemble 2"},{id:"0490_Chaos_sf2_file",library:"Chaos",displayName:"String Ensemble 2"},{id:"0490_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"String Ensemble 2"},{id:"0490_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"String Ensemble 2"},{id:"0490_JCLive_sf2_file",library:"JCLive",displayName:"String Ensemble 2"},{id:"0490_SBLive_sf2",library:"SBLive",displayName:"String Ensemble 2"},{id:"0490_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"String Ensemble 2"},{id:"0500_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Strings 1"},{id:"0500_Chaos_sf2_file",library:"Chaos",displayName:"Synth Strings 1"},{id:"0500_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Strings 1"},{id:"0500_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Strings 1"},{id:"0500_JCLive_sf2_file",library:"JCLive",displayName:"Synth Strings 1"},{id:"0500_SBLive_sf2",library:"SBLive",displayName:"Synth Strings 1"},{id:"0500_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Strings 1"},{id:"0510_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Strings 2"},{id:"0510_Chaos_sf2_file",library:"Chaos",displayName:"Synth Strings 2"},{id:"0510_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Strings 2"},{id:"0510_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Strings 2"},{id:"0510_JCLive_sf2_file",library:"JCLive",displayName:"Synth Strings 2"},{id:"0510_SBLive_sf2",library:"SBLive",displayName:"Synth Strings 2"},{id:"0510_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Strings 2"},{id:"0520_Aspirin_sf2_file",library:"Aspirin",displayName:"Choir Aahs"},{id:"0520_Chaos_sf2_file",library:"Chaos",displayName:"Choir Aahs"},{id:"0520_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Choir Aahs"},{id:"0520_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Choir Aahs"},{id:"0520_JCLive_sf2_file",library:"JCLive",displayName:"Choir Aahs"},{id:"0520_SBLive_sf2",library:"SBLive",displayName:"Choir Aahs"},{id:"0520_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Choir Aahs"},{id:"0530_Aspirin_sf2_file",library:"Aspirin",displayName:"Voice Oohs"},{id:"0530_Chaos_sf2_file",library:"Chaos",displayName:"Voice Oohs"},{id:"0530_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Voice Oohs"},{id:"0530_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Voice Oohs"},{id:"0530_JCLive_sf2_file",library:"JCLive",displayName:"Voice Oohs"},{id:"0530_SBLive_sf2",library:"SBLive",displayName:"Voice Oohs"},{id:"0530_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Voice Oohs"},{id:"0540_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Choir"},{id:"0540_Chaos_sf2_file",library:"Chaos",displayName:"Synth Choir"},{id:"0540_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Choir"},{id:"0540_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Choir"},{id:"0540_JCLive_sf2_file",library:"JCLive",displayName:"Synth Choir"},{id:"0540_SBLive_sf2",library:"SBLive",displayName:"Synth Choir"},{id:"0540_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Choir"},{id:"0550_Aspirin_sf2_file",library:"Aspirin",displayName:"Orchestra Hit"},{id:"0550_Chaos_sf2_file",library:"Chaos",displayName:"Orchestra Hit"},{id:"0550_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Orchestra Hit"},{id:"0550_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Orchestra Hit"},{id:"0550_JCLive_sf2_file",library:"JCLive",displayName:"Orchestra Hit"},{id:"0550_SBLive_sf2",library:"SBLive",displayName:"Orchestra Hit"},{id:"0550_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Orchestra Hit"},{id:"0560_Aspirin_sf2_file",library:"Aspirin",displayName:"Trumpet"},{id:"0560_Chaos_sf2_file",library:"Chaos",displayName:"Trumpet"},{id:"0560_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Trumpet"},{id:"0560_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Trumpet"},{id:"0560_JCLive_sf2_file",library:"JCLive",displayName:"Trumpet"},{id:"0560_SBLive_sf2",library:"SBLive",displayName:"Trumpet"},{id:"0560_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Trumpet"},{id:"0570_Aspirin_sf2_file",library:"Aspirin",displayName:"Trombone"},{id:"0570_Chaos_sf2_file",library:"Chaos",displayName:"Trombone"},{id:"0570_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Trombone"},{id:"0570_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Trombone"},{id:"0570_JCLive_sf2_file",library:"JCLive",displayName:"Trombone"},{id:"0570_SBLive_sf2",library:"SBLive",displayName:"Trombone"},{id:"0570_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Trombone"},{id:"0580_Aspirin_sf2_file",library:"Aspirin",displayName:"Tuba"},{id:"0580_Chaos_sf2_file",library:"Chaos",displayName:"Tuba"},{id:"0580_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tuba"},{id:"0580_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tuba"},{id:"0580_JCLive_sf2_file",library:"JCLive",displayName:"Tuba"},{id:"0580_SBLive_sf2",library:"SBLive",displayName:"Tuba"},{id:"0580_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tuba"},{id:"0590_Aspirin_sf2_file",library:"Aspirin",displayName:"Muted Trumpet"},{id:"0590_Chaos_sf2_file",library:"Chaos",displayName:"Muted Trumpet"},{id:"0590_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Muted Trumpet"},{id:"0590_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Muted Trumpet"},{id:"0590_JCLive_sf2_file",library:"JCLive",displayName:"Muted Trumpet"},{id:"0590_SBLive_sf2",library:"SBLive",displayName:"Muted Trumpet"},{id:"0590_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Muted Trumpet"},{id:"0600_Aspirin_sf2_file",library:"Aspirin",displayName:"French Horn"},{id:"0600_Chaos_sf2_file",library:"Chaos",displayName:"French Horn"},{id:"0600_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"French Horn"},{id:"0600_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"French Horn"},{id:"0600_JCLive_sf2_file",library:"JCLive",displayName:"French Horn"},{id:"0600_SBLive_sf2",library:"SBLive",displayName:"French Horn"},{id:"0600_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"French Horn"},{id:"0610_Aspirin_sf2_file",library:"Aspirin",displayName:"Brass Section"},{id:"0610_Chaos_sf2_file",library:"Chaos",displayName:"Brass Section"},{id:"0610_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Brass Section"},{id:"0610_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Brass Section"},{id:"0610_JCLive_sf2_file",library:"JCLive",displayName:"Brass Section"},{id:"0610_SBLive_sf2",library:"SBLive",displayName:"Brass Section"},{id:"0610_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Brass Section"},{id:"0620_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Brass 1"},{id:"0620_Chaos_sf2_file",library:"Chaos",displayName:"Synth Brass 1"},{id:"0620_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Brass 1"},{id:"0620_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Brass 1"},{id:"0620_JCLive_sf2_file",library:"JCLive",displayName:"Synth Brass 1"},{id:"0620_SBLive_sf2",library:"SBLive",displayName:"Synth Brass 1"},{id:"0620_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Brass 1"},{id:"0630_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Brass 2"},{id:"0630_Chaos_sf2_file",library:"Chaos",displayName:"Synth Brass 2"},{id:"0630_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Brass 2"},{id:"0630_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Brass 2"},{id:"0630_JCLive_sf2_file",library:"JCLive",displayName:"Synth Brass 2"},{id:"0630_SBLive_sf2",library:"SBLive",displayName:"Synth Brass 2"},{id:"0630_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Brass 2"},{id:"0640_Aspirin_sf2_file",library:"Aspirin",displayName:"Soprano Sax"},{id:"0640_Chaos_sf2_file",library:"Chaos",displayName:"Soprano Sax"},{id:"0640_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Soprano Sax"},{id:"0640_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Soprano Sax"},{id:"0640_JCLive_sf2_file",library:"JCLive",displayName:"Soprano Sax"},{id:"0640_SBLive_sf2",library:"SBLive",displayName:"Soprano Sax"},{id:"0640_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Soprano Sax"},{id:"0650_Aspirin_sf2_file",library:"Aspirin",displayName:"Alto Sax"},{id:"0650_Chaos_sf2_file",library:"Chaos",displayName:"Alto Sax"},{id:"0650_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Alto Sax"},{id:"0650_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Alto Sax"},{id:"0650_JCLive_sf2_file",library:"JCLive",displayName:"Alto Sax"},{id:"0650_SBLive_sf2",library:"SBLive",displayName:"Alto Sax"},{id:"0650_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Alto Sax"},{id:"0660_Aspirin_sf2_file",library:"Aspirin",displayName:"Tenor Sax"},{id:"0660_Chaos_sf2_file",library:"Chaos",displayName:"Tenor Sax"},{id:"0660_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tenor Sax"},{id:"0660_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tenor Sax"},{id:"0660_JCLive_sf2_file",library:"JCLive",displayName:"Tenor Sax"},{id:"0660_SBLive_sf2",library:"SBLive",displayName:"Tenor Sax"},{id:"0660_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tenor Sax"},{id:"0670_Aspirin_sf2_file",library:"Aspirin",displayName:"Baritone Sax"},{id:"0670_Chaos_sf2_file",library:"Chaos",displayName:"Baritone Sax"},{id:"0670_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Baritone Sax"},{id:"0670_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Baritone Sax"},{id:"0670_JCLive_sf2_file",library:"JCLive",displayName:"Baritone Sax"},{id:"0670_SBLive_sf2",library:"SBLive",displayName:"Baritone Sax"},{id:"0670_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Baritone Sax"},{id:"0680_Aspirin_sf2_file",library:"Aspirin",displayName:"Oboe"},{id:"0680_Chaos_sf2_file",library:"Chaos",displayName:"Oboe"},{id:"0680_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Oboe"},{id:"0680_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Oboe"},{id:"0680_JCLive_sf2_file",library:"JCLive",displayName:"Oboe"},{id:"0680_SBLive_sf2",library:"SBLive",displayName:"Oboe"},{id:"0680_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Oboe"},{id:"0690_Aspirin_sf2_file",library:"Aspirin",displayName:"English Horn"},{id:"0690_Chaos_sf2_file",library:"Chaos",displayName:"English Horn"},{id:"0690_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"English Horn"},{id:"0690_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"English Horn"},{id:"0690_JCLive_sf2_file",library:"JCLive",displayName:"English Horn"},{id:"0690_SBLive_sf2",library:"SBLive",displayName:"English Horn"},{id:"0690_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"English Horn"},{id:"0700_Aspirin_sf2_file",library:"Aspirin",displayName:"Bassoon"},{id:"0700_Chaos_sf2_file",library:"Chaos",displayName:"Bassoon"},{id:"0700_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Bassoon"},{id:"0700_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Bassoon"},{id:"0700_JCLive_sf2_file",library:"JCLive",displayName:"Bassoon"},{id:"0700_SBLive_sf2",library:"SBLive",displayName:"Bassoon"},{id:"0700_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Bassoon"},{id:"0710_Aspirin_sf2_file",library:"Aspirin",displayName:"Clarinet"},{id:"0710_Chaos_sf2_file",library:"Chaos",displayName:"Clarinet"},{id:"0710_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Clarinet"},{id:"0710_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Clarinet"},{id:"0710_JCLive_sf2_file",library:"JCLive",displayName:"Clarinet"},{id:"0710_SBLive_sf2",library:"SBLive",displayName:"Clarinet"},{id:"0710_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Clarinet"},{id:"0720_Aspirin_sf2_file",library:"Aspirin",displayName:"Piccolo"},{id:"0720_Chaos_sf2_file",library:"Chaos",displayName:"Piccolo"},{id:"0720_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Piccolo"},{id:"0720_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Piccolo"},{id:"0720_JCLive_sf2_file",library:"JCLive",displayName:"Piccolo"},{id:"0720_SBLive_sf2",library:"SBLive",displayName:"Piccolo"},{id:"0720_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Piccolo"},{id:"0730_Aspirin_sf2_file",library:"Aspirin",displayName:"Flute"},{id:"0730_Chaos_sf2_file",library:"Chaos",displayName:"Flute"},{id:"0730_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Flute"},{id:"0730_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Flute"},{id:"0730_JCLive_sf2_file",library:"JCLive",displayName:"Flute"},{id:"0730_SBLive_sf2",library:"SBLive",displayName:"Flute"},{id:"0730_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Flute"},{id:"0740_Aspirin_sf2_file",library:"Aspirin",displayName:"Recorder"},{id:"0740_Chaos_sf2_file",library:"Chaos",displayName:"Recorder"},{id:"0740_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Recorder"},{id:"0740_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Recorder"},{id:"0740_JCLive_sf2_file",library:"JCLive",displayName:"Recorder"},{id:"0740_SBLive_sf2",library:"SBLive",displayName:"Recorder"},{id:"0740_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Recorder"},{id:"0750_Aspirin_sf2_file",library:"Aspirin",displayName:"Pan Flute"},{id:"0750_Chaos_sf2_file",library:"Chaos",displayName:"Pan Flute"},{id:"0750_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pan Flute"},{id:"0750_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pan Flute"},{id:"0750_JCLive_sf2_file",library:"JCLive",displayName:"Pan Flute"},{id:"0750_SBLive_sf2",library:"SBLive",displayName:"Pan Flute"},{id:"0750_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pan Flute"},{id:"0760_Aspirin_sf2_file",library:"Aspirin",displayName:"Blown Bottle"},{id:"0760_Chaos_sf2_file",library:"Chaos",displayName:"Blown Bottle"},{id:"0760_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Blown Bottle"},{id:"0760_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Blown Bottle"},{id:"0760_JCLive_sf2_file",library:"JCLive",displayName:"Blown Bottle"},{id:"0760_SBLive_sf2",library:"SBLive",displayName:"Blown Bottle"},{id:"0760_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Blown Bottle"},{id:"0770_Aspirin_sf2_file",library:"Aspirin",displayName:"Shakuhachi"},{id:"0770_Chaos_sf2_file",library:"Chaos",displayName:"Shakuhachi"},{id:"0770_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Shakuhachi"},{id:"0770_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Shakuhachi"},{id:"0770_JCLive_sf2_file",library:"JCLive",displayName:"Shakuhachi"},{id:"0770_SBLive_sf2",library:"SBLive",displayName:"Shakuhachi"},{id:"0770_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Shakuhachi"},{id:"0780_Aspirin_sf2_file",library:"Aspirin",displayName:"Whistle"},{id:"0780_Chaos_sf2_file",library:"Chaos",displayName:"Whistle"},{id:"0780_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Whistle"},{id:"0780_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Whistle"},{id:"0780_JCLive_sf2_file",library:"JCLive",displayName:"Whistle"},{id:"0780_SBLive_sf2",library:"SBLive",displayName:"Whistle"},{id:"0780_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Whistle"},{id:"0790_Aspirin_sf2_file",library:"Aspirin",displayName:"Ocarina"},{id:"0790_Chaos_sf2_file",library:"Chaos",displayName:"Ocarina"},{id:"0790_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Ocarina"},{id:"0790_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Ocarina"},{id:"0790_JCLive_sf2_file",library:"JCLive",displayName:"Ocarina"},{id:"0790_SBLive_sf2",library:"SBLive",displayName:"Ocarina"},{id:"0790_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Ocarina"},{id:"0800_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 1 (square)"},{id:"0800_Chaos_sf2_file",library:"Chaos",displayName:"Lead 1 (square)"},{id:"0800_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 1 (square)"},{id:"0800_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 1 (square)"},{id:"0800_JCLive_sf2_file",library:"JCLive",displayName:"Lead 1 (square)"},{id:"0800_SBLive_sf2",library:"SBLive",displayName:"Lead 1 (square)"},{id:"0800_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 1 (square)"},{id:"0810_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 2 (sawtooth)"},{id:"0810_Chaos_sf2_file",library:"Chaos",displayName:"Lead 2 (sawtooth)"},{id:"0810_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 2 (sawtooth)"},{id:"0810_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 2 (sawtooth)"},{id:"0810_JCLive_sf2_file",library:"JCLive",displayName:"Lead 2 (sawtooth)"},{id:"0810_SBLive_sf2",library:"SBLive",displayName:"Lead 2 (sawtooth)"},{id:"0810_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 2 (sawtooth)"},{id:"0820_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 3 (calliope)"},{id:"0820_Chaos_sf2_file",library:"Chaos",displayName:"Lead 3 (calliope)"},{id:"0820_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 3 (calliope)"},{id:"0820_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 3 (calliope)"},{id:"0820_JCLive_sf2_file",library:"JCLive",displayName:"Lead 3 (calliope)"},{id:"0820_SBLive_sf2",library:"SBLive",displayName:"Lead 3 (calliope)"},{id:"0820_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 3 (calliope)"},{id:"0830_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 4 (chiff)"},{id:"0830_Chaos_sf2_file",library:"Chaos",displayName:"Lead 4 (chiff)"},{id:"0830_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 4 (chiff)"},{id:"0830_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 4 (chiff)"},{id:"0830_JCLive_sf2_file",library:"JCLive",displayName:"Lead 4 (chiff)"},{id:"0830_SBLive_sf2",library:"SBLive",displayName:"Lead 4 (chiff)"},{id:"0830_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 4 (chiff)"},{id:"0840_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 5 (charang)"},{id:"0840_Chaos_sf2_file",library:"Chaos",displayName:"Lead 5 (charang)"},{id:"0840_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 5 (charang)"},{id:"0840_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 5 (charang)"},{id:"0840_JCLive_sf2_file",library:"JCLive",displayName:"Lead 5 (charang)"},{id:"0840_SBLive_sf2",library:"SBLive",displayName:"Lead 5 (charang)"},{id:"0840_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 5 (charang)"},{id:"0850_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 6 (voice)"},{id:"0850_Chaos_sf2_file",library:"Chaos",displayName:"Lead 6 (voice)"},{id:"0850_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 6 (voice)"},{id:"0850_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 6 (voice)"},{id:"0850_JCLive_sf2_file",library:"JCLive",displayName:"Lead 6 (voice)"},{id:"0850_SBLive_sf2",library:"SBLive",displayName:"Lead 6 (voice)"},{id:"0850_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 6 (voice)"},{id:"0860_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 7 (fifths)"},{id:"0860_Chaos_sf2_file",library:"Chaos",displayName:"Lead 7 (fifths)"},{id:"0860_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 7 (fifths)"},{id:"0860_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 7 (fifths)"},{id:"0860_JCLive_sf2_file",library:"JCLive",displayName:"Lead 7 (fifths)"},{id:"0860_SBLive_sf2",library:"SBLive",displayName:"Lead 7 (fifths)"},{id:"0860_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 7 (fifths)"},{id:"0870_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 8 (bass + lead)"},{id:"0870_Chaos_sf2_file",library:"Chaos",displayName:"Lead 8 (bass + lead)"},{id:"0870_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 8 (bass + lead)"},{id:"0870_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 8 (bass + lead)"},{id:"0870_JCLive_sf2_file",library:"JCLive",displayName:"Lead 8 (bass + lead)"},{id:"0870_SBLive_sf2",library:"SBLive",displayName:"Lead 8 (bass + lead)"},{id:"0870_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 8 (bass + lead)"},{id:"0880_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 1 (new age)"},{id:"0880_Chaos_sf2_file",library:"Chaos",displayName:"Pad 1 (new age)"},{id:"0880_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 1 (new age)"},{id:"0880_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 1 (new age)"},{id:"0880_JCLive_sf2_file",library:"JCLive",displayName:"Pad 1 (new age)"},{id:"0880_SBLive_sf2",library:"SBLive",displayName:"Pad 1 (new age)"},{id:"0880_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 1 (new age)"},{id:"0890_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 2 (warm)"},{id:"0890_Chaos_sf2_file",library:"Chaos",displayName:"Pad 2 (warm)"},{id:"0890_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 2 (warm)"},{id:"0890_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 2 (warm)"},{id:"0890_JCLive_sf2_file",library:"JCLive",displayName:"Pad 2 (warm)"},{id:"0890_SBLive_sf2",library:"SBLive",displayName:"Pad 2 (warm)"},{id:"0890_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 2 (warm)"},{id:"0900_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 3 (polysynth)"},{id:"0900_Chaos_sf2_file",library:"Chaos",displayName:"Pad 3 (polysynth)"},{id:"0900_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 3 (polysynth)"},{id:"0900_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 3 (polysynth)"},{id:"0900_JCLive_sf2_file",library:"JCLive",displayName:"Pad 3 (polysynth)"},{id:"0900_SBLive_sf2",library:"SBLive",displayName:"Pad 3 (polysynth)"},{id:"0900_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 3 (polysynth)"},{id:"0910_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 4 (choir)"},{id:"0910_Chaos_sf2_file",library:"Chaos",displayName:"Pad 4 (choir)"},{id:"0910_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 4 (choir)"},{id:"0910_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 4 (choir)"},{id:"0910_JCLive_sf2_file",library:"JCLive",displayName:"Pad 4 (choir)"},{id:"0910_SBLive_sf2",library:"SBLive",displayName:"Pad 4 (choir)"},{id:"0910_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 4 (choir)"},{id:"0920_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 5 (bowed)"},{id:"0920_Chaos_sf2_file",library:"Chaos",displayName:"Pad 5 (bowed)"},{id:"0920_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 5 (bowed)"},{id:"0920_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 5 (bowed)"},{id:"0920_JCLive_sf2_file",library:"JCLive",displayName:"Pad 5 (bowed)"},{id:"0920_SBLive_sf2",library:"SBLive",displayName:"Pad 5 (bowed)"},{id:"0920_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 5 (bowed)"},{id:"0930_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 6 (metallic)"},{id:"0930_Chaos_sf2_file",library:"Chaos",displayName:"Pad 6 (metallic)"},{id:"0930_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 6 (metallic)"},{id:"0930_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 6 (metallic)"},{id:"0930_JCLive_sf2_file",library:"JCLive",displayName:"Pad 6 (metallic)"},{id:"0930_SBLive_sf2",library:"SBLive",displayName:"Pad 6 (metallic)"},{id:"0930_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 6 (metallic)"},{id:"0940_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 7 (halo)"},{id:"0940_Chaos_sf2_file",library:"Chaos",displayName:"Pad 7 (halo)"},{id:"0940_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 7 (halo)"},{id:"0940_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 7 (halo)"},{id:"0940_JCLive_sf2_file",library:"JCLive",displayName:"Pad 7 (halo)"},{id:"0940_SBLive_sf2",library:"SBLive",displayName:"Pad 7 (halo)"},{id:"0940_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 7 (halo)"},{id:"0950_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 8 (sweep)"},{id:"0950_Chaos_sf2_file",library:"Chaos",displayName:"Pad 8 (sweep)"},{id:"0950_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 8 (sweep)"},{id:"0950_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 8 (sweep)"},{id:"0950_JCLive_sf2_file",library:"JCLive",displayName:"Pad 8 (sweep)"},{id:"0950_SBLive_sf2",library:"SBLive",displayName:"Pad 8 (sweep)"},{id:"0950_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 8 (sweep)"},{id:"0960_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 1 (rain)"},{id:"0960_Chaos_sf2_file",library:"Chaos",displayName:"FX 1 (rain)"},{id:"0960_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 1 (rain)"},{id:"0960_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 1 (rain)"},{id:"0960_JCLive_sf2_file",library:"JCLive",displayName:"FX 1 (rain)"},{id:"0960_SBLive_sf2",library:"SBLive",displayName:"FX 1 (rain)"},{id:"0960_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 1 (rain)"},{id:"0970_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 2 (soundtrack)"},{id:"0970_Chaos_sf2_file",library:"Chaos",displayName:"FX 2 (soundtrack)"},{id:"0970_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 2 (soundtrack)"},{id:"0970_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 2 (soundtrack)"},{id:"0970_JCLive_sf2_file",library:"JCLive",displayName:"FX 2 (soundtrack)"},{id:"0970_SBLive_sf2",library:"SBLive",displayName:"FX 2 (soundtrack)"},{id:"0970_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 2 (soundtrack)"},{id:"0980_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 3 (crystal)"},{id:"0980_Chaos_sf2_file",library:"Chaos",displayName:"FX 3 (crystal)"},{id:"0980_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 3 (crystal)"},{id:"0980_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 3 (crystal)"},{id:"0980_JCLive_sf2_file",library:"JCLive",displayName:"FX 3 (crystal)"},{id:"0980_SBLive_sf2",library:"SBLive",displayName:"FX 3 (crystal)"},{id:"0980_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 3 (crystal)"},{id:"0990_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 4 (atmosphere)"},{id:"0990_Chaos_sf2_file",library:"Chaos",displayName:"FX 4 (atmosphere)"},{id:"0990_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 4 (atmosphere)"},{id:"0990_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 4 (atmosphere)"},{id:"0990_JCLive_sf2_file",library:"JCLive",displayName:"FX 4 (atmosphere)"},{id:"0990_SBLive_sf2",library:"SBLive",displayName:"FX 4 (atmosphere)"},{id:"0990_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 4 (atmosphere)"},{id:"1000_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 5 (brightness)"},{id:"1000_Chaos_sf2_file",library:"Chaos",displayName:"FX 5 (brightness)"},{id:"1000_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 5 (brightness)"},{id:"1000_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 5 (brightness)"},{id:"1000_JCLive_sf2_file",library:"JCLive",displayName:"FX 5 (brightness)"},{id:"1000_SBLive_sf2",library:"SBLive",displayName:"FX 5 (brightness)"},{id:"1000_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 5 (brightness)"},{id:"1010_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 6 (goblins)"},{id:"1010_Chaos_sf2_file",library:"Chaos",displayName:"FX 6 (goblins)"},{id:"1010_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 6 (goblins)"},{id:"1010_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 6 (goblins)"},{id:"1010_JCLive_sf2_file",library:"JCLive",displayName:"FX 6 (goblins)"},{id:"1010_SBLive_sf2",library:"SBLive",displayName:"FX 6 (goblins)"},{id:"1010_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 6 (goblins)"},{id:"1020_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 7 (echoes)"},{id:"1020_Chaos_sf2_file",library:"Chaos",displayName:"FX 7 (echoes)"},{id:"1020_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 7 (echoes)"},{id:"1020_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 7 (echoes)"},{id:"1020_JCLive_sf2_file",library:"JCLive",displayName:"FX 7 (echoes)"},{id:"1020_SBLive_sf2",library:"SBLive",displayName:"FX 7 (echoes)"},{id:"1020_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 7 (echoes)"},{id:"1030_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 8 (sci-fi)"},{id:"1030_Chaos_sf2_file",library:"Chaos",displayName:"FX 8 (sci-fi)"},{id:"1030_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 8 (sci-fi)"},{id:"1030_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 8 (sci-fi)"},{id:"1030_JCLive_sf2_file",library:"JCLive",displayName:"FX 8 (sci-fi)"},{id:"1030_SBLive_sf2",library:"SBLive",displayName:"FX 8 (sci-fi)"},{id:"1030_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 8 (sci-fi)"},{id:"1040_Aspirin_sf2_file",library:"Aspirin",displayName:"Sitar"},{id:"1040_Chaos_sf2_file",library:"Chaos",displayName:"Sitar"},{id:"1040_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Sitar"},{id:"1040_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Sitar"},{id:"1040_JCLive_sf2_file",library:"JCLive",displayName:"Sitar"},{id:"1040_SBLive_sf2",library:"SBLive",displayName:"Sitar"},{id:"1040_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Sitar"},{id:"1050_Aspirin_sf2_file",library:"Aspirin",displayName:"Banjo"},{id:"1050_Chaos_sf2_file",library:"Chaos",displayName:"Banjo"},{id:"1050_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Banjo"},{id:"1050_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Banjo"},{id:"1050_JCLive_sf2_file",library:"JCLive",displayName:"Banjo"},{id:"1050_SBLive_sf2",library:"SBLive",displayName:"Banjo"},{id:"1050_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Banjo"},{id:"1060_Aspirin_sf2_file",library:"Aspirin",displayName:"Shamisen"},{id:"1060_Chaos_sf2_file",library:"Chaos",displayName:"Shamisen"},{id:"1060_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Shamisen"},{id:"1060_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Shamisen"},{id:"1060_JCLive_sf2_file",library:"JCLive",displayName:"Shamisen"},{id:"1060_SBLive_sf2",library:"SBLive",displayName:"Shamisen"},{id:"1060_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Shamisen"},{id:"1070_Aspirin_sf2_file",library:"Aspirin",displayName:"Koto"},{id:"1070_Chaos_sf2_file",library:"Chaos",displayName:"Koto"},{id:"1070_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Koto"},{id:"1070_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Koto"},{id:"1070_JCLive_sf2_file",library:"JCLive",displayName:"Koto"},{id:"1070_SBLive_sf2",library:"SBLive",displayName:"Koto"},{id:"1070_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Koto"},{id:"1080_Aspirin_sf2_file",library:"Aspirin",displayName:"Kalimba"},{id:"1080_Chaos_sf2_file",library:"Chaos",displayName:"Kalimba"},{id:"1080_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Kalimba"},{id:"1080_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Kalimba"},{id:"1080_JCLive_sf2_file",library:"JCLive",displayName:"Kalimba"},{id:"1080_SBLive_sf2",library:"SBLive",displayName:"Kalimba"},{id:"1080_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Kalimba"},{id:"1090_Aspirin_sf2_file",library:"Aspirin",displayName:"Bagpipe"},{id:"1090_Chaos_sf2_file",library:"Chaos",displayName:"Bagpipe"},{id:"1090_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Bagpipe"},{id:"1090_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Bagpipe"},{id:"1090_JCLive_sf2_file",library:"JCLive",displayName:"Bagpipe"},{id:"1090_SBLive_sf2",library:"SBLive",displayName:"Bagpipe"},{id:"1090_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Bagpipe"},{id:"1100_Aspirin_sf2_file",library:"Aspirin",displayName:"Fiddle"},{id:"1100_Chaos_sf2_file",library:"Chaos",displayName:"Fiddle"},{id:"1100_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Fiddle"},{id:"1100_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Fiddle"},{id:"1100_JCLive_sf2_file",library:"JCLive",displayName:"Fiddle"},{id:"1100_SBLive_sf2",library:"SBLive",displayName:"Fiddle"},{id:"1100_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Fiddle"},{id:"1110_Aspirin_sf2_file",library:"Aspirin",displayName:"Shanai"},{id:"1110_Chaos_sf2_file",library:"Chaos",displayName:"Shanai"},{id:"1110_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Shanai"},{id:"1110_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Shanai"},{id:"1110_JCLive_sf2_file",library:"JCLive",displayName:"Shanai"},{id:"1110_SBLive_sf2",library:"SBLive",displayName:"Shanai"},{id:"1110_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Shanai"},{id:"1120_Aspirin_sf2_file",library:"Aspirin",displayName:"Tinkle Bell"},{id:"1120_Chaos_sf2_file",library:"Chaos",displayName:"Tinkle Bell"},{id:"1120_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tinkle Bell"},{id:"1120_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tinkle Bell"},{id:"1120_JCLive_sf2_file",library:"JCLive",displayName:"Tinkle Bell"},{id:"1120_SBLive_sf2",library:"SBLive",displayName:"Tinkle Bell"},{id:"1120_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tinkle Bell"},{id:"1130_Aspirin_sf2_file",library:"Aspirin",displayName:"Agogo"},{id:"1130_Chaos_sf2_file",library:"Chaos",displayName:"Agogo"},{id:"1130_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Agogo"},{id:"1130_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Agogo"},{id:"1130_JCLive_sf2_file",library:"JCLive",displayName:"Agogo"},{id:"1130_SBLive_sf2",library:"SBLive",displayName:"Agogo"},{id:"1130_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Agogo"},{id:"1140_Aspirin_sf2_file",library:"Aspirin",displayName:"Steel Drums"},{id:"1140_Chaos_sf2_file",library:"Chaos",displayName:"Steel Drums"},{id:"1140_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Steel Drums"},{id:"1140_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Steel Drums"},{id:"1140_JCLive_sf2_file",library:"JCLive",displayName:"Steel Drums"},{id:"1140_SBLive_sf2",library:"SBLive",displayName:"Steel Drums"},{id:"1140_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Steel Drums"},{id:"1150_Aspirin_sf2_file",library:"Aspirin",displayName:"Woodblock"},{id:"1150_Chaos_sf2_file",library:"Chaos",displayName:"Woodblock"},{id:"1150_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Woodblock"},{id:"1150_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Woodblock"},{id:"1150_JCLive_sf2_file",library:"JCLive",displayName:"Woodblock"},{id:"1150_SBLive_sf2",library:"SBLive",displayName:"Woodblock"},{id:"1150_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Woodblock"},{id:"1160_Aspirin_sf2_file",library:"Aspirin",displayName:"Taiko Drum"},{id:"1160_Chaos_sf2_file",library:"Chaos",displayName:"Taiko Drum"},{id:"1160_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Taiko Drum"},{id:"1160_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Taiko Drum"},{id:"1160_JCLive_sf2_file",library:"JCLive",displayName:"Taiko Drum"},{id:"1160_SBLive_sf2",library:"SBLive",displayName:"Taiko Drum"},{id:"1160_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Taiko Drum"},{id:"1170_Aspirin_sf2_file",library:"Aspirin",displayName:"Melodic Tom"},{id:"1170_Chaos_sf2_file",library:"Chaos",displayName:"Melodic Tom"},{id:"1170_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Melodic Tom"},{id:"1170_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Melodic Tom"},{id:"1170_JCLive_sf2_file",library:"JCLive",displayName:"Melodic Tom"},{id:"1170_SBLive_sf2",library:"SBLive",displayName:"Melodic Tom"},{id:"1170_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Melodic Tom"},{id:"1180_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Drum"},{id:"1180_Chaos_sf2_file",library:"Chaos",displayName:"Synth Drum"},{id:"1180_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Drum"},{id:"1180_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Drum"},{id:"1180_JCLive_sf2_file",library:"JCLive",displayName:"Synth Drum"},{id:"1180_SBLive_sf2",library:"SBLive",displayName:"Synth Drum"},{id:"1180_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Drum"},{id:"1190_Aspirin_sf2_file",library:"Aspirin",displayName:"Reverse Cymbal"},{id:"1190_Chaos_sf2_file",library:"Chaos",displayName:"Reverse Cymbal"},{id:"1190_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Reverse Cymbal"},{id:"1190_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Reverse Cymbal"},{id:"1190_JCLive_sf2_file",library:"JCLive",displayName:"Reverse Cymbal"},{id:"1190_SBLive_sf2",library:"SBLive",displayName:"Reverse Cymbal"},{id:"1190_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Reverse Cymbal"},{id:"1200_Aspirin_sf2_file",library:"Aspirin",displayName:"Guitar Fret Noise"},{id:"1200_Chaos_sf2_file",library:"Chaos",displayName:"Guitar Fret Noise"},{id:"1200_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Guitar Fret Noise"},{id:"1200_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Guitar Fret Noise"},{id:"1200_JCLive_sf2_file",library:"JCLive",displayName:"Guitar Fret Noise"},{id:"1200_SBLive_sf2",library:"SBLive",displayName:"Guitar Fret Noise"},{id:"1200_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Guitar Fret Noise"},{id:"1210_Aspirin_sf2_file",library:"Aspirin",displayName:"Breath Noise"},{id:"1210_Chaos_sf2_file",library:"Chaos",displayName:"Breath Noise"},{id:"1210_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Breath Noise"},{id:"1210_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Breath Noise"},{id:"1210_JCLive_sf2_file",library:"JCLive",displayName:"Breath Noise"},{id:"1210_SBLive_sf2",library:"SBLive",displayName:"Breath Noise"},{id:"1210_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Breath Noise"},{id:"1220_Aspirin_sf2_file",library:"Aspirin",displayName:"Seashore"},{id:"1220_Chaos_sf2_file",library:"Chaos",displayName:"Seashore"},{id:"1220_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Seashore"},{id:"1220_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Seashore"},{id:"1220_JCLive_sf2_file",library:"JCLive",displayName:"Seashore"},{id:"1220_SBLive_sf2",library:"SBLive",displayName:"Seashore"},{id:"1220_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Seashore"},{id:"1230_Aspirin_sf2_file",library:"Aspirin",displayName:"Bird Tweet"},{id:"1230_Chaos_sf2_file",library:"Chaos",displayName:"Bird Tweet"},{id:"1230_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Bird Tweet"},{id:"1230_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Bird Tweet"},{id:"1230_JCLive_sf2_file",library:"JCLive",displayName:"Bird Tweet"},{id:"1230_SBLive_sf2",library:"SBLive",displayName:"Bird Tweet"},{id:"1230_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Bird Tweet"},{id:"1240_Aspirin_sf2_file",library:"Aspirin",displayName:"Telephone Ring"},{id:"1240_Chaos_sf2_file",library:"Chaos",displayName:"Telephone Ring"},{id:"1240_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Telephone Ring"},{id:"1240_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Telephone Ring"},{id:"1240_JCLive_sf2_file",library:"JCLive",displayName:"Telephone Ring"},{id:"1240_SBLive_sf2",library:"SBLive",displayName:"Telephone Ring"},{id:"1240_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Telephone Ring"},{id:"1250_Aspirin_sf2_file",library:"Aspirin",displayName:"Helicopter"},{id:"1250_Chaos_sf2_file",library:"Chaos",displayName:"Helicopter"},{id:"1250_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Helicopter"},{id:"1250_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Helicopter"},{id:"1250_JCLive_sf2_file",library:"JCLive",displayName:"Helicopter"},{id:"1250_SBLive_sf2",library:"SBLive",displayName:"Helicopter"},{id:"1250_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Helicopter"},{id:"1260_Aspirin_sf2_file",library:"Aspirin",displayName:"Applause"},{id:"1260_Chaos_sf2_file",library:"Chaos",displayName:"Applause"},{id:"1260_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Applause"},{id:"1260_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Applause"},{id:"1260_JCLive_sf2_file",library:"JCLive",displayName:"Applause"},{id:"1260_SBLive_sf2",library:"SBLive",displayName:"Applause"},{id:"1260_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Applause"},{id:"1270_Aspirin_sf2_file",library:"Aspirin",displayName:"Gunshot"},{id:"1270_Chaos_sf2_file",library:"Chaos",displayName:"Gunshot"},{id:"1270_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Gunshot"},{id:"1270_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Gunshot"},{id:"1270_JCLive_sf2_file",library:"JCLive",displayName:"Gunshot"},{id:"1270_SBLive_sf2",library:"SBLive",displayName:"Gunshot"},{id:"1270_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Gunshot"},{id:"12835_1_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 1"},{id:"12835_1_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 1"},{id:"12835_1_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 1"},{id:"12835_1_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 1"},{id:"12835_2_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 2"},{id:"12835_2_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 2"},{id:"12835_2_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 2"},{id:"12835_2_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 2"},{id:"12835_3_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 3"},{id:"12835_3_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 3"},{id:"12835_3_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 3"},{id:"12835_3_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 3"},{id:"12835_4_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 4"},{id:"12835_4_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 4"},{id:"12835_4_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 4"},{id:"12835_4_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 4"},{id:"12835_5_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 5"},{id:"12835_5_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 5"},{id:"12835_5_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 5"},{id:"12835_5_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 5"},{id:"12835_6_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 6"},{id:"12835_6_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 6"},{id:"12835_6_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 6"},{id:"12835_6_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 6"},{id:"12835_7_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 7"},{id:"12835_7_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 7"},{id:"12835_7_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 7"},{id:"12835_7_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 7"},{id:"12835_8_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 8"},{id:"12835_8_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 8"},{id:"12835_8_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 8"},{id:"12835_8_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 8"},{id:"12835_9_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 9"},{id:"12835_9_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 9"},{id:"12835_9_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 9"},{id:"12835_10_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 10"},{id:"12835_10_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 10"},{id:"12835_10_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 10"},{id:"12835_11_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 11"},{id:"12835_11_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 11"},{id:"12835_11_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 11"},{id:"12835_12_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 12"},{id:"12835_12_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 12"},{id:"12835_13_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 13"},{id:"12835_13_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 13"},{id:"12835_14_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 14"},{id:"12835_14_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 14"},{id:"12835_15_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 15"},{id:"12835_15_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 15"},{id:"12835_16_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 16"},{id:"12835_16_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 16"},{id:"12835_17_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 17"},{id:"12835_17_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 17"},{id:"12835_18_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 18"},{id:"12835_18_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 18"}];function Vo(e){const t=1+e%18,i=wt.find(a=>a.id.startsWith(`12835_${t}_`)&&a.library==="FluidR3_GM");if(i)return{library:i.library,displayName:i.displayName};const n=wt.find(a=>a.id.startsWith(`12835_${t}_`));return n?{library:n.library,displayName:n.displayName}:null}const vi=new Map;let Ze=null;function Dr(e){return Math.max(e,1e-4)}async function Yt(e){return new Promise((t,i)=>{const n=document.createElement("script");n.src=e,n.onload=()=>t(),n.onerror=()=>i(new Error(`Failed to load script: ${e}`)),document.body.appendChild(n)})}async function Wo(){Ze||(await Yt("https://surikov.github.io/webaudiofont/npm/dist/WebAudioFontPlayer.js"),Ze=new window.WebAudioFontPlayer)}async function ur(e,t=Q(),i=null,n,a,r){const[s,o]=e.split("/"),l=`${s}/${o}`;vi.has(t)||vi.set(t,new Map);const c=vi.get(t);if(c.has(l))return c.get(l);await Wo();const d=wt.find(b=>b.library===s&&b.displayName===o);if(!d)throw new Error(`Could not find WebAudioFont entry for library=${s} and instrument=${o}`);const u=t.createStereoPanner();u.pan.value=a??0,u.connect(i||rt());const p=d.displayName.startsWith("Drum Kit");if(console.log("Is drum kit: ",p),!p){const b=`_tone_${d.id}`,N=`https://surikov.github.io/webaudiofontdata/sound/${d.id}.js`;r?await Yt(N):await xr(Yt(N));const S=window[b];if(!S)throw new Error(`Missing preset: ${b}`);if(Ze.loader.decodeAfterLoading(t,b),t instanceof OfflineAudioContext){const L=(S==null?void 0:S.zones)??[];for(const M of L)if(M.file&&!M.buffer){const F=atob(M.file),w=new ArrayBuffer(F.length),I=new Uint8Array(w);for(let T=0;T<F.length;T++)I[T]=F.charCodeAt(T);M.buffer=await new Promise((T,q)=>t.decodeAudioData(w,T,q))}}const B={_preset:S,_volume:n??1,_activeEnvelopes:[],start({note:L,duration:M=1,velocity:F=100,time:w}){const I=typeof L=="string"?P(L):L;if(I==null||typeof I!="number")return;const T=typeof w=="number"?w:0,q=Math.max(.01,Math.min(1,F/127)),D=Dr(B._volume),k=Math.max(.01,Math.min(1,D*q)),U=Ze.queueWaveTable(t,u||rt(),S,T,I,M,k);B._activeEnvelopes.push(U)},stop(){var L;for(const M of B._activeEnvelopes)try{M.cancel?M.cancel():(L=M.audioBufferSourceNode)!=null&&L.stop&&M.audioBufferSourceNode.stop()}catch(F){console.warn("Failed to stop envelope:",F)}B._activeEnvelopes=[]},setVolume(L){B._volume=Math.max(0,Math.min(1,L))},setPan(L){u.pan.value=Math.max(-1,Math.min(1,L))},load:Promise.resolve()};return c.set(l,B),B}const f=d.id.match(/^12835_(\d+)_([A-Za-z0-9_]+)_sf2_file$/);if(!f)throw new Error(`Invalid drum ID format in catalogue: ${d.id}`);const[,m,h]=f,_=parseInt(m,10);console.log("Regex got kit number: ",_);const y={},g=async()=>{for(const b of js){const N=`_drum_${b}_${_}_${h}_sf2_file`;console.log("varName is: ",N);const S=`https://surikov.github.io/webaudiofontdata/sound/${12800+b}_${_}_${h}_sf2_file.js`;try{await Yt(S);const B=window[N];if(!B){console.warn(`Missing drum preset: ${N}`);continue}Ze.loader.decodeAfterLoading(t,N),y[b]=B}catch(B){console.warn(`Failed to load drum preset ${b}: ${B}`)}}};r??!1?await g():await xr(g());const v={_preset:y,_volume:n??1,_activeEnvelopes:[],start({note:b,duration:N=1,velocity:S=100,time:B}){const L=typeof b=="string"?P(b):b;if(L==null||typeof L!="number"){console.warn(`Invalid MIDI pitch: ${b}`);return}const M=y[L];if(!M){console.warn(`No drum preset loaded for MIDI ${L}`);return}const F=typeof B=="number"?B:0,w=Dr(v._volume),I=Ze.queueWaveTable(t,u||rt(),M,F,L,N,w);v._activeEnvelopes.push(I)},stop(){var b;for(const N of v._activeEnvelopes)try{N.cancel?N.cancel():(b=N.audioBufferSourceNode)!=null&&b.stop&&N.audioBufferSourceNode.stop()}catch(S){console.warn("Failed to stop envelope:",S)}v._activeEnvelopes=[]},load:Promise.resolve(),setVolume(b){v._volume=Math.max(0,Math.min(1,b))},setPan(b){u.pan.value=Math.max(-1,Math.min(1,b))}};return c.set(l,v),v}async function Ko(){const e=new Set;for(const t of wt)e.add(t.library);return Array.from(e)}async function zo(e){return wt.filter(t=>t.library===e).map(t=>t.displayName)}async function xr(e){Qe();try{return await e}finally{ei()}}function Xo(){return{name:"webaudiofont",loadInstrument:ur,getAvailableLibraries:Ko,getAvailableInstruments:zo}}let Oi=null,Ui=null;async function jo(e){if(Ui===e)return;const[,t,i]=e.split("/");Oi=await ur(`${t}/${i}`),Ui=e}function Yo(){return Ui}function Qo(e,t=100,i=!1){if(!Oi)return null;const a=Q().currentTime,r=P(e);return r===null?null:(Oi.start({note:r,velocity:t,time:a,duration:1.5,loop:i}),()=>{})}function Zo(e){}async function ed(e,t,i,n=100,a=!1,r=null,s=null,o=null,l,c){const d=s||Q(),[,u,p]=e.split("/"),f=await ur(`${u}/${p}`,d,o,l,c);l!==void 0&&f.setVolume&&f.setVolume(l),c!==void 0&&f.setPan&&f.setPan(c);const m=P(t);return m===null||f.start({note:m,duration:i,velocity:n,loop:a,time:r??d.currentTime}),null}function td(){return{name:"webaudiofont",setActiveInstrument:jo,getActiveInstrumentName:Yo,playNote:Qo,stopNoteByPitch:Zo,loadAndPlayNote:ed}}const di={sf2:Ho(),webaudiofont:td()};let st=null;async function Zn(e){if(!e.includes("/"))throw new Error(`Invalid instrument name: "${e}". Expected "<engine>/<library>/<instrument>"`);const t=e.split("/")[0],i=di[t];if(!i)throw new Error(`Engine "${t}" not available`);await i.setActiveInstrument(e),st=e}function id(){return st}function ea(e,t=100,i=!1){if(!st)return null;const n=st.split("/")[0],a=di[n];if(!a)throw new Error(`Engine "${n}" not available`);return a.playNote(e,t,i)}function rd(e){if(!st)return;const t=st.split("/")[0],i=di[t];if(!i)throw new Error(`Engine "${t}" not available`);i.stopNoteByPitch(e)}async function nd(e,t,i,n=100,a=!1,r=null,s=null,o=null,l,c){const d=e.split("/")[0],u=di[d];if(!u)throw new Error(`Engine "${d}" not available`);return await u.loadAndPlayNote(e,t,i,n,a,r,s,o,l,c)}let Si=null;function Q(){return Si||(Si=new(window.AudioContext||window.webkitAudioContext)),Si}let Ut=null,Dt=null;function Di(){return Ut||(Ut=Q().createAnalyser(),Ut.fftSize=2048),Ut}function rt(){return Dt||(Dt=Q().createGain(),Di().connect(Q().destination),Dt.connect(Di())),Dt}function ad(e){try{const t=ea(e,100,!1);return t?{stop:t,forceStop:t}:null}catch(t){return console.error("[playNote] Failed to play note",e,t),null}}function sd(e,t,{getPitchRow:i,cellWidth:n,cellHeight:a,labelWidth:r}){if(!e)return;if(!(e!=null&&e.animationCtx)){console.warn("Missing animationCtx in animateNotePlay");return}const s=t.start*n+r,o=i(t.pitch)*a,l=t.duration*n,c=a-1,d=s+l/2,u=o+c/2,f=(P(t.pitch)||0)*5%360,m=e.animationCtx,h=document.createElement("canvas");h.width=m.canvas.width,h.height=m.canvas.height;let _=h.getContext("2d");if(!_){console.warn("Could not get animation context from offscreen canvas");return}const y=performance.now(),g=ve();let v=t.duration*6e4/g;v=Math.max(100,Math.min(v,1600));const b=2,N=50;function S(M){const F=Math.sin(M*Math.PI),w=`hsla(${f}, 100%, 70%, ${.4*F})`;_&&(_.globalAlpha=1,_.fillStyle=w,_.beginPath(),_.roundRect(s,o,l,c,3),_.fill())}function B(M,F,w){const I=Math.sin(M*Math.PI),T=1+F*I,q=(1-M)*w;if(_){_.globalAlpha=q,_.strokeStyle=`hsl(${f}, 100%, 65%)`,_.lineWidth=1.5;const D=l*T,k=c*T;_.beginPath(),_.roundRect(d-D/2,u-k/2,D,k,4),_.stroke()}}function L(M){const F=M-y,w=F/v;if(w>1){_=null,h.width=0,h.height=0;return}if(_){_.clearRect(0,0,h.width,h.height),_.save(),S(w);for(let D=0;D<b;D++){const k=D*N,U=Math.max(0,Math.min(1,(F-k)/(v-k)));B(U,.1+D*.1,.3)}_.restore(),m.save();const I=1.5,T=l*I+8,q=c*I+8;m.clearRect(d-T/2,u-q/2,T,q),m.globalAlpha=1,m.drawImage(h,0,0),m.restore()}requestAnimationFrame(L)}requestAnimationFrame(L)}const ci={sf2:Uo(),webaudiofont:Xo()},ta="sf2";async function Jr(e,t,i,n,a,r){const s=e.split("/");if(s.length!==3)throw new Error(`Invalid instrument fullName format: "${e}". Expected format "engine/library/instrument"`);const[o,l,c]=s,d=ci[o];if(!d)throw new Error(`Engine "${o}" not available`);return console.log("Calling loadInstrument with ",`engine: ${o} at ${l}/${c}`),await d.loadInstrument(`${l}/${c}`,t,i,n,a,r)}async function ld(e=ta){const t=ci[e];if(!t)throw new Error(`Engine "${e}" not available`);return await t.getAvailableLibraries()}async function od(e,t=ta){const i=ci[t];if(!i)throw new Error(`Engine "${t}" not available`);return await i.getAvailableInstruments(e)}function dd(){return Object.keys(ci)}const be=class be{constructor(t,i,n=Q(),a=rt(),r="sf2/fluidr3-gm/acoustic_grand_piano",s=!1){this.notes=[],this.colorIndex=0,this.id=0,this.mute=!1,this.solo=!1,this.collapsed=!1,this._activeNoteKeys=new Set,this._noteHandlers=new Map,this._beatHandler=null,this._unsub=null,this._scheduledAnimations=[],this._animationLoopRunning=!1,this._animationCursor=0,this._volume=100/127,this._pan=0,this._instrument=null,be.allSequencers.push(this),this.container=t,this.config={...i},this.context=n,this.destination=a,this.instrumentName=r,this.squelchLoadingScreen=s,this.container&&(this.pianoRollCanvas=this.container.querySelector(".piano-roll"),this.gridCanvas=this.container.querySelector(".note-grid"),this.animationCanvas=this.container.querySelector(".note-animate-canvas"),this._initCanvases())}static isAnySoloActive(){return be.allSequencers.some(t=>t.solo)}static rescheduleAll(){if(!O.isActive())return;const t=O.getStartTime(),i=O.getStartBeat();for(const n of be.allSequencers)n.stopScheduledNotes(),n.shouldPlay&&n.reschedulePlayback(t,i)}_initCanvases(){if(!this.container)return;const t=this.container.querySelector("canvas.note-grid"),i=this.container.querySelector("canvas.playhead-canvas"),n=this.container.querySelector("#grid-scroll-container"),a=this.container.querySelector("canvas.note-animate-canvas");this.grid=Ll(t,i,a,n,this.notes,this.config,this),this.grid.scheduleRedraw()}async initInstrument(){try{this._instrument=await Jr(this.instrumentName,this.context,this.destination,this._volume,this._pan),this.updateToDrumNoteRange()}catch(t){console.warn(`[SEQ:${this.id}] Failed to load instrument '${this.instrumentName}':`,t)}}setInstrument(t){this.instrumentName=t,this.updateTrackLabel(),this.initInstrument()}updateTrackLabel(){var i;const t=(i=this.container)==null?void 0:i.querySelector(".track-name");t&&(t.textContent=`${this.id+1}: ${this.instrumentName}`)}get volume(){return this._volume}set volume(t){var i;this._volume=Math.max(0,Math.min(1,t)),(i=this._instrument)!=null&&i.setVolume&&this._instrument.setVolume(this._volume)}get pan(){return this._pan}set pan(t){var i;this._pan=Math.max(-1,Math.min(1,t)),(i=this._instrument)!=null&&i.setPan&&this._instrument.setPan(this._pan)}get shouldPlay(){return be.isAnySoloActive()?this.solo:!this.mute}toggleMute(){this.mute=!this.mute,this.mute&&(this.solo=!1),this.stopScheduledNotes(),this.updateTrackStyle(),O.isActive()&&be.rescheduleAll()}toggleSolo(){this.solo=!this.solo,this.solo&&(this.mute=!1),this.updateTrackStyle(),O.isActive()&&be.rescheduleAll()}async preparePlayback(t,i=0){var o,l,c;if(this._instrument||await this.initInstrument(),this.stopScheduledNotes(),!((o=this._instrument)!=null&&o.start)){console.warn(`[SEQ:${this.id}] Instrument does not support scheduled playback.`);return}const a=60/ve(),r=this.notes;r.sort((d,u)=>d.start-u.start);let s=0;for(;s<r.length&&r[s].start<i;)s++;for(;s<r.length;s++){const d=r[s],u=P(d.pitch);if(u===null)continue;const p=t+(d.start-i)*a,f=d.duration*a,m=d.velocity??100;try{console.log(`[SEQ:${this.id}] Scheduling note ${d.pitch} at ${p.toFixed(3)}`),this._instrument.start({note:u,time:p,duration:f,velocity:m}),!this.collapsed&&((c=(l=this.grid)==null?void 0:l.gridContext)!=null&&c.animationCtx)&&(this._scheduledAnimations.push({time:p,note:d,context:this.grid.gridContext}),this._startAnimationLoop())}catch(h){console.warn(`[SEQ:${this.id}] Failed to schedule note`,d,h)}}}stopScheduledNotes(){this._instrument&&this._instrument.stop(),this._scheduledAnimations=[],this._animationCursor=0,this._animationLoopRunning=!1}_startAnimationLoop(){if(this._animationLoopRunning)return;this._animationLoopRunning=!0;const t=()=>{const i=Q().currentTime,n=.05,a=this._scheduledAnimations.length;for(;this._animationCursor<a&&this._scheduledAnimations[this._animationCursor].time<i+n;){const{note:r,context:s}=this._scheduledAnimations[this._animationCursor++];sd(s,r,{getPitchRow:s.getPitchRow,cellWidth:s.getCellWidth(),cellHeight:s.getCellHeight(),labelWidth:ie})}this._animationCursor>=a?(this._scheduledAnimations=[],this._animationCursor=0,this._animationLoopRunning=!1):requestAnimationFrame(t)};requestAnimationFrame(t)}resumeAnimationsFromCurrentTime(t,i){var s;if(!((s=this.grid)!=null&&s.gridContext)||this.collapsed)return;const a=60/ve(),r=Q().currentTime;for(const o of this.notes){const l=t+(o.start-i)*a;l>=r&&this._scheduledAnimations.push({time:l,note:o,context:this.grid.gridContext})}this._scheduledAnimations.sort((o,l)=>o.time-l.time),this._startAnimationLoop()}async reschedulePlayback(t,i=0){var o,l,c;if(this.stopScheduledNotes(),this._instrument||await this.initInstrument(),this.mute||!this.shouldPlay||!((o=this._instrument)!=null&&o.start))return;const a=60/ve(),r=Q().currentTime,s=this.notes.filter(d=>d.start>=i);for(const d of s){const u=P(d.pitch);if(u===null)continue;const p=t+(d.start-i)*a,f=d.duration*a,m=d.velocity??100;if(!(p<=r+.01))try{console.log(`[SEQ:${this.id}] Recheduling note ${d.pitch} at ${p.toFixed(3)}`),this._instrument.start({note:u,time:p,duration:f,velocity:m}),!this.collapsed&&((c=(l=this.grid)==null?void 0:l.gridContext)!=null&&c.animationCtx)&&p>=r&&(this._scheduledAnimations.push({time:p,note:d,context:this.grid.gridContext}),this._startAnimationLoop())}catch(h){console.warn(`[SEQ:${this.id}] Failed to re-schedule note`,d,h)}}}async exportToOffline(t){const i=60/ve();if(t!=null&&t.aborted)return;const n=await Jr(this.instrumentName,this.context,this.destination,this._volume,this._pan);if(!(t!=null&&t.aborted))for(const a of this.notes){if(t!=null&&t.aborted)return;const r=a.start*i,s=Math.max(.01,r),o=a.duration*i,l=a.velocity??100,c=P(a.pitch);if(c==null)continue;const d=this.instrumentName.split("/"),p=(d.length>=3?d[1]:d[0])==="drummachines"&&n.__midiMap?n.__midiMap.get(c)??c:c;try{n.start({note:p,duration:o,velocity:l,time:s,loop:!1})}catch(f){console.warn(`[SEQ:${this.id}] Failed to start note in export:`,a,f)}}}playNote(t,i,n=100,a=!1){return nd(this.instrumentName,t,i,n,a,null,this.context,this.destination,this.volume,this.pan)}updateTotalMeasures(){var s,o,l;const t=j();this.clampNotesToGrid();const i=t*this.config.cellWidth+ie,n=(s=this.container)==null?void 0:s.querySelector("canvas.note-grid"),a=(o=this.container)==null?void 0:o.querySelector(".playhead-canvas"),r=(l=this.container)==null?void 0:l.querySelector(".mini-contour");n&&(n.width=i,n.style.width=`${i}px`),a&&(a.width=i,a.style.width=`${i}px`),r&&at(r,this.notes,this.config,this.colorIndex),this.redraw()}clampNotesToGrid(){const t=j(),i=this.notes.filter(n=>n.start<t);i.forEach(n=>{n.start+n.duration>t&&(n.duration=t-n.start)}),this.notes.splice(0,this.notes.length,...i)}updateTrackStyle(){if(!this.container)return;const t=this.container.querySelector(".mute-btn"),i=this.container.querySelector(".solo-btn"),n=this.container.querySelector(".sequencer-body"),a=this.container.querySelector(".mini-contour");t==null||t.classList.toggle("bg-red-600",this.mute),t==null||t.classList.toggle("bg-gray-700",!this.mute),i==null||i.classList.toggle("bg-yellow-200",this.solo),i==null||i.classList.toggle("bg-gray-700",!this.solo);const r=this.mute&&!this.solo;n==null||n.classList.toggle("opacity-40",r),n==null||n.classList.toggle("opacity-100",!r),a==null||a.classList.toggle("opacity-40",r),a==null||a.classList.toggle("opacity-100",!r)}redraw(){var t;(t=this.grid)==null||t.scheduleRedraw()}getState(){return{notes:[...this.notes],config:{...this.config},instrument:this.instrumentName}}setState({notes:t,config:i,instrument:n,volume:a,pan:r}){this.notes.length=0,this.notes.push(...t),Object.assign(this.config,i),typeof a=="number"&&(this.volume=a),typeof r=="number"&&(this.pan=r),n&&(this.instrumentName=n),this.redraw()}updateNotesFromTrackMap(t){this.notes.splice(0,this.notes.length,...t.n.map(([i,n,a,r=100])=>({pitch:i,start:n,duration:a,velocity:r})))}updateNoteRange(t){var d,u,p,f;const[i,n]=t,a=P(i),r=P(n);if(a===null||r===null){console.warn(`Invalid note range: ${t}`);return}if(a>=r){console.warn("Invalid note range: low note must be lower than high note");return}this.config.noteRange=t,this.config.visibleNotes=Ei(n,i)+1;const s=(d=this.container)==null?void 0:d.querySelector("canvas.note-grid"),o=(u=this.container)==null?void 0:u.querySelector(".playhead-canvas"),l=(p=this.container)==null?void 0:p.querySelector(".note-animate-canvas"),c=(f=this.container)==null?void 0:f.querySelector(".mini-contour");if(s&&o&&l){const m=this.config.visibleNotes*this.config.cellHeight;[s,o,l].forEach(h=>{h.height=m,h.style.height=`${m}px`}),c&&at(c,this.notes,this.config,this.colorIndex),this.redraw()}this.notes.forEach(m=>{const h=P(m.pitch);h!==null&&(h<a?m.pitch=i:h>r&&(m.pitch=n))})}updateToDrumNoteRange(){this.instrumentName.toLowerCase().includes("drum kit")?this.updateNoteRange(["B1","A5"]):this.updateNoteRange(["C1","B9"])}setCollapsed(t){var i,n,a,r;this.collapsed=t,t?(this._scheduledAnimations=[],this._animationCursor=0,this._animationLoopRunning=!1,(i=this.animationCanvas)==null||i.classList.add("hidden"),(n=this.grid)!=null&&n.gridContext&&(this.grid.gridContext.animationCtx=null)):((a=this.animationCanvas)==null||a.classList.remove("hidden"),this.animationCanvas&&((r=this.grid)!=null&&r.gridContext)&&(this.grid.gridContext.animationCtx=this.animationCanvas.getContext("2d")),O.isActive()&&this.resumeAnimationsFromCurrentTime(O.getStartTime(),O.getStartBeat()))}destroy(){var t;this.stopScheduledNotes(),(t=this.container)==null||t.remove()}};be.allSequencers=[];let ii=be,Ge,et,ia,ra,xe,de,Se="sf2";function cd(){Ge=document.getElementById("instrument-select-modal"),et=document.getElementById("instrument-select"),ia=document.getElementById("instrument-select-confirm"),ra=document.getElementById("instrument-cancel-btn"),xe=document.getElementById("instrument-engine-select"),de=document.getElementById("instrument-library-select"),ud(),fd()}function ud(){const e=dd();xe.innerHTML="",e.forEach(t=>{const i=document.createElement("option");i.value=t,i.textContent=t.toUpperCase(),xe.appendChild(i)}),xe.value=Se}function fd(){xe.addEventListener("change",async()=>{Se=xe.value,await na()}),de.addEventListener("change",()=>{const e=new CustomEvent("instrument-library-change",{detail:{preselect:null}});de.dispatchEvent(e)}),de.addEventListener("instrument-library-change",async e=>{var a;const t=e,i=de.value,n=((a=t.detail)==null?void 0:a.preselect)??null;try{const r=await od(i,Se);et.innerHTML="",r.forEach(s=>{const o=document.createElement("option");o.value=`${Se}/${i}/${s}`,o.textContent=s.split("_").map(l=>l?l[0].toUpperCase()+l.slice(1):"").join(" "),et.appendChild(o)}),n?et.value=n:r.length>0&&(et.value=`${Se}/${i}/${r[0]}`)}catch(r){console.error(`Failed to load instruments for library: ${i}`,r)}}),ia.addEventListener("click",md),ra.addEventListener("click",pd)}async function na(e=null,t=null){try{const i=await ld(Se);de.innerHTML="",i.forEach(a=>{const r=document.createElement("option");r.value=a,r.textContent=a.replace(/_/g," ").replace(/\b\w/g,s=>s.toUpperCase()),de.appendChild(r)}),e&&i.includes(e)?de.value=e:i.length>0&&(de.value=i[0]);const n=new CustomEvent("instrument-library-change",{detail:{preselect:t}});de.dispatchEvent(n)}catch(i){console.error("Failed to refresh libraries for engine:",Se,i)}}async function aa(e,t){const[i,n,a]=e.split("/");Se=i||"sf2",xe.value=Se,t!==void 0?Ge.dataset.currentSequencer=String(t):delete Ge.dataset.currentSequencer,await na(n,e)}async function md(){const e=et.value;Ge.classList.add("hidden");const t=Number(Ge.dataset.currentSequencer);if(Ge.dataset.currentSequencer!==void 0&&!isNaN(t)){const i=xd(t);if(i){$(fs(i.id,e),ms(i.id,i.instrumentName)),i.setInstrument(e);return}console.warn(`Failed to find sequencer with ID ${t}`);return}if(Ge.dataset.currentSequencer===void 0)try{return await Zn(e),window.dispatchEvent(new CustomEvent("global-instrument-selected",{detail:{fullName:e}})),e}catch(i){console.error("Failed to load global instrument:",e,i)}}function pd(){Ge.classList.add("hidden")}function _d(e,t){var p;const i=(p=e.querySelector(".volume-fill"))==null?void 0:p.parentElement,n=e.querySelector(".volume-fill"),a=e.querySelector(".volume-thumb");let r=!1,s=!1,o=!1,l=null;if(!i||!n){console.warn("[setupVolumeBar] Volume bar or fill element missing.");return}function c(){const f=Math.max(0,Math.min(1,t.volume)),m=100/127,h=i.clientWidth,_=14,y=0,g=h-_,v=f*h,b=Math.max(y,Math.min(g,v-_/2)),N=Math.round(f*100);n.style.width=`${N}%`,a.style.left=`${b}px`;const S=Math.round(f/m*100);i.setAttribute("title",`Volume: ${S}%`),f>m?(n.classList.add("overdrive"),a.classList.add("overdrive")):(n.classList.remove("overdrive"),a.classList.remove("overdrive"))}function d(){s?(n.classList.add("precise"),a.classList.add("precise")):(n.classList.remove("precise"),a.classList.remove("precise"))}t.refreshVolumeUI=c,requestAnimationFrame(c);function u(f){const m=i.getBoundingClientRect(),h=f-m.left,_=100/127,y=.1;let g=Math.max(0,Math.min(1,h/m.width));return!s&&Math.abs(g-_)<y?(g=_,!r&&navigator.vibrate&&navigator.vibrate(10),r=!0):r=!1,t.volume=g,c(),g}i.addEventListener("mousedown",f=>{o=!0,s=f.shiftKey,l=t.volume,d(),u(f.clientX),f.preventDefault()}),window.addEventListener("mousemove",f=>{o&&(s=f.shiftKey,d(),u(f.clientX))}),window.addEventListener("mouseup",f=>{if(!o)return;o=!1;const m=u(f.clientX);l!==null&&m!==l&&$(_s(t.id,m),ys(t.id,l)),s=!1,d(),n.classList.remove("precise"),a.classList.remove("precise"),c(),l=null})}function yd(e,t){var p;const i=(p=e.querySelector(".pan-fill"))==null?void 0:p.parentElement,n=e.querySelector(".pan-fill"),a=e.querySelector(".pan-thumb");let r=!1,s=!1,o=!1,l=null;if(!i||!n){console.warn("[setupPanBar] Pan bar or fill element missing.");return}function c(){const f=Math.max(-1,Math.min(1,t.pan)),m=(f+1)/2,h=i.clientWidth,_=14,y=0,g=h-_,v=m*h,b=Math.max(y,Math.min(g,v-_/2)),N=Math.round(m*100);n.style.width=`${N}%`,a.style.left=`${b}px`;const S=Math.round(f*100);i.setAttribute("title",`Pan: ${S}%`)}t.refreshPanUI=c;function d(){s?(n.classList.add("precise"),a.classList.add("precise")):(n.classList.remove("precise"),a.classList.remove("precise"))}requestAnimationFrame(c);function u(f){const m=i.getBoundingClientRect(),h=f-m.left;let y=Math.max(0,Math.min(1,h/m.width))*2-1;const g=0;return!s&&Math.abs(y-g)<.05?(y=g,!r&&navigator.vibrate&&navigator.vibrate(10),r=!0):r=!1,t.pan=y,c(),y}i.addEventListener("mousedown",f=>{o=!0,s=f.shiftKey,l=t.pan,d(),u(f.clientX),f.preventDefault()}),window.addEventListener("mouseup",f=>{if(!o)return;o=!1;const m=u(f.clientX);l!==null&&m!==l&&$(bs(t.id,m),gs(t.id,l)),s=!1,d(),n.classList.remove("precise"),a.classList.remove("precise"),c(),l=null}),window.addEventListener("mousemove",f=>{o&&(s=f.shiftKey,d(),u(f.clientX))})}function fr(){return typeof window<"u"&&typeof localStorage<"u"}function hd(){if(!fr())return;const e=qe();localStorage.setItem("userConfig",JSON.stringify(e))}function bd(){if(!fr())return;const e=localStorage.getItem("userConfig");if(e)try{const t=JSON.parse(e);Gt(t)}catch(t){console.error("Failed to parse userConfig from localStorage:",t)}}fr()&&bd();const qr=["gpt-4o","gpt-4o-mini","gpt-4.1","gpt-4.1-mini","o3-mini","o4-mini"];function xi(){return qe().openaiApiKey}function $r(){return qe().openaiModel}function gd(e){Gt({openaiApiKey:e})}function vd(e){if(!qr.includes(e))throw new Error(`Invalid model: ${e}. Must be one of: ${qr.join(", ")}`);Gt({openaiModel:e})}function Sd(){var a;const e=document.getElementById("openai-key-input"),t=document.getElementById("openai-model-select"),i=document.getElementById("config-save"),n=document.querySelectorAll("#config-close, #config-close-bottom");e.value=xi(),t.value=$r(),i.addEventListener("click",()=>{var r;gd(e.value),vd(t.value),hd(),(r=document.getElementById("userconfig-modal"))==null||r.classList.add("hidden")}),n.forEach(r=>{r.addEventListener("click",()=>{var s;e.value=xi(),t.value=$r(),(s=document.getElementById("userconfig-modal"))==null||s.classList.add("hidden")})}),(a=document.getElementById("key-not-set-ok"))==null||a.addEventListener("click",()=>{var r;(r=document.getElementById("openai-key-not-set-modal"))==null||r.classList.add("hidden")})}const Nd=["Darkroom","Seashell","Cyberpunk","Classic Blue","Midnight"],Bd=["Track Color","Note Velocity","Pitch Class Contrast","Scriabin","Octave Bands"];function Cd(){const e=document.getElementById("grid-color-select"),t=document.getElementById("note-color-select");if(!e||!t)return;for(const n of Nd){const a=document.createElement("option");a.value=n,a.textContent=n,e.appendChild(a)}for(const n of Bd){const a=document.createElement("option");a.value=n,a.textContent=n,t.appendChild(a)}const i=qe();e.value=i.gridColorScheme,t.value=i.noteColorScheme,e.addEventListener("change",n=>{const a=n.target;Gt({gridColorScheme:a.value}),me().forEach(r=>{var s;return(s=r.grid)==null?void 0:s.scheduleRedraw()})}),t.addEventListener("change",n=>{const a=n.target;Gt({noteColorScheme:a.value}),me().forEach(r=>{var s;return(s=r.grid)==null?void 0:s.scheduleRedraw()})})}function Ld(){const e=document.getElementById("userconfig-modal"),t=document.querySelectorAll(".settings-tab"),i=document.querySelectorAll(".settings-section");if(!e)return;function n(){t.forEach(a=>{const r=a.dataset.tab;if(!r)return;const s=document.getElementById(r),o=s!==null&&!s.classList.contains("hidden");a.classList.toggle("text-purple-500",o),a.classList.toggle("opacity-100",o),a.classList.toggle("text-gray-500",!o),a.classList.toggle("opacity-50",!o)})}t.forEach(a=>{a.addEventListener("click",()=>{const r=a.dataset.tab;if(!r)return;i.forEach(o=>o.classList.add("hidden"));const s=document.getElementById(r);s&&s.classList.remove("hidden"),n()})}),n(),Sd(),Cd()}function Md(e,t){const i=ui();if(!i){console.warn("No active grid found to apply velocity changes.");return}if(!e||e.length===0){console.warn("No notes provided to apply velocity changes.");return}const n=e.map(m=>({...m})),{mode:a,value:r,rampDirection:s="none",rampAmount:o=0,rampMode:l="linear",randomize:c=!1,randomRange:d=0}=t,u=e.map((m,h)=>({note:m,originalIndex:h}));u.sort((m,h)=>m.note.start-h.note.start),u.forEach(({note:m},h)=>{let _;switch(a){case"set":_=Math.max(1,r);break;case"increase":_=(m.velocity??100)+r;break;case"decrease":_=(m.velocity??100)-r;break;case"none":default:_=m.velocity??100;break}let y=0;if(s!=="none"&&o!==0){const v=l==="linear"?h:Math.pow(h,1.3);y=o*v,s==="down"&&(y=-y)}let g=_+y;if(c&&d>0){const v=(Math.random()*2-1)*d;g+=v}m.velocity=Math.max(1,Math.min(127,Math.round(g)))});const f=u.sort((m,h)=>m.originalIndex-h.originalIndex).map(({note:m})=>({...m}));$(Os(i.gridContext.sequencer.id,f),Us(i.gridContext.sequencer.id,n))}let mr=[];const Hr="velocity-modal",Gd="velocity-action-select",wd="velocity-value-input",Ed="velocity-apply-btn",Fd="velocity-cancel-btn";function sa(){const e=document.getElementById(Hr);if(!e)throw new Error(`[VelocityModeMenu] Modal element "#${Hr}" not found`);return e}function la(e){mr=e,sa().classList.remove("hidden")}function oa(){sa().classList.add("hidden"),mr=[]}function Pd(){var u,p,f,m,h,_,y,g,v;const e=((u=document.getElementById("velocity-set-toggle"))==null?void 0:u.checked)??!0,t=((p=document.getElementById("velocity-ramp-toggle"))==null?void 0:p.checked)??!1,i=((f=document.getElementById("velocity-randomize-toggle"))==null?void 0:f.checked)??!1,n=parseInt(((m=document.getElementById(wd))==null?void 0:m.value)??"",10),a=isNaN(n)?100:n,r=Math.max(1,Math.min(127,a)),s=e?(h=document.getElementById(Gd))==null?void 0:h.value:"none",o=t?(_=document.getElementById("velocity-ramp-direction"))==null?void 0:_.value:"none",l=t?parseInt(((y=document.getElementById("velocity-ramp-amount"))==null?void 0:y.value)??"0",10):0,c=t?(g=document.querySelector('input[name="ramp-mode"]:checked'))==null?void 0:g.value:"linear",d=i?parseInt(((v=document.getElementById("velocity-random-range"))==null?void 0:v.value)??"0",10):0;Md(mr,{mode:s,value:r,rampDirection:o,rampAmount:l,rampMode:c,randomize:i,randomRange:d}),oa()}function Ad(){oa()}function kd(){const e=document.getElementById("velocity-set-toggle"),t=document.getElementById("velocity-set-fields"),i=document.getElementById("velocity-ramp-toggle"),n=document.getElementById("velocity-ramp-fields"),a=document.getElementById("velocity-randomize-toggle"),r=document.getElementById("velocity-random-fields");if(e&&t&&e.addEventListener("change",()=>{t.classList.toggle("opacity-50",!e.checked),t.classList.toggle("pointer-events-none",!e.checked)}),i&&n&&(i.checked=!1,n.classList.add("opacity-50","pointer-events-none"),i.addEventListener("change",()=>{n.classList.toggle("opacity-50",!i.checked),n.classList.toggle("pointer-events-none",!i.checked)})),a&&r){const s=()=>{const o=a.checked;r.classList.toggle("opacity-50",!o),r.classList.toggle("pointer-events-none",!o)};a.addEventListener("change",s),s()}}function Id(){var e,t;(e=document.getElementById(Ed))==null||e.addEventListener("click",Pd),(t=document.getElementById(Fd))==null||t.addEventListener("click",Ad),kd()}function da(e){const t=document.getElementById("error-modal"),i=document.getElementById("error-message-content");if(!t||!i){console.error("Error modal elements not found");return}i.textContent=e,t.classList.remove("hidden")}var _n;(_n=document.getElementById("error-close-btn"))==null||_n.addEventListener("click",()=>{var e;(e=document.getElementById("error-modal"))==null||e.classList.add("hidden")});let Vr=!1,Ue=!1,De=!1;function Td({getSequencers:e,onPlay:t,onStop:i,onPause:n,onResume:a,onDurationChange:r,onSnapChange:s,onToggleLoop:o,onTempoChange:l,onSave:c,onLoad:d,onMeasuresChange:u,onBeatsPerMeasureChange:p}){if(Vr)return;Vr=!0;const f=document.getElementById("play-button"),m=f.querySelector("use"),h=document.getElementById("stop-button"),_=document.getElementById("note-duration"),y=document.getElementById("dotted-note-btn"),g=document.getElementById("triplet-note-btn"),v=document.getElementById("snap-resolution"),b=document.getElementById("loop-toggle"),N=document.getElementById("tempo-input"),S=document.getElementById("save-button"),B=document.getElementById("load-button"),L=document.getElementById("measures-input"),M=document.getElementById("beats-per-measure-input"),F=document.getElementById("config-button"),w=document.getElementById("export-modal"),I=document.getElementById("export-json"),T=document.getElementById("export-wav"),q=document.getElementById("export-midi"),D=document.getElementById("export-cancel");_.value=String(se.currentDuration||1),v.value=String(se.snapResolution||.25);const k=document.getElementById("import-modal"),U=document.getElementById("import-json"),Ce=document.getElementById("import-midi"),$e=document.getElementById("import-cancel"),X=document.getElementById("load-input");B.addEventListener("click",()=>{k==null||k.classList.remove("hidden")}),X&&X.addEventListener("change",A=>{var W;const x=A.target,G=(W=x.files)==null?void 0:W[0];G&&d(G),x.value=""}),U&&U.addEventListener("click",()=>{k==null||k.classList.add("hidden"),X&&(X.setAttribute("accept",".json"),X.click())}),Ce&&Ce.addEventListener("click",()=>{k==null||k.classList.add("hidden"),X&&(X.setAttribute("accept",".mid,.midi"),X.click())}),$e&&$e.addEventListener("click",()=>{k==null||k.classList.add("hidden")}),m.setAttribute("href","#icon-play"),f.addEventListener("click",()=>{!Ue&&!De?(Ue=!0,De=!1,t(),m.setAttribute("href","#icon-pause")):Ue?(Ue=!1,De=!0,n(),m.setAttribute("href","#icon-play")):De&&(Ue=!0,De=!1,a(),m.setAttribute("href","#icon-pause"))}),h.addEventListener("click",()=>{i(),Ue=!1,De=!1,m.setAttribute("href","#icon-play")}),window.addEventListener("keydown",A=>{var W;if(document.querySelector(".ai-modal:not(.hidden)"))return;const G=(W=document.activeElement)==null?void 0:W.tagName;if(!(G==="INPUT"||G==="TEXTAREA")){if(A.code==="Space"){A.preventDefault(),f.click();return}if((A.metaKey||A.ctrlKey)&&A.key.toLowerCase()==="r"){A.preventDefault();return}if(A.key==="1"&&Pi()===ue.SELECT){const Z=fa();if(!Z||Z.selectedNotes.length===0){da("No notes selected. Please select notes before adjusting velocity.");return}A.preventDefault(),la(Z.selectedNotes);return}if(Pi()===ue.NOTE_PLACEMENT){if(Object.prototype.hasOwnProperty.call(Cr,A.code)){A.preventDefault();const Z=Cr[A.code];_.value=String(Z),_.dispatchEvent(new Event("change"))}if(A.key==="."){A.preventDefault(),y==null||y.click();return}if(A.key==="/"){A.preventDefault(),g==null||g.click();return}}}}),_.addEventListener("change",A=>{const x=A.target,G=parseFloat(x.value);Fe(G),r(G),e().forEach(W=>{const Z=W.grid;if(Z!=null&&Z.getPreviewNote){const He=Z.getPreviewNote();He&&(He.duration=G,Z.scheduleRedraw())}})});function Fe(A){document.querySelectorAll(".note-duration-btn").forEach(G=>{const W=parseFloat(G.dataset.value??"0");G.classList.remove("bg-purple-700","bg-gray-800"),W===A?G.classList.add("bg-purple-700"):G.classList.add("bg-gray-800")})}v.addEventListener("change",A=>{const G=A.target.value;Object.prototype.hasOwnProperty.call(es,G)&&(se.snapResolution=parseFloat(G),v.value=String(G),s(se.snapResolution))}),b.addEventListener("change",A=>{const x=A.target;o(x.checked)}),N.addEventListener("change",A=>{const x=A.target,G=parseInt(x.value,10);x.blur(),isNaN(G)||l(G)}),S.addEventListener("click",()=>{w?w.classList.remove("hidden"):c("json")}),I&&I.addEventListener("click",()=>{w==null||w.classList.add("hidden"),c==null||c("json")}),T&&T.addEventListener("click",()=>{w==null||w.classList.add("hidden"),requestAnimationFrame(()=>{c==null||c("wav")})}),q&&q.addEventListener("click",()=>{w==null||w.classList.add("hidden"),c==null||c("midi")}),D&&D.addEventListener("click",()=>{w==null||w.classList.add("hidden")}),F==null||F.addEventListener("click",()=>{const A=document.getElementById("userconfig-modal");A==null||A.classList.remove("hidden")}),Ld(),L&&(L.value=String(Pt())),M&&(M.value=String(Ft())),L==null||L.addEventListener("change",A=>{const x=A.target,G=parseInt(x.value,10);!isNaN(G)&&G>0&&(u==null||u(G))}),M==null||M.addEventListener("change",A=>{const x=A.target,G=parseInt(x.value,10);!isNaN(G)&&G>0&&(p==null||p(G))}),Fe(parseFloat(_.value))}function Rd(){Ue=!1,De=!1;const e=document.getElementById("play-button"),t=e==null?void 0:e.querySelector("use");t&&t.setAttribute("href","#icon-play")}function Od(e){const t=e.querySelector(".cursor-grab");if(!t)return;const i=e.querySelector(".sequencer-body");if(!i)return;let n=!1,a=0,r=0;const s=150,o=1e3;t.addEventListener("mousedown",l=>{n=!0,a=l.clientY,r=i.offsetHeight,t.classList.replace("cursor-grab","cursor-grabbing"),document.body.style.userSelect="none"}),window.addEventListener("mousemove",l=>{if(!n)return;const c=l.clientY-a;let d=r+c;d=Math.max(s,Math.min(o,d)),i.style.height=`${d}px`}),window.addEventListener("mouseup",()=>{n&&(n=!1,t.classList.replace("cursor-grabbing","cursor-grab"),document.body.style.userSelect="")})}const R=[],Ud=document.getElementById("sequencers-container"),Dd=document.getElementById("sequencer-template"),ca=document.getElementById("add-sequencer");function ua(e){const i=Dd.content.cloneNode(!0).querySelector(".sequencer");Ud.insertBefore(i,ca);const n=R.length,a={id:n,...se},r=(e==null?void 0:e.instrument)||"sf2/fluidr3-gm/acoustic_grand_piano",s=new ii(i,a,Q(),rt(),r);s.id=n,s.colorIndex=n,s.mute=!1,s.solo=!1,s.volume=100/127;const o=i.querySelector("canvas.mini-contour");e&&s.setState({notes:e.notes,config:{},instrument:e.instrument,volume:e.volume,pan:e.pan}),at(o,s.notes,s.config,s.colorIndex),s.updateTrackLabel(),s.initInstrument(),_d(i,s),yd(i,s);const l=i.querySelector(".collapse-btn"),c=l.querySelector("use"),d=i.querySelector(".sequencer-body");l.addEventListener("click",()=>{const _=d.classList.toggle("hidden");c.setAttribute("href",_?"#icon-caret-up":"#icon-caret-down"),o.classList.toggle("hidden",!_),kt(i,!_),s.setCollapsed(_),_&&at(o,s.notes,s.config,s.colorIndex)}),i.querySelector(".delete-btn").addEventListener("click",()=>{const _=document.getElementById("delete-confirm-modal"),y=document.getElementById("delete-confirm"),g=document.getElementById("delete-cancel");_.classList.remove("hidden");const v=()=>{const S=ds(s.id,s.instrumentName,s.notes,s.volume,s.pan),B=cs(s.id,s.instrumentName,s.notes,s.volume,s.pan);$(S,B),N()},b=()=>{N()},N=()=>{_.classList.add("hidden"),y.removeEventListener("click",v),g.removeEventListener("click",b)};y.addEventListener("click",v),g.addEventListener("click",b)});const p=i.querySelector(".instrument-select-btn");function f(_,y){_.classList.toggle("side-button-activated",y)}const m=i.querySelector(".mute-btn"),h=i.querySelector(".solo-btn");return m.addEventListener("click",()=>{s.toggleMute(),f(m,s.mute),f(h,s.solo)}),h.addEventListener("click",()=>{s.toggleSolo(),f(m,s.mute),f(h,s.solo)}),p.addEventListener("click",async()=>{const _=s.instrumentName||"sf2/fluidr3-gm/acoustic_grand_piano";await aa(_,s.id),document.getElementById("instrument-select-modal").classList.remove("hidden")}),Od(i),R.push(s),{seq:s,wrapper:i}}function kt(e,t){var i,n,a,r,s;(i=e.querySelector(".zoom-in-btn"))==null||i.classList.toggle("hidden",!t),(n=e.querySelector(".zoom-out-btn"))==null||n.classList.toggle("hidden",!t),(a=e.querySelector(".zoom-reset-btn"))==null||a.classList.toggle("hidden",!t),(r=e.querySelector(".zoom-button-divider"))==null||r.classList.toggle("hidden",!t),(s=e.querySelector(".grip-handle"))==null||s.classList.toggle("hidden",!t)}function me(){return R}function xd(e){const t=e;return R.find(i=>i.id===t)}function Jd(){R.slice().forEach(i=>i.destroy()),R.length=0;const e=Je(),t=structuredClone(e);t.sequencers=[],Ws(),Ln(t),Et(t)}function qd(){document.getElementById("global-mini-contour"),ca.addEventListener("click",()=>{const e=R.length;$(Nn(e,"sf2/fluidr3-gm/acoustic_grand_piano"),Ki(e))})}let Ne=null;function bt(e){Ne&&Ne!==e&&Ne.clearSelection(),Ne=e}function $d(){Ne=null}function ui(){return Ne}function fa(){if(!Ne)return null;const e=Ne.getSelectedNotes();if(!e||e.length===0)return null;const i=me().find(n=>n.grid===Ne);return i?{sequencerId:i.id,selectedNotes:e}:null}function Hd(){const e=fa();if(!e||e.selectedNotes.length===0){da("No notes selected. Please select notes before adjusting velocity.");return}la(e.selectedNotes)}function Vd(){const e=document.getElementById("velocity-mode-menu-btn");if(!e){console.warn('[VelocityMode] Could not find button with id "velocity-mode-menu-btn".');return}e.addEventListener("click",Hd)}const Wd="v0.0.9",Kd="May 1, 2025",zd=["✨ New Features","- 🖥️ Increased playback performance by over 1000%","- 🎹 Added additional WAV export options","- 🛠️ Across the board UI/UX Improvements","- 🎵 Added velocity menu with various features","- 🦟 Squashed various bugs","🐞 Known Issues","- 🚫 Scaling groups of notes not functional","🛣️ Roadmap","- 🧠 Upcoming: AI-assisted generation and extension tools"];function Xd(){const e=document.getElementById("whats-new-modal"),t=e==null?void 0:e.querySelector("ul"),i=document.getElementById("whats-new-metadata"),n=e==null?void 0:e.querySelector("img");if(e&&t&&i){t.innerHTML="",i.textContent=`${Wd} — Updated ${Kd}`,n&&(n.src=hn("static/logo.png"));let a=null;for(const r of zd)if(r.startsWith("✨")||r.startsWith("🐞")||r.startsWith("🛣️")){const s=document.createElement("li");s.textContent=r,s.classList.add("font-bold","mt-6","text-lg"),t.appendChild(s),a=document.createElement("ul"),a.classList.add("list-disc","list-inside","ml-6","mt-2","space-y-1"),t.appendChild(a)}else if(a){const s=document.createElement("li");s.textContent=r.replace(/^- /,""),a.appendChild(s)}e.classList.remove("hidden")}}function jd(){const e=document.getElementById("whats-new-modal");e&&(e.style.opacity="0",e.style.transition="opacity 0.4s ease-out",setTimeout(()=>{e.classList.add("hidden"),e.style.opacity="1"},400))}var yn;(yn=document.getElementById("whats-new-close-btn"))==null||yn.addEventListener("click",jd);function Yd(){var e;(e=document.getElementById("footer-whats-new-btn"))==null||e.addEventListener("click",Xd)}function Qd(){const e=document.getElementById("footer-help-btn");e&&e.addEventListener("click",()=>{window.open("https://github.com/alacrity-ai/sequenzia","_blank")})}function fi(e=3){const r=["C","D","E","F","G","A","B"],s=["C#","D#","","F#","G#","A#",""],o=[e,e+1,e+2],l={};let c=0;for(const d of o)r.forEach(u=>{const p=`${u}${d}`;l[p]={note:p,x:c,width:60,height:200,isBlack:!1},c+=60});c=0;for(const d of o)s.forEach((u,p)=>{if(u===""){c+=60;return}const f=`${u}${d}`;l[f]={note:f,x:c+60-40/2,width:40,height:120,isBlack:!0},c+=60});return l}function lt(e,t,i=new Set,n=null){e.clearRect(0,0,e.canvas.width,e.canvas.height);const a={};if(n)for(const[r,s]of Object.entries(n))a[s]=r;for(const r of Object.values(t))r.isBlack||(Wr(e,{...r,fill:i.has(r.note)?"#cce0ff":"#ffffff",stroke:"#333",radius:6}),e.fillStyle="#333",e.font="12px sans-serif",e.textAlign="center",a[r.note]&&(e.fillStyle="#7c3aed",e.fillText(a[r.note],r.x+r.width/2,r.height-24),e.fillStyle="#333"),e.fillText(r.note,r.x+r.width/2,r.height-8));for(const r of Object.values(t))r.isBlack&&(Wr(e,{...r,fill:i.has(r.note)?"#4a60ff":"#111111",stroke:"#000000",radius:4}),Zd(e,r),a[r.note]&&(e.fillStyle="#c084fc",e.font="10px sans-serif",e.textAlign="center",e.fillText(a[r.note],r.x+r.width/2,r.height-28)))}function Wr(e,t){const{x:i,width:n,height:a,fill:r,stroke:s,radius:o=8}=t;e.beginPath(),e.moveTo(i,0),e.lineTo(i,a-o),e.quadraticCurveTo(i,a,i+o,a),e.lineTo(i+n-o,a),e.quadraticCurveTo(i+n,a,i+n,a-o),e.lineTo(i+n,0),e.closePath(),e.fillStyle=r,e.fill(),e.strokeStyle=s,e.lineWidth=1,e.stroke()}function Zd(e,t){const i=e.createLinearGradient(t.x,0,t.x,t.height);i.addColorStop(0,"rgba(255,255,255,0.2)"),i.addColorStop(.3,"rgba(255,255,255,0)"),e.fillStyle=i,e.beginPath(),e.moveTo(t.x,0),e.lineTo(t.x+t.width,0),e.lineTo(t.x+t.width,t.height*.4),e.lineTo(t.x,t.height*.4),e.closePath(),e.fill()}let Kr=!1,xt=null;function ma(e,t){if(Kr)return;Kr=!0,xt=t;const i=e.getContext("2d");if(!i)return;const n=new Map,a=new Set;function r(d,u){const p=xt();for(const f of Object.values(p))if(f.isBlack&&d>=f.x&&d<=f.x+f.width&&u>=0&&u<=f.height)return f.note;for(const f of Object.values(p))if(!f.isBlack&&d>=f.x&&d<=f.x+f.width&&u>=0&&u<=f.height)return f.note;return null}function s(d){if(!d||a.has(d))return;const u=ad(d);u&&(n.set(d,u),a.add(d),i&&lt(i,xt(),a))}function o(d){if(!a.has(d))return;const u=n.get(d);u&&(u.stop(),n.delete(d)),a.delete(d),i&&lt(i,xt(),a)}function l(){for(const d of a)o(d)}let c=!1;e.addEventListener("mousedown",d=>{c=!0;const u=e.getBoundingClientRect(),p=d.clientX-u.left,f=d.clientY-u.top,m=r(p,f);s(m)}),e.addEventListener("mousemove",d=>{if(!c)return;const u=e.getBoundingClientRect(),p=d.clientX-u.left,f=d.clientY-u.top,m=r(p,f);s(m)}),e.addEventListener("mouseup",()=>{c=!1,l()}),e.addEventListener("mouseleave",()=>{c=!1,l()})}const pr=[..."qwertyuiop[zxcvbnm,./"],_r=["2","3","5","6","7","9","0","=","s","d","g","h","k","l",";"];function ec(){const e=document.getElementById("instrument-loop-toggle");return(e==null?void 0:e.checked)??!1}let Ji=!1,Jt=null,Bt=null,Ct=null;function pa(e,t){if(Ji)return;Ji=!0;const i=e.getContext("2d");if(!i)throw new Error("Canvas 2D context not available.");const n=new Set,a=new Set,r=new Map,s=pr,o=_r;Jt=t;function l(){const u=Jt(),p=Object.values(u).filter(h=>!h.isBlack).sort((h,_)=>h.x-_.x).map(h=>h.note),f=Object.values(u).filter(h=>h.isBlack).sort((h,_)=>h.x-_.x).map(h=>h.note),m={};return s.forEach((h,_)=>{p[_]&&(m[h]=p[_])}),o.forEach((h,_)=>{f[_]&&(m[h]=f[_])}),m}function c(u){const p=l(),f=p[u];if(!(!f||n.has(u))){if(n.add(u),!a.has(f)){const m=ea(f,100,ec());m&&(r.set(f,{stop:m}),a.add(f))}i&&lt(i,Jt(),a,p)}}function d(u){const p=l(),f=p[u];f&&(n.delete(u),a.has(f)&&(rd(f),r.delete(f),a.delete(f)),i&&lt(i,Jt(),a,p))}Bt=u=>{u.repeat||c(u.key)},Ct=u=>{d(u.key)},window.addEventListener("keydown",Bt),window.addEventListener("keyup",Ct)}function _a(){Bt&&(window.removeEventListener("keydown",Bt),Bt=null),Ct&&(window.removeEventListener("keyup",Ct),Ct=null),Ji=!1}let je=3,Ve=fi(je),qt=!1;async function tc(e){var r,s;const t=e.getContext("2d");if(!t)throw new Error("Failed to get 2D context for keyboard canvas");function i(){const o=Object.values(Ve).filter(d=>!d.isBlack).sort((d,u)=>d.x-u.x).map(d=>d.note),l=Object.values(Ve).filter(d=>d.isBlack).sort((d,u)=>d.x-u.x).map(d=>d.note),c={};return pr.forEach((d,u)=>{o[u]&&(c[d]=o[u])}),_r.forEach((d,u)=>{l[u]&&(c[d]=l[u])}),c}function n(){if(!t)return;Ve=fi(je);const o=qt?i():null;lt(t,Ve,new Set,o)}ma(e,()=>Ve),n(),(r=document.getElementById("octave-up"))==null||r.addEventListener("click",()=>{je<7&&(je++,n())}),(s=document.getElementById("octave-down"))==null||s.addEventListener("click",()=>{je>1&&(je--,n())});const a=document.getElementById("disable-keyboard-inputs");return a.classList.remove("bg-purple-600"),a.classList.add("bg-gray-700"),a.addEventListener("click",()=>{qt=!qt,qt?(pa(e,()=>Ve),a.classList.remove("bg-gray-700"),a.classList.add("bg-purple-600")):(_a(),a.classList.remove("bg-purple-600"),a.classList.add("bg-gray-700")),n()}),{refreshKeyboard:n}}let Ye=3,We=fi(Ye),$t=!1,Ht=null;async function ic(e){var r,s;if(Ht=e.getContext("2d"),!Ht)throw new Error("Failed to get 2D context for keyboard canvas.");await Zn("sf2/fluidr3-gm/acoustic_grand_piano");function t(){const o=Object.values(We).filter(d=>!d.isBlack).sort((d,u)=>d.x-u.x).map(d=>d.note),l=Object.values(We).filter(d=>d.isBlack).sort((d,u)=>d.x-u.x).map(d=>d.note),c={};return pr.forEach((d,u)=>{o[u]&&(c[d]=o[u])}),_r.forEach((d,u)=>{l[u]&&(c[d]=l[u])}),c}function i(){We=fi(Ye);const o=$t?t():null;Ht&&lt(Ht,We,new Set,o)}ma(e,()=>We),i(),(r=document.getElementById("octave-up"))==null||r.addEventListener("click",()=>{Ye<7&&(Ye++,i())}),(s=document.getElementById("octave-down"))==null||s.addEventListener("click",()=>{Ye>1&&(Ye--,i())});const n=document.getElementById("disable-keyboard-inputs");n.classList.remove("bg-purple-600"),n.classList.add("bg-gray-700"),n.addEventListener("click",()=>{$t=!$t,$t?(pa(e,()=>We),n.classList.remove("bg-gray-700"),n.classList.add("bg-purple-600")):(_a(),n.classList.remove("bg-purple-600"),n.classList.add("bg-gray-700")),i()}),document.getElementById("global-instrument-select-btn").addEventListener("click",async()=>{const o=id()||"sf2/fluidr3-gm/acoustic_grand_piano",l=document.getElementById("instrument-select-modal");delete l.dataset.currentSequencer,await aa(o),l.classList.remove("hidden")})}async function rc(e){await ic(e);const{refreshKeyboard:t}=await tc(e)}function nc(e,t){const i=t.getContext("2d");if(!i)throw new Error("Canvas 2D context not available");const n=t.width,a=t.height,r=new Uint8Array(e.fftSize),s=new Uint8Array(e.frequencyBinCount),o=document.createElement("canvas");o.width=n,o.height=a;const l=o.getContext("2d");if(!l)throw new Error("Offscreen canvas 2D context not available");let c="frequency";function d(){if(!i)return;e.getByteTimeDomainData(r),i.fillStyle="#000",i.fillRect(0,0,n,a),i.lineWidth=2,i.strokeStyle="#00ffcc",i.beginPath();const m=n/r.length;let h=0;for(let _=0;_<r.length;_++){const g=r[_]/128*a/2;_===0?i.moveTo(h,g):i.lineTo(h,g),h+=m}i.lineTo(n,a/2),i.stroke()}function u(){if(e.getByteFrequencyData(s),!i)return;i.fillStyle="#000",i.fillRect(0,0,n,a),i.fillStyle="rgba(255,255,255,0.2)",i.fillRect(0,0,1,a),i.fillRect(n-1,0,1,a);const m=128,h=2,_=[];for(let y=0;y<m;y++)_.push(y*n/(m-1));_[_.length-1]=n-1;for(let y=0;y<m;y++){const g=_[y],v=y<m-1?_[y+1]:n,b=Math.max(1,v-g-h),N=20,S=2e4,B=y/(m-1),L=N*Math.pow(S/N,B),F=Math.min(s.length-1,Math.floor(L/22050*s.length)),w=s[F]/255,I=Math.max(1,w*a),T=240-B*240;i.fillStyle=`hsl(${T}, ${80+w*20}%, ${40+w*40}%)`,i.fillRect(g,a-I,b,I)}}function p(){if(e.getByteFrequencyData(s),!l)return;o.initialized||(l.fillStyle="#000",l.fillRect(0,0,n,a),o.initialized=!0),l.drawImage(o,-1,0),l.fillStyle="#000",l.fillRect(n-1,0,1,a);const m=128,h=20,_=2e4;for(let y=0;y<m;y++){const g=y/(m-1),v=h*Math.pow(_/h,g),N=Math.min(s.length-1,Math.floor(v/22050*s.length)),S=s[N]/255,B=a-1-Math.floor(y*a/m);if(S<.05)continue;const L=Math.floor(S*255),M=Math.floor(S*(255-g*200)),F=Math.floor(S*(100+g*155));l.fillStyle=`rgb(${L}, ${M}, ${F})`,l.fillRect(n-1,B,1,1)}i&&(i.fillStyle="#000",i.fillRect(0,0,n,a),i.drawImage(o,0,0))}function f(){switch(requestAnimationFrame(f),c){case"frequency":u();break;case"spectrogram":p();break;case"waveform":default:d()}}return f(),{setMode(m){["waveform","frequency","spectrogram"].includes(m)&&(c=m,i.clearRect(0,0,n,a),c==="spectrogram"&&l.clearRect(0,0,n,a))}}}function ac(e,t){const i=nc(Di(),e),n=[{name:"waveform",emoji:"🌊"},{name:"frequency",emoji:"📊"},{name:"spectrogram",emoji:"🌈"}];let a=0;function r(){a=(a+1)%n.length;const{name:s,emoji:o}=n[a];i.setMode(s),t.textContent=o,t.title=`Mode: ${s}`}t.addEventListener("click",r),r()}function sc(){var u;const e=document.getElementById("global-mini-expand-btn"),t=document.getElementById("global-mini-contour"),i=document.getElementById("global-mini-playhead"),n=(u=t==null?void 0:t.parentElement)==null?void 0:u.parentElement,a=t==null?void 0:t.parentElement,r=e==null?void 0:e.querySelector("svg use"),s=document.querySelector(".footer-spacer"),o=40;let l=!1;function c(p,f){const m=p.offsetWidth;p.style.height=`${f}px`,p.height=f,p.width=m}if(!e||!t||!i||!n||!a||!r||!s){console.warn("FooterUI: One or more elements not found.");return}n.style.height=`${o}px`,a.style.height=`${o}px`,c(t,o),c(i,o),re(t,me());function d(){l=!l;const p=l?200:40;!n||!a||!t||!i||!r||!s||(n.style.height=`${p}px`,a.style.height=`${p}px`,c(t,p),c(i,p),r.setAttribute("href",l?"#icon-caret-down":"#icon-caret-up"),s.style.height=`${p-40+140}px`,re(t,me()))}e.addEventListener("click",d)}function lc(e){if(!e.sequencers.length)throw new Error("No tracks to export.");const t=e.tempo,i=e.timeSignature[0],n=e.totalMeasures,a={v:3,t:new Date().toISOString(),c:{b:t,bpm:i,tm:n},i:e.sequencers.map(s=>s.instrument||"sf2/fluidr3-gm/acoustic_grand_piano"),vlm:e.sequencers.map(s=>s.volume??100/127),pan:e.sequencers.map(s=>s.pan??0),tr:e.sequencers.map(s=>({n:s.notes.map(o=>[o.pitch,o.start,o.duration,o.velocity??100])}))},r=new Blob([JSON.stringify(a)],{type:"application/json"});return{url:URL.createObjectURL(r),filename:`session-${Date.now()}.json`}}async function oc(e,t={sampleRate:44100,includePan:!0}){if(!e.tracks||e.tracks.length===0)throw new Error("No tracks to export.");const i=t.sampleRate,n=t.includePan?2:1,a=new AbortController;let r=!1;Qe("Exporting Session","Rendering your session offline...",()=>{r=!0,a.abort()},!0);try{const o=60/ve(),l=Math.max(...e.tracks.flatMap(m=>m.notes.map(h=>(h.start+h.duration)*o+.2))),c=new OfflineAudioContext(n,Math.ceil(i*l),i);for(const m of e.tracks){if(r)return;const h=m.instrument||"sf2/fluidr3-gm/acoustic_grand_piano",_=!0,y=new ii(null,m.config,c,c.destination,h,_);if(y.setState(m),await y.exportToOffline(a.signal),r)return}if(r)return;Qe("Rendering Audio","Rendering audio buffer…",void 0,!0);const d=await c.startRendering();Qe("Converting to WAV","Converting to WAV format…",void 0,!0);const u=dc(d);Qe("Downloading WAV","Please wait...",void 0,!0);const p=URL.createObjectURL(u),f=document.createElement("a");f.href=p,f.download=`session-${Date.now()}.wav`,f.click(),URL.revokeObjectURL(p)}catch(s){r?console.warn("Export operation was cancelled by the user."):console.error("Error during export:",s)}finally{ei(!0)}}function dc(e){const t=e.numberOfChannels,i=e.length*t*2,n=new DataView(new ArrayBuffer(44+i)),a=(s,o)=>{for(let l=0;l<o.length;l++)n.setUint8(s+l,o.charCodeAt(l))};a(0,"RIFF"),n.setUint32(4,36+i,!0),a(8,"WAVE"),a(12,"fmt "),n.setUint32(16,16,!0),n.setUint16(20,1,!0),n.setUint16(22,t,!0),n.setUint32(24,e.sampleRate,!0),n.setUint32(28,e.sampleRate*t*2,!0),n.setUint16(32,t*2,!0),n.setUint16(34,16,!0),a(36,"data"),n.setUint32(40,i,!0);let r=44;for(let s=0;s<e.length;s++)for(let o=0;o<t;o++){const l=e.getChannelData(o)[s],c=Math.max(-1,Math.min(1,l));n.setInt16(r,c*32767,!0),r+=2}return new Blob([n.buffer],{type:"audio/wav"})}function cc(){document.getElementById("save-wav-options-modal").classList.remove("hidden")}function ya(){document.getElementById("save-wav-options-modal").classList.add("hidden")}async function uc(){var a;const e=parseInt(document.getElementById("save-wav-sample-rate").value,10),t=((a=document.getElementById("save-wav-include-pan"))==null?void 0:a.checked)??!0;ya();const i=Je(),n={globalConfig:{bpm:i.tempo,beatsPerMeasure:i.timeSignature[0],totalMeasures:i.totalMeasures},tracks:R.map(r=>({notes:r.notes,instrument:r.instrumentName,config:r.config,volume:r.volume,pan:r.pan}))};try{await oc(n,{sampleRate:e,includePan:t})}catch(r){console.error("[SaveWav] Export failed:",r)}}function fc(){ya()}function mc(){const e=document.getElementById("save-wav-options-apply-btn"),t=document.getElementById("save-wav-options-cancel-btn");e&&e.addEventListener("click",uc),t&&t.addEventListener("click",fc)}function pc(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var i=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};i.prototype=t.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(i,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),i}var Pe={},Vt={},Ni,zr;function _c(){if(zr)return Ni;zr=1;function e(a){var r=new n(a),s=r.readChunk();if(s.id!="MThd")throw"Bad MIDI file.  Expected 'MHdr', got: '"+s.id+"'";for(var o=t(s.data),l=[],c=0;!r.eof()&&c<o.numTracks;c++){var d=r.readChunk();if(d.id!="MTrk")throw"Bad MIDI file.  Expected 'MTrk', got: '"+d.id+"'";var u=i(d.data);l.push(u)}return{header:o,tracks:l}}function t(a){var r=new n(a),s=r.readUInt16(),o=r.readUInt16(),l={format:s,numTracks:o},c=r.readUInt16();return c&32768?(l.framesPerSecond=256-(c>>8),l.ticksPerFrame=c&255):l.ticksPerBeat=c,l}function i(a){for(var r=new n(a),s=[];!r.eof();){var o=c();s.push(o)}return s;var l;function c(){var d={};d.deltaTime=r.readVarInt();var u=r.readUInt8();if((u&240)===240)if(u===255){d.meta=!0;var p=r.readUInt8(),f=r.readVarInt();switch(p){case 0:if(d.type="sequenceNumber",f!==2)throw"Expected length for sequenceNumber event is 2, got "+f;return d.number=r.readUInt16(),d;case 1:return d.type="text",d.text=r.readString(f),d;case 2:return d.type="copyrightNotice",d.text=r.readString(f),d;case 3:return d.type="trackName",d.text=r.readString(f),d;case 4:return d.type="instrumentName",d.text=r.readString(f),d;case 5:return d.type="lyrics",d.text=r.readString(f),d;case 6:return d.type="marker",d.text=r.readString(f),d;case 7:return d.type="cuePoint",d.text=r.readString(f),d;case 32:if(d.type="channelPrefix",f!=1)throw"Expected length for channelPrefix event is 1, got "+f;return d.channel=r.readUInt8(),d;case 33:if(d.type="portPrefix",f!=1)throw"Expected length for portPrefix event is 1, got "+f;return d.port=r.readUInt8(),d;case 47:if(d.type="endOfTrack",f!=0)throw"Expected length for endOfTrack event is 0, got "+f;return d;case 81:if(d.type="setTempo",f!=3)throw"Expected length for setTempo event is 3, got "+f;return d.microsecondsPerBeat=r.readUInt24(),d;case 84:if(d.type="smpteOffset",f!=5)throw"Expected length for smpteOffset event is 5, got "+f;var m=r.readUInt8(),h={0:24,32:25,64:29,96:30};return d.frameRate=h[m&96],d.hour=m&31,d.min=r.readUInt8(),d.sec=r.readUInt8(),d.frame=r.readUInt8(),d.subFrame=r.readUInt8(),d;case 88:if(d.type="timeSignature",f!=2&&f!=4)throw"Expected length for timeSignature event is 4 or 2, got "+f;return d.numerator=r.readUInt8(),d.denominator=1<<r.readUInt8(),f===4?(d.metronome=r.readUInt8(),d.thirtyseconds=r.readUInt8()):(d.metronome=36,d.thirtyseconds=8),d;case 89:if(d.type="keySignature",f!=2)throw"Expected length for keySignature event is 2, got "+f;return d.key=r.readInt8(),d.scale=r.readUInt8(),d;case 127:return d.type="sequencerSpecific",d.data=r.readBytes(f),d;default:return d.type="unknownMeta",d.data=r.readBytes(f),d.metatypeByte=p,d}}else if(u==240){d.type="sysEx";var f=r.readVarInt();return d.data=r.readBytes(f),d}else if(u==247){d.type="endSysEx";var f=r.readVarInt();return d.data=r.readBytes(f),d}else throw"Unrecognised MIDI event type byte: "+u;else{var _;if((u&128)===0){if(l===null)throw"Running status byte encountered before status byte";_=u,u=l,d.running=!0}else _=r.readUInt8(),l=u;var y=u>>4;switch(d.channel=u&15,y){case 8:return d.type="noteOff",d.noteNumber=_,d.velocity=r.readUInt8(),d;case 9:var g=r.readUInt8();return d.type=g===0?"noteOff":"noteOn",d.noteNumber=_,d.velocity=g,g===0&&(d.byte9=!0),d;case 10:return d.type="noteAftertouch",d.noteNumber=_,d.amount=r.readUInt8(),d;case 11:return d.type="controller",d.controllerType=_,d.value=r.readUInt8(),d;case 12:return d.type="programChange",d.programNumber=_,d;case 13:return d.type="channelAftertouch",d.amount=_,d;case 14:return d.type="pitchBend",d.value=_+(r.readUInt8()<<7)-8192,d;default:throw"Unrecognised MIDI event type: "+y}}}}function n(a){this.buffer=a,this.bufferLen=this.buffer.length,this.pos=0}return n.prototype.eof=function(){return this.pos>=this.bufferLen},n.prototype.readUInt8=function(){var a=this.buffer[this.pos];return this.pos+=1,a},n.prototype.readInt8=function(){var a=this.readUInt8();return a&128?a-256:a},n.prototype.readUInt16=function(){var a=this.readUInt8(),r=this.readUInt8();return(a<<8)+r},n.prototype.readInt16=function(){var a=this.readUInt16();return a&32768?a-65536:a},n.prototype.readUInt24=function(){var a=this.readUInt8(),r=this.readUInt8(),s=this.readUInt8();return(a<<16)+(r<<8)+s},n.prototype.readInt24=function(){var a=this.readUInt24();return a&8388608?a-16777216:a},n.prototype.readUInt32=function(){var a=this.readUInt8(),r=this.readUInt8(),s=this.readUInt8(),o=this.readUInt8();return(a<<24)+(r<<16)+(s<<8)+o},n.prototype.readBytes=function(a){var r=this.buffer.slice(this.pos,this.pos+a);return this.pos+=a,r},n.prototype.readString=function(a){var r=this.readBytes(a);return String.fromCharCode.apply(null,r)},n.prototype.readVarInt=function(){for(var a=0;!this.eof();){var r=this.readUInt8();if(r&128)a+=r&127,a<<=7;else return a+r}return a},n.prototype.readChunk=function(){var a=this.readString(4),r=this.readUInt32(),s=this.readBytes(r);return{id:a,length:r,data:s}},Ni=e,Ni}var Bi,Xr;function yc(){if(Xr)return Bi;Xr=1;function e(r,s){if(typeof r!="object")throw"Invalid MIDI data";s=s||{};var o=r.header||{},l=r.tracks||[],c,d=l.length,u=new a;for(t(u,o,d),c=0;c<d;c++)i(u,l[c],s);return u.buffer}function t(r,s,o){var l=s.format==null?1:s.format,c=128;s.timeDivision?c=s.timeDivision:s.ticksPerFrame&&s.framesPerSecond?c=-(s.framesPerSecond&255)<<8|s.ticksPerFrame&255:s.ticksPerBeat&&(c=s.ticksPerBeat&32767);var d=new a;d.writeUInt16(l),d.writeUInt16(o),d.writeUInt16(c),r.writeChunk("MThd",d.buffer)}function i(r,s,o){var l=new a,c,d=s.length,u=null;for(c=0;c<d;c++)(o.running===!1||!o.running&&!s[c].running)&&(u=null),u=n(l,s[c],u,o.useByte9ForNoteOff);r.writeChunk("MTrk",l.buffer)}function n(r,s,o,l){var c=s.type,d=s.deltaTime,u=s.text||"",p=s.data||[],f=null;switch(r.writeVarInt(d),c){case"sequenceNumber":r.writeUInt8(255),r.writeUInt8(0),r.writeVarInt(2),r.writeUInt16(s.number);break;case"text":r.writeUInt8(255),r.writeUInt8(1),r.writeVarInt(u.length),r.writeString(u);break;case"copyrightNotice":r.writeUInt8(255),r.writeUInt8(2),r.writeVarInt(u.length),r.writeString(u);break;case"trackName":r.writeUInt8(255),r.writeUInt8(3),r.writeVarInt(u.length),r.writeString(u);break;case"instrumentName":r.writeUInt8(255),r.writeUInt8(4),r.writeVarInt(u.length),r.writeString(u);break;case"lyrics":r.writeUInt8(255),r.writeUInt8(5),r.writeVarInt(u.length),r.writeString(u);break;case"marker":r.writeUInt8(255),r.writeUInt8(6),r.writeVarInt(u.length),r.writeString(u);break;case"cuePoint":r.writeUInt8(255),r.writeUInt8(7),r.writeVarInt(u.length),r.writeString(u);break;case"channelPrefix":r.writeUInt8(255),r.writeUInt8(32),r.writeVarInt(1),r.writeUInt8(s.channel);break;case"portPrefix":r.writeUInt8(255),r.writeUInt8(33),r.writeVarInt(1),r.writeUInt8(s.port);break;case"endOfTrack":r.writeUInt8(255),r.writeUInt8(47),r.writeVarInt(0);break;case"setTempo":r.writeUInt8(255),r.writeUInt8(81),r.writeVarInt(3),r.writeUInt24(s.microsecondsPerBeat);break;case"smpteOffset":r.writeUInt8(255),r.writeUInt8(84),r.writeVarInt(5);var m={24:0,25:32,29:64,30:96},h=s.hour&31|m[s.frameRate];r.writeUInt8(h),r.writeUInt8(s.min),r.writeUInt8(s.sec),r.writeUInt8(s.frame),r.writeUInt8(s.subFrame);break;case"timeSignature":r.writeUInt8(255),r.writeUInt8(88),r.writeVarInt(4),r.writeUInt8(s.numerator);var _=Math.floor(Math.log(s.denominator)/Math.LN2)&255;r.writeUInt8(_),r.writeUInt8(s.metronome),r.writeUInt8(s.thirtyseconds||8);break;case"keySignature":r.writeUInt8(255),r.writeUInt8(89),r.writeVarInt(2),r.writeInt8(s.key),r.writeUInt8(s.scale);break;case"sequencerSpecific":r.writeUInt8(255),r.writeUInt8(127),r.writeVarInt(p.length),r.writeBytes(p);break;case"unknownMeta":s.metatypeByte!=null&&(r.writeUInt8(255),r.writeUInt8(s.metatypeByte),r.writeVarInt(p.length),r.writeBytes(p));break;case"sysEx":r.writeUInt8(240),r.writeVarInt(p.length),r.writeBytes(p);break;case"endSysEx":r.writeUInt8(247),r.writeVarInt(p.length),r.writeBytes(p);break;case"noteOff":var y=l!==!1&&s.byte9||l&&s.velocity==0?144:128;f=y|s.channel,f!==o&&r.writeUInt8(f),r.writeUInt8(s.noteNumber),r.writeUInt8(s.velocity);break;case"noteOn":f=144|s.channel,f!==o&&r.writeUInt8(f),r.writeUInt8(s.noteNumber),r.writeUInt8(s.velocity);break;case"noteAftertouch":f=160|s.channel,f!==o&&r.writeUInt8(f),r.writeUInt8(s.noteNumber),r.writeUInt8(s.amount);break;case"controller":f=176|s.channel,f!==o&&r.writeUInt8(f),r.writeUInt8(s.controllerType),r.writeUInt8(s.value);break;case"programChange":f=192|s.channel,f!==o&&r.writeUInt8(f),r.writeUInt8(s.programNumber);break;case"channelAftertouch":f=208|s.channel,f!==o&&r.writeUInt8(f),r.writeUInt8(s.amount);break;case"pitchBend":f=224|s.channel,f!==o&&r.writeUInt8(f);var g=8192+s.value,v=g&127,b=g>>7&127;r.writeUInt8(v),r.writeUInt8(b);break;default:throw"Unrecognized event type: "+c}return f}function a(){this.buffer=[]}return a.prototype.writeUInt8=function(r){this.buffer.push(r&255)},a.prototype.writeInt8=a.prototype.writeUInt8,a.prototype.writeUInt16=function(r){var s=r>>8&255,o=r&255;this.writeUInt8(s),this.writeUInt8(o)},a.prototype.writeInt16=a.prototype.writeUInt16,a.prototype.writeUInt24=function(r){var s=r>>16&255,o=r>>8&255,l=r&255;this.writeUInt8(s),this.writeUInt8(o),this.writeUInt8(l)},a.prototype.writeInt24=a.prototype.writeUInt24,a.prototype.writeUInt32=function(r){var s=r>>24&255,o=r>>16&255,l=r>>8&255,c=r&255;this.writeUInt8(s),this.writeUInt8(o),this.writeUInt8(l),this.writeUInt8(c)},a.prototype.writeInt32=a.prototype.writeUInt32,a.prototype.writeBytes=function(r){this.buffer=this.buffer.concat(Array.prototype.slice.call(r,0))},a.prototype.writeString=function(r){var s,o=r.length,l=[];for(s=0;s<o;s++)l.push(r.codePointAt(s));this.writeBytes(l)},a.prototype.writeVarInt=function(r){if(r<0)throw"Cannot write negative variable-length integer";if(r<=127)this.writeUInt8(r);else{var s=r,o=[];for(o.push(s&127),s>>=7;s;){var l=s&127|128;o.push(l),s>>=7}this.writeBytes(o.reverse())}},a.prototype.writeChunk=function(r,s){this.writeString(r),this.writeUInt32(s.length),this.writeBytes(s)},Bi=e,Bi}var jr;function ha(){return jr||(jr=1,Vt.parseMidi=_c(),Vt.writeMidi=yc()),Vt}var Ci={},Ae={},Yr;function ba(){if(Yr)return Ae;Yr=1,Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.insert=Ae.search=void 0;function e(i,n,a){a===void 0&&(a="ticks");var r=0,s=i.length,o=s;if(s>0&&i[s-1][a]<=n)return s-1;for(;r<o;){var l=Math.floor(r+(o-r)/2),c=i[l],d=i[l+1];if(c[a]===n){for(var u=l;u<i.length;u++){var p=i[u];p[a]===n&&(l=u)}return l}else{if(c[a]<n&&d[a]>n)return l;c[a]>n?o=l:c[a]<n&&(r=l+1)}}return-1}Ae.search=e;function t(i,n,a){if(a===void 0&&(a="ticks"),i.length){var r=e(i,n[a],a);i.splice(r+1,0,n)}else i.push(n)}return Ae.insert=t,Ae}var Qr;function qi(){return Qr||(Qr=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Header=e.keySignatureKeys=void 0;var t=ba(),i=new WeakMap;e.keySignatureKeys=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];var n=function(){function a(r){var s=this;if(this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",i.set(this,480),r){i.set(this,r.header.ticksPerBeat),r.tracks.forEach(function(l){l.forEach(function(c){c.meta&&(c.type==="timeSignature"?s.timeSignatures.push({ticks:c.absoluteTime,timeSignature:[c.numerator,c.denominator]}):c.type==="setTempo"?s.tempos.push({bpm:6e7/c.microsecondsPerBeat,ticks:c.absoluteTime}):c.type==="keySignature"&&s.keySignatures.push({key:e.keySignatureKeys[c.key+7],scale:c.scale===0?"major":"minor",ticks:c.absoluteTime}))})});var o=0;r.tracks[0].forEach(function(l){o+=l.deltaTime,l.meta&&(l.type==="trackName"?s.name=l.text:(l.type==="text"||l.type==="cuePoint"||l.type==="marker"||l.type==="lyrics")&&s.meta.push({text:l.text,ticks:o,type:l.type}))}),this.update()}}return a.prototype.update=function(){var r=this,s=0,o=0;this.tempos.sort(function(l,c){return l.ticks-c.ticks}),this.tempos.forEach(function(l,c){var d=c>0?r.tempos[c-1].bpm:r.tempos[0].bpm,u=l.ticks/r.ppq-o,p=60/d*u;l.time=p+s,s=l.time,o+=u}),this.timeSignatures.sort(function(l,c){return l.ticks-c.ticks}),this.timeSignatures.forEach(function(l,c){var d=c>0?r.timeSignatures[c-1]:r.timeSignatures[0],u=(l.ticks-d.ticks)/r.ppq,p=u/d.timeSignature[0]/(d.timeSignature[1]/4);d.measures=d.measures||0,l.measures=p+d.measures})},a.prototype.ticksToSeconds=function(r){var s=(0,t.search)(this.tempos,r);if(s!==-1){var o=this.tempos[s],l=o.time,c=(r-o.ticks)/this.ppq;return l+60/o.bpm*c}else{var d=r/this.ppq;return 60/120*d}},a.prototype.ticksToMeasures=function(r){var s=(0,t.search)(this.timeSignatures,r);if(s!==-1){var o=this.timeSignatures[s],l=(r-o.ticks)/this.ppq;return o.measures+l/(o.timeSignature[0]/o.timeSignature[1])/4}else return r/this.ppq/4},Object.defineProperty(a.prototype,"ppq",{get:function(){return i.get(this)},enumerable:!1,configurable:!0}),a.prototype.secondsToTicks=function(r){var s=(0,t.search)(this.tempos,r,"time");if(s!==-1){var o=this.tempos[s],l=o.time,c=r-l,d=c/(60/o.bpm);return Math.round(o.ticks+d*this.ppq)}else{var u=r/.5;return Math.round(u*this.ppq)}},a.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map(function(r){return{bpm:r.bpm,ticks:r.ticks}}),timeSignatures:this.timeSignatures}},a.prototype.fromJSON=function(r){this.name=r.name,this.tempos=r.tempos.map(function(s){return Object.assign({},s)}),this.timeSignatures=r.timeSignatures.map(function(s){return Object.assign({},s)}),this.keySignatures=r.keySignatures.map(function(s){return Object.assign({},s)}),this.meta=r.meta.map(function(s){return Object.assign({},s)}),i.set(this,r.ppq),this.update()},a.prototype.setTempo=function(r){this.tempos=[{bpm:r,ticks:0}],this.update()},a}();e.Header=n}(Ci)),Ci}var dt={},Li={},Zr;function ga(){return Zr||(Zr=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ControlChange=e.controlChangeIds=e.controlChangeNames=void 0,e.controlChangeNames={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"},e.controlChangeIds=Object.keys(e.controlChangeNames).reduce(function(a,r){return a[e.controlChangeNames[r]]=r,a},{});var t=new WeakMap,i=new WeakMap,n=function(){function a(r,s){t.set(this,s),i.set(this,r.controllerType),this.ticks=r.absoluteTime,this.value=r.value}return Object.defineProperty(a.prototype,"number",{get:function(){return i.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"name",{get:function(){return e.controlChangeNames[this.number]?e.controlChangeNames[this.number]:null},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"time",{get:function(){var r=t.get(this);return r.ticksToSeconds(this.ticks)},set:function(r){var s=t.get(this);this.ticks=s.secondsToTicks(r)},enumerable:!1,configurable:!0}),a.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},a}();e.ControlChange=n}(Li)),Li}var ct={},en;function hc(){if(en)return ct;en=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.createControlChanges=void 0;var e=ga();function t(){return new Proxy({},{get:function(i,n){if(i[n])return i[n];if(e.controlChangeIds.hasOwnProperty(n))return i[e.controlChangeIds[n]]},set:function(i,n,a){return e.controlChangeIds.hasOwnProperty(n)?i[e.controlChangeIds[n]]=a:i[n]=a,!0}})}return ct.createControlChanges=t,ct}var ut={},tn;function bc(){if(tn)return ut;tn=1,Object.defineProperty(ut,"__esModule",{value:!0}),ut.PitchBend=void 0;var e=new WeakMap,t=function(){function i(n,a){e.set(this,a),this.ticks=n.absoluteTime,this.value=n.value}return Object.defineProperty(i.prototype,"time",{get:function(){var n=e.get(this);return n.ticksToSeconds(this.ticks)},set:function(n){var a=e.get(this);this.ticks=a.secondsToTicks(n)},enumerable:!1,configurable:!0}),i.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},i}();return ut.PitchBend=t,ut}var ft={},pe={},rn;function gc(){return rn||(rn=1,Object.defineProperty(pe,"__esModule",{value:!0}),pe.DrumKitByPatchID=pe.InstrumentFamilyByID=pe.instrumentByPatchID=void 0,pe.instrumentByPatchID=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"],pe.InstrumentFamilyByID=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"],pe.DrumKitByPatchID={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"}),pe}var nn;function vc(){if(nn)return ft;nn=1,Object.defineProperty(ft,"__esModule",{value:!0}),ft.Instrument=void 0;var e=gc(),t=new WeakMap,i=function(){function n(a,r){if(this.number=0,t.set(this,r),this.number=0,a){var s=a.find(function(o){return o.type==="programChange"});s&&(this.number=s.programNumber)}}return Object.defineProperty(n.prototype,"name",{get:function(){return this.percussion?e.DrumKitByPatchID[this.number]:e.instrumentByPatchID[this.number]},set:function(a){var r=e.instrumentByPatchID.indexOf(a);r!==-1&&(this.number=r)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"family",{get:function(){return this.percussion?"drums":e.InstrumentFamilyByID[Math.floor(this.number/8)]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"percussion",{get:function(){var a=t.get(this);return a.channel===9},enumerable:!1,configurable:!0}),n.prototype.toJSON=function(){return{family:this.family,number:this.number,name:this.name}},n.prototype.fromJSON=function(a){this.number=a.number},n}();return ft.Instrument=i,ft}var mt={},an;function Sc(){if(an)return mt;an=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.Note=void 0;function e(s){var o=Math.floor(s/12)-1;return t(s)+o.toString()}function t(s){var o=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],l=s%12;return o[l]}function i(s){var o=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return o.indexOf(s)}var n=function(){var s=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,o={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13};return function(l){var c=s.exec(l),d=c[1],u=c[2],p=o[d.toLowerCase()];return p+(parseInt(u,10)+1)*12}}(),a=new WeakMap,r=function(){function s(o,l,c){a.set(this,c),this.midi=o.midi,this.velocity=o.velocity,this.noteOffVelocity=l.velocity,this.ticks=o.ticks,this.durationTicks=l.ticks-o.ticks}return Object.defineProperty(s.prototype,"name",{get:function(){return e(this.midi)},set:function(o){this.midi=n(o)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(o){var l=o-this.octave;this.midi+=l*12},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"pitch",{get:function(){return t(this.midi)},set:function(o){this.midi=12*(this.octave+1)+i(o)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"duration",{get:function(){var o=a.get(this);return o.ticksToSeconds(this.ticks+this.durationTicks)-o.ticksToSeconds(this.ticks)},set:function(o){var l=a.get(this),c=l.secondsToTicks(this.time+o);this.durationTicks=c-this.ticks},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"time",{get:function(){var o=a.get(this);return o.ticksToSeconds(this.ticks)},set:function(o){var l=a.get(this);this.ticks=l.secondsToTicks(o)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"bars",{get:function(){var o=a.get(this);return o.ticksToMeasures(this.ticks)},enumerable:!1,configurable:!0}),s.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},s}();return mt.Note=r,mt}var sn;function ln(){if(sn)return dt;sn=1,Object.defineProperty(dt,"__esModule",{value:!0}),dt.Track=void 0;var e=ba(),t=ga(),i=hc(),n=bc(),a=vc(),r=Sc(),s=new WeakMap,o=function(){function l(c,d){var u=this;if(this.name="",this.notes=[],this.controlChanges=(0,i.createControlChanges)(),this.pitchBends=[],s.set(this,d),c){var p=c.find(function(b){return b.type==="trackName"});this.name=p?p.text:""}if(this.instrument=new a.Instrument(c,this),this.channel=0,c){for(var f=c.filter(function(b){return b.type==="noteOn"}),m=c.filter(function(b){return b.type==="noteOff"}),h=function(){var b=f.shift();_.channel=b.channel;var N=m.findIndex(function(B){return B.noteNumber===b.noteNumber&&B.absoluteTime>=b.absoluteTime});if(N!==-1){var S=m.splice(N,1)[0];_.addNote({durationTicks:S.absoluteTime-b.absoluteTime,midi:b.noteNumber,noteOffVelocity:S.velocity/127,ticks:b.absoluteTime,velocity:b.velocity/127})}},_=this;f.length;)h();var y=c.filter(function(b){return b.type==="controller"});y.forEach(function(b){u.addCC({number:b.controllerType,ticks:b.absoluteTime,value:b.value/127})});var g=c.filter(function(b){return b.type==="pitchBend"});g.forEach(function(b){u.addPitchBend({ticks:b.absoluteTime,value:b.value/Math.pow(2,13)})});var v=c.find(function(b){return b.type==="endOfTrack"});this.endOfTrackTicks=v!==void 0?v.absoluteTime:void 0}}return l.prototype.addNote=function(c){var d=s.get(this),u=new r.Note({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},d);return Object.assign(u,c),(0,e.insert)(this.notes,u,"ticks"),this},l.prototype.addCC=function(c){var d=s.get(this),u=new t.ControlChange({controllerType:c.number},d);return delete c.number,Object.assign(u,c),Array.isArray(this.controlChanges[u.number])||(this.controlChanges[u.number]=[]),(0,e.insert)(this.controlChanges[u.number],u,"ticks"),this},l.prototype.addPitchBend=function(c){var d=s.get(this),u=new n.PitchBend({},d);return Object.assign(u,c),(0,e.insert)(this.pitchBends,u,"ticks"),this},Object.defineProperty(l.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var c=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,d=0;d<this.notes.length-1;d++){var u=this.notes[d].time+this.notes[d].duration;c<u&&(c=u)}return c},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var c=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,d=0;d<this.notes.length-1;d++){var u=this.notes[d].ticks+this.notes[d].durationTicks;c<u&&(c=u)}return c},enumerable:!1,configurable:!0}),l.prototype.fromJSON=function(c){var d=this;this.name=c.name,this.channel=c.channel,this.instrument=new a.Instrument(void 0,this),this.instrument.fromJSON(c.instrument),c.endOfTrackTicks!==void 0&&(this.endOfTrackTicks=c.endOfTrackTicks);for(var u in c.controlChanges)c.controlChanges[u]&&c.controlChanges[u].forEach(function(p){d.addCC({number:p.number,ticks:p.ticks,value:p.value})});c.notes.forEach(function(p){d.addNote({durationTicks:p.durationTicks,midi:p.midi,ticks:p.ticks,velocity:p.velocity})})},l.prototype.toJSON=function(){for(var c={},d=0;d<127;d++)this.controlChanges.hasOwnProperty(d)&&(c[d]=this.controlChanges[d].map(function(p){return p.toJSON()}));var u={channel:this.channel,controlChanges:c,pitchBends:this.pitchBends.map(function(p){return p.toJSON()}),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map(function(p){return p.toJSON()})};return this.endOfTrackTicks!==void 0&&(u.endOfTrackTicks=this.endOfTrackTicks),u},l}();return dt.Track=o,dt}var ke={};function Nc(e){var t=[];return va(e,t),t}function va(e,t){for(var i=0;i<e.length;i++){var n=e[i];Array.isArray(n)?va(n,t):t.push(n)}}const Bc=Object.freeze(Object.defineProperty({__proto__:null,flatten:Nc},Symbol.toStringTag,{value:"Module"})),Cc=pc(Bc);var on;function Lc(){if(on)return ke;on=1;var e=ke&&ke.__spreadArray||function(y,g,v){if(v||arguments.length===2)for(var b=0,N=g.length,S;b<N;b++)(S||!(b in g))&&(S||(S=Array.prototype.slice.call(g,0,b)),S[b]=g[b]);return y.concat(S||Array.prototype.slice.call(g))};Object.defineProperty(ke,"__esModule",{value:!0}),ke.encode=void 0;var t=ha(),i=qi(),n=Cc;function a(y,g){return[{absoluteTime:y.ticks,channel:g,deltaTime:0,noteNumber:y.midi,type:"noteOn",velocity:Math.floor(y.velocity*127)},{absoluteTime:y.ticks+y.durationTicks,channel:g,deltaTime:0,noteNumber:y.midi,type:"noteOff",velocity:Math.floor(y.noteOffVelocity*127)}]}function r(y){return(0,n.flatten)(y.notes.map(function(g){return a(g,y.channel)}))}function s(y,g){return{absoluteTime:y.ticks,channel:g,controllerType:y.number,deltaTime:0,type:"controller",value:Math.floor(y.value*127)}}function o(y){for(var g=[],v=0;v<127;v++)y.controlChanges.hasOwnProperty(v)&&y.controlChanges[v].forEach(function(b){g.push(s(b,y.channel))});return g}function l(y,g){return{absoluteTime:y.ticks,channel:g,deltaTime:0,type:"pitchBend",value:y.value}}function c(y){var g=[];return y.pitchBends.forEach(function(v){g.push(l(v,y.channel))}),g}function d(y){return{absoluteTime:0,channel:y.channel,deltaTime:0,programNumber:y.instrument.number,type:"programChange"}}function u(y){return{absoluteTime:0,deltaTime:0,meta:!0,text:y,type:"trackName"}}function p(y){return{absoluteTime:y.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/y.bpm),type:"setTempo"}}function f(y){return{absoluteTime:y.ticks,deltaTime:0,denominator:y.timeSignature[1],meta:!0,metronome:24,numerator:y.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}function m(y){var g=i.keySignatureKeys.indexOf(y.key);return{absoluteTime:y.ticks,deltaTime:0,key:g+7,meta:!0,scale:y.scale==="major"?0:1,type:"keySignature"}}function h(y){return{absoluteTime:y.ticks,deltaTime:0,meta:!0,text:y.text,type:y.type}}function _(y){var g={header:{format:1,numTracks:y.tracks.length+1,ticksPerBeat:y.header.ppq},tracks:e([e(e(e(e([{absoluteTime:0,deltaTime:0,meta:!0,text:y.header.name,type:"trackName"}],y.header.keySignatures.map(function(v){return m(v)}),!0),y.header.meta.map(function(v){return h(v)}),!0),y.header.tempos.map(function(v){return p(v)}),!0),y.header.timeSignatures.map(function(v){return f(v)}),!0)],y.tracks.map(function(v){return e(e(e([u(v.name),d(v)],r(v),!0),o(v),!0),c(v),!0)}),!0)};return g.tracks=g.tracks.map(function(v){v=v.sort(function(N,S){return N.absoluteTime-S.absoluteTime});var b=0;return v.forEach(function(N){N.deltaTime=N.absoluteTime-b,b=N.absoluteTime,delete N.absoluteTime}),v.push({deltaTime:0,meta:!0,type:"endOfTrack"}),v}),new Uint8Array((0,t.writeMidi)(g))}return ke.encode=_,ke}var dn;function Mc(){return dn||(dn=1,function(e){var t=Pe&&Pe.__awaiter||function(u,p,f,m){function h(_){return _ instanceof f?_:new f(function(y){y(_)})}return new(f||(f=Promise))(function(_,y){function g(N){try{b(m.next(N))}catch(S){y(S)}}function v(N){try{b(m.throw(N))}catch(S){y(S)}}function b(N){N.done?_(N.value):h(N.value).then(g,v)}b((m=m.apply(u,p||[])).next())})},i=Pe&&Pe.__generator||function(u,p){var f={label:0,sent:function(){if(_[0]&1)throw _[1];return _[1]},trys:[],ops:[]},m,h,_,y;return y={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function g(b){return function(N){return v([b,N])}}function v(b){if(m)throw new TypeError("Generator is already executing.");for(;f;)try{if(m=1,h&&(_=b[0]&2?h.return:b[0]?h.throw||((_=h.return)&&_.call(h),0):h.next)&&!(_=_.call(h,b[1])).done)return _;switch(h=0,_&&(b=[b[0]&2,_.value]),b[0]){case 0:case 1:_=b;break;case 4:return f.label++,{value:b[1],done:!1};case 5:f.label++,h=b[1],b=[0];continue;case 7:b=f.ops.pop(),f.trys.pop();continue;default:if(_=f.trys,!(_=_.length>0&&_[_.length-1])&&(b[0]===6||b[0]===2)){f=0;continue}if(b[0]===3&&(!_||b[1]>_[0]&&b[1]<_[3])){f.label=b[1];break}if(b[0]===6&&f.label<_[1]){f.label=_[1],_=b;break}if(_&&f.label<_[2]){f.label=_[2],f.ops.push(b);break}_[2]&&f.ops.pop(),f.trys.pop();continue}b=p.call(u,f)}catch(N){b=[6,N],h=0}finally{m=_=0}if(b[0]&5)throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Header=e.Track=e.Midi=void 0;var n=ha(),a=qi(),r=ln(),s=Lc(),o=function(){function u(p){var f=this,m=null;if(p){var h=p instanceof ArrayBuffer?new Uint8Array(p):p;m=(0,n.parseMidi)(h),m.tracks.forEach(function(_){var y=0;_.forEach(function(g){y+=g.deltaTime,g.absoluteTime=y})}),m.tracks=d(m.tracks)}this.header=new a.Header(m),this.tracks=[],p&&(this.tracks=m.tracks.map(function(_){return new r.Track(_,f.header)}),m.header.format===1&&this.tracks[0].duration===0&&this.tracks.shift())}return u.fromUrl=function(p){return t(this,void 0,void 0,function(){var f,m;return i(this,function(h){switch(h.label){case 0:return[4,fetch(p)];case 1:return f=h.sent(),f.ok?[4,f.arrayBuffer()]:[3,3];case 2:return m=h.sent(),[2,new u(m)];case 3:throw new Error("Could not load '".concat(p,"'"))}})})},Object.defineProperty(u.prototype,"name",{get:function(){return this.header.name},set:function(p){this.header.name=p},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"duration",{get:function(){var p=this.tracks.map(function(f){return f.duration});return Math.max.apply(Math,p)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"durationTicks",{get:function(){var p=this.tracks.map(function(f){return f.durationTicks});return Math.max.apply(Math,p)},enumerable:!1,configurable:!0}),u.prototype.addTrack=function(){var p=new r.Track(void 0,this.header);return this.tracks.push(p),p},u.prototype.toArray=function(){return(0,s.encode)(this)},u.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map(function(p){return p.toJSON()})}},u.prototype.fromJSON=function(p){var f=this;this.header=new a.Header,this.header.fromJSON(p.header),this.tracks=p.tracks.map(function(m){var h=new r.Track(void 0,f.header);return h.fromJSON(m),h})},u.prototype.clone=function(){var p=new u;return p.fromJSON(this.toJSON()),p},u}();e.Midi=o;var l=ln();Object.defineProperty(e,"Track",{enumerable:!0,get:function(){return l.Track}});var c=qi();Object.defineProperty(e,"Header",{enumerable:!0,get:function(){return c.Header}});function d(u){for(var p=[],f=0;f<u.length;f++)for(var m=p.length,h=new Map,_=Array(16).fill(0),y=0,g=u[f];y<g.length;y++){var v=g[y],b=m,N=v.channel;if(N!==void 0){v.type==="programChange"&&(_[N]=v.programNumber);var S=_[N],B="".concat(S," ").concat(N);h.has(B)?b=h.get(B):(b=m+h.size,h.set(B,b))}p[b]||p.push([]),p[b].push(v)}return p}}(Pe)),Pe}var Sa=Mc();const Na=["acoustic_grand_piano","bright_acoustic_piano","electric_grand_piano","honkytonk_piano","electric_piano_1","electric_piano_2","harpsichord","clavinet","celesta","glockenspiel","music_box","vibraphone","marimba","xylophone","tubular_bells","dulcimer","drawbar_organ","percussive_organ","rock_organ","church_organ","reed_organ","accordion","harmonica","tango_accordion","acoustic_guitar_nylon","acoustic_guitar_steel","electric_guitar_jazz","electric_guitar_clean","electric_guitar_muted","overdriven_guitar","distortion_guitar","guitar_harmonics","acoustic_bass","electric_bass_finger","electric_bass_pick","fretless_bass","slap_bass_1","slap_bass_2","synth_bass_1","synth_bass_2","violin","viola","cello","contrabass","tremolo_strings","pizzicato_strings","orchestral_harp","timpani","string_ensemble_1","string_ensemble_2","synth_strings_1","synth_strings_2","choir_aahs","voice_oohs","synth_choir","orchestra_hit","trumpet","trombone","tuba","muted_trumpet","french_horn","brass_section","synth_brass_1","synth_brass_2","soprano_sax","alto_sax","tenor_sax","baritone_sax","oboe","english_horn","bassoon","clarinet","piccolo","flute","recorder","pan_flute","blown_bottle","shakuhachi","whistle","ocarina","lead_1_square","lead_2_sawtooth","lead_3_calliope","lead_4_chiff","lead_5_charang","lead_6_voice","lead_7_fifths","lead_8_bass__lead","pad_1_new_age","pad_2_warm","pad_3_polysynth","pad_4_choir","pad_5_bowed","pad_6_metallic","pad_7_halo","pad_8_sweep","fx_1_rain","fx_2_soundtrack","fx_3_crystal","fx_4_atmosphere","fx_5_brightness","fx_6_goblins","fx_7_echoes","fx_8_scifi","sitar","banjo","shamisen","koto","kalimba","bagpipe","fiddle","shanai","tinkle_bell","agogo","steel_drums","woodblock","taiko_drum","melodic_tom","synth_drum","reverse_cymbal","guitar_fret_noise","breath_noise","seashore","bird_tweet","telephone_ring","helicopter","applause","gunshot"];function Gc(e){const t=e.split("/"),n=t[t.length-1].trim().toLowerCase().replace(/\s+/g,"_"),a=Na.findIndex(r=>r===n);return a!==-1?a:(n.includes("drum")||n.includes("drummachine"),0)}async function wc(e){if(!e.sequencers.length)throw new Error("No tracks to export.");const t=new Sa.Midi;t.header.setTempo(e.tempo),t.header.timeSignatures.push({ticks:0,timeSignature:e.timeSignature});for(const[a,r]of e.sequencers.entries()){const s=t.addTrack(),o=r.instrument.toLowerCase().includes("drum");s.channel=o?9:a%16;const l=Gc(r.instrument);if(s.instrument.number=l,typeof r.volume=="number"&&s.addCC({number:7,time:0,value:Math.max(0,Math.min(1,r.volume))}),typeof r.pan=="number"){const c=(r.pan+1)/2;s.addCC({number:10,time:0,value:Math.max(0,Math.min(1,c))})}for(const c of r.notes){const d=P(c.pitch),u=Math.max(.01,Math.min(1,(c.velocity??100)/127));if(d===null)continue;const p=cn(c.start,e.tempo),f=cn(c.duration,e.tempo);s.addNote({midi:d,time:p,duration:f,velocity:u})}}const i=new Blob([t.toArray()],{type:"audio/midi"});return{url:URL.createObjectURL(i),filename:`session-${Date.now()}.mid`}}function cn(e,t){return 60/t*e}async function Ec(e){var l,c,d;const t=await e.text();let i;try{i=JSON.parse(t)}catch{throw new Error("Invalid JSON format.")}if(!Array.isArray(i.tr))throw new Error("Missing or invalid `tr` (tracks) array.");const n={bpm:((l=i.c)==null?void 0:l.b)??120,beatsPerMeasure:((c=i.c)==null?void 0:c.bpm)??4,totalMeasures:((d=i.c)==null?void 0:d.tm)??8},a=Array.isArray(i.i)?i.i:[],r=Array.isArray(i.vlm)?i.vlm:[],s=Array.isArray(i.pan)?i.pan:[],o=i.tr.map((u,p)=>{if(!Array.isArray(u.n))throw new Error(`Track ${p} missing \`n\` (notes) array.`);const f=u.n.map(([y,g,v,b])=>({pitch:y,start:g,duration:v,velocity:b??100})),m=a[p]||"sf2/fluidr3-gm/acoustic_grand_piano",h=r[p],_=s[p];return{notes:f,instrument:m,volume:typeof h=="number"?h:void 0,pan:typeof _=="number"?_:void 0,config:{}}});return{globalConfig:n,tracks:o}}async function Fc(e){var f;const t=await e.arrayBuffer(),i=new Sa.Midi(t),n=i.header.tempos[0],a=i.header.timeSignatures[0],r=(n==null?void 0:n.bpm)??120,s=((f=a==null?void 0:a.timeSignature)==null?void 0:f[0])??4,l=Math.max(0,...i.tracks.flatMap(m=>m.notes.map(h=>h.time+h.duration)))*(r/60),c=Math.ceil(l/s)||8,d={bpm:r,beatsPerMeasure:s,totalMeasures:c},u=await Io(),p=i.tracks.map(m=>{const h=m.notes.map(S=>({pitch:S.name,start:S.time*(r/60),duration:S.duration*(r/60),velocity:Math.max(1,Math.min(127,Math.round(S.velocity*127)))}));let _=m.instrument.number;(_===void 0||_===0)&&(_=m.channel===9?0:m.channel%128);const y=m.controlChanges[7]||[],g=m.controlChanges[10]||[],v=y.length>0?y[0].value:void 0,b=g.length>0?g[0].value*2-1:void 0;let N;if(m.channel===9){const S=Vo(_);S?N=`webaudiofont/${S.library}/${S.displayName}`:N=`sf2/drummachines/${u.includes("LM-2")?"LM-2":u[0]??"TR-808"}`}else N=`sf2/fluidr3-gm/${Na[_]||"acoustic_grand_piano"}`;return{notes:h,instrument:N,volume:v,pan:b,config:{}}});return{globalConfig:d,tracks:p}}function Pc(){for(const e of R){const t=e.container;if(!t)continue;const i=t.querySelector(".sequencer-body"),n=t.querySelector("canvas.mini-contour"),a=t.querySelector(".collapse-btn use");!i||!n||i.classList.contains("hidden")||(i.classList.add("hidden"),n.classList.remove("hidden"),a==null||a.setAttribute("href","#icon-caret-up"),e.setCollapsed(!0),kt(t,!1),at(n,e.notes,e.config,e.colorIndex))}}let he=null,ri=null;function Ac(e){ri=e,he=ri.getContext("2d")}function mi(e){if(!he||!ri)return;const{width:t,height:i}=ri;he.clearRect(0,0,t,i);const n=Math.round(e)+.5;he.strokeStyle="#ff00ff",he.lineWidth=1,he.beginPath(),he.moveTo(n,0),he.lineTo(n,i),he.stroke()}function un(e,t){Zi(t.bpm),er(t.beatsPerMeasure),tr(t.totalMeasures);const i=document.getElementById("tempo-input");i&&(i.value=String(ve()));const n=document.getElementById("measures-input");n&&(n.value=String(Pt())),Jd();for(const[r,s]of e.entries()){const o=r,l=s.instrument||"sf2/fluidr3-gm/acoustic_grand_piano",c=s.notes||[],d=s.volume,u=s.pan;$({type:"CREATE_SEQUENCER",id:o,instrument:l,notes:structuredClone(c),volume:d,pan:u,config:{...s.config||{}}},Ki(o))}$(Yi("Session Loaded"),Cn("Session Loaded")),Pc();const a=document.getElementById("global-mini-contour");a&&vs(a,R),mi(0)}function kc(){const e=document.querySelectorAll(".note-duration-btn"),t=document.getElementById("note-duration"),i=document.getElementById("dotted-note-btn"),n=document.getElementById("triplet-note-btn");let a=!1,r=!1;function s(l){let c=l;a?c=l*1.5:r&&(c=l*(2/3));let d=Array.from(t.options).find(u=>Math.abs(parseFloat(u.value)-c)<1e-4);d||(d=new Option(c.toString(),c.toString()),t.add(d)),t.value=d.value,t.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))}e.forEach(l=>{l.addEventListener("click",()=>{e.forEach(d=>d.classList.remove("bg-purple-600")),l.classList.add("bg-purple-600");const c=parseFloat(l.dataset.value);s(c)})}),i.addEventListener("click",()=>{r&&(r=!1,n.classList.remove("bg-purple-600")),a=!a,i.classList.toggle("bg-purple-600"),o()}),n.addEventListener("click",()=>{a&&(a=!1,i.classList.remove("bg-purple-600")),r=!r,n.classList.toggle("bg-purple-600"),se.isTripletMode=r,R.forEach(l=>{l.config.isTripletMode=r}),o()});function o(){const l=document.querySelector(".note-duration-btn.bg-purple-600");if(l){const c=parseFloat(l.dataset.value);s(c)}}s(se.currentDuration||1)}let Lt=null;function Ba(e){const i=j();function n(){var s;if(!e.isActive())return;const a=e.getCurrentBeat(),r=a/i*1260;mi(r);for(const o of e.sequencers)if((s=o==null?void 0:o.grid)!=null&&s.drawPlayhead){const l=o.grid.getXForBeat(a);o.grid.drawPlayhead(l)}Lt=requestAnimationFrame(n)}$i(),Lt=requestAnimationFrame(n)}function $i(){Lt!==null&&(cancelAnimationFrame(Lt),Lt=null)}function Ic(e){var t;mi(0);for(const i of e.sequencers)(t=i==null?void 0:i.grid)!=null&&t.drawPlayhead&&i.grid.drawPlayhead(0)}let ni=!1,Me=null,Hi=null,Vi=!1;function Tc(e,t){Me=e,Hi=t,Me.addEventListener("mousedown",Rc),window.addEventListener("mousemove",Oc),window.addEventListener("mouseup",Uc)}function Rc(e){O.isActive()&&(O.pause(),Vi=!0),ni=!0,yr(e)}function Oc(e){ni&&yr(e)}function Uc(e){ni&&(yr(e),ni=!1,Vi&&(O.resume(),Vi=!1))}function yr(e){if(!Me||!Hi)return;const t=Me.getBoundingClientRect(),i=Me.width/t.width;let n=(e.clientX-t.left)*i;n=Math.max(0,Math.min(Me.width,n));const a=j(),r=n/Me.width*a,s=bn(r,Hi),o=s/a*Me.width;O.seek(s),mi(o)}const hr={maxBeatsContext:32,extendBeatsAmount:16};function Zc(){return hr.maxBeatsContext}function eu(){return hr.extendBeatsAmount}function Wi(e,t,i,n){const a=j(),r=n/a*t;e.clearRect(0,0,t,i);const s=hr.maxBeatsContext,l=Math.max(0,n-s)/a*t,c=r-l;e.fillStyle="rgba(85, 187, 255, 0.55)",e.fillRect(l,0,c,i),e.strokeStyle="#ffffff",e.lineWidth=2,e.beginPath(),e.moveTo(r,0),e.lineTo(r,i),e.stroke()}let fn=!1,Mi=!1,Mt=0;function tu(){return Mt}function mn(){if(!fn){fn=!0;const n=document.getElementById("extend-use-tags"),a=document.getElementById("extend-tags");if(n&&a){let c=function(){const p=d.checked;u.disabled=!p,u.classList.toggle("opacity-50",!p),u.classList.toggle("cursor-not-allowed",!p)};const d=n,u=a;c(),d.addEventListener("change",c)}const r=document.getElementById("extend-start-help-btn"),s=document.getElementById("extend-start-help-popup"),o=document.getElementById("extend-start-help-close");r&&s&&o&&(r.addEventListener("click",()=>s.classList.remove("hidden")),o.addEventListener("click",()=>s.classList.add("hidden")),document.addEventListener("click",c=>{c.target instanceof Node&&!s.contains(c.target)&&c.target!==r&&s.classList.add("hidden")}));const l=document.querySelector("#ai-extend-modal .generate-btn");l&&l.addEventListener("click",async()=>{const{extendTracksWithAI:c}=await Ja(async()=>{const{extendTracksWithAI:d}=await import("./extendTracks-57MsIfp2.js");return{extendTracksWithAI:d}},__vite__mapDeps([0,1]));await c()})}const e=document.getElementById("extend-track-checkboxes"),t=document.getElementById("extend-select-all"),i=document.getElementById("extend-deselect-all");e&&t&&i&&(e.innerHTML="",me().forEach((a,r)=>{const s=`extend-track-${r}`,o=document.createElement("div");o.className="flex items-center gap-2";const l=document.createElement("input");l.type="checkbox",l.id=s,l.dataset.index=r.toString(),l.checked=!0,l.className="w-4 h-4 rounded border-gray-600 bg-gray-700 text-purple-600 focus:ring-purple-500";const c=document.createElement("label");c.htmlFor=s,c.className="text-sm text-gray-200",c.textContent=a.config.name||`Track ${r+1}`,l.addEventListener("change",()=>{gt()}),o.appendChild(l),o.appendChild(c),e.appendChild(o)}),t.addEventListener("click",()=>{e.querySelectorAll('input[type="checkbox"]').forEach(a=>a.checked=!0),gt()}),i.addEventListener("click",()=>{e.querySelectorAll('input[type="checkbox"]').forEach(a=>a.checked=!1),gt()}),gt())}function Dc(){const e=document.getElementById("extend-mini-contour"),t=document.getElementById("extend-mini-playhead");if(!e||!t)return;const i=t.getContext("2d");if(!i)return;const n=e.clientWidth,a=e.clientHeight;e.width=n,e.height=a,t.width=n,t.height=a,gt(),Wi(i,n,a,Mt),t.addEventListener("mousedown",s=>{Mi=!0,r(s.offsetX)}),window.addEventListener("mouseup",()=>{Mi=!1}),window.addEventListener("mousemove",s=>{if(!Mi)return;const o=t.getBoundingClientRect();r(s.clientX-o.left)});function r(s){if(!i)return;const o=j(),l=Math.max(0,Math.min(s,n));Mt=Math.round(l/n*o),Wi(i,n,a,Mt)}}function gt(){const e=document.getElementById("extend-mini-contour"),t=document.getElementById("extend-mini-playhead");if(!e||!t)return;const i=t.getContext("2d");if(!i)return;const n=t.width,a=t.height,r=document.querySelectorAll('#extend-track-checkboxes input[type="checkbox"]'),s=Array.from(r).filter(l=>l.checked).map(l=>parseInt(l.dataset.index||"0",10)),o=me().filter((l,c)=>s.includes(c));re(e,o),Wi(i,n,a,Mt)}function xc(){const e=document.getElementById("note-placement-mode-btn"),t=document.getElementById("select-mode-btn"),i=document.getElementById("note-duration-controls"),n=document.getElementById("select-mode-controls"),a=document.getElementById("velocity-mode-controls");if(!e||!t||!i||!n||!a){console.error("Missing essential UI elements for edit mode switching.");return}function r(o){[e,t].forEach(l=>{l&&(l.classList.remove("bg-purple-600"),l.classList.add("bg-gray-800"))}),o.classList.remove("bg-gray-800"),o.classList.add("bg-purple-600")}function s(o){[i,n,a].forEach(l=>{l&&l.classList.add("hidden")}),o.classList.remove("hidden")}e.addEventListener("click",()=>{r(e),s(i),fe("note-placement")}),t.addEventListener("click",()=>{r(t),s(n),fe("select")}),window.addEventListener("keydown",o=>{var d;const l=(d=document.activeElement)==null?void 0:d.tagName;if(!(l==="INPUT"||l==="TEXTAREA"||document.querySelector(".ai-modal:not(.hidden)")))switch(o.key.toLowerCase()){case"q":e.click();break;case"w":t.click();break;default:return}}),r(e),s(i),fe("note-placement")}function Jc(){var p,f,m;const e=document.getElementById("note-mode-btn"),t=document.getElementById("ai-mode-btn"),i=document.getElementById("note-duration-panel"),n=document.getElementById("ai-control-panel");if(!e||!t||!i||!n){console.error("Missing essential elements for control mode switching.");return}function a(){document.querySelectorAll(".sequencer").forEach(h=>{const _=h.querySelector(".delete-btn"),y=h.querySelector(".collapse-btn"),g=y==null?void 0:y.querySelector("use"),v=h.querySelector(".sequencer-body"),b=h.querySelector(".mini-contour");!_||!y||!g||!v||!b||(_.classList.add("button-locked"),y.classList.add("button-locked"),kt(h,!1),v.classList.contains("hidden")||(v.classList.add("hidden"),b.classList.remove("hidden"),g.setAttribute("href","#icon-caret-up")))})}function r(){document.querySelectorAll(".sequencer").forEach(h=>{const _=h.querySelector(".delete-btn"),y=h.querySelector(".collapse-btn");_==null||_.classList.remove("button-locked"),y==null||y.classList.remove("button-locked")})}function s(){!e||!t||!i||!n||(e.classList.replace("bg-gray-800","bg-blue-600"),t.classList.replace("bg-purple-600","bg-gray-800"),i.classList.remove("hidden"),n.classList.add("hidden"),r())}function o(){if(!xi()){const h=document.getElementById("openai-key-not-set-modal");h==null||h.classList.remove("hidden");return}!e||!t||!i||!n||(t.classList.replace("bg-gray-800","bg-purple-600"),e.classList.replace("bg-blue-600","bg-gray-800"),i.classList.add("hidden"),n.classList.remove("hidden"),a())}e.addEventListener("click",s),t.addEventListener("click",o);const l=document.getElementById("ai-inpaint-modal"),c=document.getElementById("ai-extend-modal"),d=document.getElementById("ai-generate-modal");function u(h){if(!h)return;const _=h.querySelector(".cancel-btn");_==null||_.addEventListener("click",()=>{h.classList.add("hidden")})}u(l),u(c),u(d),mn(),(p=document.getElementById("ai-inpaint-btn"))==null||p.addEventListener("click",()=>{l==null||l.classList.remove("hidden")}),(f=document.getElementById("ai-extend-btn"))==null||f.addEventListener("click",()=>{c==null||c.classList.remove("hidden"),Dc(),mn()}),(m=document.getElementById("ai-generate-btn"))==null||m.addEventListener("click",()=>{d==null||d.classList.remove("hidden")}),xc()}function Ca(){const e=ui();if(!e)return;const t=e.gridContext,i=t.getSelectedNotes();i.length!==0&&($(zi(t.sequencer.id,i),Xi(t.sequencer.id,i)),it()&&(tt(),fe(ue.NOTE_PLACEMENT)),t.setSelectedNotes([]))}function La(){const e=ui();if(!e)return;const t=e.getSelectedNotes();t.length!==0&&In(t)}function Ma(){const e=ui();if(!e)return;const t=e.gridContext,i=t.getSelectedNotes();i.length!==0&&(In(i),$(Gs(t.sequencer.id,i),ws(t.sequencer.id,i)),it()&&(tt(),fe(ue.NOTE_PLACEMENT)),t.setSelectedNotes([]))}function Ga(){Ai().notes.length&&(document.body.style.cursor="crosshair",cl((t,i)=>{const n=t.gridContext,{x:a,y:r}=n.getCanvasPos(i),s=n.getSnappedBeatFromX(a),o=n.getPitchFromRow(Math.floor(r/n.getCellHeight())),l=P(o);if(l===null)return;const{notes:c,anchorBeat:d,anchorMidi:u}=Ai(),p=s-d,f=l-u,m=c.map(h=>{const _=P(h.pitch);return _===null?{...h}:{pitch:we(_+f)??h.pitch,start:h.start+p,duration:h.duration}});$(Fs(n.sequencer.id,m),Ps(n.sequencer.id,m)),it()&&(tt(),fe(ue.NOTE_PLACEMENT)),n.setSelectedNotes(m),document.body.style.cursor="default",ir()}))}function qc(){document.addEventListener("keydown",e=>{const i=navigator.platform.toUpperCase().includes("MAC")?e.metaKey:e.ctrlKey,n=document.activeElement,a=n instanceof HTMLElement?n.tagName:null;if(!(a==="INPUT"||a==="TEXTAREA"))switch(!0){case(i&&e.key==="c"):e.preventDefault(),La();break;case(i&&e.key==="x"):e.preventDefault(),Ma();break;case(i&&e.key==="v"):e.preventDefault(),Ga();break;case e.key==="Delete":e.preventDefault(),Ca();break}})}function $c(){const e=document.querySelector(".select-mode-copy");e&&(e.onclick=La);const t=document.querySelector(".select-mode-cut");t&&(t.onclick=Ma);const i=document.querySelector(".select-mode-paste");i&&(i.onclick=Ga);const n=document.querySelector(".select-mode-delete");n&&(n.onclick=Ca),qc()}function Hc(e,t){return e!==void 0&&t!==void 0&&e===t}function Vc(e=Je()){var i,n,a;Zi(e.tempo,!1),er(e.timeSignature[0],!1),tr(e.totalMeasures,!1);for(const r of R)r.updateTotalMeasures();for(const r of e.sequencers){const s=R.find(o=>Hc(o.id,r.id));if(s){s.instrumentName=r.instrument,typeof r.volume=="number"&&(s.volume=r.volume),typeof r.pan=="number"&&(s.pan=r.pan);const o=(i=s.container)==null?void 0:i.querySelector("canvas.mini-contour");o&&at(o,s.notes,s.config,s.colorIndex);const l=(n=s.grid)==null?void 0:n.gridContext;if(l){const c=l.getSelectedNotes?l.getSelectedNotes():[],d=l.getSelectedNote?l.getSelectedNote():null,u=c.map(p=>({pitch:p.pitch,start:p.start,duration:p.duration,velocity:p.velocity}));if(l.notes.length=0,l.notes.push(...structuredClone(r.notes)),c.length>0){const p=u.map(f=>l.notes.find(m=>m.pitch===f.pitch&&m.start===f.start&&m.duration===f.duration&&m.velocity===f.velocity)).filter(Boolean);p.length>0&&(l.setSelectedNotes(p),d&&p.length===1&&l.setSelectedNote(p[0]))}if(O!=null&&O.isActive()){const p=O.getStartTime(),f=O.getStartBeat();s.reschedulePlayback(p,f)}(a=s.grid)==null||a.scheduleRedraw()}}else{const o={id:r.id,instrument:r.instrument,notes:structuredClone(r.notes),volume:r.volume,pan:r.pan},{wrapper:l}=ua(o),c=l.querySelector(".sequencer");c&&kt(c,!0)}}const t=document.getElementById("global-mini-contour");t&&re(t,R)}class Wc{constructor(t){this.startTime=0,this.startBeat=0,this.isPlaying=!1,this.animationFrameId=null,this.onResumeCallback=null,this.tick=()=>{if(!this.isPlaying)return;const i=this.getCurrentBeat(),n=j();if(i>=n)if(zs())this.seek(0),this.start();else{this.stop();return}this.animationFrameId=requestAnimationFrame(this.tick)},this.context=Q(),this.sequencers=t}setOnResumeCallback(t){this.onResumeCallback=t}getCurrentBeat(){if(!this.isPlaying)return this.startBeat;const t=60/ve();return(this.context.currentTime-this.startTime)/t+this.startBeat}async start(){const t=this.context.currentTime+.1;this.startTime=t,this.startBeat=0,this.isPlaying=!0,await this.scheduleAll(t,this.startBeat),this.context.state==="suspended"&&await this.context.resume(),this.animationFrameId=requestAnimationFrame(this.tick)}syncAfterTempoChange(t){const i=this.context.currentTime,n=60/t,a=(i-this.startTime)/n+this.startBeat;this.startBeat=a,this.startTime=i}async pause(){if(!this.isPlaying)return;const t=this.getCurrentBeat();for(const i of this.sequencers)i.stopScheduledNotes();await this.context.suspend(),this.startBeat=t,this.isPlaying=!1,this.animationFrameId&&cancelAnimationFrame(this.animationFrameId)}async resume(){var n;if(this.isPlaying)return;await this.context.resume();const i=this.context.currentTime+.05;this.startTime=i,await this.scheduleAll(i,this.startBeat),this.isPlaying=!0,(n=this.onResumeCallback)==null||n.call(this),this.animationFrameId=requestAnimationFrame(this.tick)}async scheduleAll(t,i){for(const n of this.sequencers)n.shouldPlay?await n.preparePlayback(t,i):n.stopScheduledNotes()}stop(){for(const t of this.sequencers)t.stopScheduledNotes();this.isPlaying=!1,this.startBeat=0,this.startTime=0,this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),Rd()}seek(t){this.startBeat=t,this.startTime=this.context.currentTime,this.isPlaying=!1,this.animationFrameId&&cancelAnimationFrame(this.animationFrameId)}setSequencers(t){this.sequencers=t}isActive(){return this.isPlaying}getStartTime(){return this.startTime}getStartBeat(){return this.startBeat}}qa();const O=new Wc(me());O.setOnResumeCallback(()=>Ba(O));Js(Vc);cd();function Kc(){const e=document.getElementById("global-mini-contour");e&&re(e,R)}document.getElementById("global-mini-contour");const wa=document.getElementById("global-mini-playhead");Ac(wa);Tc(wa,se);const pn=0,zc="sf2/fluidr3-gm/acoustic_grand_piano";$(Nn(pn,zc),Ki(pn));const Xc=document.getElementById("piano");rc(Xc);const jc=document.getElementById("waveform"),Yc=document.getElementById("visualizer-mode");ac(jc,Yc);$(Yi("Initial App State"),Cn("Initial App State"));Wa(Hs,Vs);$c();Kc();qd();kc();Vd();Id();mc();Jc();sc();Yd();Qd();Va();Td({getSequencers:()=>R,onPlay:async()=>{await O.start(),Ba(O)},onPause:async()=>{await O.pause(),$i()},onResume:async()=>{await O.resume()},onStop:()=>{O.stop(),$i(),Ic(O)},onDurationChange:e=>{se.currentDuration=e,R.forEach(t=>t.config.currentDuration=e)},onSnapChange:e=>{se.snapResolution=e,R.forEach(t=>t.config.snapResolution=e)},onToggleLoop:e=>{se.loopEnabled=e,R.forEach(t=>t.config.loopEnabled=e),Ks(e)},onTempoChange:e=>{Zi(e)},onSave:async e=>{const t=Je();if(e==="json"){const{url:i,filename:n}=lc(t),a=document.createElement("a");a.href=i,a.download=n,a.click(),URL.revokeObjectURL(i)}else if(e==="wav")cc();else if(e==="midi"){const{url:i,filename:n}=await wc(t),a=document.createElement("a");a.href=i,a.download=n,a.click(),URL.revokeObjectURL(i)}},onLoad:async e=>{var t;try{const i=(t=e.name.split(".").pop())==null?void 0:t.toLowerCase();if(i==="json"){const{tracks:n,globalConfig:a}=await Ec(e);un(n,a)}else if(i==="mid"||i==="midi"){const{tracks:n,globalConfig:a}=await Fc(e);un(n,a)}else throw new Error("Unsupported file type.")}catch(i){i instanceof Error?alert("Failed to load file: "+i.message):alert("Failed to load file: Unknown error")}},onMeasuresChange:e=>{tr(e);const t=document.getElementById("global-mini-contour");t&&re(t,R)},onBeatsPerMeasureChange:e=>{er(e);const t=document.getElementById("global-mini-contour");t&&re(t,R)}});$a();const iu=Object.freeze(Object.defineProperty({__proto__:null,engine:O},Symbol.toStringTag,{value:"Module"}));export{$r as a,me as b,tu as c,Zc as d,eu as e,Ft as f,xi as g,at as h,re as i,iu as m,tr as u};
