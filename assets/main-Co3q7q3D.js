var Oc=function(){function t(e,i){i===void 0&&(i=[]),this._eventType=e,this._eventFunctions=i}return t.prototype.init=function(){var e=this;this._eventFunctions.forEach(function(i){typeof window<"u"&&window.addEventListener(e._eventType,i)})},t}(),Dc=function(){function t(){this._instances={Accordion:{},Carousel:{},Collapse:{},Dial:{},Dismiss:{},Drawer:{},Dropdown:{},Modal:{},Popover:{},Tabs:{},Tooltip:{},InputCounter:{},CopyClipboard:{},Datepicker:{}}}return t.prototype.addInstance=function(e,i,r,n){if(n===void 0&&(n=!1),!this._instances[e])return console.warn("Flowbite: Component ".concat(e," does not exist.")),!1;if(this._instances[e][r]&&!n){console.warn("Flowbite: Instance with ID ".concat(r," already exists."));return}n&&this._instances[e][r]&&this._instances[e][r].destroyAndRemoveInstance(),this._instances[e][r||this._generateRandomId()]=i},t.prototype.getAllInstances=function(){return this._instances},t.prototype.getInstances=function(e){return this._instances[e]?this._instances[e]:(console.warn("Flowbite: Component ".concat(e," does not exist.")),!1)},t.prototype.getInstance=function(e,i){if(this._componentAndInstanceCheck(e,i)){if(!this._instances[e][i]){console.warn("Flowbite: Instance with ID ".concat(i," does not exist."));return}return this._instances[e][i]}},t.prototype.destroyAndRemoveInstance=function(e,i){this._componentAndInstanceCheck(e,i)&&(this.destroyInstanceObject(e,i),this.removeInstance(e,i))},t.prototype.removeInstance=function(e,i){this._componentAndInstanceCheck(e,i)&&delete this._instances[e][i]},t.prototype.destroyInstanceObject=function(e,i){this._componentAndInstanceCheck(e,i)&&this._instances[e][i].destroy()},t.prototype.instanceExists=function(e,i){return!(!this._instances[e]||!this._instances[e][i])},t.prototype._generateRandomId=function(){return Math.random().toString(36).substr(2,9)},t.prototype._componentAndInstanceCheck=function(e,i){return this._instances[e]?this._instances[e][i]?!0:(console.warn("Flowbite: Instance with ID ".concat(i," does not exist.")),!1):(console.warn("Flowbite: Component ".concat(e," does not exist.")),!1)},t}(),I=new Dc;typeof window<"u"&&(window.FlowbiteInstances=I);var wr=function(){return wr=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++){e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},wr.apply(this,arguments)},Sr={alwaysOpen:!1,activeClasses:"bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white",inactiveClasses:"text-gray-500 dark:text-gray-400",onOpen:function(){},onClose:function(){},onToggle:function(){}},Fc={id:null,override:!0},Yo=function(){function t(e,i,r,n){e===void 0&&(e=null),i===void 0&&(i=[]),r===void 0&&(r=Sr),n===void 0&&(n=Fc),this._instanceId=n.id?n.id:e.id,this._accordionEl=e,this._items=i,this._options=wr(wr({},Sr),r),this._initialized=!1,this.init(),I.addInstance("Accordion",this,this._instanceId,n.override)}return t.prototype.init=function(){var e=this;this._items.length&&!this._initialized&&(this._items.forEach(function(i){i.active&&e.open(i.id);var r=function(){e.toggle(i.id)};i.triggerEl.addEventListener("click",r),i.clickHandler=r}),this._initialized=!0)},t.prototype.destroy=function(){this._items.length&&this._initialized&&(this._items.forEach(function(e){e.triggerEl.removeEventListener("click",e.clickHandler),delete e.clickHandler}),this._initialized=!1)},t.prototype.removeInstance=function(){I.removeInstance("Accordion",this._instanceId)},t.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},t.prototype.getItem=function(e){return this._items.filter(function(i){return i.id===e})[0]},t.prototype.open=function(e){var i,r,n=this,s=this.getItem(e);this._options.alwaysOpen||this._items.map(function(a){var o,l;a!==s&&((o=a.triggerEl.classList).remove.apply(o,n._options.activeClasses.split(" ")),(l=a.triggerEl.classList).add.apply(l,n._options.inactiveClasses.split(" ")),a.targetEl.classList.add("hidden"),a.triggerEl.setAttribute("aria-expanded","false"),a.active=!1,a.iconEl&&a.iconEl.classList.add("rotate-180"))}),(i=s.triggerEl.classList).add.apply(i,this._options.activeClasses.split(" ")),(r=s.triggerEl.classList).remove.apply(r,this._options.inactiveClasses.split(" ")),s.triggerEl.setAttribute("aria-expanded","true"),s.targetEl.classList.remove("hidden"),s.active=!0,s.iconEl&&s.iconEl.classList.remove("rotate-180"),this._options.onOpen(this,s)},t.prototype.toggle=function(e){var i=this.getItem(e);i.active?this.close(e):this.open(e),this._options.onToggle(this,i)},t.prototype.close=function(e){var i,r,n=this.getItem(e);(i=n.triggerEl.classList).remove.apply(i,this._options.activeClasses.split(" ")),(r=n.triggerEl.classList).add.apply(r,this._options.inactiveClasses.split(" ")),n.targetEl.classList.add("hidden"),n.triggerEl.setAttribute("aria-expanded","false"),n.active=!1,n.iconEl&&n.iconEl.classList.add("rotate-180"),this._options.onClose(this,n)},t.prototype.updateOnOpen=function(e){this._options.onOpen=e},t.prototype.updateOnClose=function(e){this._options.onClose=e},t.prototype.updateOnToggle=function(e){this._options.onToggle=e},t}();function hs(){document.querySelectorAll("[data-accordion]").forEach(function(t){var e=t.getAttribute("data-accordion"),i=t.getAttribute("data-active-classes"),r=t.getAttribute("data-inactive-classes"),n=[];t.querySelectorAll("[data-accordion-target]").forEach(function(s){if(s.closest("[data-accordion]")===t){var a={id:s.getAttribute("data-accordion-target"),triggerEl:s,targetEl:document.querySelector(s.getAttribute("data-accordion-target")),iconEl:s.querySelector("[data-accordion-icon]"),active:s.getAttribute("aria-expanded")==="true"};n.push(a)}}),new Yo(t,n,{alwaysOpen:e==="open",activeClasses:i||Sr.activeClasses,inactiveClasses:r||Sr.inactiveClasses})})}typeof window<"u"&&(window.Accordion=Yo,window.initAccordions=hs);var Cr=function(){return Cr=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++){e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},Cr.apply(this,arguments)},Ca={onCollapse:function(){},onExpand:function(){},onToggle:function(){}},Rc={id:null,override:!0},jn=function(){function t(e,i,r,n){e===void 0&&(e=null),i===void 0&&(i=null),r===void 0&&(r=Ca),n===void 0&&(n=Rc),this._instanceId=n.id?n.id:e.id,this._targetEl=e,this._triggerEl=i,this._options=Cr(Cr({},Ca),r),this._visible=!1,this._initialized=!1,this.init(),I.addInstance("Collapse",this,this._instanceId,n.override)}return t.prototype.init=function(){var e=this;this._triggerEl&&this._targetEl&&!this._initialized&&(this._triggerEl.hasAttribute("aria-expanded")?this._visible=this._triggerEl.getAttribute("aria-expanded")==="true":this._visible=!this._targetEl.classList.contains("hidden"),this._clickHandler=function(){e.toggle()},this._triggerEl.addEventListener("click",this._clickHandler),this._initialized=!0)},t.prototype.destroy=function(){this._triggerEl&&this._initialized&&(this._triggerEl.removeEventListener("click",this._clickHandler),this._initialized=!1)},t.prototype.removeInstance=function(){I.removeInstance("Collapse",this._instanceId)},t.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},t.prototype.collapse=function(){this._targetEl.classList.add("hidden"),this._triggerEl&&this._triggerEl.setAttribute("aria-expanded","false"),this._visible=!1,this._options.onCollapse(this)},t.prototype.expand=function(){this._targetEl.classList.remove("hidden"),this._triggerEl&&this._triggerEl.setAttribute("aria-expanded","true"),this._visible=!0,this._options.onExpand(this)},t.prototype.toggle=function(){this._visible?this.collapse():this.expand(),this._options.onToggle(this)},t.prototype.updateOnCollapse=function(e){this._options.onCollapse=e},t.prototype.updateOnExpand=function(e){this._options.onExpand=e},t.prototype.updateOnToggle=function(e){this._options.onToggle=e},t}();function fs(){document.querySelectorAll("[data-collapse-toggle]").forEach(function(t){var e=t.getAttribute("data-collapse-toggle"),i=document.getElementById(e);i?I.instanceExists("Collapse",i.getAttribute("id"))?new jn(i,t,{},{id:i.getAttribute("id")+"_"+I._generateRandomId()}):new jn(i,t):console.error('The target element with id "'.concat(e,'" does not exist. Please check the data-collapse-toggle attribute.'))})}typeof window<"u"&&(window.Collapse=jn,window.initCollapses=fs);var gt=function(){return gt=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++){e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},gt.apply(this,arguments)},dr={defaultPosition:0,indicators:{items:[],activeClasses:"bg-white dark:bg-gray-800",inactiveClasses:"bg-white/50 dark:bg-gray-800/50 hover:bg-white dark:hover:bg-gray-800"},interval:3e3,onNext:function(){},onPrev:function(){},onChange:function(){}},Uc={id:null,override:!0},Zo=function(){function t(e,i,r,n){e===void 0&&(e=null),i===void 0&&(i=[]),r===void 0&&(r=dr),n===void 0&&(n=Uc),this._instanceId=n.id?n.id:e.id,this._carouselEl=e,this._items=i,this._options=gt(gt(gt({},dr),r),{indicators:gt(gt({},dr.indicators),r.indicators)}),this._activeItem=this.getItem(this._options.defaultPosition),this._indicators=this._options.indicators.items,this._intervalDuration=this._options.interval,this._intervalInstance=null,this._initialized=!1,this.init(),I.addInstance("Carousel",this,this._instanceId,n.override)}return t.prototype.init=function(){var e=this;this._items.length&&!this._initialized&&(this._items.map(function(i){i.el.classList.add("absolute","inset-0","transition-transform","transform")}),this.getActiveItem()?this.slideTo(this.getActiveItem().position):this.slideTo(0),this._indicators.map(function(i,r){i.el.addEventListener("click",function(){e.slideTo(r)})}),this._initialized=!0)},t.prototype.destroy=function(){this._initialized&&(this._initialized=!1)},t.prototype.removeInstance=function(){I.removeInstance("Carousel",this._instanceId)},t.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},t.prototype.getItem=function(e){return this._items[e]},t.prototype.slideTo=function(e){var i=this._items[e],r={left:i.position===0?this._items[this._items.length-1]:this._items[i.position-1],middle:i,right:i.position===this._items.length-1?this._items[0]:this._items[i.position+1]};this._rotate(r),this._setActiveItem(i),this._intervalInstance&&(this.pause(),this.cycle()),this._options.onChange(this)},t.prototype.next=function(){var e=this.getActiveItem(),i=null;e.position===this._items.length-1?i=this._items[0]:i=this._items[e.position+1],this.slideTo(i.position),this._options.onNext(this)},t.prototype.prev=function(){var e=this.getActiveItem(),i=null;e.position===0?i=this._items[this._items.length-1]:i=this._items[e.position-1],this.slideTo(i.position),this._options.onPrev(this)},t.prototype._rotate=function(e){if(this._items.map(function(i){i.el.classList.add("hidden")}),this._items.length===1){e.middle.el.classList.remove("-translate-x-full","translate-x-full","translate-x-0","hidden","z-10"),e.middle.el.classList.add("translate-x-0","z-20");return}e.left.el.classList.remove("-translate-x-full","translate-x-full","translate-x-0","hidden","z-20"),e.left.el.classList.add("-translate-x-full","z-10"),e.middle.el.classList.remove("-translate-x-full","translate-x-full","translate-x-0","hidden","z-10"),e.middle.el.classList.add("translate-x-0","z-30"),e.right.el.classList.remove("-translate-x-full","translate-x-full","translate-x-0","hidden","z-30"),e.right.el.classList.add("translate-x-full","z-20")},t.prototype.cycle=function(){var e=this;typeof window<"u"&&(this._intervalInstance=window.setInterval(function(){e.next()},this._intervalDuration))},t.prototype.pause=function(){clearInterval(this._intervalInstance)},t.prototype.getActiveItem=function(){return this._activeItem},t.prototype._setActiveItem=function(e){var i,r,n=this;this._activeItem=e;var s=e.position;this._indicators.length&&(this._indicators.map(function(a){var o,l;a.el.setAttribute("aria-current","false"),(o=a.el.classList).remove.apply(o,n._options.indicators.activeClasses.split(" ")),(l=a.el.classList).add.apply(l,n._options.indicators.inactiveClasses.split(" "))}),(i=this._indicators[s].el.classList).add.apply(i,this._options.indicators.activeClasses.split(" ")),(r=this._indicators[s].el.classList).remove.apply(r,this._options.indicators.inactiveClasses.split(" ")),this._indicators[s].el.setAttribute("aria-current","true"))},t.prototype.updateOnNext=function(e){this._options.onNext=e},t.prototype.updateOnPrev=function(e){this._options.onPrev=e},t.prototype.updateOnChange=function(e){this._options.onChange=e},t}();function ps(){document.querySelectorAll("[data-carousel]").forEach(function(t){var e=t.getAttribute("data-carousel-interval"),i=t.getAttribute("data-carousel")==="slide",r=[],n=0;t.querySelectorAll("[data-carousel-item]").length&&Array.from(t.querySelectorAll("[data-carousel-item]")).map(function(c,d){r.push({position:d,el:c}),c.getAttribute("data-carousel-item")==="active"&&(n=d)});var s=[];t.querySelectorAll("[data-carousel-slide-to]").length&&Array.from(t.querySelectorAll("[data-carousel-slide-to]")).map(function(c){s.push({position:parseInt(c.getAttribute("data-carousel-slide-to")),el:c})});var a=new Zo(t,r,{defaultPosition:n,indicators:{items:s},interval:e||dr.interval});i&&a.cycle();var o=t.querySelector("[data-carousel-next]"),l=t.querySelector("[data-carousel-prev]");o&&o.addEventListener("click",function(){a.next()}),l&&l.addEventListener("click",function(){a.prev()})})}typeof window<"u"&&(window.Carousel=Zo,window.initCarousels=ps);var Pr=function(){return Pr=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++){e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},Pr.apply(this,arguments)},Pa={transition:"transition-opacity",duration:300,timing:"ease-out",onHide:function(){}},Hc={id:null,override:!0},Qo=function(){function t(e,i,r,n){e===void 0&&(e=null),i===void 0&&(i=null),r===void 0&&(r=Pa),n===void 0&&(n=Hc),this._instanceId=n.id?n.id:e.id,this._targetEl=e,this._triggerEl=i,this._options=Pr(Pr({},Pa),r),this._initialized=!1,this.init(),I.addInstance("Dismiss",this,this._instanceId,n.override)}return t.prototype.init=function(){var e=this;this._triggerEl&&this._targetEl&&!this._initialized&&(this._clickHandler=function(){e.hide()},this._triggerEl.addEventListener("click",this._clickHandler),this._initialized=!0)},t.prototype.destroy=function(){this._triggerEl&&this._initialized&&(this._triggerEl.removeEventListener("click",this._clickHandler),this._initialized=!1)},t.prototype.removeInstance=function(){I.removeInstance("Dismiss",this._instanceId)},t.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},t.prototype.hide=function(){var e=this;this._targetEl.classList.add(this._options.transition,"duration-".concat(this._options.duration),this._options.timing,"opacity-0"),setTimeout(function(){e._targetEl.classList.add("hidden")},this._options.duration),this._options.onHide(this,this._targetEl)},t.prototype.updateOnHide=function(e){this._options.onHide=e},t}();function ms(){document.querySelectorAll("[data-dismiss-target]").forEach(function(t){var e=t.getAttribute("data-dismiss-target"),i=document.querySelector(e);i?new Qo(i,t):console.error('The dismiss element with id "'.concat(e,'" does not exist. Please check the data-dismiss-target attribute.'))})}typeof window<"u"&&(window.Dismiss=Qo,window.initDismisses=ms);var X="top",me="bottom",ye="right",Y="left",ys="auto",Oi=[X,me,ye,Y],Wt="start",Ni="end",qc="clippingParents",el="viewport",ri="popper",jc="reference",Na=Oi.reduce(function(t,e){return t.concat([e+"-"+Wt,e+"-"+Ni])},[]),tl=[].concat(Oi,[ys]).reduce(function(t,e){return t.concat([e,e+"-"+Wt,e+"-"+Ni])},[]),Kc="beforeRead",$c="read",zc="afterRead",Vc="beforeMain",Wc="main",Jc="afterMain",Xc="beforeWrite",Yc="write",Zc="afterWrite",Qc=[Kc,$c,zc,Vc,Wc,Jc,Xc,Yc,Zc];function Ee(t){return t?(t.nodeName||"").toLowerCase():null}function ae(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Ct(t){var e=ae(t).Element;return t instanceof e||t instanceof Element}function fe(t){var e=ae(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function gs(t){if(typeof ShadowRoot>"u")return!1;var e=ae(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function eu(t){var e=t.state;Object.keys(e.elements).forEach(function(i){var r=e.styles[i]||{},n=e.attributes[i]||{},s=e.elements[i];!fe(s)||!Ee(s)||(Object.assign(s.style,r),Object.keys(n).forEach(function(a){var o=n[a];o===!1?s.removeAttribute(a):s.setAttribute(a,o===!0?"":o)}))})}function tu(t){var e=t.state,i={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,i.popper),e.styles=i,e.elements.arrow&&Object.assign(e.elements.arrow.style,i.arrow),function(){Object.keys(e.elements).forEach(function(r){var n=e.elements[r],s=e.attributes[r]||{},a=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:i[r]),o=a.reduce(function(l,c){return l[c]="",l},{});!fe(n)||!Ee(n)||(Object.assign(n.style,o),Object.keys(s).forEach(function(l){n.removeAttribute(l)}))})}}const iu={name:"applyStyles",enabled:!0,phase:"write",fn:eu,effect:tu,requires:["computeStyles"]};function ke(t){return t.split("-")[0]}var Mt=Math.max,Nr=Math.min,Jt=Math.round;function Kn(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function il(){return!/^((?!chrome|android).)*safari/i.test(Kn())}function Xt(t,e,i){e===void 0&&(e=!1),i===void 0&&(i=!1);var r=t.getBoundingClientRect(),n=1,s=1;e&&fe(t)&&(n=t.offsetWidth>0&&Jt(r.width)/t.offsetWidth||1,s=t.offsetHeight>0&&Jt(r.height)/t.offsetHeight||1);var a=Ct(t)?ae(t):window,o=a.visualViewport,l=!il()&&i,c=(r.left+(l&&o?o.offsetLeft:0))/n,d=(r.top+(l&&o?o.offsetTop:0))/s,u=r.width/n,f=r.height/s;return{width:u,height:f,top:d,right:c+u,bottom:d+f,left:c,x:c,y:d}}function vs(t){var e=Xt(t),i=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-i)<=1&&(i=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:i,height:r}}function rl(t,e){var i=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(i&&gs(i)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Ue(t){return ae(t).getComputedStyle(t)}function ru(t){return["table","td","th"].indexOf(Ee(t))>=0}function st(t){return((Ct(t)?t.ownerDocument:t.document)||window.document).documentElement}function Jr(t){return Ee(t)==="html"?t:t.assignedSlot||t.parentNode||(gs(t)?t.host:null)||st(t)}function ka(t){return!fe(t)||Ue(t).position==="fixed"?null:t.offsetParent}function nu(t){var e=/firefox/i.test(Kn()),i=/Trident/i.test(Kn());if(i&&fe(t)){var r=Ue(t);if(r.position==="fixed")return null}var n=Jr(t);for(gs(n)&&(n=n.host);fe(n)&&["html","body"].indexOf(Ee(n))<0;){var s=Ue(n);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return n;n=n.parentNode}return null}function Di(t){for(var e=ae(t),i=ka(t);i&&ru(i)&&Ue(i).position==="static";)i=ka(i);return i&&(Ee(i)==="html"||Ee(i)==="body"&&Ue(i).position==="static")?e:i||nu(t)||e}function _s(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function gi(t,e,i){return Mt(t,Nr(e,i))}function su(t,e,i){var r=gi(t,e,i);return r>i?i:r}function nl(){return{top:0,right:0,bottom:0,left:0}}function sl(t){return Object.assign({},nl(),t)}function al(t,e){return e.reduce(function(i,r){return i[r]=t,i},{})}var au=function(e,i){return e=typeof e=="function"?e(Object.assign({},i.rects,{placement:i.placement})):e,sl(typeof e!="number"?e:al(e,Oi))};function ou(t){var e,i=t.state,r=t.name,n=t.options,s=i.elements.arrow,a=i.modifiersData.popperOffsets,o=ke(i.placement),l=_s(o),c=[Y,ye].indexOf(o)>=0,d=c?"height":"width";if(!(!s||!a)){var u=au(n.padding,i),f=vs(s),h=l==="y"?X:Y,m=l==="y"?me:ye,g=i.rects.reference[d]+i.rects.reference[l]-a[l]-i.rects.popper[d],y=a[l]-i.rects.reference[l],p=Di(s),_=p?l==="y"?p.clientHeight||0:p.clientWidth||0:0,M=g/2-y/2,v=u[h],w=_-f[d]-u[m],S=_/2-f[d]/2+M,C=gi(v,S,w),P=l;i.modifiersData[r]=(e={},e[P]=C,e.centerOffset=C-S,e)}}function lu(t){var e=t.state,i=t.options,r=i.element,n=r===void 0?"[data-popper-arrow]":r;n!=null&&(typeof n=="string"&&(n=e.elements.popper.querySelector(n),!n)||rl(e.elements.popper,n)&&(e.elements.arrow=n))}const du={name:"arrow",enabled:!0,phase:"main",fn:ou,effect:lu,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Yt(t){return t.split("-")[1]}var cu={top:"auto",right:"auto",bottom:"auto",left:"auto"};function uu(t,e){var i=t.x,r=t.y,n=e.devicePixelRatio||1;return{x:Jt(i*n)/n||0,y:Jt(r*n)/n||0}}function xa(t){var e,i=t.popper,r=t.popperRect,n=t.placement,s=t.variation,a=t.offsets,o=t.position,l=t.gpuAcceleration,c=t.adaptive,d=t.roundOffsets,u=t.isFixed,f=a.x,h=f===void 0?0:f,m=a.y,g=m===void 0?0:m,y=typeof d=="function"?d({x:h,y:g}):{x:h,y:g};h=y.x,g=y.y;var p=a.hasOwnProperty("x"),_=a.hasOwnProperty("y"),M=Y,v=X,w=window;if(c){var S=Di(i),C="clientHeight",P="clientWidth";if(S===ae(i)&&(S=st(i),Ue(S).position!=="static"&&o==="absolute"&&(C="scrollHeight",P="scrollWidth")),S=S,n===X||(n===Y||n===ye)&&s===Ni){v=me;var k=u&&S===w&&w.visualViewport?w.visualViewport.height:S[C];g-=k-r.height,g*=l?1:-1}if(n===Y||(n===X||n===me)&&s===Ni){M=ye;var N=u&&S===w&&w.visualViewport?w.visualViewport.width:S[P];h-=N-r.width,h*=l?1:-1}}var L=Object.assign({position:o},c&&cu),x=d===!0?uu({x:h,y:g},ae(i)):{x:h,y:g};if(h=x.x,g=x.y,l){var T;return Object.assign({},L,(T={},T[v]=_?"0":"",T[M]=p?"0":"",T.transform=(w.devicePixelRatio||1)<=1?"translate("+h+"px, "+g+"px)":"translate3d("+h+"px, "+g+"px, 0)",T))}return Object.assign({},L,(e={},e[v]=_?g+"px":"",e[M]=p?h+"px":"",e.transform="",e))}function hu(t){var e=t.state,i=t.options,r=i.gpuAcceleration,n=r===void 0?!0:r,s=i.adaptive,a=s===void 0?!0:s,o=i.roundOffsets,l=o===void 0?!0:o,c={placement:ke(e.placement),variation:Yt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:n,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,xa(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:a,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,xa(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const fu={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:hu,data:{}};var Yi={passive:!0};function pu(t){var e=t.state,i=t.instance,r=t.options,n=r.scroll,s=n===void 0?!0:n,a=r.resize,o=a===void 0?!0:a,l=ae(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&c.forEach(function(d){d.addEventListener("scroll",i.update,Yi)}),o&&l.addEventListener("resize",i.update,Yi),function(){s&&c.forEach(function(d){d.removeEventListener("scroll",i.update,Yi)}),o&&l.removeEventListener("resize",i.update,Yi)}}const mu={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:pu,data:{}};var yu={left:"right",right:"left",bottom:"top",top:"bottom"};function cr(t){return t.replace(/left|right|bottom|top/g,function(e){return yu[e]})}var gu={start:"end",end:"start"};function La(t){return t.replace(/start|end/g,function(e){return gu[e]})}function bs(t){var e=ae(t),i=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:i,scrollTop:r}}function Ms(t){return Xt(st(t)).left+bs(t).scrollLeft}function vu(t,e){var i=ae(t),r=st(t),n=i.visualViewport,s=r.clientWidth,a=r.clientHeight,o=0,l=0;if(n){s=n.width,a=n.height;var c=il();(c||!c&&e==="fixed")&&(o=n.offsetLeft,l=n.offsetTop)}return{width:s,height:a,x:o+Ms(t),y:l}}function _u(t){var e,i=st(t),r=bs(t),n=(e=t.ownerDocument)==null?void 0:e.body,s=Mt(i.scrollWidth,i.clientWidth,n?n.scrollWidth:0,n?n.clientWidth:0),a=Mt(i.scrollHeight,i.clientHeight,n?n.scrollHeight:0,n?n.clientHeight:0),o=-r.scrollLeft+Ms(t),l=-r.scrollTop;return Ue(n||i).direction==="rtl"&&(o+=Mt(i.clientWidth,n?n.clientWidth:0)-s),{width:s,height:a,x:o,y:l}}function ws(t){var e=Ue(t),i=e.overflow,r=e.overflowX,n=e.overflowY;return/auto|scroll|overlay|hidden/.test(i+n+r)}function ol(t){return["html","body","#document"].indexOf(Ee(t))>=0?t.ownerDocument.body:fe(t)&&ws(t)?t:ol(Jr(t))}function vi(t,e){var i;e===void 0&&(e=[]);var r=ol(t),n=r===((i=t.ownerDocument)==null?void 0:i.body),s=ae(r),a=n?[s].concat(s.visualViewport||[],ws(r)?r:[]):r,o=e.concat(a);return n?o:o.concat(vi(Jr(a)))}function $n(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function bu(t,e){var i=Xt(t,!1,e==="fixed");return i.top=i.top+t.clientTop,i.left=i.left+t.clientLeft,i.bottom=i.top+t.clientHeight,i.right=i.left+t.clientWidth,i.width=t.clientWidth,i.height=t.clientHeight,i.x=i.left,i.y=i.top,i}function Ea(t,e,i){return e===el?$n(vu(t,i)):Ct(e)?bu(e,i):$n(_u(st(t)))}function Mu(t){var e=vi(Jr(t)),i=["absolute","fixed"].indexOf(Ue(t).position)>=0,r=i&&fe(t)?Di(t):t;return Ct(r)?e.filter(function(n){return Ct(n)&&rl(n,r)&&Ee(n)!=="body"}):[]}function wu(t,e,i,r){var n=e==="clippingParents"?Mu(t):[].concat(e),s=[].concat(n,[i]),a=s[0],o=s.reduce(function(l,c){var d=Ea(t,c,r);return l.top=Mt(d.top,l.top),l.right=Nr(d.right,l.right),l.bottom=Nr(d.bottom,l.bottom),l.left=Mt(d.left,l.left),l},Ea(t,a,r));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function ll(t){var e=t.reference,i=t.element,r=t.placement,n=r?ke(r):null,s=r?Yt(r):null,a=e.x+e.width/2-i.width/2,o=e.y+e.height/2-i.height/2,l;switch(n){case X:l={x:a,y:e.y-i.height};break;case me:l={x:a,y:e.y+e.height};break;case ye:l={x:e.x+e.width,y:o};break;case Y:l={x:e.x-i.width,y:o};break;default:l={x:e.x,y:e.y}}var c=n?_s(n):null;if(c!=null){var d=c==="y"?"height":"width";switch(s){case Wt:l[c]=l[c]-(e[d]/2-i[d]/2);break;case Ni:l[c]=l[c]+(e[d]/2-i[d]/2);break}}return l}function ki(t,e){e===void 0&&(e={});var i=e,r=i.placement,n=r===void 0?t.placement:r,s=i.strategy,a=s===void 0?t.strategy:s,o=i.boundary,l=o===void 0?qc:o,c=i.rootBoundary,d=c===void 0?el:c,u=i.elementContext,f=u===void 0?ri:u,h=i.altBoundary,m=h===void 0?!1:h,g=i.padding,y=g===void 0?0:g,p=sl(typeof y!="number"?y:al(y,Oi)),_=f===ri?jc:ri,M=t.rects.popper,v=t.elements[m?_:f],w=wu(Ct(v)?v:v.contextElement||st(t.elements.popper),l,d,a),S=Xt(t.elements.reference),C=ll({reference:S,element:M,placement:n}),P=$n(Object.assign({},M,C)),k=f===ri?P:S,N={top:w.top-k.top+p.top,bottom:k.bottom-w.bottom+p.bottom,left:w.left-k.left+p.left,right:k.right-w.right+p.right},L=t.modifiersData.offset;if(f===ri&&L){var x=L[n];Object.keys(N).forEach(function(T){var F=[ye,me].indexOf(T)>=0?1:-1,B=[X,me].indexOf(T)>=0?"y":"x";N[T]+=x[B]*F})}return N}function Su(t,e){e===void 0&&(e={});var i=e,r=i.placement,n=i.boundary,s=i.rootBoundary,a=i.padding,o=i.flipVariations,l=i.allowedAutoPlacements,c=l===void 0?tl:l,d=Yt(r),u=d?o?Na:Na.filter(function(m){return Yt(m)===d}):Oi,f=u.filter(function(m){return c.indexOf(m)>=0});f.length===0&&(f=u);var h=f.reduce(function(m,g){return m[g]=ki(t,{placement:g,boundary:n,rootBoundary:s,padding:a})[ke(g)],m},{});return Object.keys(h).sort(function(m,g){return h[m]-h[g]})}function Cu(t){if(ke(t)===ys)return[];var e=cr(t);return[La(t),e,La(e)]}function Pu(t){var e=t.state,i=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var n=i.mainAxis,s=n===void 0?!0:n,a=i.altAxis,o=a===void 0?!0:a,l=i.fallbackPlacements,c=i.padding,d=i.boundary,u=i.rootBoundary,f=i.altBoundary,h=i.flipVariations,m=h===void 0?!0:h,g=i.allowedAutoPlacements,y=e.options.placement,p=ke(y),_=p===y,M=l||(_||!m?[cr(y)]:Cu(y)),v=[y].concat(M).reduce(function(Ve,Me){return Ve.concat(ke(Me)===ys?Su(e,{placement:Me,boundary:d,rootBoundary:u,padding:c,flipVariations:m,allowedAutoPlacements:g}):Me)},[]),w=e.rects.reference,S=e.rects.popper,C=new Map,P=!0,k=v[0],N=0;N<v.length;N++){var L=v[N],x=ke(L),T=Yt(L)===Wt,F=[X,me].indexOf(x)>=0,B=F?"width":"height",O=ki(e,{placement:L,boundary:d,rootBoundary:u,altBoundary:f,padding:c}),G=F?T?ye:Y:T?me:X;w[B]>S[B]&&(G=cr(G));var le=cr(G),ie=[];if(s&&ie.push(O[x]<=0),o&&ie.push(O[G]<=0,O[le]<=0),ie.every(function(Ve){return Ve})){k=L,P=!1;break}C.set(L,ie)}if(P)for(var de=m?3:1,ze=function(Me){var ii=v.find(function(Ji){var ot=C.get(Ji);if(ot)return ot.slice(0,Me).every(function(hn){return hn})});if(ii)return k=ii,"break"},at=de;at>0;at--){var It=ze(at);if(It==="break")break}e.placement!==k&&(e.modifiersData[r]._skip=!0,e.placement=k,e.reset=!0)}}const Nu={name:"flip",enabled:!0,phase:"main",fn:Pu,requiresIfExists:["offset"],data:{_skip:!1}};function Aa(t,e,i){return i===void 0&&(i={x:0,y:0}),{top:t.top-e.height-i.y,right:t.right-e.width+i.x,bottom:t.bottom-e.height+i.y,left:t.left-e.width-i.x}}function Ba(t){return[X,ye,me,Y].some(function(e){return t[e]>=0})}function ku(t){var e=t.state,i=t.name,r=e.rects.reference,n=e.rects.popper,s=e.modifiersData.preventOverflow,a=ki(e,{elementContext:"reference"}),o=ki(e,{altBoundary:!0}),l=Aa(a,r),c=Aa(o,n,s),d=Ba(l),u=Ba(c);e.modifiersData[i]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:d,hasPopperEscaped:u},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":u})}const xu={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:ku};function Lu(t,e,i){var r=ke(t),n=[Y,X].indexOf(r)>=0?-1:1,s=typeof i=="function"?i(Object.assign({},e,{placement:t})):i,a=s[0],o=s[1];return a=a||0,o=(o||0)*n,[Y,ye].indexOf(r)>=0?{x:o,y:a}:{x:a,y:o}}function Eu(t){var e=t.state,i=t.options,r=t.name,n=i.offset,s=n===void 0?[0,0]:n,a=tl.reduce(function(d,u){return d[u]=Lu(u,e.rects,s),d},{}),o=a[e.placement],l=o.x,c=o.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[r]=a}const Au={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Eu};function Bu(t){var e=t.state,i=t.name;e.modifiersData[i]=ll({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Tu={name:"popperOffsets",enabled:!0,phase:"read",fn:Bu,data:{}};function Iu(t){return t==="x"?"y":"x"}function Gu(t){var e=t.state,i=t.options,r=t.name,n=i.mainAxis,s=n===void 0?!0:n,a=i.altAxis,o=a===void 0?!1:a,l=i.boundary,c=i.rootBoundary,d=i.altBoundary,u=i.padding,f=i.tether,h=f===void 0?!0:f,m=i.tetherOffset,g=m===void 0?0:m,y=ki(e,{boundary:l,rootBoundary:c,padding:u,altBoundary:d}),p=ke(e.placement),_=Yt(e.placement),M=!_,v=_s(p),w=Iu(v),S=e.modifiersData.popperOffsets,C=e.rects.reference,P=e.rects.popper,k=typeof g=="function"?g(Object.assign({},e.rects,{placement:e.placement})):g,N=typeof k=="number"?{mainAxis:k,altAxis:k}:Object.assign({mainAxis:0,altAxis:0},k),L=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,x={x:0,y:0};if(S){if(s){var T,F=v==="y"?X:Y,B=v==="y"?me:ye,O=v==="y"?"height":"width",G=S[v],le=G+y[F],ie=G-y[B],de=h?-P[O]/2:0,ze=_===Wt?C[O]:P[O],at=_===Wt?-P[O]:-C[O],It=e.elements.arrow,Ve=h&&It?vs(It):{width:0,height:0},Me=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:nl(),ii=Me[F],Ji=Me[B],ot=gi(0,C[O],Ve[O]),hn=M?C[O]/2-de-ot-ii-N.mainAxis:ze-ot-ii-N.mainAxis,Ec=M?-C[O]/2+de+ot+Ji+N.mainAxis:at+ot+Ji+N.mainAxis,fn=e.elements.arrow&&Di(e.elements.arrow),Ac=fn?v==="y"?fn.clientTop||0:fn.clientLeft||0:0,ma=(T=L==null?void 0:L[v])!=null?T:0,Bc=G+hn-ma-Ac,Tc=G+Ec-ma,ya=gi(h?Nr(le,Bc):le,G,h?Mt(ie,Tc):ie);S[v]=ya,x[v]=ya-G}if(o){var ga,Ic=v==="x"?X:Y,Gc=v==="x"?me:ye,lt=S[w],Xi=w==="y"?"height":"width",va=lt+y[Ic],_a=lt-y[Gc],pn=[X,Y].indexOf(p)!==-1,ba=(ga=L==null?void 0:L[w])!=null?ga:0,Ma=pn?va:lt-C[Xi]-P[Xi]-ba+N.altAxis,wa=pn?lt+C[Xi]+P[Xi]-ba-N.altAxis:_a,Sa=h&&pn?su(Ma,lt,wa):gi(h?Ma:va,lt,h?wa:_a);S[w]=Sa,x[w]=Sa-lt}e.modifiersData[r]=x}}const Ou={name:"preventOverflow",enabled:!0,phase:"main",fn:Gu,requiresIfExists:["offset"]};function Du(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function Fu(t){return t===ae(t)||!fe(t)?bs(t):Du(t)}function Ru(t){var e=t.getBoundingClientRect(),i=Jt(e.width)/t.offsetWidth||1,r=Jt(e.height)/t.offsetHeight||1;return i!==1||r!==1}function Uu(t,e,i){i===void 0&&(i=!1);var r=fe(e),n=fe(e)&&Ru(e),s=st(e),a=Xt(t,n,i),o={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!i)&&((Ee(e)!=="body"||ws(s))&&(o=Fu(e)),fe(e)?(l=Xt(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):s&&(l.x=Ms(s))),{x:a.left+o.scrollLeft-l.x,y:a.top+o.scrollTop-l.y,width:a.width,height:a.height}}function Hu(t){var e=new Map,i=new Set,r=[];t.forEach(function(s){e.set(s.name,s)});function n(s){i.add(s.name);var a=[].concat(s.requires||[],s.requiresIfExists||[]);a.forEach(function(o){if(!i.has(o)){var l=e.get(o);l&&n(l)}}),r.push(s)}return t.forEach(function(s){i.has(s.name)||n(s)}),r}function qu(t){var e=Hu(t);return Qc.reduce(function(i,r){return i.concat(e.filter(function(n){return n.phase===r}))},[])}function ju(t){var e;return function(){return e||(e=new Promise(function(i){Promise.resolve().then(function(){e=void 0,i(t())})})),e}}function Ku(t){var e=t.reduce(function(i,r){var n=i[r.name];return i[r.name]=n?Object.assign({},n,r,{options:Object.assign({},n.options,r.options),data:Object.assign({},n.data,r.data)}):r,i},{});return Object.keys(e).map(function(i){return e[i]})}var Ta={placement:"bottom",modifiers:[],strategy:"absolute"};function Ia(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function $u(t){t===void 0&&(t={});var e=t,i=e.defaultModifiers,r=i===void 0?[]:i,n=e.defaultOptions,s=n===void 0?Ta:n;return function(o,l,c){c===void 0&&(c=s);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},Ta,s),modifiersData:{},elements:{reference:o,popper:l},attributes:{},styles:{}},u=[],f=!1,h={state:d,setOptions:function(p){var _=typeof p=="function"?p(d.options):p;g(),d.options=Object.assign({},s,d.options,_),d.scrollParents={reference:Ct(o)?vi(o):o.contextElement?vi(o.contextElement):[],popper:vi(l)};var M=qu(Ku([].concat(r,d.options.modifiers)));return d.orderedModifiers=M.filter(function(v){return v.enabled}),m(),h.update()},forceUpdate:function(){if(!f){var p=d.elements,_=p.reference,M=p.popper;if(Ia(_,M)){d.rects={reference:Uu(_,Di(M),d.options.strategy==="fixed"),popper:vs(M)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(N){return d.modifiersData[N.name]=Object.assign({},N.data)});for(var v=0;v<d.orderedModifiers.length;v++){if(d.reset===!0){d.reset=!1,v=-1;continue}var w=d.orderedModifiers[v],S=w.fn,C=w.options,P=C===void 0?{}:C,k=w.name;typeof S=="function"&&(d=S({state:d,options:P,name:k,instance:h})||d)}}}},update:ju(function(){return new Promise(function(y){h.forceUpdate(),y(d)})}),destroy:function(){g(),f=!0}};if(!Ia(o,l))return h;h.setOptions(c).then(function(y){!f&&c.onFirstUpdate&&c.onFirstUpdate(y)});function m(){d.orderedModifiers.forEach(function(y){var p=y.name,_=y.options,M=_===void 0?{}:_,v=y.effect;if(typeof v=="function"){var w=v({state:d,name:p,instance:h,options:M}),S=function(){};u.push(w||S)}})}function g(){u.forEach(function(y){return y()}),u=[]}return h}}var zu=[mu,Tu,fu,iu,Au,Nu,Ou,du,xu],Ss=$u({defaultModifiers:zu}),Je=function(){return Je=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++){e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},Je.apply(this,arguments)},Zi=function(t,e,i){if(i||arguments.length===2)for(var r=0,n=e.length,s;r<n;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))},Xe={placement:"bottom",triggerType:"click",offsetSkidding:0,offsetDistance:10,delay:300,ignoreClickOutsideClass:!1,onShow:function(){},onHide:function(){},onToggle:function(){}},Vu={id:null,override:!0},dl=function(){function t(e,i,r,n){e===void 0&&(e=null),i===void 0&&(i=null),r===void 0&&(r=Xe),n===void 0&&(n=Vu),this._instanceId=n.id?n.id:e.id,this._targetEl=e,this._triggerEl=i,this._options=Je(Je({},Xe),r),this._popperInstance=null,this._visible=!1,this._initialized=!1,this.init(),I.addInstance("Dropdown",this,this._instanceId,n.override)}return t.prototype.init=function(){this._triggerEl&&this._targetEl&&!this._initialized&&(this._popperInstance=this._createPopperInstance(),this._setupEventListeners(),this._initialized=!0)},t.prototype.destroy=function(){var e=this,i=this._getTriggerEvents();this._options.triggerType==="click"&&i.showEvents.forEach(function(r){e._triggerEl.removeEventListener(r,e._clickHandler)}),this._options.triggerType==="hover"&&(i.showEvents.forEach(function(r){e._triggerEl.removeEventListener(r,e._hoverShowTriggerElHandler),e._targetEl.removeEventListener(r,e._hoverShowTargetElHandler)}),i.hideEvents.forEach(function(r){e._triggerEl.removeEventListener(r,e._hoverHideHandler),e._targetEl.removeEventListener(r,e._hoverHideHandler)})),this._popperInstance.destroy(),this._initialized=!1},t.prototype.removeInstance=function(){I.removeInstance("Dropdown",this._instanceId)},t.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},t.prototype._setupEventListeners=function(){var e=this,i=this._getTriggerEvents();this._clickHandler=function(){e.toggle()},this._options.triggerType==="click"&&i.showEvents.forEach(function(r){e._triggerEl.addEventListener(r,e._clickHandler)}),this._hoverShowTriggerElHandler=function(r){r.type==="click"?e.toggle():setTimeout(function(){e.show()},e._options.delay)},this._hoverShowTargetElHandler=function(){e.show()},this._hoverHideHandler=function(){setTimeout(function(){e._targetEl.matches(":hover")||e.hide()},e._options.delay)},this._options.triggerType==="hover"&&(i.showEvents.forEach(function(r){e._triggerEl.addEventListener(r,e._hoverShowTriggerElHandler),e._targetEl.addEventListener(r,e._hoverShowTargetElHandler)}),i.hideEvents.forEach(function(r){e._triggerEl.addEventListener(r,e._hoverHideHandler),e._targetEl.addEventListener(r,e._hoverHideHandler)}))},t.prototype._createPopperInstance=function(){return Ss(this._triggerEl,this._targetEl,{placement:this._options.placement,modifiers:[{name:"offset",options:{offset:[this._options.offsetSkidding,this._options.offsetDistance]}}]})},t.prototype._setupClickOutsideListener=function(){var e=this;this._clickOutsideEventListener=function(i){e._handleClickOutside(i,e._targetEl)},document.body.addEventListener("click",this._clickOutsideEventListener,!0)},t.prototype._removeClickOutsideListener=function(){document.body.removeEventListener("click",this._clickOutsideEventListener,!0)},t.prototype._handleClickOutside=function(e,i){var r=e.target,n=this._options.ignoreClickOutsideClass,s=!1;if(n){var a=document.querySelectorAll(".".concat(n));a.forEach(function(o){if(o.contains(r)){s=!0;return}})}r!==i&&!i.contains(r)&&!this._triggerEl.contains(r)&&!s&&this.isVisible()&&this.hide()},t.prototype._getTriggerEvents=function(){switch(this._options.triggerType){case"hover":return{showEvents:["mouseenter","click"],hideEvents:["mouseleave"]};case"click":return{showEvents:["click"],hideEvents:[]};case"none":return{showEvents:[],hideEvents:[]};default:return{showEvents:["click"],hideEvents:[]}}},t.prototype.toggle=function(){this.isVisible()?this.hide():this.show(),this._options.onToggle(this)},t.prototype.isVisible=function(){return this._visible},t.prototype.show=function(){this._targetEl.classList.remove("hidden"),this._targetEl.classList.add("block"),this._targetEl.removeAttribute("aria-hidden"),this._popperInstance.setOptions(function(e){return Je(Je({},e),{modifiers:Zi(Zi([],e.modifiers,!0),[{name:"eventListeners",enabled:!0}],!1)})}),this._setupClickOutsideListener(),this._popperInstance.update(),this._visible=!0,this._options.onShow(this)},t.prototype.hide=function(){this._targetEl.classList.remove("block"),this._targetEl.classList.add("hidden"),this._targetEl.setAttribute("aria-hidden","true"),this._popperInstance.setOptions(function(e){return Je(Je({},e),{modifiers:Zi(Zi([],e.modifiers,!0),[{name:"eventListeners",enabled:!1}],!1)})}),this._visible=!1,this._removeClickOutsideListener(),this._options.onHide(this)},t.prototype.updateOnShow=function(e){this._options.onShow=e},t.prototype.updateOnHide=function(e){this._options.onHide=e},t.prototype.updateOnToggle=function(e){this._options.onToggle=e},t}();function Cs(){document.querySelectorAll("[data-dropdown-toggle]").forEach(function(t){var e=t.getAttribute("data-dropdown-toggle"),i=document.getElementById(e);if(i){var r=t.getAttribute("data-dropdown-placement"),n=t.getAttribute("data-dropdown-offset-skidding"),s=t.getAttribute("data-dropdown-offset-distance"),a=t.getAttribute("data-dropdown-trigger"),o=t.getAttribute("data-dropdown-delay"),l=t.getAttribute("data-dropdown-ignore-click-outside-class");new dl(i,t,{placement:r||Xe.placement,triggerType:a||Xe.triggerType,offsetSkidding:n?parseInt(n):Xe.offsetSkidding,offsetDistance:s?parseInt(s):Xe.offsetDistance,delay:o?parseInt(o):Xe.delay,ignoreClickOutsideClass:l||Xe.ignoreClickOutsideClass})}else console.error('The dropdown element with id "'.concat(e,'" does not exist. Please check the data-dropdown-toggle attribute.'))})}typeof window<"u"&&(window.Dropdown=dl,window.initDropdowns=Cs);var kr=function(){return kr=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++){e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},kr.apply(this,arguments)},xr={placement:"center",backdropClasses:"bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40",backdrop:"dynamic",closable:!0,onHide:function(){},onShow:function(){},onToggle:function(){}},Wu={id:null,override:!0},cl=function(){function t(e,i,r){e===void 0&&(e=null),i===void 0&&(i=xr),r===void 0&&(r=Wu),this._eventListenerInstances=[],this._instanceId=r.id?r.id:e.id,this._targetEl=e,this._options=kr(kr({},xr),i),this._isHidden=!0,this._backdropEl=null,this._initialized=!1,this.init(),I.addInstance("Modal",this,this._instanceId,r.override)}return t.prototype.init=function(){var e=this;this._targetEl&&!this._initialized&&(this._getPlacementClasses().map(function(i){e._targetEl.classList.add(i)}),this._initialized=!0)},t.prototype.destroy=function(){this._initialized&&(this.removeAllEventListenerInstances(),this._destroyBackdropEl(),this._initialized=!1)},t.prototype.removeInstance=function(){I.removeInstance("Modal",this._instanceId)},t.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},t.prototype._createBackdrop=function(){var e;if(this._isHidden){var i=document.createElement("div");(e=i.classList).add.apply(e,this._options.backdropClasses.split(" ")),document.querySelector("body").append(i),this._backdropEl=i}},t.prototype._destroyBackdropEl=function(){!this._isHidden&&this._backdropEl&&(this._backdropEl.remove(),this._backdropEl=null)},t.prototype._setupModalCloseEventListeners=function(){var e=this;this._options.backdrop==="dynamic"&&(this._clickOutsideEventListener=function(i){e._handleOutsideClick(i.target)},this._targetEl.addEventListener("click",this._clickOutsideEventListener,!0)),this._keydownEventListener=function(i){i.key==="Escape"&&e.hide()},document.body.addEventListener("keydown",this._keydownEventListener,!0)},t.prototype._removeModalCloseEventListeners=function(){this._options.backdrop==="dynamic"&&this._targetEl.removeEventListener("click",this._clickOutsideEventListener,!0),document.body.removeEventListener("keydown",this._keydownEventListener,!0)},t.prototype._handleOutsideClick=function(e){(e===this._targetEl||e===this._backdropEl&&this.isVisible())&&this.hide()},t.prototype._getPlacementClasses=function(){switch(this._options.placement){case"top-left":return["justify-start","items-start"];case"top-center":return["justify-center","items-start"];case"top-right":return["justify-end","items-start"];case"center-left":return["justify-start","items-center"];case"center":return["justify-center","items-center"];case"center-right":return["justify-end","items-center"];case"bottom-left":return["justify-start","items-end"];case"bottom-center":return["justify-center","items-end"];case"bottom-right":return["justify-end","items-end"];default:return["justify-center","items-center"]}},t.prototype.toggle=function(){this._isHidden?this.show():this.hide(),this._options.onToggle(this)},t.prototype.show=function(){this.isHidden&&(this._targetEl.classList.add("flex"),this._targetEl.classList.remove("hidden"),this._targetEl.setAttribute("aria-modal","true"),this._targetEl.setAttribute("role","dialog"),this._targetEl.removeAttribute("aria-hidden"),this._createBackdrop(),this._isHidden=!1,this._options.closable&&this._setupModalCloseEventListeners(),document.body.classList.add("overflow-hidden"),this._options.onShow(this))},t.prototype.hide=function(){this.isVisible&&(this._targetEl.classList.add("hidden"),this._targetEl.classList.remove("flex"),this._targetEl.setAttribute("aria-hidden","true"),this._targetEl.removeAttribute("aria-modal"),this._targetEl.removeAttribute("role"),this._destroyBackdropEl(),this._isHidden=!0,document.body.classList.remove("overflow-hidden"),this._options.closable&&this._removeModalCloseEventListeners(),this._options.onHide(this))},t.prototype.isVisible=function(){return!this._isHidden},t.prototype.isHidden=function(){return this._isHidden},t.prototype.addEventListenerInstance=function(e,i,r){this._eventListenerInstances.push({element:e,type:i,handler:r})},t.prototype.removeAllEventListenerInstances=function(){this._eventListenerInstances.map(function(e){e.element.removeEventListener(e.type,e.handler)}),this._eventListenerInstances=[]},t.prototype.getAllEventListenerInstances=function(){return this._eventListenerInstances},t.prototype.updateOnShow=function(e){this._options.onShow=e},t.prototype.updateOnHide=function(e){this._options.onHide=e},t.prototype.updateOnToggle=function(e){this._options.onToggle=e},t}();function Ps(){document.querySelectorAll("[data-modal-target]").forEach(function(t){var e=t.getAttribute("data-modal-target"),i=document.getElementById(e);if(i){var r=i.getAttribute("data-modal-placement"),n=i.getAttribute("data-modal-backdrop");new cl(i,{placement:r||xr.placement,backdrop:n||xr.backdrop})}else console.error("Modal with id ".concat(e," does not exist. Are you sure that the data-modal-target attribute points to the correct modal id?."))}),document.querySelectorAll("[data-modal-toggle]").forEach(function(t){var e=t.getAttribute("data-modal-toggle"),i=document.getElementById(e);if(i){var r=I.getInstance("Modal",e);if(r){var n=function(){r.toggle()};t.addEventListener("click",n),r.addEventListenerInstance(t,"click",n)}else console.error("Modal with id ".concat(e," has not been initialized. Please initialize it using the data-modal-target attribute."))}else console.error("Modal with id ".concat(e," does not exist. Are you sure that the data-modal-toggle attribute points to the correct modal id?"))}),document.querySelectorAll("[data-modal-show]").forEach(function(t){var e=t.getAttribute("data-modal-show"),i=document.getElementById(e);if(i){var r=I.getInstance("Modal",e);if(r){var n=function(){r.show()};t.addEventListener("click",n),r.addEventListenerInstance(t,"click",n)}else console.error("Modal with id ".concat(e," has not been initialized. Please initialize it using the data-modal-target attribute."))}else console.error("Modal with id ".concat(e," does not exist. Are you sure that the data-modal-show attribute points to the correct modal id?"))}),document.querySelectorAll("[data-modal-hide]").forEach(function(t){var e=t.getAttribute("data-modal-hide"),i=document.getElementById(e);if(i){var r=I.getInstance("Modal",e);if(r){var n=function(){r.hide()};t.addEventListener("click",n),r.addEventListenerInstance(t,"click",n)}else console.error("Modal with id ".concat(e," has not been initialized. Please initialize it using the data-modal-target attribute."))}else console.error("Modal with id ".concat(e," does not exist. Are you sure that the data-modal-hide attribute points to the correct modal id?"))})}typeof window<"u"&&(window.Modal=cl,window.initModals=Ps);var Lr=function(){return Lr=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++){e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},Lr.apply(this,arguments)},vt={placement:"left",bodyScrolling:!1,backdrop:!0,edge:!1,edgeOffset:"bottom-[60px]",backdropClasses:"bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-30",onShow:function(){},onHide:function(){},onToggle:function(){}},Ju={id:null,override:!0},Ns=function(){function t(e,i,r){e===void 0&&(e=null),i===void 0&&(i=vt),r===void 0&&(r=Ju),this._eventListenerInstances=[],this._instanceId=r.id?r.id:e.id,this._targetEl=e,this._options=Lr(Lr({},vt),i),this._visible=!1,this._initialized=!1,this.init(),I.addInstance("Drawer",this,this._instanceId,r.override)}return t.prototype.init=function(){var e=this;this._targetEl&&!this._initialized&&(this._targetEl.setAttribute("aria-hidden","true"),this._targetEl.classList.add("transition-transform"),this._getPlacementClasses(this._options.placement).base.map(function(i){e._targetEl.classList.add(i)}),this._handleEscapeKey=function(i){i.key==="Escape"&&e.isVisible()&&e.hide()},document.addEventListener("keydown",this._handleEscapeKey),this._initialized=!0)},t.prototype.destroy=function(){this._initialized&&(this.removeAllEventListenerInstances(),this._destroyBackdropEl(),document.removeEventListener("keydown",this._handleEscapeKey),this._initialized=!1)},t.prototype.removeInstance=function(){I.removeInstance("Drawer",this._instanceId)},t.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},t.prototype.hide=function(){var e=this;this._options.edge?(this._getPlacementClasses(this._options.placement+"-edge").active.map(function(i){e._targetEl.classList.remove(i)}),this._getPlacementClasses(this._options.placement+"-edge").inactive.map(function(i){e._targetEl.classList.add(i)})):(this._getPlacementClasses(this._options.placement).active.map(function(i){e._targetEl.classList.remove(i)}),this._getPlacementClasses(this._options.placement).inactive.map(function(i){e._targetEl.classList.add(i)})),this._targetEl.setAttribute("aria-hidden","true"),this._targetEl.removeAttribute("aria-modal"),this._targetEl.removeAttribute("role"),this._options.bodyScrolling||document.body.classList.remove("overflow-hidden"),this._options.backdrop&&this._destroyBackdropEl(),this._visible=!1,this._options.onHide(this)},t.prototype.show=function(){var e=this;this._options.edge?(this._getPlacementClasses(this._options.placement+"-edge").active.map(function(i){e._targetEl.classList.add(i)}),this._getPlacementClasses(this._options.placement+"-edge").inactive.map(function(i){e._targetEl.classList.remove(i)})):(this._getPlacementClasses(this._options.placement).active.map(function(i){e._targetEl.classList.add(i)}),this._getPlacementClasses(this._options.placement).inactive.map(function(i){e._targetEl.classList.remove(i)})),this._targetEl.setAttribute("aria-modal","true"),this._targetEl.setAttribute("role","dialog"),this._targetEl.removeAttribute("aria-hidden"),this._options.bodyScrolling||document.body.classList.add("overflow-hidden"),this._options.backdrop&&this._createBackdrop(),this._visible=!0,this._options.onShow(this)},t.prototype.toggle=function(){this.isVisible()?this.hide():this.show()},t.prototype._createBackdrop=function(){var e,i=this;if(!this._visible){var r=document.createElement("div");r.setAttribute("drawer-backdrop",""),(e=r.classList).add.apply(e,this._options.backdropClasses.split(" ")),document.querySelector("body").append(r),r.addEventListener("click",function(){i.hide()})}},t.prototype._destroyBackdropEl=function(){this._visible&&document.querySelector("[drawer-backdrop]")!==null&&document.querySelector("[drawer-backdrop]").remove()},t.prototype._getPlacementClasses=function(e){switch(e){case"top":return{base:["top-0","left-0","right-0"],active:["transform-none"],inactive:["-translate-y-full"]};case"right":return{base:["right-0","top-0"],active:["transform-none"],inactive:["translate-x-full"]};case"bottom":return{base:["bottom-0","left-0","right-0"],active:["transform-none"],inactive:["translate-y-full"]};case"left":return{base:["left-0","top-0"],active:["transform-none"],inactive:["-translate-x-full"]};case"bottom-edge":return{base:["left-0","top-0"],active:["transform-none"],inactive:["translate-y-full",this._options.edgeOffset]};default:return{base:["left-0","top-0"],active:["transform-none"],inactive:["-translate-x-full"]}}},t.prototype.isHidden=function(){return!this._visible},t.prototype.isVisible=function(){return this._visible},t.prototype.addEventListenerInstance=function(e,i,r){this._eventListenerInstances.push({element:e,type:i,handler:r})},t.prototype.removeAllEventListenerInstances=function(){this._eventListenerInstances.map(function(e){e.element.removeEventListener(e.type,e.handler)}),this._eventListenerInstances=[]},t.prototype.getAllEventListenerInstances=function(){return this._eventListenerInstances},t.prototype.updateOnShow=function(e){this._options.onShow=e},t.prototype.updateOnHide=function(e){this._options.onHide=e},t.prototype.updateOnToggle=function(e){this._options.onToggle=e},t}();function ks(){document.querySelectorAll("[data-drawer-target]").forEach(function(t){var e=t.getAttribute("data-drawer-target"),i=document.getElementById(e);if(i){var r=t.getAttribute("data-drawer-placement"),n=t.getAttribute("data-drawer-body-scrolling"),s=t.getAttribute("data-drawer-backdrop"),a=t.getAttribute("data-drawer-edge"),o=t.getAttribute("data-drawer-edge-offset");new Ns(i,{placement:r||vt.placement,bodyScrolling:n?n==="true":vt.bodyScrolling,backdrop:s?s==="true":vt.backdrop,edge:a?a==="true":vt.edge,edgeOffset:o||vt.edgeOffset})}else console.error("Drawer with id ".concat(e," not found. Are you sure that the data-drawer-target attribute points to the correct drawer id?"))}),document.querySelectorAll("[data-drawer-toggle]").forEach(function(t){var e=t.getAttribute("data-drawer-toggle"),i=document.getElementById(e);if(i){var r=I.getInstance("Drawer",e);if(r){var n=function(){r.toggle()};t.addEventListener("click",n),r.addEventListenerInstance(t,"click",n)}else console.error("Drawer with id ".concat(e," has not been initialized. Please initialize it using the data-drawer-target attribute."))}else console.error("Drawer with id ".concat(e," not found. Are you sure that the data-drawer-target attribute points to the correct drawer id?"))}),document.querySelectorAll("[data-drawer-dismiss], [data-drawer-hide]").forEach(function(t){var e=t.getAttribute("data-drawer-dismiss")?t.getAttribute("data-drawer-dismiss"):t.getAttribute("data-drawer-hide"),i=document.getElementById(e);if(i){var r=I.getInstance("Drawer",e);if(r){var n=function(){r.hide()};t.addEventListener("click",n),r.addEventListenerInstance(t,"click",n)}else console.error("Drawer with id ".concat(e," has not been initialized. Please initialize it using the data-drawer-target attribute."))}else console.error("Drawer with id ".concat(e," not found. Are you sure that the data-drawer-target attribute points to the correct drawer id"))}),document.querySelectorAll("[data-drawer-show]").forEach(function(t){var e=t.getAttribute("data-drawer-show"),i=document.getElementById(e);if(i){var r=I.getInstance("Drawer",e);if(r){var n=function(){r.show()};t.addEventListener("click",n),r.addEventListenerInstance(t,"click",n)}else console.error("Drawer with id ".concat(e," has not been initialized. Please initialize it using the data-drawer-target attribute."))}else console.error("Drawer with id ".concat(e," not found. Are you sure that the data-drawer-target attribute points to the correct drawer id?"))})}typeof window<"u"&&(window.Drawer=Ns,window.initDrawers=ks);var Er=function(){return Er=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++){e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},Er.apply(this,arguments)},Ar={defaultTabId:null,activeClasses:"text-blue-600 hover:text-blue-600 dark:text-blue-500 dark:hover:text-blue-500 border-blue-600 dark:border-blue-500",inactiveClasses:"dark:border-transparent text-gray-500 hover:text-gray-600 dark:text-gray-400 border-gray-100 hover:border-gray-300 dark:border-gray-700 dark:hover:text-gray-300",onShow:function(){}},Xu={id:null,override:!0},ul=function(){function t(e,i,r,n){e===void 0&&(e=null),i===void 0&&(i=[]),r===void 0&&(r=Ar),n===void 0&&(n=Xu),this._instanceId=n.id?n.id:e.id,this._tabsEl=e,this._items=i,this._activeTab=r?this.getTab(r.defaultTabId):null,this._options=Er(Er({},Ar),r),this._initialized=!1,this.init(),I.addInstance("Tabs",this,this._instanceId,n.override)}return t.prototype.init=function(){var e=this;this._items.length&&!this._initialized&&(this._activeTab||this.setActiveTab(this._items[0]),this.show(this._activeTab.id,!0),this._items.map(function(i){i.triggerEl.addEventListener("click",function(r){r.preventDefault(),e.show(i.id)})}))},t.prototype.destroy=function(){this._initialized&&(this._initialized=!1)},t.prototype.removeInstance=function(){this.destroy(),I.removeInstance("Tabs",this._instanceId)},t.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},t.prototype.getActiveTab=function(){return this._activeTab},t.prototype.setActiveTab=function(e){this._activeTab=e},t.prototype.getTab=function(e){return this._items.filter(function(i){return i.id===e})[0]},t.prototype.show=function(e,i){var r,n,s=this;i===void 0&&(i=!1);var a=this.getTab(e);a===this._activeTab&&!i||(this._items.map(function(o){var l,c;o!==a&&((l=o.triggerEl.classList).remove.apply(l,s._options.activeClasses.split(" ")),(c=o.triggerEl.classList).add.apply(c,s._options.inactiveClasses.split(" ")),o.targetEl.classList.add("hidden"),o.triggerEl.setAttribute("aria-selected","false"))}),(r=a.triggerEl.classList).add.apply(r,this._options.activeClasses.split(" ")),(n=a.triggerEl.classList).remove.apply(n,this._options.inactiveClasses.split(" ")),a.triggerEl.setAttribute("aria-selected","true"),a.targetEl.classList.remove("hidden"),this.setActiveTab(a),this._options.onShow(this,a))},t.prototype.updateOnShow=function(e){this._options.onShow=e},t}();function xs(){document.querySelectorAll("[data-tabs-toggle]").forEach(function(t){var e=[],i=t.getAttribute("data-tabs-active-classes"),r=t.getAttribute("data-tabs-inactive-classes"),n=null;t.querySelectorAll('[role="tab"]').forEach(function(s){var a=s.getAttribute("aria-selected")==="true",o={id:s.getAttribute("data-tabs-target"),triggerEl:s,targetEl:document.querySelector(s.getAttribute("data-tabs-target"))};e.push(o),a&&(n=o.id)}),new ul(t,e,{defaultTabId:n,activeClasses:i||Ar.activeClasses,inactiveClasses:r||Ar.inactiveClasses})})}typeof window<"u"&&(window.Tabs=ul,window.initTabs=xs);var Ye=function(){return Ye=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++){e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},Ye.apply(this,arguments)},Qi=function(t,e,i){if(i||arguments.length===2)for(var r=0,n=e.length,s;r<n;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))},Br={placement:"top",triggerType:"hover",onShow:function(){},onHide:function(){},onToggle:function(){}},Yu={id:null,override:!0},hl=function(){function t(e,i,r,n){e===void 0&&(e=null),i===void 0&&(i=null),r===void 0&&(r=Br),n===void 0&&(n=Yu),this._instanceId=n.id?n.id:e.id,this._targetEl=e,this._triggerEl=i,this._options=Ye(Ye({},Br),r),this._popperInstance=null,this._visible=!1,this._initialized=!1,this.init(),I.addInstance("Tooltip",this,this._instanceId,n.override)}return t.prototype.init=function(){this._triggerEl&&this._targetEl&&!this._initialized&&(this._setupEventListeners(),this._popperInstance=this._createPopperInstance(),this._initialized=!0)},t.prototype.destroy=function(){var e=this;if(this._initialized){var i=this._getTriggerEvents();i.showEvents.forEach(function(r){e._triggerEl.removeEventListener(r,e._showHandler)}),i.hideEvents.forEach(function(r){e._triggerEl.removeEventListener(r,e._hideHandler)}),this._removeKeydownListener(),this._removeClickOutsideListener(),this._popperInstance&&this._popperInstance.destroy(),this._initialized=!1}},t.prototype.removeInstance=function(){I.removeInstance("Tooltip",this._instanceId)},t.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},t.prototype._setupEventListeners=function(){var e=this,i=this._getTriggerEvents();this._showHandler=function(){e.show()},this._hideHandler=function(){e.hide()},i.showEvents.forEach(function(r){e._triggerEl.addEventListener(r,e._showHandler)}),i.hideEvents.forEach(function(r){e._triggerEl.addEventListener(r,e._hideHandler)})},t.prototype._createPopperInstance=function(){return Ss(this._triggerEl,this._targetEl,{placement:this._options.placement,modifiers:[{name:"offset",options:{offset:[0,8]}}]})},t.prototype._getTriggerEvents=function(){switch(this._options.triggerType){case"hover":return{showEvents:["mouseenter","focus"],hideEvents:["mouseleave","blur"]};case"click":return{showEvents:["click","focus"],hideEvents:["focusout","blur"]};case"none":return{showEvents:[],hideEvents:[]};default:return{showEvents:["mouseenter","focus"],hideEvents:["mouseleave","blur"]}}},t.prototype._setupKeydownListener=function(){var e=this;this._keydownEventListener=function(i){i.key==="Escape"&&e.hide()},document.body.addEventListener("keydown",this._keydownEventListener,!0)},t.prototype._removeKeydownListener=function(){document.body.removeEventListener("keydown",this._keydownEventListener,!0)},t.prototype._setupClickOutsideListener=function(){var e=this;this._clickOutsideEventListener=function(i){e._handleClickOutside(i,e._targetEl)},document.body.addEventListener("click",this._clickOutsideEventListener,!0)},t.prototype._removeClickOutsideListener=function(){document.body.removeEventListener("click",this._clickOutsideEventListener,!0)},t.prototype._handleClickOutside=function(e,i){var r=e.target;r!==i&&!i.contains(r)&&!this._triggerEl.contains(r)&&this.isVisible()&&this.hide()},t.prototype.isVisible=function(){return this._visible},t.prototype.toggle=function(){this.isVisible()?this.hide():this.show()},t.prototype.show=function(){this._targetEl.classList.remove("opacity-0","invisible"),this._targetEl.classList.add("opacity-100","visible"),this._popperInstance.setOptions(function(e){return Ye(Ye({},e),{modifiers:Qi(Qi([],e.modifiers,!0),[{name:"eventListeners",enabled:!0}],!1)})}),this._setupClickOutsideListener(),this._setupKeydownListener(),this._popperInstance.update(),this._visible=!0,this._options.onShow(this)},t.prototype.hide=function(){this._targetEl.classList.remove("opacity-100","visible"),this._targetEl.classList.add("opacity-0","invisible"),this._popperInstance.setOptions(function(e){return Ye(Ye({},e),{modifiers:Qi(Qi([],e.modifiers,!0),[{name:"eventListeners",enabled:!1}],!1)})}),this._removeClickOutsideListener(),this._removeKeydownListener(),this._visible=!1,this._options.onHide(this)},t.prototype.updateOnShow=function(e){this._options.onShow=e},t.prototype.updateOnHide=function(e){this._options.onHide=e},t.prototype.updateOnToggle=function(e){this._options.onToggle=e},t}();function Fi(){document.querySelectorAll("[data-tooltip-target]").forEach(function(t){var e=t.getAttribute("data-tooltip-target"),i=document.getElementById(e);if(i){var r=t.getAttribute("data-tooltip-trigger"),n=t.getAttribute("data-tooltip-placement");new hl(i,t,{placement:n||Br.placement,triggerType:r||Br.triggerType})}else console.error('The tooltip element with id "'.concat(e,'" does not exist. Please check the data-tooltip-target attribute.'))})}typeof window<"u"&&(window.Tooltip=hl,window.initTooltips=Fi);var Ze=function(){return Ze=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++){e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},Ze.apply(this,arguments)},er=function(t,e,i){if(i||arguments.length===2)for(var r=0,n=e.length,s;r<n;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))},_i={placement:"top",offset:10,triggerType:"hover",onShow:function(){},onHide:function(){},onToggle:function(){}},Zu={id:null,override:!0},Ls=function(){function t(e,i,r,n){e===void 0&&(e=null),i===void 0&&(i=null),r===void 0&&(r=_i),n===void 0&&(n=Zu),this._instanceId=n.id?n.id:e.id,this._targetEl=e,this._triggerEl=i,this._options=Ze(Ze({},_i),r),this._popperInstance=null,this._visible=!1,this._initialized=!1,this.init(),I.addInstance("Popover",this,n.id?n.id:this._targetEl.id,n.override)}return t.prototype.init=function(){this._triggerEl&&this._targetEl&&!this._initialized&&(this._setupEventListeners(),this._popperInstance=this._createPopperInstance(),this._initialized=!0)},t.prototype.destroy=function(){var e=this;if(this._initialized){var i=this._getTriggerEvents();i.showEvents.forEach(function(r){e._triggerEl.removeEventListener(r,e._showHandler),e._targetEl.removeEventListener(r,e._showHandler)}),i.hideEvents.forEach(function(r){e._triggerEl.removeEventListener(r,e._hideHandler),e._targetEl.removeEventListener(r,e._hideHandler)}),this._removeKeydownListener(),this._removeClickOutsideListener(),this._popperInstance&&this._popperInstance.destroy(),this._initialized=!1}},t.prototype.removeInstance=function(){I.removeInstance("Popover",this._instanceId)},t.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},t.prototype._setupEventListeners=function(){var e=this,i=this._getTriggerEvents();this._showHandler=function(){e.show()},this._hideHandler=function(){setTimeout(function(){e._targetEl.matches(":hover")||e.hide()},100)},i.showEvents.forEach(function(r){e._triggerEl.addEventListener(r,e._showHandler),e._targetEl.addEventListener(r,e._showHandler)}),i.hideEvents.forEach(function(r){e._triggerEl.addEventListener(r,e._hideHandler),e._targetEl.addEventListener(r,e._hideHandler)})},t.prototype._createPopperInstance=function(){return Ss(this._triggerEl,this._targetEl,{placement:this._options.placement,modifiers:[{name:"offset",options:{offset:[0,this._options.offset]}}]})},t.prototype._getTriggerEvents=function(){switch(this._options.triggerType){case"hover":return{showEvents:["mouseenter","focus"],hideEvents:["mouseleave","blur"]};case"click":return{showEvents:["click","focus"],hideEvents:["focusout","blur"]};case"none":return{showEvents:[],hideEvents:[]};default:return{showEvents:["mouseenter","focus"],hideEvents:["mouseleave","blur"]}}},t.prototype._setupKeydownListener=function(){var e=this;this._keydownEventListener=function(i){i.key==="Escape"&&e.hide()},document.body.addEventListener("keydown",this._keydownEventListener,!0)},t.prototype._removeKeydownListener=function(){document.body.removeEventListener("keydown",this._keydownEventListener,!0)},t.prototype._setupClickOutsideListener=function(){var e=this;this._clickOutsideEventListener=function(i){e._handleClickOutside(i,e._targetEl)},document.body.addEventListener("click",this._clickOutsideEventListener,!0)},t.prototype._removeClickOutsideListener=function(){document.body.removeEventListener("click",this._clickOutsideEventListener,!0)},t.prototype._handleClickOutside=function(e,i){var r=e.target;r!==i&&!i.contains(r)&&!this._triggerEl.contains(r)&&this.isVisible()&&this.hide()},t.prototype.isVisible=function(){return this._visible},t.prototype.toggle=function(){this.isVisible()?this.hide():this.show(),this._options.onToggle(this)},t.prototype.show=function(){this._targetEl.classList.remove("opacity-0","invisible"),this._targetEl.classList.add("opacity-100","visible"),this._popperInstance.setOptions(function(e){return Ze(Ze({},e),{modifiers:er(er([],e.modifiers,!0),[{name:"eventListeners",enabled:!0}],!1)})}),this._setupClickOutsideListener(),this._setupKeydownListener(),this._popperInstance.update(),this._visible=!0,this._options.onShow(this)},t.prototype.hide=function(){this._targetEl.classList.remove("opacity-100","visible"),this._targetEl.classList.add("opacity-0","invisible"),this._popperInstance.setOptions(function(e){return Ze(Ze({},e),{modifiers:er(er([],e.modifiers,!0),[{name:"eventListeners",enabled:!1}],!1)})}),this._removeClickOutsideListener(),this._removeKeydownListener(),this._visible=!1,this._options.onHide(this)},t.prototype.updateOnShow=function(e){this._options.onShow=e},t.prototype.updateOnHide=function(e){this._options.onHide=e},t.prototype.updateOnToggle=function(e){this._options.onToggle=e},t}();function Es(){document.querySelectorAll("[data-popover-target]").forEach(function(t){var e=t.getAttribute("data-popover-target"),i=document.getElementById(e);if(i){var r=t.getAttribute("data-popover-trigger"),n=t.getAttribute("data-popover-placement"),s=t.getAttribute("data-popover-offset");new Ls(i,t,{placement:n||_i.placement,offset:s?parseInt(s):_i.offset,triggerType:r||_i.triggerType})}else console.error('The popover element with id "'.concat(e,'" does not exist. Please check the data-popover-target attribute.'))})}typeof window<"u"&&(window.Popover=Ls,window.initPopovers=Es);var Tr=function(){return Tr=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++){e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},Tr.apply(this,arguments)},zn={triggerType:"hover",onShow:function(){},onHide:function(){},onToggle:function(){}},Qu={id:null,override:!0},fl=function(){function t(e,i,r,n,s){e===void 0&&(e=null),i===void 0&&(i=null),r===void 0&&(r=null),n===void 0&&(n=zn),s===void 0&&(s=Qu),this._instanceId=s.id?s.id:r.id,this._parentEl=e,this._triggerEl=i,this._targetEl=r,this._options=Tr(Tr({},zn),n),this._visible=!1,this._initialized=!1,this.init(),I.addInstance("Dial",this,this._instanceId,s.override)}return t.prototype.init=function(){var e=this;if(this._triggerEl&&this._targetEl&&!this._initialized){var i=this._getTriggerEventTypes(this._options.triggerType);this._showEventHandler=function(){e.show()},i.showEvents.forEach(function(r){e._triggerEl.addEventListener(r,e._showEventHandler),e._targetEl.addEventListener(r,e._showEventHandler)}),this._hideEventHandler=function(){e._parentEl.matches(":hover")||e.hide()},i.hideEvents.forEach(function(r){e._parentEl.addEventListener(r,e._hideEventHandler)}),this._initialized=!0}},t.prototype.destroy=function(){var e=this;if(this._initialized){var i=this._getTriggerEventTypes(this._options.triggerType);i.showEvents.forEach(function(r){e._triggerEl.removeEventListener(r,e._showEventHandler),e._targetEl.removeEventListener(r,e._showEventHandler)}),i.hideEvents.forEach(function(r){e._parentEl.removeEventListener(r,e._hideEventHandler)}),this._initialized=!1}},t.prototype.removeInstance=function(){I.removeInstance("Dial",this._instanceId)},t.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},t.prototype.hide=function(){this._targetEl.classList.add("hidden"),this._triggerEl&&this._triggerEl.setAttribute("aria-expanded","false"),this._visible=!1,this._options.onHide(this)},t.prototype.show=function(){this._targetEl.classList.remove("hidden"),this._triggerEl&&this._triggerEl.setAttribute("aria-expanded","true"),this._visible=!0,this._options.onShow(this)},t.prototype.toggle=function(){this._visible?this.hide():this.show()},t.prototype.isHidden=function(){return!this._visible},t.prototype.isVisible=function(){return this._visible},t.prototype._getTriggerEventTypes=function(e){switch(e){case"hover":return{showEvents:["mouseenter","focus"],hideEvents:["mouseleave","blur"]};case"click":return{showEvents:["click","focus"],hideEvents:["focusout","blur"]};case"none":return{showEvents:[],hideEvents:[]};default:return{showEvents:["mouseenter","focus"],hideEvents:["mouseleave","blur"]}}},t.prototype.updateOnShow=function(e){this._options.onShow=e},t.prototype.updateOnHide=function(e){this._options.onHide=e},t.prototype.updateOnToggle=function(e){this._options.onToggle=e},t}();function As(){document.querySelectorAll("[data-dial-init]").forEach(function(t){var e=t.querySelector("[data-dial-toggle]");if(e){var i=e.getAttribute("data-dial-toggle"),r=document.getElementById(i);if(r){var n=e.getAttribute("data-dial-trigger");new fl(t,e,r,{triggerType:n||zn.triggerType})}else console.error("Dial with id ".concat(i," does not exist. Are you sure that the data-dial-toggle attribute points to the correct modal id?"))}else console.error("Dial with id ".concat(t.id," does not have a trigger element. Are you sure that the data-dial-toggle attribute exists?"))})}typeof window<"u"&&(window.Dial=fl,window.initDials=As);var Ir=function(){return Ir=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++){e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},Ir.apply(this,arguments)},Ga={minValue:null,maxValue:null,onIncrement:function(){},onDecrement:function(){}},eh={id:null,override:!0},pl=function(){function t(e,i,r,n,s){e===void 0&&(e=null),i===void 0&&(i=null),r===void 0&&(r=null),n===void 0&&(n=Ga),s===void 0&&(s=eh),this._instanceId=s.id?s.id:e.id,this._targetEl=e,this._incrementEl=i,this._decrementEl=r,this._options=Ir(Ir({},Ga),n),this._initialized=!1,this.init(),I.addInstance("InputCounter",this,this._instanceId,s.override)}return t.prototype.init=function(){var e=this;this._targetEl&&!this._initialized&&(this._inputHandler=function(i){{var r=i.target;/^\d*$/.test(r.value)||(r.value=r.value.replace(/[^\d]/g,"")),e._options.maxValue!==null&&parseInt(r.value)>e._options.maxValue&&(r.value=e._options.maxValue.toString()),e._options.minValue!==null&&parseInt(r.value)<e._options.minValue&&(r.value=e._options.minValue.toString())}},this._incrementClickHandler=function(){e.increment()},this._decrementClickHandler=function(){e.decrement()},this._targetEl.addEventListener("input",this._inputHandler),this._incrementEl&&this._incrementEl.addEventListener("click",this._incrementClickHandler),this._decrementEl&&this._decrementEl.addEventListener("click",this._decrementClickHandler),this._initialized=!0)},t.prototype.destroy=function(){this._targetEl&&this._initialized&&(this._targetEl.removeEventListener("input",this._inputHandler),this._incrementEl&&this._incrementEl.removeEventListener("click",this._incrementClickHandler),this._decrementEl&&this._decrementEl.removeEventListener("click",this._decrementClickHandler),this._initialized=!1)},t.prototype.removeInstance=function(){I.removeInstance("InputCounter",this._instanceId)},t.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},t.prototype.getCurrentValue=function(){return parseInt(this._targetEl.value)||0},t.prototype.increment=function(){this._options.maxValue!==null&&this.getCurrentValue()>=this._options.maxValue||(this._targetEl.value=(this.getCurrentValue()+1).toString(),this._options.onIncrement(this))},t.prototype.decrement=function(){this._options.minValue!==null&&this.getCurrentValue()<=this._options.minValue||(this._targetEl.value=(this.getCurrentValue()-1).toString(),this._options.onDecrement(this))},t.prototype.updateOnIncrement=function(e){this._options.onIncrement=e},t.prototype.updateOnDecrement=function(e){this._options.onDecrement=e},t}();function Bs(){document.querySelectorAll("[data-input-counter]").forEach(function(t){var e=t.id,i=document.querySelector('[data-input-counter-increment="'+e+'"]'),r=document.querySelector('[data-input-counter-decrement="'+e+'"]'),n=t.getAttribute("data-input-counter-min"),s=t.getAttribute("data-input-counter-max");t?I.instanceExists("InputCounter",t.getAttribute("id"))||new pl(t,i||null,r||null,{minValue:n?parseInt(n):null,maxValue:s?parseInt(s):null}):console.error('The target element with id "'.concat(e,'" does not exist. Please check the data-input-counter attribute.'))})}typeof window<"u"&&(window.InputCounter=pl,window.initInputCounters=Bs);var Gr=function(){return Gr=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++){e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},Gr.apply(this,arguments)},Or={htmlEntities:!1,contentType:"input",onCopy:function(){}},th={id:null,override:!0},ml=function(){function t(e,i,r,n){e===void 0&&(e=null),i===void 0&&(i=null),r===void 0&&(r=Or),n===void 0&&(n=th),this._instanceId=n.id?n.id:i.id,this._triggerEl=e,this._targetEl=i,this._options=Gr(Gr({},Or),r),this._initialized=!1,this.init(),I.addInstance("CopyClipboard",this,this._instanceId,n.override)}return t.prototype.init=function(){var e=this;this._targetEl&&this._triggerEl&&!this._initialized&&(this._triggerElClickHandler=function(){e.copy()},this._triggerEl&&this._triggerEl.addEventListener("click",this._triggerElClickHandler),this._initialized=!0)},t.prototype.destroy=function(){this._triggerEl&&this._targetEl&&this._initialized&&(this._triggerEl&&this._triggerEl.removeEventListener("click",this._triggerElClickHandler),this._initialized=!1)},t.prototype.removeInstance=function(){I.removeInstance("CopyClipboard",this._instanceId)},t.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},t.prototype.getTargetValue=function(){if(this._options.contentType==="input")return this._targetEl.value;if(this._options.contentType==="innerHTML")return this._targetEl.innerHTML;if(this._options.contentType==="textContent")return this._targetEl.textContent.replace(/\s+/g," ").trim()},t.prototype.copy=function(){var e=this.getTargetValue();this._options.htmlEntities&&(e=this.decodeHTML(e));var i=document.createElement("textarea");return i.value=e,document.body.appendChild(i),i.select(),document.execCommand("copy"),document.body.removeChild(i),this._options.onCopy(this),e},t.prototype.decodeHTML=function(e){var i=document.createElement("textarea");return i.innerHTML=e,i.textContent},t.prototype.updateOnCopyCallback=function(e){this._options.onCopy=e},t}();function Ts(){document.querySelectorAll("[data-copy-to-clipboard-target]").forEach(function(t){var e=t.getAttribute("data-copy-to-clipboard-target"),i=document.getElementById(e),r=t.getAttribute("data-copy-to-clipboard-content-type"),n=t.getAttribute("data-copy-to-clipboard-html-entities");i?I.instanceExists("CopyClipboard",i.getAttribute("id"))||new ml(t,i,{htmlEntities:n&&n==="true"?!0:Or.htmlEntities,contentType:r||Or.contentType}):console.error('The target element with id "'.concat(e,'" does not exist. Please check the data-copy-to-clipboard-target attribute.'))})}typeof window<"u"&&(window.CopyClipboard=ml,window.initClipboards=Ts);function Vn(t,e){(e==null||e>t.length)&&(e=t.length);for(var i=0,r=Array(e);i<e;i++)r[i]=t[i];return r}function ih(t){if(Array.isArray(t))return t}function rh(t){if(Array.isArray(t))return Vn(t)}function nh(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Is(t,e,i){return e=rt(e),dh(t,yl()?Reflect.construct(e,i||[],rt(t).constructor):e.apply(t,i))}function kt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Oa(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,hh(r.key),r)}}function xt(t,e,i){return e&&Oa(t.prototype,e),i&&Oa(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function xi(){return xi=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(t,e,i){var r=ch(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(arguments.length<3?t:i):n.value}},xi.apply(null,arguments)}function rt(t){return rt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},rt(t)}function Gs(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wn(t,e)}function yl(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yl=function(){return!!t})()}function sh(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ah(t,e){var i=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(i!=null){var r,n,s,a,o=[],l=!0,c=!1;try{if(s=(i=i.call(t)).next,e===0){if(Object(i)!==i)return;l=!1}else for(;!(l=(r=s.call(i)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(d){c=!0,n=d}finally{try{if(!l&&i.return!=null&&(a=i.return(),Object(a)!==a))return}finally{if(c)throw n}}return o}}function oh(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lh(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dh(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nh(t)}function Wn(t,e){return Wn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},Wn(t,e)}function se(t,e){return ih(t)||ah(t,e)||gl(t,e)||oh()}function ch(t,e){for(;!{}.hasOwnProperty.call(t,e)&&(t=rt(t))!==null;);return t}function Ri(t){return rh(t)||sh(t)||gl(t)||lh()}function uh(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function hh(t){var e=uh(t,"string");return typeof e=="symbol"?e:e+""}function Dr(t){"@babel/helpers - typeof";return Dr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dr(t)}function gl(t,e){if(t){if(typeof t=="string")return Vn(t,e);var i={}.toString.call(t).slice(8,-1);return i==="Object"&&t.constructor&&(i=t.constructor.name),i==="Map"||i==="Set"?Array.from(t):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Vn(t,e):void 0}}function He(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Os(t){return t[t.length-1]}function Pt(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];return i.forEach(function(n){t.includes(n)||t.push(n)}),t}function mn(t,e){return t?t.split(e):[]}function Ds(t,e,i){var r=e===void 0||t>=e,n=i===void 0||t<=i;return r&&n}function vl(t,e,i){return t<e?e:t>i?i:t}function Zt(t,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",s=Object.keys(i).reduce(function(o,l){var c=i[l];return typeof c=="function"&&(c=c(r)),"".concat(o," ").concat(l,'="').concat(c,'"')},t);n+="<".concat(s,"></").concat(t,">");var a=r+1;return a<e?Zt(t,e,i,a,n):n}function Fs(t){return t.replace(/>\s+/g,">").replace(/\s+</,"<")}function Jn(t){return new Date(t).setHours(0,0,0,0)}function Lt(){return new Date().setHours(0,0,0,0)}function tt(){switch(arguments.length){case 0:return Lt();case 1:return Jn(arguments.length<=0?void 0:arguments[0])}var t=new Date(0);return t.setFullYear.apply(t,arguments),t.setHours(0,0,0,0)}function Ht(t,e){var i=new Date(t);return i.setDate(i.getDate()+e)}function fh(t,e){return Ht(t,e*7)}function Fr(t,e){var i=new Date(t),r=i.getMonth()+e,n=r%12;n<0&&(n+=12);var s=i.setMonth(r);return i.getMonth()!==n?i.setDate(0):s}function qt(t,e){var i=new Date(t),r=i.getMonth(),n=i.setFullYear(i.getFullYear()+e);return r===1&&i.getMonth()===2?i.setDate(0):n}function Da(t,e){return(t-e+7)%7}function Rr(t,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=new Date(t).getDay();return Ht(t,Da(e,i)-Da(r,i))}function ph(t){var e=Rr(t,4,1),i=Rr(new Date(e).setMonth(0,4),4,1);return Math.round((e-i)/6048e5)+1}function ht(t,e){var i=new Date(t).getFullYear();return Math.floor(i/e)*e}var Xn=/dd?|DD?|mm?|MM?|yy?(?:yy)?/,mh=/[\s!-/:-@[-`{-~]+/,yn={},Fa={y:function(e,i){return new Date(e).setFullYear(parseInt(i,10))},m:function(e,i,r){var n=new Date(e),s=parseInt(i,10)-1;if(isNaN(s)){if(!i)return NaN;var a=i.toLowerCase(),o=function(c){return c.toLowerCase().startsWith(a)};if(s=r.monthsShort.findIndex(o),s<0&&(s=r.months.findIndex(o)),s<0)return NaN}return n.setMonth(s),n.getMonth()!==_l(s)?n.setDate(0):n.getTime()},d:function(e,i){return new Date(e).setDate(parseInt(i,10))}},yh={d:function(e){return e.getDate()},dd:function(e){return tr(e.getDate(),2)},D:function(e,i){return i.daysShort[e.getDay()]},DD:function(e,i){return i.days[e.getDay()]},m:function(e){return e.getMonth()+1},mm:function(e){return tr(e.getMonth()+1,2)},M:function(e,i){return i.monthsShort[e.getMonth()]},MM:function(e,i){return i.months[e.getMonth()]},y:function(e){return e.getFullYear()},yy:function(e){return tr(e.getFullYear(),2).slice(-2)},yyyy:function(e){return tr(e.getFullYear(),4)}};function _l(t){return t>-1?t%12:_l(t+12)}function tr(t,e){return t.toString().padStart(e,"0")}function bl(t){if(typeof t!="string")throw new Error("Invalid date format.");if(t in yn)return yn[t];var e=t.split(Xn),i=t.match(new RegExp(Xn,"g"));if(e.length===0||!i)throw new Error("Invalid date format.");var r=i.map(function(s){return yh[s]}),n=Object.keys(Fa).reduce(function(s,a){var o=i.find(function(l){return l[0]!=="D"&&l[0].toLowerCase()===a});return o&&s.push(a),s},[]);return yn[t]={parser:function(a,o){var l=a.split(mh).reduce(function(c,d,u){if(d.length>0&&i[u]){var f=i[u][0];f==="M"?c.m=d:f!=="D"&&(c[f]=d)}return c},{});return n.reduce(function(c,d){var u=Fa[d](c,l[d],o);return isNaN(u)?c:u},Lt())},formatter:function(a,o){var l=r.reduce(function(c,d,u){return c+="".concat(e[u]).concat(d(a,o))},"");return l+=Os(e)}}}function Li(t,e,i){if(t instanceof Date||typeof t=="number"){var r=Jn(t);return isNaN(r)?void 0:r}if(t){if(t==="today")return Lt();if(e&&e.toValue){var n=e.toValue(t,e,i);return isNaN(n)?void 0:Jn(n)}return bl(e).parser(t,i)}}function Ei(t,e,i){if(isNaN(t)||!t&&t!==0)return"";var r=typeof t=="number"?new Date(t):t;return e.toDisplay?e.toDisplay(r,e,i):bl(e).formatter(r,i)}var Ur=new WeakMap,Ml=EventTarget.prototype,Ra=Ml.addEventListener,Ua=Ml.removeEventListener;function Rs(t,e){var i=Ur.get(t);i||(i=[],Ur.set(t,i)),e.forEach(function(r){Ra.call.apply(Ra,Ri(r)),i.push(r)})}function wl(t){var e=Ur.get(t);e&&(e.forEach(function(i){Ua.call.apply(Ua,Ri(i))}),Ur.delete(t))}if(!Event.prototype.composedPath){var gh=function t(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];i.push(e);var r;return e.parentNode?r=e.parentNode:e.host?r=e.host:e.defaultView&&(r=e.defaultView),r?t(r,i):i};Event.prototype.composedPath=function(){return gh(this.target)}}function Sl(t,e,i){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,n=t[r];return e(n)?n:n===i||!n.parentElement?void 0:Sl(t,e,i,r+1)}function Cl(t,e){var i=typeof e=="function"?e:function(r){return r.matches(e)};return Sl(t.composedPath(),i,t.currentTarget)}var ni={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear",titleFormat:"MM y"}},Ui={autohide:!1,beforeShowDay:null,beforeShowDecade:null,beforeShowMonth:null,beforeShowYear:null,calendarWeeks:!1,clearBtn:!1,dateDelimiter:",",datesDisabled:[],daysOfWeekDisabled:[],daysOfWeekHighlighted:[],defaultViewDate:void 0,disableTouchKeyboard:!1,format:"mm/dd/yyyy",language:"en",maxDate:null,maxNumberOfDates:1,maxView:3,minDate:null,nextArrow:'<svg class="w-4 h-4 rtl:rotate-180 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 10"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 5h12m0 0L9 1m4 4L9 9"/></svg>',orientation:"auto",pickLevel:0,prevArrow:'<svg class="w-4 h-4 rtl:rotate-180 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 10"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5H1m0 0 4 4M1 5l4-4"/></svg>',showDaysOfWeek:!0,showOnClick:!0,showOnFocus:!0,startView:0,title:"",todayBtn:!1,todayBtnMode:0,todayHighlight:!1,updateOnBlur:!0,weekStart:0},gn=null;function qe(t){return gn==null&&(gn=document.createRange()),gn.createContextualFragment(t)}function bi(t){t.style.display!=="none"&&(t.style.display&&(t.dataset.styleDisplay=t.style.display),t.style.display="none")}function Mi(t){t.style.display==="none"&&(t.dataset.styleDisplay?(t.style.display=t.dataset.styleDisplay,delete t.dataset.styleDisplay):t.style.display="")}function Hr(t){t.firstChild&&(t.removeChild(t.firstChild),Hr(t))}function vh(t,e){Hr(t),e instanceof DocumentFragment?t.appendChild(e):typeof e=="string"?t.appendChild(qe(e)):typeof e.forEach=="function"&&e.forEach(function(i){t.appendChild(i)})}var vn=Ui.language,_h=Ui.format,bh=Ui.weekStart;function Ha(t,e){return t.length<6&&e>=0&&e<7?Pt(t,e):t}function qa(t){return(t+6)%7}function ja(t,e,i,r){var n=Li(t,e,i);return n!==void 0?n:r}function _n(t,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,r=parseInt(t,10);return r>=0&&r<=i?r:e}function bn(t,e){var i=Object.assign({},t),r={},n=e.constructor.locales,s=e.config||{},a=s.format,o=s.language,l=s.locale,c=s.maxDate,d=s.maxView,u=s.minDate,f=s.pickLevel,h=s.startView,m=s.weekStart;if(i.language){var g;if(i.language!==o&&(n[i.language]?g=i.language:(g=i.language.split("-")[0],n[g]===void 0&&(g=!1))),delete i.language,g){o=r.language=g;var y=l||n[vn];l=Object.assign({format:_h,weekStart:bh},n[vn]),o!==vn&&Object.assign(l,n[o]),r.locale=l,a===y.format&&(a=r.format=l.format),m===y.weekStart&&(m=r.weekStart=l.weekStart,r.weekEnd=qa(l.weekStart))}}if(i.format){var p=typeof i.format.toDisplay=="function",_=typeof i.format.toValue=="function",M=Xn.test(i.format);(p&&_||M)&&(a=r.format=i.format),delete i.format}var v=u,w=c;if(i.minDate!==void 0&&(v=i.minDate===null?tt(0,0,1):ja(i.minDate,a,l,v),delete i.minDate),i.maxDate!==void 0&&(w=i.maxDate===null?void 0:ja(i.maxDate,a,l,w),delete i.maxDate),w<v?(u=r.minDate=w,c=r.maxDate=v):(u!==v&&(u=r.minDate=v),c!==w&&(c=r.maxDate=w)),i.datesDisabled&&(r.datesDisabled=i.datesDisabled.reduce(function(B,O){var G=Li(O,a,l);return G!==void 0?Pt(B,G):B},[]),delete i.datesDisabled),i.defaultViewDate!==void 0){var S=Li(i.defaultViewDate,a,l);S!==void 0&&(r.defaultViewDate=S),delete i.defaultViewDate}if(i.weekStart!==void 0){var C=Number(i.weekStart)%7;isNaN(C)||(m=r.weekStart=C,r.weekEnd=qa(C)),delete i.weekStart}if(i.daysOfWeekDisabled&&(r.daysOfWeekDisabled=i.daysOfWeekDisabled.reduce(Ha,[]),delete i.daysOfWeekDisabled),i.daysOfWeekHighlighted&&(r.daysOfWeekHighlighted=i.daysOfWeekHighlighted.reduce(Ha,[]),delete i.daysOfWeekHighlighted),i.maxNumberOfDates!==void 0){var P=parseInt(i.maxNumberOfDates,10);P>=0&&(r.maxNumberOfDates=P,r.multidate=P!==1),delete i.maxNumberOfDates}i.dateDelimiter&&(r.dateDelimiter=String(i.dateDelimiter),delete i.dateDelimiter);var k=f;i.pickLevel!==void 0&&(k=_n(i.pickLevel,2),delete i.pickLevel),k!==f&&(f=r.pickLevel=k);var N=d;i.maxView!==void 0&&(N=_n(i.maxView,d),delete i.maxView),N=f>N?f:N,N!==d&&(d=r.maxView=N);var L=h;if(i.startView!==void 0&&(L=_n(i.startView,L),delete i.startView),L<f?L=f:L>d&&(L=d),L!==h&&(r.startView=L),i.prevArrow){var x=qe(i.prevArrow);x.childNodes.length>0&&(r.prevArrow=x.childNodes),delete i.prevArrow}if(i.nextArrow){var T=qe(i.nextArrow);T.childNodes.length>0&&(r.nextArrow=T.childNodes),delete i.nextArrow}if(i.disableTouchKeyboard!==void 0&&(r.disableTouchKeyboard="ontouchstart"in document&&!!i.disableTouchKeyboard,delete i.disableTouchKeyboard),i.orientation){var F=i.orientation.toLowerCase().split(/\s+/g);r.orientation={x:F.find(function(B){return B==="left"||B==="right"})||"auto",y:F.find(function(B){return B==="top"||B==="bottom"})||"auto"},delete i.orientation}if(i.todayBtnMode!==void 0){switch(i.todayBtnMode){case 0:case 1:r.todayBtnMode=i.todayBtnMode}delete i.todayBtnMode}return Object.keys(i).forEach(function(B){i[B]!==void 0&&He(Ui,B)&&(r[B]=i[B])}),r}var Mh=Fs(`<div class="datepicker hidden">
  <div class="datepicker-picker inline-block rounded-lg bg-white dark:bg-gray-700 shadow-lg p-4">
    <div class="datepicker-header">
      <div class="datepicker-title bg-white dark:bg-gray-700 dark:text-white px-2 py-3 text-center font-semibold"></div>
      <div class="datepicker-controls flex justify-between mb-2">
        <button type="button" class="bg-white dark:bg-gray-700 rounded-lg text-gray-500 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-600 hover:text-gray-900 dark:hover:text-white text-lg p-2.5 focus:outline-none focus:ring-2 focus:ring-gray-200 prev-btn"></button>
        <button type="button" class="text-sm rounded-lg text-gray-900 dark:text-white bg-white dark:bg-gray-700 font-semibold py-2.5 px-5 hover:bg-gray-100 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-200 view-switch"></button>
        <button type="button" class="bg-white dark:bg-gray-700 rounded-lg text-gray-500 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-600 hover:text-gray-900 dark:hover:text-white text-lg p-2.5 focus:outline-none focus:ring-2 focus:ring-gray-200 next-btn"></button>
      </div>
    </div>
    <div class="datepicker-main p-1"></div>
    <div class="datepicker-footer">
      <div class="datepicker-controls flex space-x-2 rtl:space-x-reverse mt-2">
        <button type="button" class="%buttonClass% today-btn text-white bg-blue-700 !bg-primary-700 dark:bg-blue-600 dark:!bg-primary-600 hover:bg-blue-800 hover:!bg-primary-800 dark:hover:bg-blue-700 dark:hover:!bg-primary-700 focus:ring-4 focus:ring-blue-300 focus:!ring-primary-300 font-medium rounded-lg text-sm px-5 py-2 text-center w-1/2"></button>
        <button type="button" class="%buttonClass% clear-btn text-gray-900 dark:text-white bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-600 focus:ring-4 focus:ring-blue-300 focus:!ring-primary-300 font-medium rounded-lg text-sm px-5 py-2 text-center w-1/2"></button>
      </div>
    </div>
  </div>
</div>`),wh=Fs(`<div class="days">
  <div class="days-of-week grid grid-cols-7 mb-1">`.concat(Zt("span",7,{class:"dow block flex-1 leading-9 border-0 rounded-lg cursor-default text-center text-gray-900 font-semibold text-sm"}),`</div>
  <div class="datepicker-grid w-64 grid grid-cols-7">`).concat(Zt("span",42,{class:"block flex-1 leading-9 border-0 rounded-lg cursor-default text-center text-gray-900 font-semibold text-sm h-6 leading-6 text-sm font-medium text-gray-500 dark:text-gray-400"}),`</div>
</div>`)),Sh=Fs(`<div class="calendar-weeks">
  <div class="days-of-week flex"><span class="dow h-6 leading-6 text-sm font-medium text-gray-500 dark:text-gray-400"></span></div>
  <div class="weeks">`.concat(Zt("span",6,{class:"week block flex-1 leading-9 border-0 rounded-lg cursor-default text-center text-gray-900 font-semibold text-sm"}),`</div>
</div>`)),Us=function(){function t(e,i){kt(this,t),Object.assign(this,i,{picker:e,element:qe('<div class="datepicker-view flex"></div>').firstChild,selected:[]}),this.init(this.picker.datepicker.config)}return xt(t,[{key:"init",value:function(i){i.pickLevel!==void 0&&(this.isMinView=this.id===i.pickLevel),this.setOptions(i),this.updateFocus(),this.updateSelection()}},{key:"performBeforeHook",value:function(i,r,n){var s=this.beforeShow(new Date(n));switch(Dr(s)){case"boolean":s={enabled:s};break;case"string":s={classes:s}}if(s){if(s.enabled===!1&&(i.classList.add("disabled"),Pt(this.disabled,r)),s.classes){var a,o=s.classes.split(/\s+/);(a=i.classList).add.apply(a,Ri(o)),o.includes("disabled")&&Pt(this.disabled,r)}s.content&&vh(i,s.content)}}}])}(),Ch=function(t){function e(i){return kt(this,e),Is(this,e,[i,{id:0,name:"days",cellClass:"day"}])}return Gs(e,t),xt(e,[{key:"init",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(n){var s=qe(wh).firstChild;this.dow=s.firstChild,this.grid=s.lastChild,this.element.appendChild(s)}xi(rt(e.prototype),"init",this).call(this,r)}},{key:"setOptions",value:function(r){var n=this,s;if(He(r,"minDate")&&(this.minDate=r.minDate),He(r,"maxDate")&&(this.maxDate=r.maxDate),r.datesDisabled&&(this.datesDisabled=r.datesDisabled),r.daysOfWeekDisabled&&(this.daysOfWeekDisabled=r.daysOfWeekDisabled,s=!0),r.daysOfWeekHighlighted&&(this.daysOfWeekHighlighted=r.daysOfWeekHighlighted),r.todayHighlight!==void 0&&(this.todayHighlight=r.todayHighlight),r.weekStart!==void 0&&(this.weekStart=r.weekStart,this.weekEnd=r.weekEnd,s=!0),r.locale){var a=this.locale=r.locale;this.dayNames=a.daysMin,this.switchLabelFormat=a.titleFormat,s=!0}if(r.beforeShowDay!==void 0&&(this.beforeShow=typeof r.beforeShowDay=="function"?r.beforeShowDay:void 0),r.calendarWeeks!==void 0)if(r.calendarWeeks&&!this.calendarWeeks){var o=qe(Sh).firstChild;this.calendarWeeks={element:o,dow:o.firstChild,weeks:o.lastChild},this.element.insertBefore(o,this.element.firstChild)}else this.calendarWeeks&&!r.calendarWeeks&&(this.element.removeChild(this.calendarWeeks.element),this.calendarWeeks=null);r.showDaysOfWeek!==void 0&&(r.showDaysOfWeek?(Mi(this.dow),this.calendarWeeks&&Mi(this.calendarWeeks.dow)):(bi(this.dow),this.calendarWeeks&&bi(this.calendarWeeks.dow))),s&&Array.from(this.dow.children).forEach(function(l,c){var d=(n.weekStart+c)%7;l.textContent=n.dayNames[d],l.className=n.daysOfWeekDisabled.includes(d)?"dow disabled text-center h-6 leading-6 text-sm font-medium text-gray-500 dark:text-gray-400 cursor-not-allowed":"dow text-center h-6 leading-6 text-sm font-medium text-gray-500 dark:text-gray-400"})}},{key:"updateFocus",value:function(){var r=new Date(this.picker.viewDate),n=r.getFullYear(),s=r.getMonth(),a=tt(n,s,1),o=Rr(a,this.weekStart,this.weekStart);this.first=a,this.last=tt(n,s+1,0),this.start=o,this.focused=this.picker.viewDate}},{key:"updateSelection",value:function(){var r=this.picker.datepicker,n=r.dates,s=r.rangepicker;this.selected=n,s&&(this.range=s.dates)}},{key:"render",value:function(){var r=this;this.today=this.todayHighlight?Lt():void 0,this.disabled=Ri(this.datesDisabled);var n=Ei(this.focused,this.switchLabelFormat,this.locale);if(this.picker.setViewSwitchLabel(n),this.picker.setPrevBtnDisabled(this.first<=this.minDate),this.picker.setNextBtnDisabled(this.last>=this.maxDate),this.calendarWeeks){var s=Rr(this.first,1,1);Array.from(this.calendarWeeks.weeks.children).forEach(function(a,o){a.textContent=ph(fh(s,o))})}Array.from(this.grid.children).forEach(function(a,o){var l=a.classList,c=Ht(r.start,o),d=new Date(c),u=d.getDay();if(a.className="datepicker-cell hover:bg-gray-100 dark:hover:bg-gray-600 block flex-1 leading-9 border-0 rounded-lg cursor-pointer text-center text-gray-900 dark:text-white font-semibold text-sm ".concat(r.cellClass),a.dataset.date=c,a.textContent=d.getDate(),c<r.first?l.add("prev","text-gray-500","dark:text-white"):c>r.last&&l.add("next","text-gray-500","dark:text-white"),r.today===c&&l.add("today","bg-gray-100","dark:bg-gray-600"),(c<r.minDate||c>r.maxDate||r.disabled.includes(c))&&(l.add("disabled","cursor-not-allowed","text-gray-400","dark:text-gray-500"),l.remove("hover:bg-gray-100","dark:hover:bg-gray-600","text-gray-900","dark:text-white","cursor-pointer")),r.daysOfWeekDisabled.includes(u)&&(l.add("disabled","cursor-not-allowed","text-gray-400","dark:text-gray-500"),l.remove("hover:bg-gray-100","dark:hover:bg-gray-600","text-gray-900","dark:text-white","cursor-pointer"),Pt(r.disabled,c)),r.daysOfWeekHighlighted.includes(u)&&l.add("highlighted"),r.range){var f=se(r.range,2),h=f[0],m=f[1];c>h&&c<m&&(l.add("range","bg-gray-200","dark:bg-gray-600"),l.remove("rounded-lg","rounded-l-lg","rounded-r-lg")),c===h&&(l.add("range-start","bg-gray-100","dark:bg-gray-600","rounded-l-lg"),l.remove("rounded-lg","rounded-r-lg")),c===m&&(l.add("range-end","bg-gray-100","dark:bg-gray-600","rounded-r-lg"),l.remove("rounded-lg","rounded-l-lg"))}r.selected.includes(c)&&(l.add("selected","bg-blue-700","!bg-primary-700","text-white","dark:bg-blue-600","dark:!bg-primary-600","dark:text-white"),l.remove("text-gray-900","text-gray-500","hover:bg-gray-100","dark:text-white","dark:hover:bg-gray-600","dark:bg-gray-600","bg-gray-100","bg-gray-200")),c===r.focused&&l.add("focused"),r.beforeShow&&r.performBeforeHook(a,c,c)})}},{key:"refresh",value:function(){var r=this,n=this.range||[],s=se(n,2),a=s[0],o=s[1];this.grid.querySelectorAll(".range, .range-start, .range-end, .selected, .focused").forEach(function(l){l.classList.remove("range","range-start","range-end","selected","bg-blue-700","!bg-primary-700","text-white","dark:bg-blue-600","dark:!bg-primary-600","dark:text-white","focused"),l.classList.add("text-gray-900","rounded-lg","dark:text-white")}),Array.from(this.grid.children).forEach(function(l){var c=Number(l.dataset.date),d=l.classList;d.remove("bg-gray-200","dark:bg-gray-600","rounded-l-lg","rounded-r-lg"),c>a&&c<o&&(d.add("range","bg-gray-200","dark:bg-gray-600"),d.remove("rounded-lg")),c===a&&(d.add("range-start","bg-gray-200","dark:bg-gray-600","rounded-l-lg"),d.remove("rounded-lg")),c===o&&(d.add("range-end","bg-gray-200","dark:bg-gray-600","rounded-r-lg"),d.remove("rounded-lg")),r.selected.includes(c)&&(d.add("selected","bg-blue-700","!bg-primary-700","text-white","dark:bg-blue-600","dark:!bg-primary-600","dark:text-white"),d.remove("text-gray-900","hover:bg-gray-100","dark:text-white","dark:hover:bg-gray-600","bg-gray-100","bg-gray-200","dark:bg-gray-600")),c===r.focused&&d.add("focused")})}},{key:"refreshFocus",value:function(){var r=Math.round((this.focused-this.start)/864e5);this.grid.querySelectorAll(".focused").forEach(function(n){n.classList.remove("focused")}),this.grid.children[r].classList.add("focused")}}])}(Us);function Ka(t,e){if(!(!t||!t[0]||!t[1])){var i=se(t,2),r=se(i[0],2),n=r[0],s=r[1],a=se(i[1],2),o=a[0],l=a[1];if(!(n>e||o<e))return[n===e?s:-1,o===e?l:12]}}var Ph=function(t){function e(i){return kt(this,e),Is(this,e,[i,{id:1,name:"months",cellClass:"month"}])}return Gs(e,t),xt(e,[{key:"init",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;n&&(this.grid=this.element,this.element.classList.add("months","datepicker-grid","w-64","grid","grid-cols-4"),this.grid.appendChild(qe(Zt("span",12,{"data-month":function(a){return a}})))),xi(rt(e.prototype),"init",this).call(this,r)}},{key:"setOptions",value:function(r){if(r.locale&&(this.monthNames=r.locale.monthsShort),He(r,"minDate"))if(r.minDate===void 0)this.minYear=this.minMonth=this.minDate=void 0;else{var n=new Date(r.minDate);this.minYear=n.getFullYear(),this.minMonth=n.getMonth(),this.minDate=n.setDate(1)}if(He(r,"maxDate"))if(r.maxDate===void 0)this.maxYear=this.maxMonth=this.maxDate=void 0;else{var s=new Date(r.maxDate);this.maxYear=s.getFullYear(),this.maxMonth=s.getMonth(),this.maxDate=tt(this.maxYear,this.maxMonth+1,0)}r.beforeShowMonth!==void 0&&(this.beforeShow=typeof r.beforeShowMonth=="function"?r.beforeShowMonth:void 0)}},{key:"updateFocus",value:function(){var r=new Date(this.picker.viewDate);this.year=r.getFullYear(),this.focused=r.getMonth()}},{key:"updateSelection",value:function(){var r=this.picker.datepicker,n=r.dates,s=r.rangepicker;this.selected=n.reduce(function(a,o){var l=new Date(o),c=l.getFullYear(),d=l.getMonth();return a[c]===void 0?a[c]=[d]:Pt(a[c],d),a},{}),s&&s.dates&&(this.range=s.dates.map(function(a){var o=new Date(a);return isNaN(o)?void 0:[o.getFullYear(),o.getMonth()]}))}},{key:"render",value:function(){var r=this;this.disabled=[],this.picker.setViewSwitchLabel(this.year),this.picker.setPrevBtnDisabled(this.year<=this.minYear),this.picker.setNextBtnDisabled(this.year>=this.maxYear);var n=this.selected[this.year]||[],s=this.year<this.minYear||this.year>this.maxYear,a=this.year===this.minYear,o=this.year===this.maxYear,l=Ka(this.range,this.year);Array.from(this.grid.children).forEach(function(c,d){var u=c.classList,f=tt(r.year,d,1);if(c.className="datepicker-cell hover:bg-gray-100 dark:hover:bg-gray-600 block flex-1 leading-9 border-0 rounded-lg cursor-pointer text-center text-gray-900 dark:text-white font-semibold text-sm ".concat(r.cellClass),r.isMinView&&(c.dataset.date=f),c.textContent=r.monthNames[d],(s||a&&d<r.minMonth||o&&d>r.maxMonth)&&u.add("disabled"),l){var h=se(l,2),m=h[0],g=h[1];d>m&&d<g&&u.add("range"),d===m&&u.add("range-start"),d===g&&u.add("range-end")}n.includes(d)&&(u.add("selected","bg-blue-700","!bg-primary-700","text-white","dark:bg-blue-600","dark:!bg-primary-600","dark:text-white"),u.remove("text-gray-900","hover:bg-gray-100","dark:text-white","dark:hover:bg-gray-600")),d===r.focused&&u.add("focused"),r.beforeShow&&r.performBeforeHook(c,d,f)})}},{key:"refresh",value:function(){var r=this,n=this.selected[this.year]||[],s=Ka(this.range,this.year)||[],a=se(s,2),o=a[0],l=a[1];this.grid.querySelectorAll(".range, .range-start, .range-end, .selected, .focused").forEach(function(c){c.classList.remove("range","range-start","range-end","selected","bg-blue-700","!bg-primary-700","dark:bg-blue-600","dark:!bg-primary-700","dark:text-white","text-white","focused"),c.classList.add("text-gray-900","hover:bg-gray-100","dark:text-white","dark:hover:bg-gray-600")}),Array.from(this.grid.children).forEach(function(c,d){var u=c.classList;d>o&&d<l&&u.add("range"),d===o&&u.add("range-start"),d===l&&u.add("range-end"),n.includes(d)&&(u.add("selected","bg-blue-700","!bg-primary-700","text-white","dark:bg-blue-600","dark:!bg-primary-600","dark:text-white"),u.remove("text-gray-900","hover:bg-gray-100","dark:text-white","dark:hover:bg-gray-600")),d===r.focused&&u.add("focused")})}},{key:"refreshFocus",value:function(){this.grid.querySelectorAll(".focused").forEach(function(r){r.classList.remove("focused")}),this.grid.children[this.focused].classList.add("focused")}}])}(Us);function Nh(t){return Ri(t).reduce(function(e,i,r){return e+=r?i:i.toUpperCase()},"")}var $a=function(t){function e(i,r){return kt(this,e),Is(this,e,[i,r])}return Gs(e,t),xt(e,[{key:"init",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;n&&(this.navStep=this.step*10,this.beforeShowOption="beforeShow".concat(Nh(this.cellClass)),this.grid=this.element,this.element.classList.add(this.name,"datepicker-grid","w-64","grid","grid-cols-4"),this.grid.appendChild(qe(Zt("span",12)))),xi(rt(e.prototype),"init",this).call(this,r)}},{key:"setOptions",value:function(r){if(He(r,"minDate")&&(r.minDate===void 0?this.minYear=this.minDate=void 0:(this.minYear=ht(r.minDate,this.step),this.minDate=tt(this.minYear,0,1))),He(r,"maxDate")&&(r.maxDate===void 0?this.maxYear=this.maxDate=void 0:(this.maxYear=ht(r.maxDate,this.step),this.maxDate=tt(this.maxYear,11,31))),r[this.beforeShowOption]!==void 0){var n=r[this.beforeShowOption];this.beforeShow=typeof n=="function"?n:void 0}}},{key:"updateFocus",value:function(){var r=new Date(this.picker.viewDate),n=ht(r,this.navStep),s=n+9*this.step;this.first=n,this.last=s,this.start=n-this.step,this.focused=ht(r,this.step)}},{key:"updateSelection",value:function(){var r=this,n=this.picker.datepicker,s=n.dates,a=n.rangepicker;this.selected=s.reduce(function(o,l){return Pt(o,ht(l,r.step))},[]),a&&a.dates&&(this.range=a.dates.map(function(o){if(o!==void 0)return ht(o,r.step)}))}},{key:"render",value:function(){var r=this;this.disabled=[],this.picker.setViewSwitchLabel("".concat(this.first,"-").concat(this.last)),this.picker.setPrevBtnDisabled(this.first<=this.minYear),this.picker.setNextBtnDisabled(this.last>=this.maxYear),Array.from(this.grid.children).forEach(function(n,s){var a=n.classList,o=r.start+s*r.step,l=tt(o,0,1);if(n.className="datepicker-cell hover:bg-gray-100 dark:hover:bg-gray-600 block flex-1 leading-9 border-0 rounded-lg cursor-pointer text-center text-gray-900 dark:text-white font-semibold text-sm ".concat(r.cellClass),r.isMinView&&(n.dataset.date=l),n.textContent=n.dataset.year=o,s===0?a.add("prev"):s===11&&a.add("next"),(o<r.minYear||o>r.maxYear)&&a.add("disabled"),r.range){var c=se(r.range,2),d=c[0],u=c[1];o>d&&o<u&&a.add("range"),o===d&&a.add("range-start"),o===u&&a.add("range-end")}r.selected.includes(o)&&(a.add("selected","bg-blue-700","!bg-primary-700","text-white","dark:bg-blue-600","dark:!bg-primary-600","dark:text-white"),a.remove("text-gray-900","hover:bg-gray-100","dark:text-white","dark:hover:bg-gray-600")),o===r.focused&&a.add("focused"),r.beforeShow&&r.performBeforeHook(n,o,l)})}},{key:"refresh",value:function(){var r=this,n=this.range||[],s=se(n,2),a=s[0],o=s[1];this.grid.querySelectorAll(".range, .range-start, .range-end, .selected, .focused").forEach(function(l){l.classList.remove("range","range-start","range-end","selected","bg-blue-700","!bg-primary-700","text-white","dark:bg-blue-600","dark!bg-primary-600","dark:text-white","focused")}),Array.from(this.grid.children).forEach(function(l){var c=Number(l.textContent),d=l.classList;c>a&&c<o&&d.add("range"),c===a&&d.add("range-start"),c===o&&d.add("range-end"),r.selected.includes(c)&&(d.add("selected","bg-blue-700","!bg-primary-700","text-white","dark:bg-blue-600","dark:!bg-primary-600","dark:text-white"),d.remove("text-gray-900","hover:bg-gray-100","dark:text-white","dark:hover:bg-gray-600")),c===r.focused&&d.add("focused")})}},{key:"refreshFocus",value:function(){var r=Math.round((this.focused-this.start)/this.step);this.grid.querySelectorAll(".focused").forEach(function(n){n.classList.remove("focused")}),this.grid.children[r].classList.add("focused")}}])}(Us);function jt(t,e){var i={date:t.getDate(),viewDate:new Date(t.picker.viewDate),viewId:t.picker.currentView.id,datepicker:t};t.element.dispatchEvent(new CustomEvent(e,{detail:i}))}function qr(t,e){var i=t.config,r=i.minDate,n=i.maxDate,s=t.picker,a=s.currentView,o=s.viewDate,l;switch(a.id){case 0:l=Fr(o,e);break;case 1:l=qt(o,e);break;default:l=qt(o,e*a.navStep)}l=vl(l,r,n),t.picker.changeFocus(l).render()}function Pl(t){var e=t.picker.currentView.id;e!==t.config.maxView&&t.picker.changeView(e+1).render()}function Nl(t){t.config.updateOnBlur?t.update({autohide:!0}):(t.refresh("input"),t.hide())}function za(t,e){var i=t.picker,r=new Date(i.viewDate),n=i.currentView.id,s=n===1?Fr(r,e-r.getMonth()):qt(r,e-r.getFullYear());i.changeFocus(s).changeView(n-1).render()}function kh(t){var e=t.picker,i=Lt();if(t.config.todayBtnMode===1){if(t.config.autohide){t.setDate(i);return}t.setDate(i,{render:!1}),e.update()}e.viewDate!==i&&e.changeFocus(i),e.changeView(0).render()}function xh(t){t.setDate({clear:!0})}function Lh(t){Pl(t)}function Eh(t){qr(t,-1)}function Ah(t){qr(t,1)}function Bh(t,e){var i=Cl(e,".datepicker-cell");if(!(!i||i.classList.contains("disabled"))){var r=t.picker.currentView,n=r.id,s=r.isMinView;s?t.setDate(Number(i.dataset.date)):n===1?za(t,Number(i.dataset.month)):za(t,Number(i.dataset.year))}}function Th(t){!t.inline&&!t.config.disableTouchKeyboard&&t.inputField.focus()}function Va(t,e){if(e.title!==void 0&&(e.title?(t.controls.title.textContent=e.title,Mi(t.controls.title)):(t.controls.title.textContent="",bi(t.controls.title))),e.prevArrow){var i=t.controls.prevBtn;Hr(i),e.prevArrow.forEach(function(o){i.appendChild(o.cloneNode(!0))})}if(e.nextArrow){var r=t.controls.nextBtn;Hr(r),e.nextArrow.forEach(function(o){r.appendChild(o.cloneNode(!0))})}if(e.locale&&(t.controls.todayBtn.textContent=e.locale.today,t.controls.clearBtn.textContent=e.locale.clear),e.todayBtn!==void 0&&(e.todayBtn?Mi(t.controls.todayBtn):bi(t.controls.todayBtn)),He(e,"minDate")||He(e,"maxDate")){var n=t.datepicker.config,s=n.minDate,a=n.maxDate;t.controls.todayBtn.disabled=!Ds(Lt(),s,a)}e.clearBtn!==void 0&&(e.clearBtn?Mi(t.controls.clearBtn):bi(t.controls.clearBtn))}function Wa(t){var e=t.dates,i=t.config,r=e.length>0?Os(e):i.defaultViewDate;return vl(r,i.minDate,i.maxDate)}function Ja(t,e){var i=new Date(t.viewDate),r=new Date(e),n=t.currentView,s=n.id,a=n.year,o=n.first,l=n.last,c=r.getFullYear();switch(t.viewDate=e,c!==i.getFullYear()&&jt(t.datepicker,"changeYear"),r.getMonth()!==i.getMonth()&&jt(t.datepicker,"changeMonth"),s){case 0:return e<o||e>l;case 1:return c!==a;default:return c<o||c>l}}function Mn(t){return window.getComputedStyle(t).direction}var Ih=function(){function t(e){kt(this,t),this.datepicker=e;var i=Mh.replace(/%buttonClass%/g,e.config.buttonClass),r=this.element=qe(i).firstChild,n=se(r.firstChild.children,3),s=n[0],a=n[1],o=n[2],l=s.firstElementChild,c=se(s.lastElementChild.children,3),d=c[0],u=c[1],f=c[2],h=se(o.firstChild.children,2),m=h[0],g=h[1],y={title:l,prevBtn:d,viewSwitch:u,nextBtn:f,todayBtn:m,clearBtn:g};this.main=a,this.controls=y;var p=e.inline?"inline":"dropdown";r.classList.add("datepicker-".concat(p)),p==="dropdown"&&r.classList.add("dropdown","absolute","top-0","left-0","z-50","pt-2"),Va(this,e.config),this.viewDate=Wa(e),Rs(e,[[r,"click",Th.bind(null,e),{capture:!0}],[a,"click",Bh.bind(null,e)],[y.viewSwitch,"click",Lh.bind(null,e)],[y.prevBtn,"click",Eh.bind(null,e)],[y.nextBtn,"click",Ah.bind(null,e)],[y.todayBtn,"click",kh.bind(null,e)],[y.clearBtn,"click",xh.bind(null,e)]]),this.views=[new Ch(this),new Ph(this),new $a(this,{id:2,name:"years",cellClass:"year",step:1}),new $a(this,{id:3,name:"decades",cellClass:"decade",step:10})],this.currentView=this.views[e.config.startView],this.currentView.render(),this.main.appendChild(this.currentView.element),e.config.container.appendChild(this.element)}return xt(t,[{key:"setOptions",value:function(i){Va(this,i),this.views.forEach(function(r){r.init(i,!1)}),this.currentView.render()}},{key:"detach",value:function(){this.datepicker.config.container.removeChild(this.element)}},{key:"show",value:function(){if(!this.active){this.element.classList.add("active","block"),this.element.classList.remove("hidden"),this.active=!0;var i=this.datepicker;if(!i.inline){var r=Mn(i.inputField);r!==Mn(i.config.container)?this.element.dir=r:this.element.dir&&this.element.removeAttribute("dir"),this.place(),i.config.disableTouchKeyboard&&i.inputField.blur()}jt(i,"show")}}},{key:"hide",value:function(){this.active&&(this.datepicker.exitEditMode(),this.element.classList.remove("active","block"),this.element.classList.add("active","block","hidden"),this.active=!1,jt(this.datepicker,"hide"))}},{key:"place",value:function(){var i=this.element,r=i.classList,n=i.style,s=this.datepicker,a=s.config,o=s.inputField,l=a.container,c=this.element.getBoundingClientRect(),d=c.width,u=c.height,f=l.getBoundingClientRect(),h=f.left,m=f.top,g=f.width,y=o.getBoundingClientRect(),p=y.left,_=y.top,M=y.width,v=y.height,w=a.orientation,S=w.x,C=w.y,P,k,N;l===document.body?(P=window.scrollY,k=p+window.scrollX,N=_+P):(P=l.scrollTop,k=p-h,N=_-m+P),S==="auto"&&(k<0?(S="left",k=10):k+d>g?S="right":S=Mn(o)==="rtl"?"right":"left"),S==="right"&&(k-=d-M),C==="auto"&&(C=N-u<P?"bottom":"top"),C==="top"?N-=u:N+=v,r.remove("datepicker-orient-top","datepicker-orient-bottom","datepicker-orient-right","datepicker-orient-left"),r.add("datepicker-orient-".concat(C),"datepicker-orient-".concat(S)),n.top=N&&"".concat(N,"px"),n.left=k&&"".concat(k,"px")}},{key:"setViewSwitchLabel",value:function(i){this.controls.viewSwitch.textContent=i}},{key:"setPrevBtnDisabled",value:function(i){this.controls.prevBtn.disabled=i}},{key:"setNextBtnDisabled",value:function(i){this.controls.nextBtn.disabled=i}},{key:"changeView",value:function(i){var r=this.currentView,n=this.views[i];return n.id!==r.id&&(this.currentView=n,this._renderMethod="render",jt(this.datepicker,"changeView"),this.main.replaceChild(n.element,r.element)),this}},{key:"changeFocus",value:function(i){return this._renderMethod=Ja(this,i)?"render":"refreshFocus",this.views.forEach(function(r){r.updateFocus()}),this}},{key:"update",value:function(){var i=Wa(this.datepicker);return this._renderMethod=Ja(this,i)?"render":"refresh",this.views.forEach(function(r){r.updateFocus(),r.updateSelection()}),this}},{key:"render",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,r=i&&this._renderMethod||"render";delete this._renderMethod,this.currentView[r]()}}])}();function kl(t,e,i,r,n,s){if(Ds(t,n,s)){if(r(t)){var a=e(t,i);return kl(a,e,i,r,n,s)}return t}}function ir(t,e,i,r){var n=t.picker,s=n.currentView,a=s.step||1,o=n.viewDate,l,c;switch(s.id){case 0:r?o=Ht(o,i*7):e.ctrlKey||e.metaKey?o=qt(o,i):o=Ht(o,i),l=Ht,c=function(u){return s.disabled.includes(u)};break;case 1:o=Fr(o,r?i*4:i),l=Fr,c=function(u){var f=new Date(u),h=s.year,m=s.disabled;return f.getFullYear()===h&&m.includes(f.getMonth())};break;default:o=qt(o,i*(r?4:1)*a),l=qt,c=function(u){return s.disabled.includes(ht(u,a))}}o=kl(o,l,i<0?-a:a,c,s.minDate,s.maxDate),o!==void 0&&n.changeFocus(o).render()}function Gh(t,e){if(e.key==="Tab"){Nl(t);return}var i=t.picker,r=i.currentView,n=r.id,s=r.isMinView;if(i.active)if(t.editMode)switch(e.key){case"Escape":i.hide();break;case"Enter":t.exitEditMode({update:!0,autohide:t.config.autohide});break;default:return}else switch(e.key){case"Escape":i.hide();break;case"ArrowLeft":if(e.ctrlKey||e.metaKey)qr(t,-1);else if(e.shiftKey){t.enterEditMode();return}else ir(t,e,-1,!1);break;case"ArrowRight":if(e.ctrlKey||e.metaKey)qr(t,1);else if(e.shiftKey){t.enterEditMode();return}else ir(t,e,1,!1);break;case"ArrowUp":if(e.ctrlKey||e.metaKey)Pl(t);else if(e.shiftKey){t.enterEditMode();return}else ir(t,e,-1,!0);break;case"ArrowDown":if(e.shiftKey&&!e.ctrlKey&&!e.metaKey){t.enterEditMode();return}ir(t,e,1,!0);break;case"Enter":s?t.setDate(i.viewDate):i.changeView(n-1).render();break;case"Backspace":case"Delete":t.enterEditMode();return;default:e.key.length===1&&!e.ctrlKey&&!e.metaKey&&t.enterEditMode();return}else switch(e.key){case"ArrowDown":case"Escape":i.show();break;case"Enter":t.update();break;default:return}e.preventDefault(),e.stopPropagation()}function Oh(t){t.config.showOnFocus&&!t._showing&&t.show()}function Dh(t,e){var i=e.target;(t.picker.active||t.config.showOnClick)&&(i._active=i===document.activeElement,i._clicking=setTimeout(function(){delete i._active,delete i._clicking},2e3))}function Fh(t,e){var i=e.target;i._clicking&&(clearTimeout(i._clicking),delete i._clicking,i._active&&t.enterEditMode(),delete i._active,t.config.showOnClick&&t.show())}function Rh(t,e){e.clipboardData.types.includes("text/plain")&&t.enterEditMode()}function Uh(t,e){var i=t.element;if(i===document.activeElement){var r=t.picker.element;Cl(e,function(n){return n===i||n===r})||Nl(t)}}function xl(t,e){return t.map(function(i){return Ei(i,e.format,e.locale)}).join(e.dateDelimiter)}function Ll(t,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=t.config,n=t.dates,s=t.rangepicker;if(e.length===0)return i?[]:void 0;var a=s&&t===s.datepickers[1],o=e.reduce(function(l,c){var d=Li(c,r.format,r.locale);if(d===void 0)return l;if(r.pickLevel>0){var u=new Date(d);r.pickLevel===1?d=a?u.setMonth(u.getMonth()+1,0):u.setDate(1):d=a?u.setFullYear(u.getFullYear()+1,0,0):u.setMonth(0,1)}return Ds(d,r.minDate,r.maxDate)&&!l.includes(d)&&!r.datesDisabled.includes(d)&&!r.daysOfWeekDisabled.includes(new Date(d).getDay())&&l.push(d),l},[]);if(o.length!==0)return r.multidate&&!i&&(o=o.reduce(function(l,c){return n.includes(c)||l.push(c),l},n.filter(function(l){return!o.includes(l)}))),r.maxNumberOfDates&&o.length>r.maxNumberOfDates?o.slice(r.maxNumberOfDates*-1):o}function jr(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=t.config,n=t.picker,s=t.inputField;if(e&2){var a=n.active?r.pickLevel:r.startView;n.update().changeView(a).render(i)}e&1&&s&&(s.value=xl(t.dates,r))}function Xa(t,e,i){var r=i.clear,n=i.render,s=i.autohide;n===void 0&&(n=!0),n?s===void 0&&(s=t.config.autohide):s=!1;var a=Ll(t,e,r);a&&(a.toString()!==t.dates.toString()?(t.dates=a,jr(t,n?3:1),jt(t,"changeDate")):jr(t,1),s&&t.hide())}var ur=function(){function t(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;kt(this,t),e.datepicker=this,this.element=e;var n=this.config=Object.assign({buttonClass:i.buttonClass&&String(i.buttonClass)||"button",container:document.body,defaultViewDate:Lt(),maxDate:void 0,minDate:void 0},bn(Ui,this));this._options=i,Object.assign(n,bn(i,this));var s=this.inline=e.tagName!=="INPUT",a,o;if(s)n.container=e,o=mn(e.dataset.date,n.dateDelimiter),delete e.dataset.date;else{var l=i.container?document.querySelector(i.container):null;l&&(n.container=l),a=this.inputField=e,a.classList.add("datepicker-input"),o=mn(a.value,n.dateDelimiter)}if(r){var c=r.inputs.indexOf(a),d=r.datepickers;if(c<0||c>1||!Array.isArray(d))throw Error("Invalid rangepicker object.");d[c]=this,Object.defineProperty(this,"rangepicker",{get:function(){return r}})}this.dates=[];var u=Ll(this,o);u&&u.length>0&&(this.dates=u),a&&(a.value=xl(this.dates,n));var f=this.picker=new Ih(this);if(s)this.show();else{var h=Uh.bind(null,this),m=[[a,"keydown",Gh.bind(null,this)],[a,"focus",Oh.bind(null,this)],[a,"mousedown",Dh.bind(null,this)],[a,"click",Fh.bind(null,this)],[a,"paste",Rh.bind(null,this)],[document,"mousedown",h],[document,"touchstart",h],[window,"resize",f.place.bind(f)]];Rs(this,m)}}return xt(t,[{key:"active",get:function(){return!!(this.picker&&this.picker.active)}},{key:"pickerElement",get:function(){return this.picker?this.picker.element:void 0}},{key:"setOptions",value:function(i){var r=this.picker,n=bn(i,this);Object.assign(this._options,i),Object.assign(this.config,n),r.setOptions(n),jr(this,3)}},{key:"show",value:function(){if(this.inputField){if(this.inputField.disabled)return;this.inputField!==document.activeElement&&(this._showing=!0,this.inputField.focus(),delete this._showing)}this.picker.show()}},{key:"hide",value:function(){this.inline||(this.picker.hide(),this.picker.update().changeView(this.config.startView).render())}},{key:"destroy",value:function(){return this.hide(),wl(this),this.picker.detach(),this.inline||this.inputField.classList.remove("datepicker-input"),delete this.element.datepicker,this}},{key:"getDate",value:function(){var i=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0,n=r?function(s){return Ei(s,r,i.config.locale)}:function(s){return new Date(s)};if(this.config.multidate)return this.dates.map(n);if(this.dates.length>0)return n(this.dates[0])}},{key:"setDate",value:function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];var s=[].concat(r),a={},o=Os(r);Dr(o)==="object"&&!Array.isArray(o)&&!(o instanceof Date)&&o&&Object.assign(a,s.pop());var l=Array.isArray(s[0])?s[0]:s;Xa(this,l,a)}},{key:"update",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;if(!this.inline){var r={clear:!0,autohide:!!(i&&i.autohide)},n=mn(this.inputField.value,this.config.dateDelimiter);Xa(this,n,r)}}},{key:"refresh",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;i&&typeof i!="string"&&(r=i,i=void 0);var n;i==="picker"?n=2:i==="input"?n=1:n=3,jr(this,n,!r)}},{key:"enterEditMode",value:function(){this.inline||!this.picker.active||this.editMode||(this.editMode=!0,this.inputField.classList.add("in-edit","border-blue-700","!border-primary-700"))}},{key:"exitEditMode",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;if(!(this.inline||!this.editMode)){var r=Object.assign({update:!1},i);delete this.editMode,this.inputField.classList.remove("in-edit","border-blue-700","!border-primary-700"),r.update&&this.update(r)}}}],[{key:"formatDate",value:function(i,r,n){return Ei(i,r,n&&ni[n]||ni.en)}},{key:"parseDate",value:function(i,r,n){return Li(i,r,n&&ni[n]||ni.en)}},{key:"locales",get:function(){return ni}}])}();function Ya(t){var e=Object.assign({},t);return delete e.inputs,delete e.allowOneSidedRange,delete e.maxNumberOfDates,e}function Za(t,e,i,r){Rs(t,[[i,"changeDate",e]]),new ur(i,r,t)}function si(t,e){if(!t._updating){t._updating=!0;var i=e.target;if(i.datepicker!==void 0){var r=t.datepickers,n={render:!1},s=t.inputs.indexOf(i),a=s===0?1:0,o=r[s].dates[0],l=r[a].dates[0];o!==void 0&&l!==void 0?s===0&&o>l?(r[0].setDate(l,n),r[1].setDate(o,n)):s===1&&o<l&&(r[0].setDate(o,n),r[1].setDate(l,n)):t.allowOneSidedRange||(o!==void 0||l!==void 0)&&(n.clear=!0,r[a].setDate(r[s].dates,n)),r[0].picker.update().render(),r[1].picker.update().render(),delete t._updating}}}var wn=function(){function t(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};kt(this,t);var r=Array.isArray(i.inputs)?i.inputs:Array.from(e.querySelectorAll("input"));if(!(r.length<2)){e.rangepicker=this,this.element=e,this.inputs=r.slice(0,2),this.allowOneSidedRange=!!i.allowOneSidedRange;var n=si.bind(null,this),s=Ya(i),a=[];Object.defineProperty(this,"datepickers",{get:function(){return a}}),Za(this,n,this.inputs[0],s),Za(this,n,this.inputs[1],s),Object.freeze(a),a[0].dates.length>0?si(this,{target:this.inputs[0]}):a[1].dates.length>0&&si(this,{target:this.inputs[1]})}}return xt(t,[{key:"dates",get:function(){return this.datepickers.length===2?[this.datepickers[0].dates[0],this.datepickers[1].dates[0]]:void 0}},{key:"setOptions",value:function(i){this.allowOneSidedRange=!!i.allowOneSidedRange;var r=Ya(i);this.datepickers[0].setOptions(r),this.datepickers[1].setOptions(r)}},{key:"destroy",value:function(){this.datepickers[0].destroy(),this.datepickers[1].destroy(),wl(this),delete this.element.rangepicker}},{key:"getDates",value:function(){var i=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0,n=r?function(s){return Ei(s,r,i.datepickers[0].config.locale)}:function(s){return new Date(s)};return this.dates.map(function(s){return s===void 0?s:n(s)})}},{key:"setDates",value:function(i,r){var n=se(this.datepickers,2),s=n[0],a=n[1],o=this.dates;this._updating=!0,s.setDate(i),a.setDate(r),delete this._updating,a.dates[0]!==o[1]?si(this,{target:this.inputs[1]}):s.dates[0]!==o[0]&&si(this,{target:this.inputs[0]})}}])}(),Kr=function(){return Kr=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++){e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},Kr.apply(this,arguments)},ue={defaultDatepickerId:null,autohide:!1,format:"mm/dd/yyyy",maxDate:null,minDate:null,orientation:"bottom",buttons:!1,autoSelectToday:0,title:null,language:"en",rangePicker:!1,onShow:function(){},onHide:function(){}},Hh={id:null,override:!0},El=function(){function t(e,i,r){e===void 0&&(e=null),i===void 0&&(i=ue),r===void 0&&(r=Hh),this._instanceId=r.id?r.id:e.id,this._datepickerEl=e,this._datepickerInstance=null,this._options=Kr(Kr({},ue),i),this._initialized=!1,this.init(),I.addInstance("Datepicker",this,this._instanceId,r.override)}return t.prototype.init=function(){this._datepickerEl&&!this._initialized&&(this._options.rangePicker?this._datepickerInstance=new wn(this._datepickerEl,this._getDatepickerOptions(this._options)):this._datepickerInstance=new ur(this._datepickerEl,this._getDatepickerOptions(this._options)),this._initialized=!0)},t.prototype.destroy=function(){this._initialized&&(this._initialized=!1,this._datepickerInstance.destroy())},t.prototype.removeInstance=function(){this.destroy(),I.removeInstance("Datepicker",this._instanceId)},t.prototype.destroyAndRemoveInstance=function(){this.destroy(),this.removeInstance()},t.prototype.getDatepickerInstance=function(){return this._datepickerInstance},t.prototype.getDate=function(){if(this._options.rangePicker&&this._datepickerInstance instanceof wn)return this._datepickerInstance.getDates();if(!this._options.rangePicker&&this._datepickerInstance instanceof ur)return this._datepickerInstance.getDate()},t.prototype.setDate=function(e){if(this._options.rangePicker&&this._datepickerInstance instanceof wn)return this._datepickerInstance.setDates(e);if(!this._options.rangePicker&&this._datepickerInstance instanceof ur)return this._datepickerInstance.setDate(e)},t.prototype.show=function(){this._datepickerInstance.show(),this._options.onShow(this)},t.prototype.hide=function(){this._datepickerInstance.hide(),this._options.onHide(this)},t.prototype._getDatepickerOptions=function(e){var i={};return e.buttons&&(i.todayBtn=!0,i.clearBtn=!0,e.autoSelectToday&&(i.todayBtnMode=1)),e.autohide&&(i.autohide=!0),e.format&&(i.format=e.format),e.maxDate&&(i.maxDate=e.maxDate),e.minDate&&(i.minDate=e.minDate),e.orientation&&(i.orientation=e.orientation),e.title&&(i.title=e.title),e.language&&(i.language=e.language),i},t.prototype.updateOnShow=function(e){this._options.onShow=e},t.prototype.updateOnHide=function(e){this._options.onHide=e},t}();function Hs(){document.querySelectorAll("[datepicker], [inline-datepicker], [date-rangepicker]").forEach(function(t){if(t){var e=t.hasAttribute("datepicker-buttons"),i=t.hasAttribute("datepicker-autoselect-today"),r=t.hasAttribute("datepicker-autohide"),n=t.getAttribute("datepicker-format"),s=t.getAttribute("datepicker-max-date"),a=t.getAttribute("datepicker-min-date"),o=t.getAttribute("datepicker-orientation"),l=t.getAttribute("datepicker-title"),c=t.getAttribute("datepicker-language"),d=t.hasAttribute("date-rangepicker");new El(t,{buttons:e||ue.buttons,autoSelectToday:i||ue.autoSelectToday,autohide:r||ue.autohide,format:n||ue.format,maxDate:s||ue.maxDate,minDate:a||ue.minDate,orientation:o||ue.orientation,title:l||ue.title,language:c||ue.language,rangePicker:d||ue.rangePicker})}else console.error("The datepicker element does not exist. Please check the datepicker attribute.")})}typeof window<"u"&&(window.Datepicker=El,window.initDatepickers=Hs);function qh(){hs(),fs(),ps(),ms(),Cs(),Ps(),ks(),xs(),Fi(),Es(),As(),Bs(),Ts(),Hs()}typeof window<"u"&&(window.initFlowbite=qh);var jh=new Oc("load",[hs,fs,ps,ms,Cs,Ps,ks,xs,Fi,Es,As,Bs,Ts,Hs]);jh.init();function Kh(){return new Date().toISOString()}function Yn(t,e=1){var r,n;if(t===null||typeof t!="object")return t;if(e===0){const s=((r=t.constructor)==null?void 0:r.name)||"Object",a=Object.keys(t).length;return`[${s} object, ${a} keys]`}if(Array.isArray(t))return t.map(s=>Yn(s,e-1));const i={_type:((n=t.constructor)==null?void 0:n.name)||"Object"};for(const s in t){if(!Object.prototype.hasOwnProperty.call(t,s))continue;const a=t[s];if(a instanceof HTMLElement)i[s]=`[HTMLElement: ${a.tagName}]`;else if(a instanceof AudioContext||a instanceof AudioNode)i[s]="[AudioNode]";else if(typeof a=="function")i[s]="[Function]";else if(typeof a=="object")try{i[s]=Yn(a,e-1)}catch{i[s]="[Unserializable Object]"}else i[s]=a}return i}function $h(t){try{const e=Yn(t,2);return JSON.stringify(e,null,2)}catch(e){return JSON.stringify({error:"Could not serialize log payload",reason:e.message,type:typeof t},null,2)}}function Al(t,e,i="log"){const n={timestamp:Kh(),level:i,message:t};e!==void 0&&(n.data=e);const s=$h(n);switch(i){case"warn":console.warn(s);break;case"error":console.error(s);break;case"info":console.info(s);break;case"debug":console.debug(s);break;case"log":default:console.log(s);break}}const qs="SEQUENZIA_DEV";let Hi=!1;typeof window<"u"&&(Hi=localStorage.getItem(qs)==="true");function Qa(){Hi=!0,typeof window<"u"&&localStorage.setItem(qs,"true")}function zh(){Hi=!1,typeof window<"u"&&localStorage.removeItem(qs)}function Sn(){return Hi}function J(t,e,i="log"){Hi&&Al(t,e,i)}class _t{constructor(){this.reloadCallbacks=[]}static getInstance(){return _t.instance||(_t.instance=new _t),_t.instance}registerReloadable(e){this.reloadCallbacks.push(e)}reloadAll(){this.reloadCallbacks.forEach(e=>e())}}var Vh=Object.defineProperty,Wh=Object.defineProperties,Jh=Object.getOwnPropertyDescriptors,eo=Object.getOwnPropertySymbols,Xh=Object.prototype.hasOwnProperty,Yh=Object.prototype.propertyIsEnumerable,Bl=t=>{throw TypeError(t)},to=(t,e,i)=>e in t?Vh(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,_e=(t,e)=>{for(var i in e||(e={}))Xh.call(e,i)&&to(t,i,e[i]);if(eo)for(var i of eo(e))Yh.call(e,i)&&to(t,i,e[i]);return t},it=(t,e)=>Wh(t,Jh(e)),js=(t,e,i)=>e.has(t)||Bl("Cannot "+i),E=(t,e,i)=>(js(t,e,"read from private field"),i?i.call(t):e.get(t)),$=(t,e,i)=>e.has(t)?Bl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,i),q=(t,e,i,r)=>(js(t,e,"write to private field"),e.set(t,i),i),hr=(t,e,i)=>(js(t,e,"access private method"),i),Q=(t,e,i)=>new Promise((r,n)=>{var s=l=>{try{o(i.next(l))}catch(c){n(c)}},a=l=>{try{o(i.throw(l))}catch(c){n(c)}},o=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,a);o((i=i.apply(t,e)).next())});function fr(t){const e=t.filter(i=>!!i);return e.reduce((i,r)=>{const n="output"in i?i.output:i,s="input"in r?r.input:r;return n.connect(s),r}),()=>{e.reduce((i,r)=>{const n="output"in i?i.output:i,s="input"in r?r.input:r;return n.disconnect(s),r})}}function Zh(t){let e=t;const i=new Set;function r(a){return i.add(a),a(e),()=>{i.delete(a)}}function n(a){e=a,i.forEach(o=>o(e))}function s(){return e}return{subscribe:r,set:n,get:s}}function Qh(){const t=new Set;function e(r){return t.add(r),()=>{t.delete(r)}}function i(r){t.forEach(n=>n(r))}return{subscribe:e,trigger:i}}function ef(t){let e=!1;return()=>{e||(e=!0,t.forEach(i=>i==null?void 0:i()))}}function Tl(t){return t*t/16129}function tf(t){return Math.pow(10,t/20)}var ft,We,Ot,Dt,pr,pt,mt,Il=class{constructor(t,e){this.context=t,$(this,ft),$(this,We),$(this,Ot),$(this,Dt),$(this,pr),$(this,pt),$(this,mt,!1);var i,r,n;q(this,pt,{destination:(i=e==null?void 0:e.destination)!=null?i:t.destination,volume:(r=e==null?void 0:e.volume)!=null?r:100,volumeToGain:(n=e==null?void 0:e.volumeToGain)!=null?n:Tl}),this.input=t.createGain(),q(this,ft,t.createGain()),q(this,Dt,fr([this.input,E(this,ft),E(this,pt).destination]));const s=Zh(E(this,pt).volume);this.setVolume=s.set,q(this,pr,s.subscribe(a=>{E(this,ft).gain.value=E(this,pt).volumeToGain(a)}))}addInsert(t){var e;if(E(this,mt))throw Error("Can't add insert to disconnected channel");(e=E(this,Ot))!=null||q(this,Ot,[]),E(this,Ot).push(t),E(this,Dt).call(this),q(this,Dt,fr([this.input,...E(this,Ot),E(this,ft),E(this,pt).destination]))}addEffect(t,e,i){var r;if(E(this,mt))throw Error("Can't add effect to disconnected channel");const n=this.context.createGain();n.gain.value=i;const s="input"in e?e.input:e,a=fr([E(this,ft),n,s]);(r=E(this,We))!=null||q(this,We,[]),E(this,We).push({name:t,mix:n,disconnect:a})}sendEffect(t,e){var i;if(E(this,mt))throw Error("Can't send effect to disconnected channel");const r=(i=E(this,We))==null?void 0:i.find(n=>n.name===t);r?r.mix.gain.value=e:console.warn("Send bus not found: "+t)}disconnect(){var t;E(this,mt)||(q(this,mt,!0),E(this,Dt).call(this),E(this,pr).call(this),(t=E(this,We))==null||t.forEach(e=>e.disconnect()),q(this,We,void 0))}};ft=new WeakMap;We=new WeakMap;Ot=new WeakMap;Dt=new WeakMap;pr=new WeakMap;pt=new WeakMap;mt=new WeakMap;var re,rf=class{constructor(t){this.compare=t,$(this,re,[])}push(t){const e=E(this,re).length;let i=0,r=e-1,n=e;for(;i<=r;){const s=Math.floor((i+r)/2);this.compare(t,E(this,re)[s])<0?(n=s,r=s-1):i=s+1}E(this,re).splice(n,0,t)}pop(){return E(this,re).shift()}peek(){return E(this,re)[0]}removeAll(t){const e=E(this,re).length;return q(this,re,E(this,re).filter(i=>!t(i))),E(this,re).length!==e}clear(){q(this,re,[])}size(){return E(this,re).length}};re=new WeakMap;function io(t,e){return t&&e?i=>{t(i),e(i)}:t??e}function nf(t){var e,i,r;const n={disableScheduler:(e=t.disableScheduler)!=null?e:!1,scheduleLookaheadMs:(i=t.scheduleLookaheadMs)!=null?i:200,scheduleIntervalMs:(r=t.scheduleIntervalMs)!=null?r:50,onStart:t.onStart,onEnded:t.onEnded};if(n.scheduleLookaheadMs<1)throw Error("scheduleLookaheadMs must be greater than 0");if(n.scheduleIntervalMs<1)throw Error("scheduleIntervalMs must be greater than 0");if(n.scheduleLookaheadMs<n.scheduleIntervalMs)throw Error("scheduleLookaheadMs must be greater than scheduleIntervalMs");return n}var Ie,ce,yt,Gl=class{constructor(t,e={}){$(this,Ie),$(this,ce),$(this,yt),q(this,Ie,nf(e)),q(this,ce,new rf((i,r)=>i.time-r.time)),this.player=t}get context(){return this.player.context}get buffers(){return this.player.buffers}get isRunning(){return E(this,yt)!==void 0}start(t){var e;if(E(this,Ie).disableScheduler)return this.player.start(t);const i=this.player.context,r=i.currentTime,n=(e=t.time)!=null?e:r,s=E(this,Ie).scheduleLookaheadMs/1e3;return t.onStart=io(t.onStart,E(this,Ie).onStart),t.onEnded=io(t.onEnded,E(this,Ie).onEnded),n<r+s?this.player.start(t):(E(this,ce).push(it(_e({},t),{time:n})),E(this,yt)||q(this,yt,setInterval(()=>{const a=i.currentTime+s;for(;E(this,ce).size()&&E(this,ce).peek().time<=a;){const o=E(this,ce).pop();o&&this.player.start(o)}E(this,ce).size()||(clearInterval(E(this,yt)),q(this,yt,void 0))},E(this,Ie).scheduleIntervalMs)),a=>{!a||a<n?E(this,ce).removeAll(o=>o===t)||this.player.stop(it(_e({},t),{time:a})):this.player.stop(it(_e({},t),{time:a}))})}stop(t){var e;if(E(this,Ie).disableScheduler)return this.player.stop(t);if(this.player.stop(t),!t){E(this,ce).clear();return}const i=(e=t==null?void 0:t.time)!=null?e:0,r=t==null?void 0:t.stopId;r?E(this,ce).removeAll(n=>n.time>=i&&n.stopId?n.stopId===r:n.note===r):E(this,ce).removeAll(n=>n.time>=i)}disconnect(){this.player.disconnect()}};Ie=new WeakMap;ce=new WeakMap;yt=new WeakMap;var hi,Ft,fi,Ol=class{constructor(t,e){this.context=t,this.options=e,$(this,hi),$(this,Ft,!1),$(this,fi);var i,r;q(this,hi,{velocityToGain:(i=e.velocityToGain)!=null?i:Tl,destination:(r=e.destination)!=null?r:t.destination}),this.buffers={},q(this,fi,Qh())}start(t){var e,i,r,n,s,a,o,l,c,d,u,f,h,m;if(E(this,Ft))throw new Error("Can't start a sample on disconnected player");const g=this.context,y=t.name&&this.buffers[t.name]||this.buffers[t.note];if(!y)return console.warn(`Sample not found: '${t.note}'`),()=>{};const p=g.createBufferSource();p.buffer=y;const _=(i=(e=t.detune)!=null?e:this.options.detune)!=null?i:0;p.detune?p.detune.value=_:p.playbackRate&&(p.playbackRate.value=Math.pow(2,_/1200));const M=(r=t.lpfCutoffHz)!=null?r:this.options.lpfCutoffHz,v=M?g.createBiquadFilter():void 0;M&&v&&(v.type="lowpass",v.frequency.value=M);const w=g.createGain(),S=(s=(n=t.velocity)!=null?n:this.options.velocity)!=null?s:100;w.gain.value=E(this,hi).velocityToGain(S),((a=t.loop)!=null?a:this.options.loop)&&(p.loop=!0,p.loopStart=(o=t.loopStart)!=null?o:0,p.loopEnd=(l=t.loopEnd)!=null?l:y.duration);const P=(c=t.decayTime)!=null?c:this.options.decayTime,[k,N]=sf(g,P);function L(G){if(G??(G=g.currentTime),G<=B)p.stop(G);else{const le=N(G);p.stop(le)}}const x=t.gainOffset?g.createGain():void 0;x&&t.gainOffset&&(x.gain.value=t.gainOffset);const T=(d=t.stopId)!=null?d:t.note,F=ef([fr([p,v,w,k,x,E(this,hi).destination]),(u=t.stop)==null?void 0:u.call(t,L),E(this,fi).subscribe(G=>{(!G||G.stopId===void 0||G.stopId===T)&&L(G==null?void 0:G.time)})]);p.onended=()=>{var G;F(),(G=t.onEnded)==null||G.call(t,t)},(f=t.onStart)==null||f.call(t,t);const B=Math.max((h=t.time)!=null?h:0,g.currentTime);p.start(t.time);let O=(m=t.duration)!=null?m:y.duration;return typeof t.duration=="number"&&L(B+O),L}stop(t){E(this,fi).trigger(t)}disconnect(){E(this,Ft)||(q(this,Ft,!0),this.stop(),Object.keys(this.buffers).forEach(t=>{delete this.buffers[t]}))}get connected(){return!E(this,Ft)}};hi=new WeakMap;Ft=new WeakMap;fi=new WeakMap;function sf(t,e=.2){let i=0;const r=t.createGain();r.gain.value=1;function n(s){if(i)return i;r.gain.cancelScheduledValues(s);const a=s||t.currentTime;return i=a+e,r.gain.setValueAtTime(1,a),r.gain.linearRampToValueAtTime(0,i),i}return[r,n]}var Xr=class{constructor(t,e){this.context=t;const i=new Il(t,e);this.player=new Gl(new Ol(t,it(_e({},e),{destination:i.input})),e),this.output=i}get buffers(){return this.player.buffers}start(t){return this.player.start(t)}stop(t){this.player.stop(typeof t=="object"?t:t!==void 0?{stopId:t}:void 0)}disconnect(){this.output.disconnect(),this.player.disconnect()}};function Ks(t,e,i){return Q(this,null,function*(){e=e.replace(/#/g,"%23").replace(/([^:]\/)\/+/g,"$1");const r=yield i.fetch(e);if(r.status!==200){console.warn("Error loading buffer. Invalid status: ",r.status,e);return}try{const n=yield r.arrayBuffer();return yield t.decodeAudioData(n)}catch(n){console.warn("Error loading buffer",n,e)}})}function Yr(t){if(typeof document>"u")return null;const e=document.createElement("audio");for(let i=0;i<t.length;i++){const r=t[i],n=e.canPlayType(`audio/${r}`);if(n==="probably"||n==="maybe")return r;if(r==="m4a"){const s=e.canPlayType("audio/aac");if(s==="probably"||s==="maybe")return r}}return null}function af(){var t;return"."+((t=Yr(["ogg","m4a"]))!=null?t:"ogg")}var qi={fetch(t){return fetch(t)}};function Dl(t){return typeof t=="object"&&typeof t.baseUrl=="string"&&typeof t.name=="string"&&Array.isArray(t.samples)&&Array.isArray(t.groupNames)&&typeof t.nameToSampleName=="object"&&typeof t.sampleGroupVariations=="object"}var of={baseUrl:"",name:"",samples:[],groupNames:[],nameToSampleName:{},sampleGroupVariations:{}};function lf(t,e){return Q(this,null,function*(){var i,r,n,s;const o=yield(yield e.fetch(t)).json();o.baseUrl=t.replace("/dm.json",""),o.groupNames=[],o.nameToSampleName={},o.sampleGroupVariations={};for(const l of o.samples){o.nameToSampleName[l]=l;const c=l.indexOf("/")!==-1?"/":"-",[d,u]=l.split(c);o.groupNames.includes(d)||o.groupNames.push(d),(r=(i=o.nameToSampleName)[d])!=null||(i[d]=l),(s=(n=o.sampleGroupVariations)[d])!=null||(n[d]=[]),u&&o.sampleGroupVariations[d].push(`${d}${c}${u}`)}return o})}function Fl(){return Object.keys(Rl)}var Rl={"TR-808":"https://smpldsnds.github.io/drum-machines/TR-808/dm.json","Casio-RZ1":"https://smpldsnds.github.io/drum-machines/Casio-RZ1/dm.json","LM-2":"https://smpldsnds.github.io/drum-machines/LM-2/dm.json","MFB-512":"https://smpldsnds.github.io/drum-machines/MFB-512/dm.json","Roland CR-8000":"https://smpldsnds.github.io/drum-machines/Roland-CR-8000/dm.json"};function df(t){var e,i,r;const n={instrument:(e=t==null?void 0:t.instrument)!=null?e:"TR-808",storage:(i=t==null?void 0:t.storage)!=null?i:qi,url:(r=t==null?void 0:t.url)!=null?r:""};if(typeof n.instrument=="string"){if(n.url||(n.url=Rl[n.instrument]),!n.url)throw new Error("Invalid instrument: "+n.instrument)}else if(!Dl(n.instrument))throw new Error("Invalid instrument: "+n.instrument);return n}var Ge,cf=class{constructor(t,e){$(this,Ge,of);const i=df(e),r=Dl(i.instrument)?Promise.resolve(i.instrument):lf(i.url,i.storage);this.player=new Xr(t,e),this.output=this.player.output,this.load=uf(t,this.player.buffers,r,i.storage).then(()=>this),r.then(n=>{q(this,Ge,n)})}getSampleNames(){return E(this,Ge).samples.slice()}getGroupNames(){return E(this,Ge).groupNames.slice()}getSampleNamesForGroup(t){var e;return(e=E(this,Ge).sampleGroupVariations[t])!=null?e:[]}start(t){var e;const i=E(this,Ge).nameToSampleName[t.note];return this.player.start(it(_e({},t),{note:i||t.note,stopId:(e=t.stopId)!=null?e:t.note}))}stop(t){return this.player.stop(t)}loaded(){return Q(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}get sampleNames(){return console.log("deprecated: Use getGroupNames instead"),E(this,Ge).groupNames.slice()}getVariations(t){var e;return console.warn("deprecated: use getSampleNamesForGroup"),(e=E(this,Ge).sampleGroupVariations[t])!=null?e:[]}};Ge=new WeakMap;function uf(t,e,i,r){var n;const s=(n=Yr(["ogg","m4a"]))!=null?n:"ogg";return i.then(a=>Promise.all(a.samples.map(o=>Q(this,null,function*(){const l=`${a.baseUrl}/${o}.${s}`,c=yield Ks(t,l,r);c&&(e[o]=c)}))))}function hf(t){const i=/^([a-gA-G]?)(#{1,}|b{1,}|)(-?\d+)$/.exec(t);if(!i)return;const r=i[1].toUpperCase();if(!r)return;const n=i[2],s=n[0]==="b"?-n.length:n.length,a=i[3]?+i[3]:4,o=(r.charCodeAt(0)+3)%7;return[0,2,4,5,7,9,11][o]+s+12*(a+1)}function je(t){return t===void 0?void 0:typeof t=="number"?t:hf(t)}function ff(t={}){return{groups:[],options:t}}function $s(){return{regions:[]}}function Ul(t,e,i,r){const n=[],s=je(e.note);if(s===void 0)return n;for(const a of t.regions){const o=Hl(s,i??0,e,a,r);o&&n.push(o)}return n}function pf(t,e,i,r){const n=je(e.note);if(n!==void 0)for(const s of t.regions){const a=Hl(n,0,e,s,r);if(a)return a}}function Hl(t,e,i,r,n){var s,a,o,l,c,d,u,f,h,m,g,y,p,_,M,v,w,S,C,P,k,N,L,x,T,F,B,O;if(!(t>=((s=r.midiLow)!=null?s:0)&&t<((a=r.midiHigh)!=null?a:127)+1)||!(i.velocity===void 0||i.velocity>=((o=r.velLow)!=null?o:0)&&i.velocity<=((l=r.velHigh)!=null?l:127)))return;if(r.seqLength){const Ve=e%r.seqLength,Me=((c=r.seqPosition)!=null?c:1)-1;if(Ve!==Me)return}const ie=t-r.midiPitch,de=(d=i.velocity)!=null?d:n==null?void 0:n.velocity,ze=r.volume?tf(r.volume):0,at=(f=(u=i.gainOffset)!=null?u:void 0)!=null?f:0,It=(h=i.detune)!=null?h:0;return{decayTime:(y=(g=i==null?void 0:i.decayTime)!=null?g:(m=r.sample)==null?void 0:m.decayTime)!=null?y:n==null?void 0:n.decayTime,detune:100*(ie+((p=r.tune)!=null?p:0))+It,duration:(v=(M=i==null?void 0:i.duration)!=null?M:(_=r.sample)==null?void 0:_.duration)!=null?v:n==null?void 0:n.duration,gainOffset:at+ze||void 0,loop:(C=(S=i==null?void 0:i.loop)!=null?S:(w=r.sample)==null?void 0:w.loop)!=null?C:n==null?void 0:n.loop,loopEnd:(N=(k=i==null?void 0:i.loopEnd)!=null?k:(P=r.sample)==null?void 0:P.loopEnd)!=null?N:n==null?void 0:n.loopEnd,loopStart:(T=(x=i==null?void 0:i.loopStart)!=null?x:(L=r.sample)==null?void 0:L.loopStart)!=null?T:n==null?void 0:n.loopStart,lpfCutoffHz:(O=(B=i==null?void 0:i.lpfCutoffHz)!=null?B:(F=r.sample)==null?void 0:F.lpfCutoffHz)!=null?O:n==null?void 0:n.lpfCutoffHz,name:r.sampleName,note:t,onEnded:i.onEnded,onStart:i.onStart,stopId:i.name,time:i.time,velocity:de??void 0}}function mf(t){if(t.length===0)return[];if(t.sort((e,i)=>e.midiPitch-i.midiPitch),t[0].midiLow=0,t[0].midiHigh=127,t.length===1)return t;for(let e=1;e<t.length;e++){const i=t[e-1],r=t[e],n=Math.floor((i.midiPitch+r.midiPitch)/2);i.midiHigh=n,r.midiLow=n+1}return t[t.length-1].midiHigh=127,t}var yf=class{constructor(t,e){this.context=t,this.seqNum=0;const i=new Il(t,e);this.instrument=ff(e),this.player=new Gl(new Ol(t,it(_e({},e),{destination:i.input})),e),this.output=i}get buffers(){return this.player.buffers}start(t){const e=[],i=typeof t=="object"?t:{note:t};for(const r of this.instrument.groups){const n=Ul(r,i,this.seqNum);this.seqNum++;for(const s of n){let a=this.player.start(s);e.push(a)}}return r=>e.forEach(n=>n(r))}stop(t){if(t==null){this.player.stop();return}const e=typeof t=="object"?t:{stopId:t},i=je(e.stopId);i&&(e.stopId=i,this.player.stop(e))}disconnect(){this.output.disconnect(),this.player.disconnect()}};function ql(t,e){const i=af();return(r,n)=>Q(this,null,function*(){const s=yield fetch(t).then(l=>l.text()),a=gf(s,e.group);a.length&&console.warn("Problems converting sfz",a);const o=new Set;return e.group.regions.forEach(l=>o.add(l.sampleName)),Promise.all(Array.from(o).map(l=>Q(this,null,function*(){const c=e.urlFromSampleName(l,i),d=yield Ks(r,c,n);e.buffers[l]=d}))).then(()=>e.group)})}function gf(t,e){let i="global";const r=t.split(`
`).map(wf).filter(a=>!!a),n=new Sf;let s=[];for(const a of r)switch(a.type){case"mode":s.push(n.closeScope(i,e)),i=a.value;break;case"prop:num":case"prop:str":case"prop:num_arr":n.push(a.key,a.value);break;case"unknown":console.warn("Unknown SFZ token",a.value);break}return s.filter(a=>!!a)}var vf=/^<([^>]+)>$/,_f=/^([^=]+)=([-\.\d]+)$/,bf=/^([^=]+)=(.+)$/,Mf=/^([^=]+)_(\d+)=(\d+)$/;function wf(t){if(t=t.trim(),t===""||t.startsWith("//"))return;const e=t.match(vf);if(e)return{type:"mode",value:e[1]};const i=t.match(Mf);if(i)return{type:"prop:num_arr",key:i[1],value:[Number(i[2]),Number(i[3])]};const r=t.match(_f);if(r)return{type:"prop:num",key:r[1],value:Number(r[2])};const n=t.match(bf);return n?{type:"prop:str",key:n[1],value:n[2]}:{type:"unknown",value:t}}var pi,mr,Sf=class{constructor(){$(this,pi),this.values={},this.global={},this.group={}}closeScope(t,e){if(t==="global")hr(this,pi,mr).call(this,this.global);else if(t==="group")this.group=hr(this,pi,mr).call(this,{});else if(t==="region"){const i=hr(this,pi,mr).call(this,_e(_e({sampleName:"",midiPitch:-1},this.global),this.group));if(i.sampleName==="")return"Missing sample name";if(i.midiPitch===-1)if(i.midiLow!==void 0)i.midiPitch=i.midiLow;else return"Missing pitch_keycenter";i.seqLength&&i.seqPosition===void 0&&(i.seqPosition=1),i.ampRelease&&(i.sample={decayTime:i.ampRelease},delete i.ampRelease),e.regions.push(i)}}get empty(){return Object.keys(this.values).length===0}get keys(){return Object.keys(this.values)}push(t,e){this.values[t]=e}popNum(t,e,i){return typeof this.values[t]!="number"?!1:(e[i]=this.values[t],delete this.values[t],!0)}popStr(t,e,i){return typeof this.values[t]!="string"?!1:(e[i]=this.values[t],delete this.values[t],!0)}popNumArr(t,e,i){return Array.isArray(this.values[t])?(e[i]=this.values[t],delete this.values[t],!0):!1}};pi=new WeakSet;mr=function(t){return this.popStr("sample",t,"sampleName"),this.popNum("pitch_keycenter",t,"midiPitch"),this.popNum("ampeg_attack",t,"ampAttack"),this.popNum("ampeg_release",t,"ampRelease"),this.popNum("bend_down",t,"bendDown"),this.popNum("bend_up",t,"bendUp"),this.popNum("group",t,"group"),this.popNum("hikey",t,"midiHigh"),this.popNum("hivel",t,"velHigh"),this.popNum("lokey",t,"midiLow"),this.popNum("offset",t,"offset"),this.popNum("lovel",t,"velLow"),this.popNum("off_by",t,"groupOffBy"),this.popNum("pitch_keytrack",t,"ignore"),this.popNum("seq_length",t,"seqLength"),this.popNum("seq_position",t,"seqPosition"),this.popNum("tune",t,"tune"),this.popNum("volume",t,"volume"),this.popNumArr("amp_velcurve",t,"ampVelCurve"),this.values={},t};var Cf="https://smpldsnds.github.io/sgossner-vcsl/";function Pf(t){return Cf+t+".sfz"}function Nf(t,e){const i=Pf(t),n=`https://smpldsnds.github.io/sgossner-vcsl/${t.slice(0,t.lastIndexOf("/")+1)}`,s=$s();return ql(i,{buffers:e,group:s,urlFromSampleName:(a,o)=>n+"/"+a.replace(".wav",o)})}var kf=class{constructor(t,e={}){var i,r;this.config={instrument:(i=e.instrument)!=null?i:"Arco",storage:(r=e.storage)!=null?r:qi},this.player=new yf(t,e);const n=Nf(this.config.instrument,this.player.buffers);this.load=n(t,this.config.storage).then(s=>(this.player.instrument.groups.push(s),this))}get output(){return this.player.output}get buffers(){return this.player.buffers}get context(){return this.player.context}start(t){return this.player.start(t)}stop(t){return this.player.stop(t)}disconnect(){this.player.disconnect()}};function xf(){return Object.keys(jl)}var Lf=class extends kf{constructor(t,e){var i;super(t,it(_e({},e),{instrument:jl[(i=e.instrument)!=null?i:""]}))}},jl={"Balafon - Hard Mallet":"Idiophones/Struck Idiophones/Balafon - Hard Mallet","Balafon - Keyswitch":"Idiophones/Struck Idiophones/Balafon - Keyswitch","Balafon - Soft Mallet":"Idiophones/Struck Idiophones/Balafon - Soft Mallet","Balafon - Traditional Mallet":"Idiophones/Struck Idiophones/Balafon - Traditional Mallet","Tubular Bells 1":"Idiophones/Struck Idiophones/Tubular Bells 1","Tubular Bells 2":"Idiophones/Struck Idiophones/Tubular Bells 2","Vibraphone - Bowed":"Idiophones/Struck Idiophones/Vibraphone - Bowed","Vibraphone - Hard Mallets":"Idiophones/Struck Idiophones/Vibraphone - Hard Mallets","Vibraphone - Keyswitch":"Idiophones/Struck Idiophones/Vibraphone - Keyswitch","Vibraphone - Soft Mallets":"Idiophones/Struck Idiophones/Vibraphone - Soft Mallets","Xylophone - Hard Mallets":"Idiophones/Struck Idiophones/Xylophone - Hard Mallets","Xylophone - Keyswitch":"Idiophones/Struck Idiophones/Xylophone - Keyswitch","Xylophone - Medium Mallets":"Idiophones/Struck Idiophones/Xylophone - Medium Mallets","Xylophone - Soft Mallets":"Idiophones/Struck Idiophones/Xylophone - Soft Mallets"};function Ef(){return["Pizzicato","Arco","Switched"]}function Af(t){return`https://smpldsnds.github.io/sfzinstruments-dsmolken-double-bass/d_smolken_rubner_bass_${{Arco:"arco",Pizzicato:"pizz",Switched:"switched"}[t]}.sfz`}var Bf=class{constructor(t,e={}){this.seqNum=0;var i,r;this.config={instrument:(i=e.instrument)!=null?i:"Arco",storage:(r=e.storage)!=null?r:qi},this.player=new Xr(t,e),this.group=$s();const n=Af(this.config.instrument),s=ql(n,{buffers:this.player.buffers,group:this.group,urlFromSampleName:(a,o)=>`https://smpldsnds.github.io/sfzinstruments-dsmolken-double-bass/${a.replace("\\","/").replace(".wav",o)}`});this.load=s(t,this.config.storage).then(()=>this)}get output(){return this.player.output}get buffers(){return this.player.buffers}get context(){return this.player.context}start(t){const e=Ul(this.group,typeof t=="object"?t:{note:t},this.seqNum);this.seqNum++;const i=e.map(r=>this.player.start(r));return r=>i.forEach(n=>n(r))}stop(t){if(t==null){this.player.stop();return}const e=typeof t=="object"?t:{stopId:t},i=je(e.stopId);i&&(e.stopId=i,this.player.stop(e))}disconnect(){this.player.disconnect()}};function Tf(t,e){var i;const r=(i=Yr(["ogg","mp3"]))!=null?i:"mp3";return`https://gleitz.github.io/midi-js-soundfonts/${e}/${t}-${r}.js`}function If(t,e,i){return(r,n)=>Q(this,null,function*(){const s=yield(yield n.fetch(t)).text(),a=Gf(s),o=Object.keys(a);yield Promise.all(o.map(l=>Q(this,null,function*(){const c=je(l);if(!c)return;const d=Df(Of(a[l])),u=yield r.decodeAudioData(d);e[l]=u,i.regions.push({sampleName:l,midiPitch:c})}))),mf(i.regions)})}function Gf(t){const e=t.indexOf("MIDI.Soundfont.");if(e<0)throw Error("Invalid MIDI.js Soundfont format");const i=t.indexOf("=",e)+2,r=t.lastIndexOf(",");return JSON.parse(t.slice(i,r)+"}")}function Of(t){return t.slice(t.indexOf(",")+1)}function Df(t){const e=window.atob(t),i=e.length,r=new Uint8Array(i);for(let n=0;n<i;n++)r[n]=e.charCodeAt(n);return r.buffer}var Ff=["MusyngKite","FluidR3_GM"],Rf=["accordion","acoustic_bass","acoustic_grand_piano","acoustic_guitar_nylon","acoustic_guitar_steel","agogo","alto_sax","applause","bagpipe","banjo","baritone_sax","bassoon","bird_tweet","blown_bottle","brass_section","breath_noise","bright_acoustic_piano","celesta","cello","choir_aahs","church_organ","clarinet","clavinet","contrabass","distortion_guitar","drawbar_organ","dulcimer","electric_bass_finger","electric_bass_pick","electric_grand_piano","electric_guitar_clean","electric_guitar_jazz","electric_guitar_muted","electric_piano_1","electric_piano_2","english_horn","fiddle","flute","french_horn","fretless_bass","fx_1_rain","fx_2_soundtrack","fx_3_crystal","fx_4_atmosphere","fx_5_brightness","fx_6_goblins","fx_7_echoes","fx_8_scifi","glockenspiel","guitar_fret_noise","guitar_harmonics","gunshot","harmonica","harpsichord","helicopter","honkytonk_piano","kalimba","koto","lead_1_square","lead_2_sawtooth","lead_3_calliope","lead_4_chiff","lead_5_charang","lead_6_voice","lead_7_fifths","lead_8_bass__lead","marimba","melodic_tom","music_box","muted_trumpet","oboe","ocarina","orchestra_hit","orchestral_harp","overdriven_guitar","pad_1_new_age","pad_2_warm","pad_3_polysynth","pad_4_choir","pad_5_bowed","pad_6_metallic","pad_7_halo","pad_8_sweep","pan_flute","percussive_organ","piccolo","pizzicato_strings","recorder","reed_organ","reverse_cymbal","rock_organ","seashore","shakuhachi","shamisen","shanai","sitar","slap_bass_1","slap_bass_2","soprano_sax","steel_drums","string_ensemble_1","string_ensemble_2","synth_bass_1","synth_bass_2","synth_brass_1","synth_brass_2","synth_choir","synth_drum","synth_strings_1","synth_strings_2","taiko_drum","tango_accordion","telephone_ring","tenor_sax","timpani","tinkle_bell","tremolo_strings","trombone","trumpet","tuba","tubular_bells","vibraphone","viola","violin","voice_oohs","whistle","woodblock","xylophone"];function Uf(t,e){if(!t.startsWith("http"))return`https://goldst.dev/midi-js-soundfonts/${e}/${t}-loop.json`}function Hf(t,e=44100){return Q(this,null,function*(){if(t)try{const i=yield fetch(t);if(i.status!==200)return;const r=yield i.json(),n={};return Object.keys(r).forEach(s=>{const a=je(s);if(a){const o=r[s];n[a]=[o[0]/e,o[1]/e]}}),n}catch{return}})}function qf(){return Ff}function jf(){return Rf}var mi,Kf=class{constructor(t,e){this.context=t,$(this,mi),this.config=zf(e),this.player=new Xr(t,e),this.group=$s(),q(this,mi,!1);const i=$f(this.config.instrumentUrl,this.config.loopDataUrl,this.player.buffers,this.group);this.load=i(t,this.config.storage).then(n=>(q(this,mi,n),this));const r=t.createGain();r.gain.value=this.config.extraGain,this.player.output.addInsert(r)}get output(){return this.player.output}get hasLoops(){return E(this,mi)}loaded(){return Q(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}disconnect(){this.player.disconnect()}start(t){const e=pf(this.group,typeof t=="object"?t:{note:t});return e?this.player.start(e):()=>{}}stop(t){return this.player.stop(t)}};mi=new WeakMap;function $f(t,e,i,r){const n=If(t,i,r);return(s,a)=>Q(this,null,function*(){const[o,l]=yield Promise.all([n(s,a),Hf(e)]);return l&&r.regions.forEach(c=>{var d;const u=l[c.midiPitch];u&&((d=c.sample)!=null||(c.sample={}),c.sample.loop=!0,c.sample.loopStart=u[0],c.sample.loopEnd=u[1])}),!!l})}function zf(t){var e,i,r,n;if(!t.instrument&&!t.instrumentUrl)throw Error("Soundfont: instrument or instrumentUrl is required");const s={kit:"MusyngKite",instrument:t.instrument,storage:(e=t.storage)!=null?e:qi,extraGain:(i=t.extraGain)!=null?i:5,loadLoopData:(r=t.loadLoopData)!=null?r:!1,loopDataUrl:t.loopDataUrl,instrumentUrl:(n=t.instrumentUrl)!=null?n:""};if(s.instrument&&s.instrument.startsWith("http")&&(console.warn("Use 'instrumentUrl' instead of 'instrument' to load from a URL"),s.instrumentUrl=s.instrument,s.instrument=void 0),s.instrumentUrl)(s.kit||s.instrument)&&console.warn("Soundfont: 'kit' and 'instrument' config parameters are ignored because 'instrumentUrl' is explicitly set.");else if(s.instrument)s.instrumentUrl=Tf(s.instrument,s.kit);else throw Error("Soundfont: 'instrument' or 'instrumentUrl' configuration parameter is required");return s.loadLoopData&&s.instrument&&!s.loopDataUrl&&(s.loopDataUrl=Uf(s.instrument,s.kit)),s}var Vf="https://danigb.github.io/samples/splendid-grand-piano",Zn,Kl,Wf=class{constructor(t,e){this.context=t,$(this,Zn),this.options=Object.assign({baseUrl:Vf,storage:qi,detune:0,volume:100,velocity:100,decayTime:.5},e),this.player=new Xr(t,this.options);const i=Xf(this.options.baseUrl,this.options.storage,this.options.notesToLoad);this.load=i(t,this.player.buffers).then(()=>this)}get output(){return this.player.output}get buffers(){return this.player.buffers}loaded(){return Q(this,null,function*(){return console.warn("deprecated: use load instead"),this.load})}start(t){var e,i;const r=typeof t=="object"?_e({},t):{note:t},n=hr(this,Zn,Kl).call(this,r);return n?(r.note=n[0],r.stopId=(e=r.stopId)!=null?e:n[1],r.detune=n[2]+((i=r.detune)!=null?i:this.options.detune),this.player.start(r)):()=>{}}stop(t){var e;if(typeof t=="string")return this.player.stop((e=je(t))!=null?e:t);if(typeof t=="object"){const i=je(t.stopId);return this.player.stop(i!==void 0?it(_e({},t),{stopId:i}):t)}else return this.player.stop(t)}};Zn=new WeakSet;Kl=function(t){var e;const i=je(t.note);if(!i)return;const r=(e=t.velocity)!=null?e:this.options.velocity,n=$r.findIndex(a=>r>=a.vel_range[0]&&r<=a.vel_range[1]),s=$r[n];if(s)return Jf(s.name,i,this.player.buffers)};function Jf(t,e,i){let r=0;for(;i[t+(e+r)]===void 0&&r<128;)r>0?r=-r:r=-r+1;return r===127?[t+e,e,0]:[t+(e+r),e,-r*100]}function Xf(t,e,i){var r;const n=(r=Yr(["ogg","m4a"]))!=null?r:"ogg";let s=i?$r.filter(a=>a.vel_range[0]<=i.velocityRange[1]&&a.vel_range[1]>=i.velocityRange[0]):$r;return(a,o)=>Q(this,null,function*(){for(const l of s){const c=i?l.samples.filter(d=>i.notes.includes(d[0])):l.samples;yield Promise.all(c.map(d=>Q(this,[d],function*([u,f]){const h=`${t}/${f}.${n}`,m=yield Ks(a,h,e);m&&(o[l.name+u]=m)})))}})}var $r=[{name:"PPP",vel_range:[1,40],cutoff:1e3,samples:[[23,"PP-B-1"],[27,"PP-D#0"],[29,"PP-F0"],[31,"PP-G0"],[33,"PP-A0"],[35,"PP-B0"],[37,"PP-C#1"],[38,"PP-D1"],[40,"PP-E1"],[41,"PP-F1"],[43,"PP-G1"],[45,"PP-A1"],[47,"PP-B1"],[48,"PP-C2"],[50,"PP-D2"],[52,"PP-E2"],[53,"PP-F2"],[55,"PP-G2"],[56,"PP-G#2"],[57,"PP-A2"],[58,"PP-A#2"],[59,"PP-B2"],[60,"PP-C3"],[62,"PP-D3"],[64,"PP-E3"],[65,"PP-F3"],[67,"PP-G3"],[69,"PP-A3"],[71,"PP-B3"],[72,"PP-C4"],[74,"PP-D4"],[76,"PP-E4"],[77,"PP-F4"],[79,"PP-G4"],[80,"PP-G#4"],[81,"PP-A4"],[82,"PP-A#4"],[83,"PP-B4"],[85,"PP-C#5"],[86,"PP-D5"],[87,"PP-D#5"],[89,"PP-F5"],[90,"PP-F#5"],[91,"PP-G5"],[92,"PP-G#5"],[93,"PP-A5"],[94,"PP-A#5"],[95,"PP-B5"],[96,"PP-C6"],[97,"PP-C#6"],[98,"PP-D6"],[99,"PP-D#6"],[100,"PP-E6"],[101,"PP-F6"],[102,"PP-F#6"],[103,"PP-G6"],[104,"PP-G#6"],[105,"PP-A6"],[106,"PP-A#6"],[107,"PP-B6"],[108,"PP-C7"]]},{name:"PP",vel_range:[41,67],samples:[[23,"PP-B-1"],[27,"PP-D#0"],[29,"PP-F0"],[31,"PP-G0"],[33,"PP-A0"],[35,"PP-B0"],[37,"PP-C#1"],[38,"PP-D1"],[40,"PP-E1"],[41,"PP-F1"],[43,"PP-G1"],[45,"PP-A1"],[47,"PP-B1"],[48,"PP-C2"],[50,"PP-D2"],[52,"PP-E2"],[53,"PP-F2"],[55,"PP-G2"],[56,"PP-G#2"],[57,"PP-A2"],[58,"PP-A#2"],[59,"PP-B2"],[60,"PP-C3"],[62,"PP-D3"],[64,"PP-E3"],[65,"PP-F3"],[67,"PP-G3"],[69,"PP-A3"],[71,"PP-B3"],[72,"PP-C4"],[74,"PP-D4"],[76,"PP-E4"],[77,"PP-F4"],[79,"PP-G4"],[80,"PP-G#4"],[81,"PP-A4"],[82,"PP-A#4"],[83,"PP-B4"],[85,"PP-C#5"],[86,"PP-D5"],[87,"PP-D#5"],[89,"PP-F5"],[90,"PP-F#5"],[91,"PP-G5"],[92,"PP-G#5"],[93,"PP-A5"],[94,"PP-A#5"],[95,"PP-B5"],[96,"PP-C6"],[97,"PP-C#6"],[98,"PP-D6"],[99,"PP-D#6"],[100,"PP-E6"],[101,"PP-F6"],[102,"PP-F#6"],[103,"PP-G6"],[104,"PP-G#6"],[105,"PP-A6"],[106,"PP-A#6"],[107,"PP-B6"],[108,"PP-C7"]]},{name:"MP",vel_range:[68,84],samples:[[23,"Mp-B-1"],[27,"Mp-D#0"],[29,"Mp-F0"],[31,"Mp-G0"],[33,"Mp-A0"],[35,"Mp-B0"],[37,"Mp-C#1"],[38,"Mp-D1"],[40,"Mp-E1"],[41,"Mp-F1"],[43,"Mp-G1"],[45,"Mp-A1"],[47,"Mp-B1"],[48,"Mp-C2"],[50,"Mp-D2"],[52,"Mp-E2"],[53,"Mp-F2"],[55,"Mp-G2"],[56,"Mp-G#2"],[57,"Mp-A2"],[58,"Mp-A#2"],[59,"Mp-B2"],[60,"Mp-C3"],[62,"Mp-D3"],[64,"Mp-E3"],[65,"Mp-F3"],[67,"Mp-G3"],[69,"Mp-A3"],[71,"Mp-B3"],[72,"Mp-C4"],[74,"Mp-D4"],[76,"Mp-E4"],[77,"Mp-F4"],[79,"Mp-G4"],[80,"Mp-G#4"],[81,"Mp-A4"],[82,"Mp-A#4"],[83,"Mp-B4"],[85,"Mp-C#5"],[86,"Mp-D5"],[87,"Mp-D#5"],[88,"Mp-E5"],[89,"Mp-F5"],[90,"Mp-F#5"],[91,"Mp-G5"],[92,"Mp-G#5"],[93,"Mp-A5"],[94,"Mp-A#5"],[95,"Mp-B5"],[96,"Mp-C6"],[97,"Mp-C#6"],[98,"Mp-D6"],[99,"Mp-D#6"],[100,"PP-E6"],[101,"Mp-F6"],[102,"Mp-F#6"],[103,"Mp-G6"],[104,"Mp-G#6"],[105,"Mp-A6"],[106,"Mp-A#6"],[107,"PP-B6"],[108,"PP-C7"]]},{name:"MF",vel_range:[85,100],samples:[[23,"Mf-B-1"],[27,"Mf-D#0"],[29,"Mf-F0"],[31,"Mf-G0"],[33,"Mf-A0"],[35,"Mf-B0"],[37,"Mf-C#1"],[38,"Mf-D1"],[40,"Mf-E1"],[41,"Mf-F1"],[43,"Mf-G1"],[45,"Mf-A1"],[47,"Mf-B1"],[48,"Mf-C2"],[50,"Mf-D2"],[52,"Mf-E2"],[53,"Mf-F2"],[55,"Mf-G2"],[56,"Mf-G#2"],[57,"Mf-A2"],[58,"Mf-A#2"],[59,"Mf-B2"],[60,"Mf-C3"],[62,"Mf-D3"],[64,"Mf-E3"],[65,"Mf-F3"],[67,"Mf-G3"],[69,"Mf-A3"],[71,"Mf-B3"],[72,"Mf-C4"],[74,"Mf-D4"],[76,"Mf-E4"],[77,"Mf-F4"],[79,"Mf-G4"],[80,"Mf-G#4"],[81,"Mf-A4"],[82,"Mf-A#4"],[83,"Mf-B4"],[85,"Mf-C#5"],[86,"Mf-D5"],[87,"Mf-D#5"],[88,"Mf-E5"],[89,"Mf-F5"],[90,"Mf-F#5"],[91,"Mf-G5"],[92,"Mf-G#5"],[93,"Mf-A5"],[94,"Mf-A#5"],[95,"Mf-B5"],[96,"Mf-C6"],[97,"Mf-C#6"],[98,"Mf-D6"],[99,"Mf-D#6"],[100,"Mf-E6"],[101,"Mf-F6"],[102,"Mf-F#6"],[103,"Mf-G6"],[104,"Mf-G#6"],[105,"Mf-A6"],[106,"Mf-A#6"],[107,"Mf-B6"],[108,"PP-C7"]]},{name:"FF",vel_range:[101,127],samples:[[23,"FF-B-1"],[27,"FF-D#0"],[29,"FF-F0"],[31,"FF-G0"],[33,"FF-A0"],[35,"FF-B0"],[37,"FF-C#1"],[38,"FF-D1"],[40,"FF-E1"],[41,"FF-F1"],[43,"FF-G1"],[45,"FF-A1"],[47,"FF-B1"],[48,"FF-C2"],[50,"FF-D2"],[52,"FF-E2"],[53,"FF-F2"],[55,"FF-G2"],[56,"FF-G#2"],[57,"FF-A2"],[58,"FF-A#2"],[59,"FF-B2"],[60,"FF-C3"],[62,"FF-D3"],[64,"FF-E3"],[65,"FF-F3"],[67,"FF-G3"],[69,"FF-A3"],[71,"FF-B3"],[72,"FF-C4"],[74,"FF-D4"],[76,"FF-E4"],[77,"FF-F4"],[79,"FF-G4"],[80,"FF-G#4"],[81,"FF-A4"],[82,"FF-A#4"],[83,"FF-B4"],[85,"FF-C#5"],[86,"FF-D5"],[88,"FF-E5"],[89,"FF-F5"],[91,"FF-G5"],[93,"FF-A5"],[95,"Mf-B5"],[96,"Mf-C6"],[97,"Mf-C#6"],[98,"Mf-D6"],[99,"Mf-D#6"],[100,"Mf-E6"],[102,"Mf-F#6"],[103,"Mf-G6"],[104,"Mf-G#6"],[105,"Mf-A6"],[106,"Mf-A#6"],[107,"Mf-B6"],[108,"Mf-C7"]]}];function Et(t){const e=t.startsWith("/")?t.substring(1):t;return(window.location.pathname.startsWith("/sequenzia")?"/sequenzia/":"./")+e}function Yf(){const t=document.getElementById("modal-mount-root"),e=document.getElementById("splash-modal"),i=document.getElementById("splash-logo");t&&(t.classList.remove("content-hidden"),t.classList.add("content-visible")),i&&(i.src=Et("static/logo.png")),e==null||e.classList.remove("hidden")}function Zf(t=1e3){const e=document.getElementById("splash-modal"),i=document.getElementById("footer-main"),r=document.getElementById("content-main");e&&setTimeout(()=>{e.style.opacity="0",e.style.transition="opacity 0.5s ease-out",setTimeout(()=>{e.classList.add("hidden"),e.style.opacity="1",i&&(i.classList.remove("content-hidden"),i.classList.add("content-visible")),r&&(r.classList.remove("content-hidden"),r.classList.add("content-visible"))},500)},t)}function Qf(){const t=document.getElementById("splash-modal");return t?!t.classList.contains("hidden"):!1}let $l=!1;function yi(t="Loading Sounds...",e="Please wait while we dial it in.",i,r){Qf()||Vl()&&!r||(r&&(zs(),zl(!0)),Le.showLoading({title:t,subtext:e,cancelable:!!i}),i&&(Le.destroy(),Le.reload()))}function zs(t){t&&zl(!1),Vl()||Le.hideLoading()}function zl(t){$l=t}function Vl(){return $l}let wi=0;function Wl(){wi++,wi===1&&yi()}function Jl(){wi--,wi<=0&&(wi=0,zs())}async function ep(t){Wl();try{return await t}finally{Jl()}}const Cn=new Map;async function tp(t,e){e?await t.load:await ap(t.load)}async function Zr(t,e=ee(),i=null,r,n,s,a=!0){var w;const o=t.split("/");let l="sf2",c="musyngkite",d="acoustic_grand_piano";o.length===3?[l,c,d]=o:o.length===2?[c,d]=o:o.length===1&&(d=o[0]);const u=e instanceof OfflineAudioContext;Cn.has(e)||Cn.set(e,new Map);const f=Cn.get(e),h=String(e??ee()),m=`${c}/${d}@${h}`;if(a&&f.has(m))return f.get(m);const g=Math.max(0,Math.min(127,Math.round((r??1)*127))),y=e.createStereoPanner();n!==void 0&&(y.pan.value=n);const p=e.createGain();p.connect(y),i&&i.context!==e&&(console.warn("[loadInstrument] Ignoring mismatched destination from different context"),i=null),y.connect(i||$t(e));const _={instrument:d,volume:g,destination:p,disableScheduler:u};let M;if(c==="smolken")M=new Bf(e,_);else if(c==="splendidgrandpiano")M=new Wf(e,_);else if(c==="mallets")M=new Lf(e,_);else if(c==="drummachines")M=new cf(e,_);else{const C={"fluidr3-gm":"FluidR3_GM",fatboy:"FatBoy",musyngkite:"MusyngKite"}[c.toLowerCase()]||"MusyngKite",k=`https://gleitz.github.io/midi-js-soundfonts/${C}/${d}-ogg.js`;M=new Kf(e,{..._,instrumentUrl:k,kit:C})}if(await tp(M,s??!1),c==="drummachines"){const S=((w=M.getSampleNames)==null?void 0:w.call(M))??[],C=new Map;S.forEach((P,k)=>{const N=36+k;C.set(N,P)}),M.__midiMap=C}const v=M;return v.setVolume=S=>{var P;const C=Math.max(0,Math.min(127,Math.round(S*127)));"output"in v&&typeof((P=v.output)==null?void 0:P.setVolume)=="function"&&v.output.setVolume(C)},v.setPan=S=>{y.pan.value=Math.max(-1,Math.min(1,S))},a&&f.set(m,v),v}async function ip(){const e=rp().map(r=>{switch(r){case"FluidR3_GM":return"fluidr3-gm";case"FatBoy":return"fatboy";case"MusyngKite":return"musyngkite";default:return r.toLowerCase()}}),i=["splendidgrandpiano","mallets","drummachines","smolken"];return[...new Set([...e,...i])]}function rp(){const e=[...qf()];return e.includes("FatBoy")||e.push("FatBoy"),e}async function np(t){const e=t.toLowerCase();return e==="splendidgrandpiano"?["splendidgrandpiano"]:e==="mallets"?xf():e==="drummachines"?Fl():e==="smolken"?Ef():(await Zr(`${t}/acoustic_grand_piano`,ee(),null,0,0,!0),jf()??[])}function sp(){return Fl()}async function ap(t){Wl();try{await t}finally{Jl()}}function op(){return{name:"sf2",loadInstrument:Zr,getAvailableLibraries:ip,getAvailableInstruments:np}}let Pn=null,rr=null;function At(){return Pn||(Pn=new AudioContext),Pn}function lp(){if(!rr){const t=At();rr=t.createGain(),rr.connect(t.destination)}return rr}const dp={C:0,"C#":1,Db:1,D:2,"D#":3,Eb:3,E:4,Fb:4,"E#":5,F:5,"F#":6,Gb:6,G:7,"G#":8,Ab:8,A:9,"A#":10,Bb:10,B:11,Cb:11,"B#":0};function Z(t){const e=t==null?void 0:t.match(/^([A-Ga-g])([#b]*)(-?\d+)$/);if(!e)return null;const[,i,r,n]=e,s=i.toUpperCase(),a=dp[s];if(a===void 0)return null;const o=[...r].reduce((c,d)=>d==="#"?c+1:d==="b"?c-1:c,0);return 12*(parseInt(n,10)+1)+(a+o)}let Se=null,Qn=null;async function cp(t){if(Qn===t)return;Se=await Zr(t,At()),Qn=t}function up(){return Qn}function hp(t,e=100,i=!1){var o;if(!Se)return null;const n=At().currentTime,s=Z(t);if(s===null)return null;const a=((o=Se.__midiMap)==null?void 0:o.get(s))??s;return Se.start({note:a,stopId:a,velocity:e,time:n,loop:i}),()=>{Se==null||Se.stop({stopId:a})}}function fp(t){var r;if(!Se)return;const e=Z(t);if(e===null)return;const i=((r=Se.__midiMap)==null?void 0:r.get(e))??e;Se.stop({stopId:i})}async function pp(t,e,i,r=100,n=!1,s=null,a=null,o=null,l,c){var m;const d=a||ee(),u=await Zr(t,d,o,l,c);l!==void 0&&u.setVolume&&u.setVolume(l),c!==void 0&&u.setPan&&u.setPan(c);const f=Z(e);if(f===null)return null;const h=((m=u.__midiMap)==null?void 0:m.get(f))??f;return u.start({note:h,duration:i,velocity:r,loop:n,time:s??d.currentTime}),null}function mp(){return{name:"sf2",setActiveInstrument:cp,getActiveInstrumentName:up,playNote:hp,stopNoteByPitch:fp,loadAndPlayNote:pp}}const Ai=[{id:"0000_Aspirin_sf2_file",library:"Aspirin",displayName:"Acoustic Grand Piano"},{id:"0000_Chaos_sf2_file",library:"Chaos",displayName:"Acoustic Grand Piano"},{id:"0000_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Acoustic Grand Piano"},{id:"0000_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Acoustic Grand Piano"},{id:"0000_JCLive_sf2_file",library:"JCLive",displayName:"Acoustic Grand Piano"},{id:"0000_SBLive_sf2",library:"SBLive",displayName:"Acoustic Grand Piano"},{id:"0000_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Acoustic Grand Piano"},{id:"0010_Aspirin_sf2_file",library:"Aspirin",displayName:"Bright Acoustic Piano"},{id:"0010_Chaos_sf2_file",library:"Chaos",displayName:"Bright Acoustic Piano"},{id:"0010_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Bright Acoustic Piano"},{id:"0010_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Bright Acoustic Piano"},{id:"0010_JCLive_sf2_file",library:"JCLive",displayName:"Bright Acoustic Piano"},{id:"0010_SBLive_sf2",library:"SBLive",displayName:"Bright Acoustic Piano"},{id:"0010_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Bright Acoustic Piano"},{id:"0020_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Grand Piano"},{id:"0020_Chaos_sf2_file",library:"Chaos",displayName:"Electric Grand Piano"},{id:"0020_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Grand Piano"},{id:"0020_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Grand Piano"},{id:"0020_JCLive_sf2_file",library:"JCLive",displayName:"Electric Grand Piano"},{id:"0020_SBLive_sf2",library:"SBLive",displayName:"Electric Grand Piano"},{id:"0020_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Grand Piano"},{id:"0050_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Piano 2"},{id:"0050_Chaos_sf2_file",library:"Chaos",displayName:"Electric Piano 2"},{id:"0050_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Piano 2"},{id:"0050_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Piano 2"},{id:"0050_JCLive_sf2_file",library:"JCLive",displayName:"Electric Piano 2"},{id:"0050_SBLive_sf2",library:"SBLive",displayName:"Electric Piano 2"},{id:"0050_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Piano 2"},{id:"0060_Aspirin_sf2_file",library:"Aspirin",displayName:"Harpsichord"},{id:"0060_Chaos_sf2_file",library:"Chaos",displayName:"Harpsichord"},{id:"0060_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Harpsichord"},{id:"0060_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Harpsichord"},{id:"0060_JCLive_sf2_file",library:"JCLive",displayName:"Harpsichord"},{id:"0060_SBLive_sf2",library:"SBLive",displayName:"Harpsichord"},{id:"0060_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Harpsichord"},{id:"0070_Aspirin_sf2_file",library:"Aspirin",displayName:"Clavinet"},{id:"0070_Chaos_sf2_file",library:"Chaos",displayName:"Clavinet"},{id:"0070_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Clavinet"},{id:"0070_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Clavinet"},{id:"0070_JCLive_sf2_file",library:"JCLive",displayName:"Clavinet"},{id:"0070_SBLive_sf2",library:"SBLive",displayName:"Clavinet"},{id:"0070_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Clavinet"},{id:"0080_Aspirin_sf2_file",library:"Aspirin",displayName:"Celesta"},{id:"0080_Chaos_sf2_file",library:"Chaos",displayName:"Celesta"},{id:"0080_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Celesta"},{id:"0080_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Celesta"},{id:"0080_JCLive_sf2_file",library:"JCLive",displayName:"Celesta"},{id:"0080_SBLive_sf2",library:"SBLive",displayName:"Celesta"},{id:"0080_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Celesta"},{id:"0090_Aspirin_sf2_file",library:"Aspirin",displayName:"Glockenspiel"},{id:"0090_Chaos_sf2_file",library:"Chaos",displayName:"Glockenspiel"},{id:"0090_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Glockenspiel"},{id:"0090_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Glockenspiel"},{id:"0090_JCLive_sf2_file",library:"JCLive",displayName:"Glockenspiel"},{id:"0090_SBLive_sf2",library:"SBLive",displayName:"Glockenspiel"},{id:"0090_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Glockenspiel"},{id:"0100_Aspirin_sf2_file",library:"Aspirin",displayName:"Music Box"},{id:"0100_Chaos_sf2_file",library:"Chaos",displayName:"Music Box"},{id:"0100_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Music Box"},{id:"0100_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Music Box"},{id:"0100_JCLive_sf2_file",library:"JCLive",displayName:"Music Box"},{id:"0100_SBLive_sf2",library:"SBLive",displayName:"Music Box"},{id:"0100_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Music Box"},{id:"0110_Aspirin_sf2_file",library:"Aspirin",displayName:"Vibraphone"},{id:"0110_Chaos_sf2_file",library:"Chaos",displayName:"Vibraphone"},{id:"0110_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Vibraphone"},{id:"0110_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Vibraphone"},{id:"0110_JCLive_sf2_file",library:"JCLive",displayName:"Vibraphone"},{id:"0110_SBLive_sf2",library:"SBLive",displayName:"Vibraphone"},{id:"0110_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Vibraphone"},{id:"0120_Aspirin_sf2_file",library:"Aspirin",displayName:"Marimba"},{id:"0120_Chaos_sf2_file",library:"Chaos",displayName:"Marimba"},{id:"0120_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Marimba"},{id:"0120_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Marimba"},{id:"0120_JCLive_sf2_file",library:"JCLive",displayName:"Marimba"},{id:"0120_SBLive_sf2",library:"SBLive",displayName:"Marimba"},{id:"0120_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Marimba"},{id:"0130_Aspirin_sf2_file",library:"Aspirin",displayName:"Xylophone"},{id:"0130_Chaos_sf2_file",library:"Chaos",displayName:"Xylophone"},{id:"0130_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Xylophone"},{id:"0130_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Xylophone"},{id:"0130_JCLive_sf2_file",library:"JCLive",displayName:"Xylophone"},{id:"0130_SBLive_sf2",library:"SBLive",displayName:"Xylophone"},{id:"0130_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Xylophone"},{id:"0140_Aspirin_sf2_file",library:"Aspirin",displayName:"Tubular Bells"},{id:"0140_Chaos_sf2_file",library:"Chaos",displayName:"Tubular Bells"},{id:"0140_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tubular Bells"},{id:"0140_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tubular Bells"},{id:"0140_JCLive_sf2_file",library:"JCLive",displayName:"Tubular Bells"},{id:"0140_SBLive_sf2",library:"SBLive",displayName:"Tubular Bells"},{id:"0140_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tubular Bells"},{id:"0150_Aspirin_sf2_file",library:"Aspirin",displayName:"Dulcimer"},{id:"0150_Chaos_sf2_file",library:"Chaos",displayName:"Dulcimer"},{id:"0150_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Dulcimer"},{id:"0150_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Dulcimer"},{id:"0150_JCLive_sf2_file",library:"JCLive",displayName:"Dulcimer"},{id:"0150_SBLive_sf2",library:"SBLive",displayName:"Dulcimer"},{id:"0150_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Dulcimer"},{id:"0160_Aspirin_sf2_file",library:"Aspirin",displayName:"Drawbar Organ"},{id:"0160_Chaos_sf2_file",library:"Chaos",displayName:"Drawbar Organ"},{id:"0160_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drawbar Organ"},{id:"0160_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Drawbar Organ"},{id:"0160_JCLive_sf2_file",library:"JCLive",displayName:"Drawbar Organ"},{id:"0160_SBLive_sf2",library:"SBLive",displayName:"Drawbar Organ"},{id:"0160_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Drawbar Organ"},{id:"0170_Aspirin_sf2_file",library:"Aspirin",displayName:"Percussive Organ"},{id:"0170_Chaos_sf2_file",library:"Chaos",displayName:"Percussive Organ"},{id:"0170_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Percussive Organ"},{id:"0170_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Percussive Organ"},{id:"0170_JCLive_sf2_file",library:"JCLive",displayName:"Percussive Organ"},{id:"0170_SBLive_sf2",library:"SBLive",displayName:"Percussive Organ"},{id:"0170_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Percussive Organ"},{id:"0180_Aspirin_sf2_file",library:"Aspirin",displayName:"Rock Organ"},{id:"0180_Chaos_sf2_file",library:"Chaos",displayName:"Rock Organ"},{id:"0180_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Rock Organ"},{id:"0180_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Rock Organ"},{id:"0180_JCLive_sf2_file",library:"JCLive",displayName:"Rock Organ"},{id:"0180_SBLive_sf2",library:"SBLive",displayName:"Rock Organ"},{id:"0180_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Rock Organ"},{id:"0190_Aspirin_sf2_file",library:"Aspirin",displayName:"Church Organ"},{id:"0190_Chaos_sf2_file",library:"Chaos",displayName:"Church Organ"},{id:"0190_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Church Organ"},{id:"0190_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Church Organ"},{id:"0190_JCLive_sf2_file",library:"JCLive",displayName:"Church Organ"},{id:"0190_SBLive_sf2",library:"SBLive",displayName:"Church Organ"},{id:"0190_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Church Organ"},{id:"0200_Aspirin_sf2_file",library:"Aspirin",displayName:"Reed Organ"},{id:"0200_Chaos_sf2_file",library:"Chaos",displayName:"Reed Organ"},{id:"0200_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Reed Organ"},{id:"0200_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Reed Organ"},{id:"0200_JCLive_sf2_file",library:"JCLive",displayName:"Reed Organ"},{id:"0200_SBLive_sf2",library:"SBLive",displayName:"Reed Organ"},{id:"0200_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Reed Organ"},{id:"0210_Aspirin_sf2_file",library:"Aspirin",displayName:"Accordion"},{id:"0210_Chaos_sf2_file",library:"Chaos",displayName:"Accordion"},{id:"0210_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Accordion"},{id:"0210_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Accordion"},{id:"0210_JCLive_sf2_file",library:"JCLive",displayName:"Accordion"},{id:"0210_SBLive_sf2",library:"SBLive",displayName:"Accordion"},{id:"0210_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Accordion"},{id:"0220_Aspirin_sf2_file",library:"Aspirin",displayName:"Harmonica"},{id:"0220_Chaos_sf2_file",library:"Chaos",displayName:"Harmonica"},{id:"0220_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Harmonica"},{id:"0220_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Harmonica"},{id:"0220_JCLive_sf2_file",library:"JCLive",displayName:"Harmonica"},{id:"0220_SBLive_sf2",library:"SBLive",displayName:"Harmonica"},{id:"0220_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Harmonica"},{id:"0230_Aspirin_sf2_file",library:"Aspirin",displayName:"Tango Accordion"},{id:"0230_Chaos_sf2_file",library:"Chaos",displayName:"Tango Accordion"},{id:"0230_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tango Accordion"},{id:"0230_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tango Accordion"},{id:"0230_JCLive_sf2_file",library:"JCLive",displayName:"Tango Accordion"},{id:"0230_SBLive_sf2",library:"SBLive",displayName:"Tango Accordion"},{id:"0230_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tango Accordion"},{id:"0240_Aspirin_sf2_file",library:"Aspirin",displayName:"Acoustic Guitar (nylon)"},{id:"0240_Chaos_sf2_file",library:"Chaos",displayName:"Acoustic Guitar (nylon)"},{id:"0240_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Acoustic Guitar (nylon)"},{id:"0240_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Acoustic Guitar (nylon)"},{id:"0240_JCLive_sf2_file",library:"JCLive",displayName:"Acoustic Guitar (nylon)"},{id:"0240_SBLive_sf2",library:"SBLive",displayName:"Acoustic Guitar (nylon)"},{id:"0240_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Acoustic Guitar (nylon)"},{id:"0250_Aspirin_sf2_file",library:"Aspirin",displayName:"Acoustic Guitar (steel)"},{id:"0250_Chaos_sf2_file",library:"Chaos",displayName:"Acoustic Guitar (steel)"},{id:"0250_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Acoustic Guitar (steel)"},{id:"0250_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Acoustic Guitar (steel)"},{id:"0250_JCLive_sf2_file",library:"JCLive",displayName:"Acoustic Guitar (steel)"},{id:"0250_SBLive_sf2",library:"SBLive",displayName:"Acoustic Guitar (steel)"},{id:"0250_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Acoustic Guitar (steel)"},{id:"0260_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Guitar (jazz)"},{id:"0260_Chaos_sf2_file",library:"Chaos",displayName:"Electric Guitar (jazz)"},{id:"0260_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Guitar (jazz)"},{id:"0260_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Guitar (jazz)"},{id:"0260_JCLive_sf2_file",library:"JCLive",displayName:"Electric Guitar (jazz)"},{id:"0260_SBLive_sf2",library:"SBLive",displayName:"Electric Guitar (jazz)"},{id:"0260_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Guitar (jazz)"},{id:"0270_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Guitar (clean)"},{id:"0270_Chaos_sf2_file",library:"Chaos",displayName:"Electric Guitar (clean)"},{id:"0270_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Guitar (clean)"},{id:"0270_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Guitar (clean)"},{id:"0270_JCLive_sf2_file",library:"JCLive",displayName:"Electric Guitar (clean)"},{id:"0270_SBLive_sf2",library:"SBLive",displayName:"Electric Guitar (clean)"},{id:"0270_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Guitar (clean)"},{id:"0280_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Guitar (muted)"},{id:"0280_Chaos_sf2_file",library:"Chaos",displayName:"Electric Guitar (muted)"},{id:"0280_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Guitar (muted)"},{id:"0280_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Guitar (muted)"},{id:"0280_JCLive_sf2_file",library:"JCLive",displayName:"Electric Guitar (muted)"},{id:"0280_SBLive_sf2",library:"SBLive",displayName:"Electric Guitar (muted)"},{id:"0280_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Guitar (muted)"},{id:"0290_Aspirin_sf2_file",library:"Aspirin",displayName:"Overdriven Guitar"},{id:"0290_Chaos_sf2_file",library:"Chaos",displayName:"Overdriven Guitar"},{id:"0290_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Overdriven Guitar"},{id:"0290_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Overdriven Guitar"},{id:"0290_JCLive_sf2_file",library:"JCLive",displayName:"Overdriven Guitar"},{id:"0290_SBLive_sf2",library:"SBLive",displayName:"Overdriven Guitar"},{id:"0290_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Overdriven Guitar"},{id:"0300_Aspirin_sf2_file",library:"Aspirin",displayName:"Distortion Guitar"},{id:"0300_Chaos_sf2_file",library:"Chaos",displayName:"Distortion Guitar"},{id:"0300_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Distortion Guitar"},{id:"0300_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Distortion Guitar"},{id:"0300_JCLive_sf2_file",library:"JCLive",displayName:"Distortion Guitar"},{id:"0300_SBLive_sf2",library:"SBLive",displayName:"Distortion Guitar"},{id:"0300_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Distortion Guitar"},{id:"0310_Aspirin_sf2_file",library:"Aspirin",displayName:"Guitar Harmonics"},{id:"0310_Chaos_sf2_file",library:"Chaos",displayName:"Guitar Harmonics"},{id:"0310_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Guitar Harmonics"},{id:"0310_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Guitar Harmonics"},{id:"0310_JCLive_sf2_file",library:"JCLive",displayName:"Guitar Harmonics"},{id:"0310_SBLive_sf2",library:"SBLive",displayName:"Guitar Harmonics"},{id:"0310_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Guitar Harmonics"},{id:"0320_Aspirin_sf2_file",library:"Aspirin",displayName:"Acoustic Bass"},{id:"0320_Chaos_sf2_file",library:"Chaos",displayName:"Acoustic Bass"},{id:"0320_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Acoustic Bass"},{id:"0320_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Acoustic Bass"},{id:"0320_JCLive_sf2_file",library:"JCLive",displayName:"Acoustic Bass"},{id:"0320_SBLive_sf2",library:"SBLive",displayName:"Acoustic Bass"},{id:"0320_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Acoustic Bass"},{id:"0330_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Bass (finger)"},{id:"0330_Chaos_sf2_file",library:"Chaos",displayName:"Electric Bass (finger)"},{id:"0330_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Bass (finger)"},{id:"0330_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Bass (finger)"},{id:"0330_JCLive_sf2_file",library:"JCLive",displayName:"Electric Bass (finger)"},{id:"0330_SBLive_sf2",library:"SBLive",displayName:"Electric Bass (finger)"},{id:"0330_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Bass (finger)"},{id:"0340_Aspirin_sf2_file",library:"Aspirin",displayName:"Electric Bass (pick)"},{id:"0340_Chaos_sf2_file",library:"Chaos",displayName:"Electric Bass (pick)"},{id:"0340_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Electric Bass (pick)"},{id:"0340_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Electric Bass (pick)"},{id:"0340_JCLive_sf2_file",library:"JCLive",displayName:"Electric Bass (pick)"},{id:"0340_SBLive_sf2",library:"SBLive",displayName:"Electric Bass (pick)"},{id:"0340_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Electric Bass (pick)"},{id:"0350_Aspirin_sf2_file",library:"Aspirin",displayName:"Fretless Bass"},{id:"0350_Chaos_sf2_file",library:"Chaos",displayName:"Fretless Bass"},{id:"0350_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Fretless Bass"},{id:"0350_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Fretless Bass"},{id:"0350_JCLive_sf2_file",library:"JCLive",displayName:"Fretless Bass"},{id:"0350_SBLive_sf2",library:"SBLive",displayName:"Fretless Bass"},{id:"0350_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Fretless Bass"},{id:"0360_Aspirin_sf2_file",library:"Aspirin",displayName:"Slap Bass 1"},{id:"0360_Chaos_sf2_file",library:"Chaos",displayName:"Slap Bass 1"},{id:"0360_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Slap Bass 1"},{id:"0360_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Slap Bass 1"},{id:"0360_JCLive_sf2_file",library:"JCLive",displayName:"Slap Bass 1"},{id:"0360_SBLive_sf2",library:"SBLive",displayName:"Slap Bass 1"},{id:"0360_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Slap Bass 1"},{id:"0370_Aspirin_sf2_file",library:"Aspirin",displayName:"Slap Bass 2"},{id:"0370_Chaos_sf2_file",library:"Chaos",displayName:"Slap Bass 2"},{id:"0370_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Slap Bass 2"},{id:"0370_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Slap Bass 2"},{id:"0370_JCLive_sf2_file",library:"JCLive",displayName:"Slap Bass 2"},{id:"0370_SBLive_sf2",library:"SBLive",displayName:"Slap Bass 2"},{id:"0370_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Slap Bass 2"},{id:"0380_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Bass 1"},{id:"0380_Chaos_sf2_file",library:"Chaos",displayName:"Synth Bass 1"},{id:"0380_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Bass 1"},{id:"0380_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Bass 1"},{id:"0380_JCLive_sf2_file",library:"JCLive",displayName:"Synth Bass 1"},{id:"0380_SBLive_sf2",library:"SBLive",displayName:"Synth Bass 1"},{id:"0380_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Bass 1"},{id:"0390_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Bass 2"},{id:"0390_Chaos_sf2_file",library:"Chaos",displayName:"Synth Bass 2"},{id:"0390_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Bass 2"},{id:"0390_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Bass 2"},{id:"0390_JCLive_sf2_file",library:"JCLive",displayName:"Synth Bass 2"},{id:"0390_SBLive_sf2",library:"SBLive",displayName:"Synth Bass 2"},{id:"0390_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Bass 2"},{id:"0400_Aspirin_sf2_file",library:"Aspirin",displayName:"Violin"},{id:"0400_Chaos_sf2_file",library:"Chaos",displayName:"Violin"},{id:"0400_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Violin"},{id:"0400_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Violin"},{id:"0400_JCLive_sf2_file",library:"JCLive",displayName:"Violin"},{id:"0400_SBLive_sf2",library:"SBLive",displayName:"Violin"},{id:"0400_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Violin"},{id:"0410_Aspirin_sf2_file",library:"Aspirin",displayName:"Viola"},{id:"0410_Chaos_sf2_file",library:"Chaos",displayName:"Viola"},{id:"0410_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Viola"},{id:"0410_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Viola"},{id:"0410_JCLive_sf2_file",library:"JCLive",displayName:"Viola"},{id:"0410_SBLive_sf2",library:"SBLive",displayName:"Viola"},{id:"0410_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Viola"},{id:"0420_Aspirin_sf2_file",library:"Aspirin",displayName:"Cello"},{id:"0420_Chaos_sf2_file",library:"Chaos",displayName:"Cello"},{id:"0420_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Cello"},{id:"0420_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Cello"},{id:"0420_JCLive_sf2_file",library:"JCLive",displayName:"Cello"},{id:"0420_SBLive_sf2",library:"SBLive",displayName:"Cello"},{id:"0420_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Cello"},{id:"0430_Aspirin_sf2_file",library:"Aspirin",displayName:"Contrabass"},{id:"0430_Chaos_sf2_file",library:"Chaos",displayName:"Contrabass"},{id:"0430_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Contrabass"},{id:"0430_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Contrabass"},{id:"0430_JCLive_sf2_file",library:"JCLive",displayName:"Contrabass"},{id:"0430_SBLive_sf2",library:"SBLive",displayName:"Contrabass"},{id:"0430_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Contrabass"},{id:"0440_Aspirin_sf2_file",library:"Aspirin",displayName:"Tremolo Strings"},{id:"0440_Chaos_sf2_file",library:"Chaos",displayName:"Tremolo Strings"},{id:"0440_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tremolo Strings"},{id:"0440_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tremolo Strings"},{id:"0440_JCLive_sf2_file",library:"JCLive",displayName:"Tremolo Strings"},{id:"0440_SBLive_sf2",library:"SBLive",displayName:"Tremolo Strings"},{id:"0440_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tremolo Strings"},{id:"0450_Aspirin_sf2_file",library:"Aspirin",displayName:"Pizzicato Strings"},{id:"0450_Chaos_sf2_file",library:"Chaos",displayName:"Pizzicato Strings"},{id:"0450_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pizzicato Strings"},{id:"0450_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pizzicato Strings"},{id:"0450_JCLive_sf2_file",library:"JCLive",displayName:"Pizzicato Strings"},{id:"0450_SBLive_sf2",library:"SBLive",displayName:"Pizzicato Strings"},{id:"0450_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pizzicato Strings"},{id:"0460_Aspirin_sf2_file",library:"Aspirin",displayName:"Orchestral Harp"},{id:"0460_Chaos_sf2_file",library:"Chaos",displayName:"Orchestral Harp"},{id:"0460_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Orchestral Harp"},{id:"0460_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Orchestral Harp"},{id:"0460_JCLive_sf2_file",library:"JCLive",displayName:"Orchestral Harp"},{id:"0460_SBLive_sf2",library:"SBLive",displayName:"Orchestral Harp"},{id:"0460_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Orchestral Harp"},{id:"0470_Aspirin_sf2_file",library:"Aspirin",displayName:"Timpani"},{id:"0470_Chaos_sf2_file",library:"Chaos",displayName:"Timpani"},{id:"0470_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Timpani"},{id:"0470_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Timpani"},{id:"0470_JCLive_sf2_file",library:"JCLive",displayName:"Timpani"},{id:"0470_SBLive_sf2",library:"SBLive",displayName:"Timpani"},{id:"0470_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Timpani"},{id:"0480_Aspirin_sf2_file",library:"Aspirin",displayName:"String Ensemble 1"},{id:"0480_Chaos_sf2_file",library:"Chaos",displayName:"String Ensemble 1"},{id:"0480_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"String Ensemble 1"},{id:"0480_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"String Ensemble 1"},{id:"0480_JCLive_sf2_file",library:"JCLive",displayName:"String Ensemble 1"},{id:"0480_SBLive_sf2",library:"SBLive",displayName:"String Ensemble 1"},{id:"0480_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"String Ensemble 1"},{id:"0490_Aspirin_sf2_file",library:"Aspirin",displayName:"String Ensemble 2"},{id:"0490_Chaos_sf2_file",library:"Chaos",displayName:"String Ensemble 2"},{id:"0490_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"String Ensemble 2"},{id:"0490_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"String Ensemble 2"},{id:"0490_JCLive_sf2_file",library:"JCLive",displayName:"String Ensemble 2"},{id:"0490_SBLive_sf2",library:"SBLive",displayName:"String Ensemble 2"},{id:"0490_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"String Ensemble 2"},{id:"0500_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Strings 1"},{id:"0500_Chaos_sf2_file",library:"Chaos",displayName:"Synth Strings 1"},{id:"0500_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Strings 1"},{id:"0500_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Strings 1"},{id:"0500_JCLive_sf2_file",library:"JCLive",displayName:"Synth Strings 1"},{id:"0500_SBLive_sf2",library:"SBLive",displayName:"Synth Strings 1"},{id:"0500_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Strings 1"},{id:"0510_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Strings 2"},{id:"0510_Chaos_sf2_file",library:"Chaos",displayName:"Synth Strings 2"},{id:"0510_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Strings 2"},{id:"0510_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Strings 2"},{id:"0510_JCLive_sf2_file",library:"JCLive",displayName:"Synth Strings 2"},{id:"0510_SBLive_sf2",library:"SBLive",displayName:"Synth Strings 2"},{id:"0510_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Strings 2"},{id:"0520_Aspirin_sf2_file",library:"Aspirin",displayName:"Choir Aahs"},{id:"0520_Chaos_sf2_file",library:"Chaos",displayName:"Choir Aahs"},{id:"0520_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Choir Aahs"},{id:"0520_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Choir Aahs"},{id:"0520_JCLive_sf2_file",library:"JCLive",displayName:"Choir Aahs"},{id:"0520_SBLive_sf2",library:"SBLive",displayName:"Choir Aahs"},{id:"0520_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Choir Aahs"},{id:"0530_Aspirin_sf2_file",library:"Aspirin",displayName:"Voice Oohs"},{id:"0530_Chaos_sf2_file",library:"Chaos",displayName:"Voice Oohs"},{id:"0530_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Voice Oohs"},{id:"0530_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Voice Oohs"},{id:"0530_JCLive_sf2_file",library:"JCLive",displayName:"Voice Oohs"},{id:"0530_SBLive_sf2",library:"SBLive",displayName:"Voice Oohs"},{id:"0530_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Voice Oohs"},{id:"0540_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Choir"},{id:"0540_Chaos_sf2_file",library:"Chaos",displayName:"Synth Choir"},{id:"0540_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Choir"},{id:"0540_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Choir"},{id:"0540_JCLive_sf2_file",library:"JCLive",displayName:"Synth Choir"},{id:"0540_SBLive_sf2",library:"SBLive",displayName:"Synth Choir"},{id:"0540_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Choir"},{id:"0550_Aspirin_sf2_file",library:"Aspirin",displayName:"Orchestra Hit"},{id:"0550_Chaos_sf2_file",library:"Chaos",displayName:"Orchestra Hit"},{id:"0550_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Orchestra Hit"},{id:"0550_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Orchestra Hit"},{id:"0550_JCLive_sf2_file",library:"JCLive",displayName:"Orchestra Hit"},{id:"0550_SBLive_sf2",library:"SBLive",displayName:"Orchestra Hit"},{id:"0550_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Orchestra Hit"},{id:"0560_Aspirin_sf2_file",library:"Aspirin",displayName:"Trumpet"},{id:"0560_Chaos_sf2_file",library:"Chaos",displayName:"Trumpet"},{id:"0560_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Trumpet"},{id:"0560_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Trumpet"},{id:"0560_JCLive_sf2_file",library:"JCLive",displayName:"Trumpet"},{id:"0560_SBLive_sf2",library:"SBLive",displayName:"Trumpet"},{id:"0560_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Trumpet"},{id:"0570_Aspirin_sf2_file",library:"Aspirin",displayName:"Trombone"},{id:"0570_Chaos_sf2_file",library:"Chaos",displayName:"Trombone"},{id:"0570_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Trombone"},{id:"0570_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Trombone"},{id:"0570_JCLive_sf2_file",library:"JCLive",displayName:"Trombone"},{id:"0570_SBLive_sf2",library:"SBLive",displayName:"Trombone"},{id:"0570_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Trombone"},{id:"0580_Aspirin_sf2_file",library:"Aspirin",displayName:"Tuba"},{id:"0580_Chaos_sf2_file",library:"Chaos",displayName:"Tuba"},{id:"0580_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tuba"},{id:"0580_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tuba"},{id:"0580_JCLive_sf2_file",library:"JCLive",displayName:"Tuba"},{id:"0580_SBLive_sf2",library:"SBLive",displayName:"Tuba"},{id:"0580_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tuba"},{id:"0590_Aspirin_sf2_file",library:"Aspirin",displayName:"Muted Trumpet"},{id:"0590_Chaos_sf2_file",library:"Chaos",displayName:"Muted Trumpet"},{id:"0590_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Muted Trumpet"},{id:"0590_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Muted Trumpet"},{id:"0590_JCLive_sf2_file",library:"JCLive",displayName:"Muted Trumpet"},{id:"0590_SBLive_sf2",library:"SBLive",displayName:"Muted Trumpet"},{id:"0590_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Muted Trumpet"},{id:"0600_Aspirin_sf2_file",library:"Aspirin",displayName:"French Horn"},{id:"0600_Chaos_sf2_file",library:"Chaos",displayName:"French Horn"},{id:"0600_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"French Horn"},{id:"0600_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"French Horn"},{id:"0600_JCLive_sf2_file",library:"JCLive",displayName:"French Horn"},{id:"0600_SBLive_sf2",library:"SBLive",displayName:"French Horn"},{id:"0600_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"French Horn"},{id:"0610_Aspirin_sf2_file",library:"Aspirin",displayName:"Brass Section"},{id:"0610_Chaos_sf2_file",library:"Chaos",displayName:"Brass Section"},{id:"0610_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Brass Section"},{id:"0610_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Brass Section"},{id:"0610_JCLive_sf2_file",library:"JCLive",displayName:"Brass Section"},{id:"0610_SBLive_sf2",library:"SBLive",displayName:"Brass Section"},{id:"0610_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Brass Section"},{id:"0620_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Brass 1"},{id:"0620_Chaos_sf2_file",library:"Chaos",displayName:"Synth Brass 1"},{id:"0620_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Brass 1"},{id:"0620_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Brass 1"},{id:"0620_JCLive_sf2_file",library:"JCLive",displayName:"Synth Brass 1"},{id:"0620_SBLive_sf2",library:"SBLive",displayName:"Synth Brass 1"},{id:"0620_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Brass 1"},{id:"0630_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Brass 2"},{id:"0630_Chaos_sf2_file",library:"Chaos",displayName:"Synth Brass 2"},{id:"0630_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Brass 2"},{id:"0630_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Brass 2"},{id:"0630_JCLive_sf2_file",library:"JCLive",displayName:"Synth Brass 2"},{id:"0630_SBLive_sf2",library:"SBLive",displayName:"Synth Brass 2"},{id:"0630_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Brass 2"},{id:"0640_Aspirin_sf2_file",library:"Aspirin",displayName:"Soprano Sax"},{id:"0640_Chaos_sf2_file",library:"Chaos",displayName:"Soprano Sax"},{id:"0640_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Soprano Sax"},{id:"0640_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Soprano Sax"},{id:"0640_JCLive_sf2_file",library:"JCLive",displayName:"Soprano Sax"},{id:"0640_SBLive_sf2",library:"SBLive",displayName:"Soprano Sax"},{id:"0640_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Soprano Sax"},{id:"0650_Aspirin_sf2_file",library:"Aspirin",displayName:"Alto Sax"},{id:"0650_Chaos_sf2_file",library:"Chaos",displayName:"Alto Sax"},{id:"0650_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Alto Sax"},{id:"0650_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Alto Sax"},{id:"0650_JCLive_sf2_file",library:"JCLive",displayName:"Alto Sax"},{id:"0650_SBLive_sf2",library:"SBLive",displayName:"Alto Sax"},{id:"0650_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Alto Sax"},{id:"0660_Aspirin_sf2_file",library:"Aspirin",displayName:"Tenor Sax"},{id:"0660_Chaos_sf2_file",library:"Chaos",displayName:"Tenor Sax"},{id:"0660_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tenor Sax"},{id:"0660_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tenor Sax"},{id:"0660_JCLive_sf2_file",library:"JCLive",displayName:"Tenor Sax"},{id:"0660_SBLive_sf2",library:"SBLive",displayName:"Tenor Sax"},{id:"0660_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tenor Sax"},{id:"0670_Aspirin_sf2_file",library:"Aspirin",displayName:"Baritone Sax"},{id:"0670_Chaos_sf2_file",library:"Chaos",displayName:"Baritone Sax"},{id:"0670_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Baritone Sax"},{id:"0670_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Baritone Sax"},{id:"0670_JCLive_sf2_file",library:"JCLive",displayName:"Baritone Sax"},{id:"0670_SBLive_sf2",library:"SBLive",displayName:"Baritone Sax"},{id:"0670_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Baritone Sax"},{id:"0680_Aspirin_sf2_file",library:"Aspirin",displayName:"Oboe"},{id:"0680_Chaos_sf2_file",library:"Chaos",displayName:"Oboe"},{id:"0680_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Oboe"},{id:"0680_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Oboe"},{id:"0680_JCLive_sf2_file",library:"JCLive",displayName:"Oboe"},{id:"0680_SBLive_sf2",library:"SBLive",displayName:"Oboe"},{id:"0680_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Oboe"},{id:"0690_Aspirin_sf2_file",library:"Aspirin",displayName:"English Horn"},{id:"0690_Chaos_sf2_file",library:"Chaos",displayName:"English Horn"},{id:"0690_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"English Horn"},{id:"0690_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"English Horn"},{id:"0690_JCLive_sf2_file",library:"JCLive",displayName:"English Horn"},{id:"0690_SBLive_sf2",library:"SBLive",displayName:"English Horn"},{id:"0690_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"English Horn"},{id:"0700_Aspirin_sf2_file",library:"Aspirin",displayName:"Bassoon"},{id:"0700_Chaos_sf2_file",library:"Chaos",displayName:"Bassoon"},{id:"0700_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Bassoon"},{id:"0700_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Bassoon"},{id:"0700_JCLive_sf2_file",library:"JCLive",displayName:"Bassoon"},{id:"0700_SBLive_sf2",library:"SBLive",displayName:"Bassoon"},{id:"0700_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Bassoon"},{id:"0710_Aspirin_sf2_file",library:"Aspirin",displayName:"Clarinet"},{id:"0710_Chaos_sf2_file",library:"Chaos",displayName:"Clarinet"},{id:"0710_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Clarinet"},{id:"0710_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Clarinet"},{id:"0710_JCLive_sf2_file",library:"JCLive",displayName:"Clarinet"},{id:"0710_SBLive_sf2",library:"SBLive",displayName:"Clarinet"},{id:"0710_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Clarinet"},{id:"0720_Aspirin_sf2_file",library:"Aspirin",displayName:"Piccolo"},{id:"0720_Chaos_sf2_file",library:"Chaos",displayName:"Piccolo"},{id:"0720_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Piccolo"},{id:"0720_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Piccolo"},{id:"0720_JCLive_sf2_file",library:"JCLive",displayName:"Piccolo"},{id:"0720_SBLive_sf2",library:"SBLive",displayName:"Piccolo"},{id:"0720_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Piccolo"},{id:"0730_Aspirin_sf2_file",library:"Aspirin",displayName:"Flute"},{id:"0730_Chaos_sf2_file",library:"Chaos",displayName:"Flute"},{id:"0730_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Flute"},{id:"0730_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Flute"},{id:"0730_JCLive_sf2_file",library:"JCLive",displayName:"Flute"},{id:"0730_SBLive_sf2",library:"SBLive",displayName:"Flute"},{id:"0730_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Flute"},{id:"0740_Aspirin_sf2_file",library:"Aspirin",displayName:"Recorder"},{id:"0740_Chaos_sf2_file",library:"Chaos",displayName:"Recorder"},{id:"0740_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Recorder"},{id:"0740_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Recorder"},{id:"0740_JCLive_sf2_file",library:"JCLive",displayName:"Recorder"},{id:"0740_SBLive_sf2",library:"SBLive",displayName:"Recorder"},{id:"0740_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Recorder"},{id:"0750_Aspirin_sf2_file",library:"Aspirin",displayName:"Pan Flute"},{id:"0750_Chaos_sf2_file",library:"Chaos",displayName:"Pan Flute"},{id:"0750_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pan Flute"},{id:"0750_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pan Flute"},{id:"0750_JCLive_sf2_file",library:"JCLive",displayName:"Pan Flute"},{id:"0750_SBLive_sf2",library:"SBLive",displayName:"Pan Flute"},{id:"0750_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pan Flute"},{id:"0760_Aspirin_sf2_file",library:"Aspirin",displayName:"Blown Bottle"},{id:"0760_Chaos_sf2_file",library:"Chaos",displayName:"Blown Bottle"},{id:"0760_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Blown Bottle"},{id:"0760_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Blown Bottle"},{id:"0760_JCLive_sf2_file",library:"JCLive",displayName:"Blown Bottle"},{id:"0760_SBLive_sf2",library:"SBLive",displayName:"Blown Bottle"},{id:"0760_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Blown Bottle"},{id:"0770_Aspirin_sf2_file",library:"Aspirin",displayName:"Shakuhachi"},{id:"0770_Chaos_sf2_file",library:"Chaos",displayName:"Shakuhachi"},{id:"0770_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Shakuhachi"},{id:"0770_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Shakuhachi"},{id:"0770_JCLive_sf2_file",library:"JCLive",displayName:"Shakuhachi"},{id:"0770_SBLive_sf2",library:"SBLive",displayName:"Shakuhachi"},{id:"0770_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Shakuhachi"},{id:"0780_Aspirin_sf2_file",library:"Aspirin",displayName:"Whistle"},{id:"0780_Chaos_sf2_file",library:"Chaos",displayName:"Whistle"},{id:"0780_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Whistle"},{id:"0780_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Whistle"},{id:"0780_JCLive_sf2_file",library:"JCLive",displayName:"Whistle"},{id:"0780_SBLive_sf2",library:"SBLive",displayName:"Whistle"},{id:"0780_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Whistle"},{id:"0790_Aspirin_sf2_file",library:"Aspirin",displayName:"Ocarina"},{id:"0790_Chaos_sf2_file",library:"Chaos",displayName:"Ocarina"},{id:"0790_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Ocarina"},{id:"0790_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Ocarina"},{id:"0790_JCLive_sf2_file",library:"JCLive",displayName:"Ocarina"},{id:"0790_SBLive_sf2",library:"SBLive",displayName:"Ocarina"},{id:"0790_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Ocarina"},{id:"0800_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 1 (square)"},{id:"0800_Chaos_sf2_file",library:"Chaos",displayName:"Lead 1 (square)"},{id:"0800_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 1 (square)"},{id:"0800_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 1 (square)"},{id:"0800_JCLive_sf2_file",library:"JCLive",displayName:"Lead 1 (square)"},{id:"0800_SBLive_sf2",library:"SBLive",displayName:"Lead 1 (square)"},{id:"0800_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 1 (square)"},{id:"0810_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 2 (sawtooth)"},{id:"0810_Chaos_sf2_file",library:"Chaos",displayName:"Lead 2 (sawtooth)"},{id:"0810_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 2 (sawtooth)"},{id:"0810_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 2 (sawtooth)"},{id:"0810_JCLive_sf2_file",library:"JCLive",displayName:"Lead 2 (sawtooth)"},{id:"0810_SBLive_sf2",library:"SBLive",displayName:"Lead 2 (sawtooth)"},{id:"0810_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 2 (sawtooth)"},{id:"0820_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 3 (calliope)"},{id:"0820_Chaos_sf2_file",library:"Chaos",displayName:"Lead 3 (calliope)"},{id:"0820_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 3 (calliope)"},{id:"0820_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 3 (calliope)"},{id:"0820_JCLive_sf2_file",library:"JCLive",displayName:"Lead 3 (calliope)"},{id:"0820_SBLive_sf2",library:"SBLive",displayName:"Lead 3 (calliope)"},{id:"0820_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 3 (calliope)"},{id:"0830_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 4 (chiff)"},{id:"0830_Chaos_sf2_file",library:"Chaos",displayName:"Lead 4 (chiff)"},{id:"0830_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 4 (chiff)"},{id:"0830_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 4 (chiff)"},{id:"0830_JCLive_sf2_file",library:"JCLive",displayName:"Lead 4 (chiff)"},{id:"0830_SBLive_sf2",library:"SBLive",displayName:"Lead 4 (chiff)"},{id:"0830_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 4 (chiff)"},{id:"0840_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 5 (charang)"},{id:"0840_Chaos_sf2_file",library:"Chaos",displayName:"Lead 5 (charang)"},{id:"0840_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 5 (charang)"},{id:"0840_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 5 (charang)"},{id:"0840_JCLive_sf2_file",library:"JCLive",displayName:"Lead 5 (charang)"},{id:"0840_SBLive_sf2",library:"SBLive",displayName:"Lead 5 (charang)"},{id:"0840_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 5 (charang)"},{id:"0850_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 6 (voice)"},{id:"0850_Chaos_sf2_file",library:"Chaos",displayName:"Lead 6 (voice)"},{id:"0850_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 6 (voice)"},{id:"0850_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 6 (voice)"},{id:"0850_JCLive_sf2_file",library:"JCLive",displayName:"Lead 6 (voice)"},{id:"0850_SBLive_sf2",library:"SBLive",displayName:"Lead 6 (voice)"},{id:"0850_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 6 (voice)"},{id:"0860_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 7 (fifths)"},{id:"0860_Chaos_sf2_file",library:"Chaos",displayName:"Lead 7 (fifths)"},{id:"0860_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 7 (fifths)"},{id:"0860_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 7 (fifths)"},{id:"0860_JCLive_sf2_file",library:"JCLive",displayName:"Lead 7 (fifths)"},{id:"0860_SBLive_sf2",library:"SBLive",displayName:"Lead 7 (fifths)"},{id:"0860_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 7 (fifths)"},{id:"0870_Aspirin_sf2_file",library:"Aspirin",displayName:"Lead 8 (bass + lead)"},{id:"0870_Chaos_sf2_file",library:"Chaos",displayName:"Lead 8 (bass + lead)"},{id:"0870_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Lead 8 (bass + lead)"},{id:"0870_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Lead 8 (bass + lead)"},{id:"0870_JCLive_sf2_file",library:"JCLive",displayName:"Lead 8 (bass + lead)"},{id:"0870_SBLive_sf2",library:"SBLive",displayName:"Lead 8 (bass + lead)"},{id:"0870_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Lead 8 (bass + lead)"},{id:"0880_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 1 (new age)"},{id:"0880_Chaos_sf2_file",library:"Chaos",displayName:"Pad 1 (new age)"},{id:"0880_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 1 (new age)"},{id:"0880_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 1 (new age)"},{id:"0880_JCLive_sf2_file",library:"JCLive",displayName:"Pad 1 (new age)"},{id:"0880_SBLive_sf2",library:"SBLive",displayName:"Pad 1 (new age)"},{id:"0880_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 1 (new age)"},{id:"0890_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 2 (warm)"},{id:"0890_Chaos_sf2_file",library:"Chaos",displayName:"Pad 2 (warm)"},{id:"0890_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 2 (warm)"},{id:"0890_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 2 (warm)"},{id:"0890_JCLive_sf2_file",library:"JCLive",displayName:"Pad 2 (warm)"},{id:"0890_SBLive_sf2",library:"SBLive",displayName:"Pad 2 (warm)"},{id:"0890_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 2 (warm)"},{id:"0900_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 3 (polysynth)"},{id:"0900_Chaos_sf2_file",library:"Chaos",displayName:"Pad 3 (polysynth)"},{id:"0900_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 3 (polysynth)"},{id:"0900_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 3 (polysynth)"},{id:"0900_JCLive_sf2_file",library:"JCLive",displayName:"Pad 3 (polysynth)"},{id:"0900_SBLive_sf2",library:"SBLive",displayName:"Pad 3 (polysynth)"},{id:"0900_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 3 (polysynth)"},{id:"0910_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 4 (choir)"},{id:"0910_Chaos_sf2_file",library:"Chaos",displayName:"Pad 4 (choir)"},{id:"0910_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 4 (choir)"},{id:"0910_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 4 (choir)"},{id:"0910_JCLive_sf2_file",library:"JCLive",displayName:"Pad 4 (choir)"},{id:"0910_SBLive_sf2",library:"SBLive",displayName:"Pad 4 (choir)"},{id:"0910_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 4 (choir)"},{id:"0920_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 5 (bowed)"},{id:"0920_Chaos_sf2_file",library:"Chaos",displayName:"Pad 5 (bowed)"},{id:"0920_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 5 (bowed)"},{id:"0920_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 5 (bowed)"},{id:"0920_JCLive_sf2_file",library:"JCLive",displayName:"Pad 5 (bowed)"},{id:"0920_SBLive_sf2",library:"SBLive",displayName:"Pad 5 (bowed)"},{id:"0920_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 5 (bowed)"},{id:"0930_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 6 (metallic)"},{id:"0930_Chaos_sf2_file",library:"Chaos",displayName:"Pad 6 (metallic)"},{id:"0930_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 6 (metallic)"},{id:"0930_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 6 (metallic)"},{id:"0930_JCLive_sf2_file",library:"JCLive",displayName:"Pad 6 (metallic)"},{id:"0930_SBLive_sf2",library:"SBLive",displayName:"Pad 6 (metallic)"},{id:"0930_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 6 (metallic)"},{id:"0940_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 7 (halo)"},{id:"0940_Chaos_sf2_file",library:"Chaos",displayName:"Pad 7 (halo)"},{id:"0940_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 7 (halo)"},{id:"0940_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 7 (halo)"},{id:"0940_JCLive_sf2_file",library:"JCLive",displayName:"Pad 7 (halo)"},{id:"0940_SBLive_sf2",library:"SBLive",displayName:"Pad 7 (halo)"},{id:"0940_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 7 (halo)"},{id:"0950_Aspirin_sf2_file",library:"Aspirin",displayName:"Pad 8 (sweep)"},{id:"0950_Chaos_sf2_file",library:"Chaos",displayName:"Pad 8 (sweep)"},{id:"0950_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Pad 8 (sweep)"},{id:"0950_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Pad 8 (sweep)"},{id:"0950_JCLive_sf2_file",library:"JCLive",displayName:"Pad 8 (sweep)"},{id:"0950_SBLive_sf2",library:"SBLive",displayName:"Pad 8 (sweep)"},{id:"0950_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Pad 8 (sweep)"},{id:"0960_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 1 (rain)"},{id:"0960_Chaos_sf2_file",library:"Chaos",displayName:"FX 1 (rain)"},{id:"0960_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 1 (rain)"},{id:"0960_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 1 (rain)"},{id:"0960_JCLive_sf2_file",library:"JCLive",displayName:"FX 1 (rain)"},{id:"0960_SBLive_sf2",library:"SBLive",displayName:"FX 1 (rain)"},{id:"0960_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 1 (rain)"},{id:"0970_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 2 (soundtrack)"},{id:"0970_Chaos_sf2_file",library:"Chaos",displayName:"FX 2 (soundtrack)"},{id:"0970_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 2 (soundtrack)"},{id:"0970_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 2 (soundtrack)"},{id:"0970_JCLive_sf2_file",library:"JCLive",displayName:"FX 2 (soundtrack)"},{id:"0970_SBLive_sf2",library:"SBLive",displayName:"FX 2 (soundtrack)"},{id:"0970_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 2 (soundtrack)"},{id:"0980_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 3 (crystal)"},{id:"0980_Chaos_sf2_file",library:"Chaos",displayName:"FX 3 (crystal)"},{id:"0980_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 3 (crystal)"},{id:"0980_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 3 (crystal)"},{id:"0980_JCLive_sf2_file",library:"JCLive",displayName:"FX 3 (crystal)"},{id:"0980_SBLive_sf2",library:"SBLive",displayName:"FX 3 (crystal)"},{id:"0980_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 3 (crystal)"},{id:"0990_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 4 (atmosphere)"},{id:"0990_Chaos_sf2_file",library:"Chaos",displayName:"FX 4 (atmosphere)"},{id:"0990_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 4 (atmosphere)"},{id:"0990_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 4 (atmosphere)"},{id:"0990_JCLive_sf2_file",library:"JCLive",displayName:"FX 4 (atmosphere)"},{id:"0990_SBLive_sf2",library:"SBLive",displayName:"FX 4 (atmosphere)"},{id:"0990_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 4 (atmosphere)"},{id:"1000_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 5 (brightness)"},{id:"1000_Chaos_sf2_file",library:"Chaos",displayName:"FX 5 (brightness)"},{id:"1000_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 5 (brightness)"},{id:"1000_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 5 (brightness)"},{id:"1000_JCLive_sf2_file",library:"JCLive",displayName:"FX 5 (brightness)"},{id:"1000_SBLive_sf2",library:"SBLive",displayName:"FX 5 (brightness)"},{id:"1000_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 5 (brightness)"},{id:"1010_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 6 (goblins)"},{id:"1010_Chaos_sf2_file",library:"Chaos",displayName:"FX 6 (goblins)"},{id:"1010_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 6 (goblins)"},{id:"1010_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 6 (goblins)"},{id:"1010_JCLive_sf2_file",library:"JCLive",displayName:"FX 6 (goblins)"},{id:"1010_SBLive_sf2",library:"SBLive",displayName:"FX 6 (goblins)"},{id:"1010_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 6 (goblins)"},{id:"1020_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 7 (echoes)"},{id:"1020_Chaos_sf2_file",library:"Chaos",displayName:"FX 7 (echoes)"},{id:"1020_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 7 (echoes)"},{id:"1020_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 7 (echoes)"},{id:"1020_JCLive_sf2_file",library:"JCLive",displayName:"FX 7 (echoes)"},{id:"1020_SBLive_sf2",library:"SBLive",displayName:"FX 7 (echoes)"},{id:"1020_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 7 (echoes)"},{id:"1030_Aspirin_sf2_file",library:"Aspirin",displayName:"FX 8 (sci-fi)"},{id:"1030_Chaos_sf2_file",library:"Chaos",displayName:"FX 8 (sci-fi)"},{id:"1030_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"FX 8 (sci-fi)"},{id:"1030_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"FX 8 (sci-fi)"},{id:"1030_JCLive_sf2_file",library:"JCLive",displayName:"FX 8 (sci-fi)"},{id:"1030_SBLive_sf2",library:"SBLive",displayName:"FX 8 (sci-fi)"},{id:"1030_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"FX 8 (sci-fi)"},{id:"1040_Aspirin_sf2_file",library:"Aspirin",displayName:"Sitar"},{id:"1040_Chaos_sf2_file",library:"Chaos",displayName:"Sitar"},{id:"1040_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Sitar"},{id:"1040_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Sitar"},{id:"1040_JCLive_sf2_file",library:"JCLive",displayName:"Sitar"},{id:"1040_SBLive_sf2",library:"SBLive",displayName:"Sitar"},{id:"1040_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Sitar"},{id:"1050_Aspirin_sf2_file",library:"Aspirin",displayName:"Banjo"},{id:"1050_Chaos_sf2_file",library:"Chaos",displayName:"Banjo"},{id:"1050_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Banjo"},{id:"1050_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Banjo"},{id:"1050_JCLive_sf2_file",library:"JCLive",displayName:"Banjo"},{id:"1050_SBLive_sf2",library:"SBLive",displayName:"Banjo"},{id:"1050_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Banjo"},{id:"1060_Aspirin_sf2_file",library:"Aspirin",displayName:"Shamisen"},{id:"1060_Chaos_sf2_file",library:"Chaos",displayName:"Shamisen"},{id:"1060_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Shamisen"},{id:"1060_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Shamisen"},{id:"1060_JCLive_sf2_file",library:"JCLive",displayName:"Shamisen"},{id:"1060_SBLive_sf2",library:"SBLive",displayName:"Shamisen"},{id:"1060_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Shamisen"},{id:"1070_Aspirin_sf2_file",library:"Aspirin",displayName:"Koto"},{id:"1070_Chaos_sf2_file",library:"Chaos",displayName:"Koto"},{id:"1070_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Koto"},{id:"1070_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Koto"},{id:"1070_JCLive_sf2_file",library:"JCLive",displayName:"Koto"},{id:"1070_SBLive_sf2",library:"SBLive",displayName:"Koto"},{id:"1070_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Koto"},{id:"1080_Aspirin_sf2_file",library:"Aspirin",displayName:"Kalimba"},{id:"1080_Chaos_sf2_file",library:"Chaos",displayName:"Kalimba"},{id:"1080_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Kalimba"},{id:"1080_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Kalimba"},{id:"1080_JCLive_sf2_file",library:"JCLive",displayName:"Kalimba"},{id:"1080_SBLive_sf2",library:"SBLive",displayName:"Kalimba"},{id:"1080_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Kalimba"},{id:"1090_Aspirin_sf2_file",library:"Aspirin",displayName:"Bagpipe"},{id:"1090_Chaos_sf2_file",library:"Chaos",displayName:"Bagpipe"},{id:"1090_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Bagpipe"},{id:"1090_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Bagpipe"},{id:"1090_JCLive_sf2_file",library:"JCLive",displayName:"Bagpipe"},{id:"1090_SBLive_sf2",library:"SBLive",displayName:"Bagpipe"},{id:"1090_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Bagpipe"},{id:"1100_Aspirin_sf2_file",library:"Aspirin",displayName:"Fiddle"},{id:"1100_Chaos_sf2_file",library:"Chaos",displayName:"Fiddle"},{id:"1100_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Fiddle"},{id:"1100_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Fiddle"},{id:"1100_JCLive_sf2_file",library:"JCLive",displayName:"Fiddle"},{id:"1100_SBLive_sf2",library:"SBLive",displayName:"Fiddle"},{id:"1100_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Fiddle"},{id:"1110_Aspirin_sf2_file",library:"Aspirin",displayName:"Shanai"},{id:"1110_Chaos_sf2_file",library:"Chaos",displayName:"Shanai"},{id:"1110_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Shanai"},{id:"1110_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Shanai"},{id:"1110_JCLive_sf2_file",library:"JCLive",displayName:"Shanai"},{id:"1110_SBLive_sf2",library:"SBLive",displayName:"Shanai"},{id:"1110_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Shanai"},{id:"1120_Aspirin_sf2_file",library:"Aspirin",displayName:"Tinkle Bell"},{id:"1120_Chaos_sf2_file",library:"Chaos",displayName:"Tinkle Bell"},{id:"1120_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Tinkle Bell"},{id:"1120_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Tinkle Bell"},{id:"1120_JCLive_sf2_file",library:"JCLive",displayName:"Tinkle Bell"},{id:"1120_SBLive_sf2",library:"SBLive",displayName:"Tinkle Bell"},{id:"1120_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Tinkle Bell"},{id:"1130_Aspirin_sf2_file",library:"Aspirin",displayName:"Agogo"},{id:"1130_Chaos_sf2_file",library:"Chaos",displayName:"Agogo"},{id:"1130_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Agogo"},{id:"1130_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Agogo"},{id:"1130_JCLive_sf2_file",library:"JCLive",displayName:"Agogo"},{id:"1130_SBLive_sf2",library:"SBLive",displayName:"Agogo"},{id:"1130_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Agogo"},{id:"1140_Aspirin_sf2_file",library:"Aspirin",displayName:"Steel Drums"},{id:"1140_Chaos_sf2_file",library:"Chaos",displayName:"Steel Drums"},{id:"1140_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Steel Drums"},{id:"1140_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Steel Drums"},{id:"1140_JCLive_sf2_file",library:"JCLive",displayName:"Steel Drums"},{id:"1140_SBLive_sf2",library:"SBLive",displayName:"Steel Drums"},{id:"1140_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Steel Drums"},{id:"1150_Aspirin_sf2_file",library:"Aspirin",displayName:"Woodblock"},{id:"1150_Chaos_sf2_file",library:"Chaos",displayName:"Woodblock"},{id:"1150_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Woodblock"},{id:"1150_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Woodblock"},{id:"1150_JCLive_sf2_file",library:"JCLive",displayName:"Woodblock"},{id:"1150_SBLive_sf2",library:"SBLive",displayName:"Woodblock"},{id:"1150_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Woodblock"},{id:"1160_Aspirin_sf2_file",library:"Aspirin",displayName:"Taiko Drum"},{id:"1160_Chaos_sf2_file",library:"Chaos",displayName:"Taiko Drum"},{id:"1160_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Taiko Drum"},{id:"1160_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Taiko Drum"},{id:"1160_JCLive_sf2_file",library:"JCLive",displayName:"Taiko Drum"},{id:"1160_SBLive_sf2",library:"SBLive",displayName:"Taiko Drum"},{id:"1160_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Taiko Drum"},{id:"1170_Aspirin_sf2_file",library:"Aspirin",displayName:"Melodic Tom"},{id:"1170_Chaos_sf2_file",library:"Chaos",displayName:"Melodic Tom"},{id:"1170_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Melodic Tom"},{id:"1170_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Melodic Tom"},{id:"1170_JCLive_sf2_file",library:"JCLive",displayName:"Melodic Tom"},{id:"1170_SBLive_sf2",library:"SBLive",displayName:"Melodic Tom"},{id:"1170_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Melodic Tom"},{id:"1180_Aspirin_sf2_file",library:"Aspirin",displayName:"Synth Drum"},{id:"1180_Chaos_sf2_file",library:"Chaos",displayName:"Synth Drum"},{id:"1180_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Synth Drum"},{id:"1180_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Synth Drum"},{id:"1180_JCLive_sf2_file",library:"JCLive",displayName:"Synth Drum"},{id:"1180_SBLive_sf2",library:"SBLive",displayName:"Synth Drum"},{id:"1180_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Synth Drum"},{id:"1190_Aspirin_sf2_file",library:"Aspirin",displayName:"Reverse Cymbal"},{id:"1190_Chaos_sf2_file",library:"Chaos",displayName:"Reverse Cymbal"},{id:"1190_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Reverse Cymbal"},{id:"1190_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Reverse Cymbal"},{id:"1190_JCLive_sf2_file",library:"JCLive",displayName:"Reverse Cymbal"},{id:"1190_SBLive_sf2",library:"SBLive",displayName:"Reverse Cymbal"},{id:"1190_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Reverse Cymbal"},{id:"1200_Aspirin_sf2_file",library:"Aspirin",displayName:"Guitar Fret Noise"},{id:"1200_Chaos_sf2_file",library:"Chaos",displayName:"Guitar Fret Noise"},{id:"1200_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Guitar Fret Noise"},{id:"1200_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Guitar Fret Noise"},{id:"1200_JCLive_sf2_file",library:"JCLive",displayName:"Guitar Fret Noise"},{id:"1200_SBLive_sf2",library:"SBLive",displayName:"Guitar Fret Noise"},{id:"1200_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Guitar Fret Noise"},{id:"1210_Aspirin_sf2_file",library:"Aspirin",displayName:"Breath Noise"},{id:"1210_Chaos_sf2_file",library:"Chaos",displayName:"Breath Noise"},{id:"1210_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Breath Noise"},{id:"1210_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Breath Noise"},{id:"1210_JCLive_sf2_file",library:"JCLive",displayName:"Breath Noise"},{id:"1210_SBLive_sf2",library:"SBLive",displayName:"Breath Noise"},{id:"1210_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Breath Noise"},{id:"1220_Aspirin_sf2_file",library:"Aspirin",displayName:"Seashore"},{id:"1220_Chaos_sf2_file",library:"Chaos",displayName:"Seashore"},{id:"1220_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Seashore"},{id:"1220_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Seashore"},{id:"1220_JCLive_sf2_file",library:"JCLive",displayName:"Seashore"},{id:"1220_SBLive_sf2",library:"SBLive",displayName:"Seashore"},{id:"1220_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Seashore"},{id:"1230_Aspirin_sf2_file",library:"Aspirin",displayName:"Bird Tweet"},{id:"1230_Chaos_sf2_file",library:"Chaos",displayName:"Bird Tweet"},{id:"1230_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Bird Tweet"},{id:"1230_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Bird Tweet"},{id:"1230_JCLive_sf2_file",library:"JCLive",displayName:"Bird Tweet"},{id:"1230_SBLive_sf2",library:"SBLive",displayName:"Bird Tweet"},{id:"1230_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Bird Tweet"},{id:"1240_Aspirin_sf2_file",library:"Aspirin",displayName:"Telephone Ring"},{id:"1240_Chaos_sf2_file",library:"Chaos",displayName:"Telephone Ring"},{id:"1240_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Telephone Ring"},{id:"1240_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Telephone Ring"},{id:"1240_JCLive_sf2_file",library:"JCLive",displayName:"Telephone Ring"},{id:"1240_SBLive_sf2",library:"SBLive",displayName:"Telephone Ring"},{id:"1240_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Telephone Ring"},{id:"1250_Aspirin_sf2_file",library:"Aspirin",displayName:"Helicopter"},{id:"1250_Chaos_sf2_file",library:"Chaos",displayName:"Helicopter"},{id:"1250_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Helicopter"},{id:"1250_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Helicopter"},{id:"1250_JCLive_sf2_file",library:"JCLive",displayName:"Helicopter"},{id:"1250_SBLive_sf2",library:"SBLive",displayName:"Helicopter"},{id:"1250_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Helicopter"},{id:"1260_Aspirin_sf2_file",library:"Aspirin",displayName:"Applause"},{id:"1260_Chaos_sf2_file",library:"Chaos",displayName:"Applause"},{id:"1260_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Applause"},{id:"1260_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Applause"},{id:"1260_JCLive_sf2_file",library:"JCLive",displayName:"Applause"},{id:"1260_SBLive_sf2",library:"SBLive",displayName:"Applause"},{id:"1260_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Applause"},{id:"1270_Aspirin_sf2_file",library:"Aspirin",displayName:"Gunshot"},{id:"1270_Chaos_sf2_file",library:"Chaos",displayName:"Gunshot"},{id:"1270_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Gunshot"},{id:"1270_GeneralUserGS_sf2_file",library:"GeneralUserGS",displayName:"Gunshot"},{id:"1270_JCLive_sf2_file",library:"JCLive",displayName:"Gunshot"},{id:"1270_SBLive_sf2",library:"SBLive",displayName:"Gunshot"},{id:"1270_SoundBlasterOld_sf2",library:"SoundBlasterOld",displayName:"Gunshot"},{id:"12835_1_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 1"},{id:"12835_1_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 1"},{id:"12835_1_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 1"},{id:"12835_1_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 1"},{id:"12835_2_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 2"},{id:"12835_2_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 2"},{id:"12835_2_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 2"},{id:"12835_2_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 2"},{id:"12835_3_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 3"},{id:"12835_3_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 3"},{id:"12835_3_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 3"},{id:"12835_3_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 3"},{id:"12835_4_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 4"},{id:"12835_4_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 4"},{id:"12835_4_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 4"},{id:"12835_4_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 4"},{id:"12835_5_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 5"},{id:"12835_5_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 5"},{id:"12835_5_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 5"},{id:"12835_5_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 5"},{id:"12835_6_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 6"},{id:"12835_6_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 6"},{id:"12835_6_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 6"},{id:"12835_6_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 6"},{id:"12835_7_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 7"},{id:"12835_7_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 7"},{id:"12835_7_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 7"},{id:"12835_7_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 7"},{id:"12835_8_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 8"},{id:"12835_8_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 8"},{id:"12835_8_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 8"},{id:"12835_8_SBLive_sf2_file",library:"SBLive",displayName:"Drum Kit 8"},{id:"12835_9_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 9"},{id:"12835_9_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 9"},{id:"12835_9_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 9"},{id:"12835_10_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 10"},{id:"12835_10_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 10"},{id:"12835_10_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 10"},{id:"12835_11_Chaos_sf2_file",library:"Chaos",displayName:"Drum Kit 11"},{id:"12835_11_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 11"},{id:"12835_11_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 11"},{id:"12835_12_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 12"},{id:"12835_12_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 12"},{id:"12835_13_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 13"},{id:"12835_13_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 13"},{id:"12835_14_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 14"},{id:"12835_14_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 14"},{id:"12835_15_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 15"},{id:"12835_15_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 15"},{id:"12835_16_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 16"},{id:"12835_16_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 16"},{id:"12835_17_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 17"},{id:"12835_17_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 17"},{id:"12835_18_FluidR3_GM_sf2_file",library:"FluidR3_GM",displayName:"Drum Kit 18"},{id:"12835_18_JCLive_sf2_file",library:"JCLive",displayName:"Drum Kit 18"}];function yp(t){const e=1+t%18,i=Ai.find(n=>n.id.startsWith(`12835_${e}_`)&&n.library==="FluidR3_GM");if(i)return{library:i.library,displayName:i.displayName};const r=Ai.find(n=>n.id.startsWith(`12835_${e}_`));return r?{library:r.library,displayName:r.displayName}:null}const gp=Array.from({length:47},(t,e)=>35+e),vp={35:"kick2",36:"kick1",37:"rim",38:"snare1",39:"clap",40:"snare2",41:"lowtom2",42:"hh_closed",43:"lowtom1",44:"hh_pedal",45:"midtom2",46:"hh_open",47:"midtom1",48:"hitom2",49:"crash1",50:"hitom1",51:"ride1",52:"china",53:"ride_bell",54:"tamb",55:"splash",56:"cowbell",57:"crash2",58:"vibraslap",59:"ride2",60:"bongo_hi",61:"bongo_lo",62:"conga_hi_mute",63:"conga_hi_open",64:"conga_lo",65:"timbale_hi",66:"timbale_lo",67:"agogo_hi",68:"agogo_lo",69:"cabasa",70:"maracas",71:"whistle_short",72:"whistle_long",73:"guiro_short",74:"guiro_long",75:"claves",76:"woodblock_hi",77:"woodblock_lo",78:"cuica_mute",79:"cuica_open",80:"triangle_mute",81:"triangle_open"},ro=ep,Nn=new Map;let we=null;function no(t){return Math.max(t,1e-4)}async function yr(t){return new Promise((e,i)=>{const r=document.createElement("script");r.src=t,r.onload=()=>e(),r.onerror=()=>i(new Error(`Failed to load script: ${t}`)),document.body.appendChild(r)})}async function _p(){we||(await yr("https://surikov.github.io/webaudiofont/npm/dist/WebAudioFontPlayer.js"),we=new window.WebAudioFontPlayer)}async function Vs(t,e=ee(),i=null,r,n,s,a=!0){const[o,l]=t.split("/"),c=String(e),d=`${o}/${l}@${c}`;Nn.has(e)||Nn.set(e,new Map);const u=Nn.get(e);if(a&&u.has(d))return u.get(d);if(await _p(),we.resumeContext){const C=we.resumeContext;we.resumeContext=P=>{if(!(P instanceof OfflineAudioContext))return C.call(we,P)}}const f=Ai.find(C=>C.library===o&&C.displayName===l);if(!f)throw new Error(`Could not find WebAudioFont entry for library=${o} and instrument=${l}`);i&&i.context!==e&&(console.warn("[WebAudioFont] Ignoring mismatched destination from another context"),i=null);const h=i||$t(e),m=e.createStereoPanner();if(m.pan.value=n??0,m.connect(h),!f.displayName.startsWith("Drum Kit")){const C=`_tone_${f.id}`,P=`https://surikov.github.io/webaudiofontdata/sound/${f.id}.js`;s?await yr(P):await ro(yr(P));const k=window[C];if(!k)throw new Error(`Missing preset: ${C}`);if(we.loader.decodeAfterLoading(e,C),e instanceof OfflineAudioContext){const L=(k==null?void 0:k.zones)??[];for(const x of L)if(x.file&&!x.buffer){const T=atob(x.file),F=new ArrayBuffer(T.length),B=new Uint8Array(F);for(let O=0;O<T.length;O++)B[O]=T.charCodeAt(O);x.buffer=await new Promise((O,G)=>e.decodeAudioData(F,O,G))}}const N={_preset:k,_volume:r??1,_activeEnvelopes:[],start({note:L,duration:x=1,velocity:T=100,time:F}){const B=typeof L=="string"?Z(L):L;if(B==null||typeof B!="number")return;const O=typeof F=="number"?F:0,G=Math.max(.01,Math.min(1,T/127)),le=no(N._volume),ie=Math.max(.01,Math.min(1,le*G)),de=we.queueWaveTable(e,m||$t(),k,O,B,x,ie);N._activeEnvelopes.push(de)},stop(){var L;for(const x of N._activeEnvelopes)try{x.cancel?x.cancel():(L=x.audioBufferSourceNode)!=null&&L.stop&&x.audioBufferSourceNode.stop()}catch(T){console.warn("Failed to stop envelope:",T)}N._activeEnvelopes=[]},setVolume(L){N._volume=Math.max(0,Math.min(1,L))},setPan(L){m.pan.value=Math.max(-1,Math.min(1,L))},load:Promise.resolve()};return a&&u.set(d,N),N}const y=f.id.match(/^12835_(\d+)_([A-Za-z0-9_]+)_sf2_file$/);if(!y)throw new Error(`Invalid drum ID format in catalogue: ${f.id}`);const[,p,_]=y,M=parseInt(p,10),v={},w=async()=>{for(const C of gp){const P=`_drum_${C}_${M}_${_}_sf2_file`,k=`https://surikov.github.io/webaudiofontdata/sound/${12800+C}_${M}_${_}_sf2_file.js`;try{await yr(k);const N=window[P];if(!N){console.warn(`Missing drum preset: ${P}`);continue}we.loader.decodeAfterLoading(e,P),v[C]=N}catch(N){console.warn(`Failed to load drum preset ${C}: ${N}`)}}};s??!1?await w():await ro(w());const S={_preset:v,_volume:r??1,_activeEnvelopes:[],start({note:C,duration:P=1,velocity:k=100,time:N}){const L=typeof C=="string"?Z(C):C;if(L==null||typeof L!="number"){console.warn(`Invalid MIDI pitch: ${C}`);return}const x=v[L];if(!x){console.warn(`No drum preset loaded for MIDI ${L}`);return}const T=typeof N=="number"?N:0,F=no(S._volume),B=we.queueWaveTable(e,m||$t(),x,T,L,P,F);S._activeEnvelopes.push(B)},stop(){var C;for(const P of S._activeEnvelopes)try{P.cancel?P.cancel():(C=P.audioBufferSourceNode)!=null&&C.stop&&P.audioBufferSourceNode.stop()}catch(k){console.warn("Failed to stop envelope:",k)}S._activeEnvelopes=[]},load:Promise.resolve(),setVolume(C){S._volume=Math.max(0,Math.min(1,C))},setPan(C){m.pan.value=Math.max(-1,Math.min(1,C))}};return a&&u.set(d,S),S}async function bp(){const t=new Set;for(const e of Ai)t.add(e.library);return Array.from(t)}async function Mp(t){return Ai.filter(e=>e.library===t).map(e=>e.displayName)}function wp(){return{name:"webaudiofont",loadInstrument:Vs,getAvailableLibraries:bp,getAvailableInstruments:Mp}}let es=null,ts=null;async function Sp(t){if(ts===t)return;const[,e,i]=t.split("/");es=await Vs(`${e}/${i}`,At()),ts=t}function Cp(){return ts}function Pp(t,e=100,i=!1){if(!es)return null;const n=At().currentTime,s=Z(t);return s===null?null:(es.start({note:s,velocity:e,time:n,duration:1.5,loop:i}),()=>{})}function Np(t){}async function kp(t,e,i,r=100,n=!1,s=null,a=null,o=null,l,c){const d=a||ee(),[,u,f]=t.split("/"),h=await Vs(`${u}/${f}`,d,o,l,c);l!==void 0&&h.setVolume&&h.setVolume(l),c!==void 0&&h.setPan&&h.setPan(c);const m=Z(e);return m===null||h.start({note:m,duration:i,velocity:r,loop:n,time:s??d.currentTime}),null}function xp(){return{name:"webaudiofont",setActiveInstrument:Sp,getActiveInstrumentName:Cp,playNote:Pp,stopNoteByPitch:Np,loadAndPlayNote:kp}}function Xl(t=3){const s=["C","D","E","F","G","A","B"],a=["C#","D#","","F#","G#","A#",""],o=[t,t+1,t+2],l={};let c=0;for(const d of o)s.forEach(u=>{const f=`${u}${d}`;l[f]={note:f,x:c,width:60,height:200,isBlack:!1},c+=60});c=0;for(const d of o)a.forEach((u,f)=>{if(u===""){c+=60;return}const h=`${u}${d}`;l[h]={note:h,x:c+60-40/2,width:40,height:120,isBlack:!0},c+=60});return l}let is="sf2/fluidr3-gm/acoustic_grand_piano",Ws=3,Yl=!1,Zl=Xl(Ws);function Lp(){is="sf2/fluidr3-gm/acoustic_grand_piano",Ql(is)}function Qr(){return is}function Ep(){const t=document.getElementById("instrument-loop-toggle");return(t==null?void 0:t.checked)??!1}function kn(){return Ws}function so(t){Ws=t}function wt(){return Yl}function Ap(t){Yl=t}function Kt(){return Zl}function Bp(t){Zl=t}const en={sf2:mp(),webaudiofont:xp()};async function Ql(t){if(!t.includes("/"))throw new Error(`Invalid instrument name: "${t}". Expected "<engine>/<library>/<instrument>"`);const e=t.split("/")[0],i=en[e];if(!i)throw new Error(`Engine "${e}" not available`);await i.setActiveInstrument(t)}function ed(t,e=100,i=!1){const r=Qr();if(!r)return null;const n=r.split("/")[0],s=en[n];if(!s)throw new Error(`Engine "${n}" not available`);return s.playNote(t,e,i)}function Tp(t){const e=Qr();if(!e)return;const i=e.split("/")[0],r=en[i];if(!r)throw new Error(`Engine "${i}" not available`);r.stopNoteByPitch(t)}async function Ip(t,e,i=1,r=100,n=!1,s=null,a=null,o=null,l,c){const d=t.split("/")[0],u=en[d];if(!u)throw new Error(`Engine "${d}" not available`);let f=a??ee(),h=o;return f.state==="suspended"&&(console.warn("[loadAndPlayNote] Using preview context due to suspended main context"),f=At(),h=lp()),await u.loadAndPlayNote(t,e,i,r,n,s,f,h,l,c)}let xn=null;function ee(){return xn||(xn=new(window.AudioContext||window.webkitAudioContext)),xn}const Ln=new WeakMap,En=new WeakMap;function td(t=ee()){if(!En.has(t)){const e=t.createAnalyser();e.fftSize=2048,En.set(t,e)}return En.get(t)}function $t(t=ee()){if(!Ln.has(t)){const e=t.createGain(),i=td(t);e.connect(i),i.connect(t.destination),Ln.set(t,e)}return Ln.get(t)}function Gp(t){try{const e=ed(t,100,!1);return e?{stop:e,forceStop:e}:null}catch(e){return console.error("[playNote] Failed to play note",t,e),null}}const tn={sf2:op(),webaudiofont:wp()},id="sf2";async function rd(t,e,i,r,n,s,a=!0){const o=t.split("/");if(o.length!==3)throw new Error(`Invalid instrument fullName format: "${t}". Expected format "engine/library/instrument"`);const[l,c,d]=o,u=tn[l];if(!u)throw new Error(`Engine "${l}" not available`);return await u.loadInstrument(`${c}/${d}`,e,i,r,n,s,a)}async function Op(t=id){const e=tn[t];if(!e)throw new Error(`Engine "${t}" not available`);return await e.getAvailableLibraries()}async function Dp(t,e=id){const i=tn[e];if(!i)throw new Error(`Engine "${e}" not available`);return await i.getAvailableInstruments(t)}function Fp(){return Object.keys(tn)}const Rp=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],Up=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],nd={C:0,"C#":1,Db:1,D:2,"D#":3,Eb:3,E:4,Fb:4,"E#":5,F:5,"F#":6,Gb:6,G:7,"G#":8,Ab:8,A:9,"A#":10,Bb:10,B:11,Cb:11,"B#":0};function Hp(t){return t.includes("#")}function te(t){const e=t==null?void 0:t.match(/^([A-Ga-g])([#b]*)(-?\d+)$/);if(!e)return null;const[,i,r,n]=e,s=i.toUpperCase(),a=nd[s];if(a===void 0)return null;const o=[...r].reduce((c,d)=>d==="#"?c+1:d==="b"?c-1:c,0);return 12*(parseInt(n,10)+1)+(a+o)}function bt(t){return te(t)}const qp=t=>{const e=te(t);return e!==null?e%12:0};function Js(t,e=21,i){const r=te(t);if(r===null)return null;const n=i-e+1,s=r-e,a=n-1-s;return a>=0&&a<n?a:null}function pe(t,e,i){const n=i-e+1-1-t,s=e+n;return Qt(s)}function Qt(t,e=!1){const r=(e?Up:Rp)[t%12],n=Math.floor(t/12)-1;return`${r}${n}`}function sd(t,e){const i=new Map;for(let r=t;r<=e;r++)i.set(r,Hp(Qt(r)));return i}function jp(t,e){const i=te(t),r=te(e);if(i===null||r===null)throw new Error(`Invalid pitches provided: ${t}, ${e}`);return i-r}function Kp(t,e){const i=structuredClone(t);return i.tempo=e.bpm,i}function ad(t){return{type:"CHANGE_TEMPO",bpm:t}}function $p(t){return ad(t)}function zp(t,e){const i=structuredClone(t);return i.timeSignature=[e.beats,4],i}function od(t){return{type:"SET_TIME_SIGNATURE",beats:t}}function Vp(t){return od(t)}function Wp(t,e){const i=structuredClone(t);return i.totalMeasures=e.measures,i}function ld(t){return{type:"SET_TOTAL_MEASURES",measures:t}}function Jp(t){return ld(t)}function Xp(t){return t!==null&&typeof t=="object"&&"name"in t&&typeof t.name=="string"}function Yp(t){return t!==null&&typeof t=="object"&&"step"in t&&typeof t.step=="number"&&"alt"in t&&typeof t.alt=="number"&&!isNaN(t.step)&&!isNaN(t.alt)}var dd=[0,2,4,-1,1,3,5],Zp=dd.map(t=>Math.floor(t*7/12));function Qp(t){const{step:e,alt:i,oct:r,dir:n=1}=t,s=dd[e]+7*i;if(r===void 0)return[n*s];const a=r-Zp[e]-4*i;return[n*s,n*a]}var ao=(t,e)=>Array(Math.abs(e)+1).join(t),rs=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),em="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",tm="(AA|A|P|M|m|d|dd)([-+]?\\d+)",im=new RegExp("^"+em+"|"+tm+"$");function rm(t){const e=im.exec(`${t}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var oo={};function ns(t){return typeof t=="string"?oo[t]||(oo[t]=nm(t)):Yp(t)?ns(am(t)):Xp(t)?ns(t.name):rs}var lo=[0,2,4,5,7,9,11],cd="PMMPPMM";function nm(t){const e=rm(t);if(e[0]==="")return rs;const i=+e[0],r=e[1],n=(Math.abs(i)-1)%7,s=cd[n];if(s==="M"&&r==="P")return rs;const a=s==="M"?"majorable":"perfectable",o=""+i+r,l=i<0?-1:1,c=i===8||i===-8?i:l*(n+1),d=sm(a,r),u=Math.floor((Math.abs(i)-1)/7),f=l*(lo[n]+d+12*u),h=(l*(lo[n]+d)%12+12)%12,m=Qp({step:n,alt:d,oct:u,dir:l});return{empty:!1,name:o,num:i,q:r,step:n,alt:d,dir:l,type:a,simple:c,semitones:f,chroma:h,coord:m,oct:u}}function sm(t,e){return e==="M"&&t==="majorable"||e==="P"&&t==="perfectable"?0:e==="m"&&t==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(t==="perfectable"?e.length:e.length+1):0}function am(t){const{step:e,alt:i,oct:r=0,dir:n}=t;if(!n)return"";const s=e+1+7*r,a=s===0?e+1:s,o=n<0?"-":"",l=cd[e]==="M"?"majorable":"perfectable";return o+a+om(l,i)}function om(t,e){return e===0?t==="majorable"?"M":"P":e===-1&&t==="majorable"?"m":e>0?ao("A",e):ao("d",t==="perfectable"?e:e+1)}function lm(t){return t!==null&&typeof t=="object"&&"name"in t&&typeof t.name=="string"}function dm(t){return t!==null&&typeof t=="object"&&"step"in t&&typeof t.step=="number"&&"alt"in t&&typeof t.alt=="number"&&!isNaN(t.step)&&!isNaN(t.alt)}var ud=[0,2,4,-1,1,3,5],hd=ud.map(t=>Math.floor(t*7/12));function cm(t){const{step:e,alt:i,oct:r,dir:n=1}=t,s=ud[e]+7*i;if(r===void 0)return[n*s];const a=r-hd[e]-4*i;return[n*s,n*a]}var um=[3,0,4,1,5,2,6];function hm(t){const[e,i,r]=t,n=um[fm(e)],s=Math.floor((e+1)/7);if(i===void 0)return{step:n,alt:s,dir:r};const a=i+4*s+hd[n];return{step:n,alt:s,oct:a,dir:r}}function fm(t){const e=(t+1)%7;return e<0?7+e:e}var co=(t,e)=>Array(Math.abs(e)+1).join(t),fd=Object.freeze({empty:!0,name:"",letter:"",acc:"",pc:"",step:NaN,alt:NaN,chroma:NaN,height:NaN,coord:[],midi:null,freq:null}),uo=new Map,pm=t=>"CDEFGAB".charAt(t),mm=t=>t<0?co("b",-t):co("#",t),ym=t=>t[0]==="b"?-t.length:t.length;function W(t){const e=JSON.stringify(t),i=uo.get(e);if(i)return i;const r=typeof t=="string"?Mm(t):dm(t)?W(wm(t)):lm(t)?W(t.name):fd;return uo.set(e,r),r}var gm=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function vm(t){const e=gm.exec(t);return e?[e[1].toUpperCase(),e[2].replace(/x/g,"##"),e[3],e[4]]:["","","",""]}function _m(t){return W(hm(t))}var bm=(t,e)=>(t%e+e)%e,An=[0,2,4,5,7,9,11];function Mm(t){const e=vm(t);if(e[0]===""||e[3]!=="")return fd;const i=e[0],r=e[1],n=e[2],s=(i.charCodeAt(0)+3)%7,a=ym(r),o=n.length?+n:void 0,l=cm({step:s,alt:a,oct:o}),c=i+r+n,d=i+r,u=(An[s]+a+120)%12,f=o===void 0?bm(An[s]+a,12)-12*99:An[s]+a+12*(o+1),h=f>=0&&f<=127?f:null,m=o===void 0?null:Math.pow(2,(f-69)/12)*440;return{empty:!1,acc:r,alt:a,chroma:u,coord:l,freq:m,height:f,letter:i,midi:h,name:c,oct:o,pc:d,step:s}}function wm(t){const{step:e,alt:i,oct:r}=t,n=pm(e);if(!n)return"";const s=n+mm(i);return r||r===0?s+r:s}function zr(t,e){const i=W(t),r=Array.isArray(e)?e:ns(e).coord;if(i.empty||!r||r.length<2)return"";const n=i.coord,s=n.length===1?[n[0]+r[0]]:[n[0]+r[0],n[1]+r[1]];return _m(s).name}function pd(t,e){const i=t.length;return r=>{if(!e)return"";const n=r<0?(i- -r%i)%i:r%i,s=Math.floor(r/i),a=zr(e,[0,s]);return zr(a,t[n])}}function Sm(t,e){const i=[];for(;e--;i[e]=e+t);return i}function Cm(t,e){const i=[];for(;e--;i[e]=t-e);return i}function Pm(t,e){return t<e?Sm(t,e-t+1):Cm(t,t-e+1)}function ji(t,e){const i=e.length,r=(t%i+i)%i;return e.slice(r,i).concat(e.slice(0,r))}function Nm(t){return t.filter(e=>e===0||e)}function km(t){return t!==null&&typeof t=="object"&&"name"in t&&typeof t.name=="string"}function xm(t){return t!==null&&typeof t=="object"&&"step"in t&&typeof t.step=="number"&&"alt"in t&&typeof t.alt=="number"&&!isNaN(t.step)&&!isNaN(t.alt)}var md=[0,2,4,-1,1,3,5],Lm=md.map(t=>Math.floor(t*7/12));function Em(t){const{step:e,alt:i,oct:r,dir:n=1}=t,s=md[e]+7*i;if(r===void 0)return[n*s];const a=r-Lm[e]-4*i;return[n*s,n*a]}var ho=(t,e)=>Array(Math.abs(e)+1).join(t),ss=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),Am="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",Bm="(AA|A|P|M|m|d|dd)([-+]?\\d+)",Tm=new RegExp("^"+Am+"|"+Bm+"$");function Im(t){const e=Tm.exec(`${t}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var fo={};function as(t){return typeof t=="string"?fo[t]||(fo[t]=Gm(t)):xm(t)?as(Dm(t)):km(t)?as(t.name):ss}var po=[0,2,4,5,7,9,11],yd="PMMPPMM";function Gm(t){const e=Im(t);if(e[0]==="")return ss;const i=+e[0],r=e[1],n=(Math.abs(i)-1)%7,s=yd[n];if(s==="M"&&r==="P")return ss;const a=s==="M"?"majorable":"perfectable",o=""+i+r,l=i<0?-1:1,c=i===8||i===-8?i:l*(n+1),d=Om(a,r),u=Math.floor((Math.abs(i)-1)/7),f=l*(po[n]+d+12*u),h=(l*(po[n]+d)%12+12)%12,m=Em({step:n,alt:d,oct:u,dir:l});return{empty:!1,name:o,num:i,q:r,step:n,alt:d,dir:l,type:a,simple:c,semitones:f,chroma:h,coord:m,oct:u}}function Om(t,e){return e==="M"&&t==="majorable"||e==="P"&&t==="perfectable"?0:e==="m"&&t==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(t==="perfectable"?e.length:e.length+1):0}function Dm(t){const{step:e,alt:i,oct:r=0,dir:n}=t;if(!n)return"";const s=e+1+7*r,a=s===0?e+1:s,o=n<0?"-":"",l=yd[e]==="M"?"majorable":"perfectable";return o+a+Fm(l,i)}function Fm(t,e){return e===0?t==="majorable"?"M":"P":e===-1&&t==="majorable"?"m":e>0?ho("A",e):ho("d",t==="perfectable"?e:e+1)}var Ae={empty:!0,name:"",setNum:0,chroma:"000000000000",normalized:"000000000000",intervals:[]},gd=t=>Number(t).toString(2).padStart(12,"0"),mo=t=>parseInt(t,2),Rm=/^[01]{12}$/;function Xs(t){return Rm.test(t)}var Um=t=>typeof t=="number"&&t>=0&&t<=4095,Hm=t=>t&&Xs(t.chroma),yo={[Ae.chroma]:Ae};function be(t){const e=Xs(t)?t:Um(t)?gd(t):Array.isArray(t)?Jm(t):Hm(t)?t.chroma:Ae.chroma;return yo[e]=yo[e]||Wm(e)}var qm=t=>be(t).chroma,jm=["1P","2m","2M","3m","3M","4P","5d","5P","6m","6M","7m","7M"];function Km(t){const e=[];for(let i=0;i<12;i++)t.charAt(i)==="1"&&e.push(jm[i]);return e}function $m(t,e=!0){const r=be(t).chroma.split("");return Nm(r.map((n,s)=>{const a=ji(s,r);return e&&a[0]==="0"?null:a.join("")}))}function vd(t){const e=be(t).setNum;return i=>{const r=be(i).setNum;return e&&e!==r&&(r&e)===r}}function zm(t){const e=be(t).setNum;return i=>{const r=be(i).setNum;return e&&e!==r&&(r|e)===r}}function Vm(t){const e=t.split("");return e.map((i,r)=>ji(r,e).join(""))}function Wm(t){const e=mo(t),i=Vm(t).map(mo).filter(s=>s>=2048).sort()[0],r=gd(i),n=Km(t);return{empty:!1,name:"",setNum:e,chroma:t,normalized:r,intervals:n}}function Jm(t){if(t.length===0)return Ae.chroma;let e;const i=[0,0,0,0,0,0,0,0,0,0,0,0];for(let r=0;r<t.length;r++)e=W(t[r]),e.empty&&(e=as(t[r])),e.empty||(i[e.chroma]=1);return i.join("")}var Xm=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7  ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 #4 #11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -7 m -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim  o"],["1P 3m 5d 7d","diminished seventh","dim7 7 o7"],["1P 3m 5d 7m","half-diminished","m7b5  -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],Ym=Xm;({...Ae});var _d=[],gr={};function Zm(t,e,i){const r=ey(t),n={...be(t),name:i||"",quality:r,intervals:t,aliases:e};_d.push(n),n.name&&(gr[n.name]=n),gr[n.setNum]=n,gr[n.chroma]=n,n.aliases.forEach(s=>Qm(n,s))}function Qm(t,e){gr[e]=t}function ey(t){const e=i=>t.indexOf(i)!==-1;return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}Ym.forEach(([t,e,i])=>Zm(t.split(" "),i.split(" "),e));_d.sort((t,e)=>t.setNum-e.setNum);var ty=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7  ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 #4 #11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -7 m -^7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim  o"],["1P 3m 5d 7d","diminished seventh","dim7 7 o7"],["1P 3m 5d 7m","half-diminished","m7b5  -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],iy=ty;({...Ae});var bd=[],vr={};function ry(t,e,i){const r=sy(t),n={...be(t),name:i||"",quality:r,intervals:t,aliases:e};bd.push(n),n.name&&(vr[n.name]=n),vr[n.setNum]=n,vr[n.chroma]=n,n.aliases.forEach(s=>ny(n,s))}function ny(t,e){vr[e]=t}function sy(t){const e=i=>t.indexOf(i)!==-1;return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}iy.forEach(([t,e,i])=>ry(t.split(" "),i.split(" "),e));bd.sort((t,e)=>t.setNum-e.setNum);var ay=[["1P 2M 3M 5P 6M","major pentatonic","pentatonic"],["1P 2M 3M 4P 5P 6M 7M","major","ionian"],["1P 2M 3m 4P 5P 6m 7m","minor","aeolian"],["1P 2M 3m 3M 5P 6M","major blues"],["1P 3m 4P 5d 5P 7m","minor blues","blues"],["1P 2M 3m 4P 5P 6M 7M","melodic minor"],["1P 2M 3m 4P 5P 6m 7M","harmonic minor"],["1P 2M 3M 4P 5P 6M 7m 7M","bebop"],["1P 2M 3m 4P 5d 6m 6M 7M","diminished","whole-half diminished"],["1P 2M 3m 4P 5P 6M 7m","dorian"],["1P 2M 3M 4A 5P 6M 7M","lydian"],["1P 2M 3M 4P 5P 6M 7m","mixolydian","dominant"],["1P 2m 3m 4P 5P 6m 7m","phrygian"],["1P 2m 3m 4P 5d 6m 7m","locrian"],["1P 3M 4P 5P 7M","ionian pentatonic"],["1P 3M 4P 5P 7m","mixolydian pentatonic","indian"],["1P 2M 4P 5P 6M","ritusen"],["1P 2M 4P 5P 7m","egyptian"],["1P 3M 4P 5d 7m","neopolitan major pentatonic"],["1P 3m 4P 5P 6m","vietnamese 1"],["1P 2m 3m 5P 6m","pelog"],["1P 2m 4P 5P 6m","kumoijoshi"],["1P 2M 3m 5P 6m","hirajoshi"],["1P 2m 4P 5d 7m","iwato"],["1P 2m 4P 5P 7m","in-sen"],["1P 3M 4A 5P 7M","lydian pentatonic","chinese"],["1P 3m 4P 6m 7m","malkos raga"],["1P 3m 4P 5d 7m","locrian pentatonic","minor seven flat five pentatonic"],["1P 3m 4P 5P 7m","minor pentatonic","vietnamese 2"],["1P 3m 4P 5P 6M","minor six pentatonic"],["1P 2M 3m 5P 6M","flat three pentatonic","kumoi"],["1P 2M 3M 5P 6m","flat six pentatonic"],["1P 2m 3M 5P 6M","scriabin"],["1P 3M 5d 6m 7m","whole tone pentatonic"],["1P 3M 4A 5A 7M","lydian #5P pentatonic"],["1P 3M 4A 5P 7m","lydian dominant pentatonic"],["1P 3m 4P 5P 7M","minor #7M pentatonic"],["1P 3m 4d 5d 7m","super locrian pentatonic"],["1P 2M 3m 4P 5P 7M","minor hexatonic"],["1P 2A 3M 5P 5A 7M","augmented"],["1P 2M 4P 5P 6M 7m","piongio"],["1P 2m 3M 4A 6M 7m","prometheus neopolitan"],["1P 2M 3M 4A 6M 7m","prometheus"],["1P 2m 3M 5d 6m 7m","mystery #1"],["1P 2m 3M 4P 5A 6M","six tone symmetric"],["1P 2M 3M 4A 5A 6A","whole tone","messiaen's mode #1"],["1P 2m 4P 4A 5P 7M","messiaen's mode #5"],["1P 2M 3M 4P 5d 6m 7m","locrian major","arabian"],["1P 2m 3M 4A 5P 6m 7M","double harmonic lydian"],["1P 2m 2A 3M 4A 6m 7m","altered","super locrian","diminished whole tone","pomeroy"],["1P 2M 3m 4P 5d 6m 7m","locrian #2","half-diminished","aeolian b5"],["1P 2M 3M 4P 5P 6m 7m","mixolydian b6","melodic minor fifth mode","hindu"],["1P 2M 3M 4A 5P 6M 7m","lydian dominant","lydian b7","overtone"],["1P 2M 3M 4A 5A 6M 7M","lydian augmented"],["1P 2m 3m 4P 5P 6M 7m","dorian b2","phrygian #6","melodic minor second mode"],["1P 2m 3m 4d 5d 6m 7d","ultralocrian","superlocrian bb7","superlocrian diminished"],["1P 2m 3m 4P 5d 6M 7m","locrian 6","locrian natural 6","locrian sharp 6"],["1P 2A 3M 4P 5P 5A 7M","augmented heptatonic"],["1P 2M 3m 4A 5P 6M 7m","dorian #4","ukrainian dorian","romanian minor","altered dorian"],["1P 2M 3m 4A 5P 6M 7M","lydian diminished"],["1P 2M 3M 4A 5A 7m 7M","leading whole tone"],["1P 2M 3M 4A 5P 6m 7m","lydian minor"],["1P 2m 3M 4P 5P 6m 7m","phrygian dominant","spanish","phrygian major"],["1P 2m 3m 4P 5P 6m 7M","balinese"],["1P 2m 3m 4P 5P 6M 7M","neopolitan major"],["1P 2M 3M 4P 5P 6m 7M","harmonic major"],["1P 2m 3M 4P 5P 6m 7M","double harmonic major","gypsy"],["1P 2M 3m 4A 5P 6m 7M","hungarian minor"],["1P 2A 3M 4A 5P 6M 7m","hungarian major"],["1P 2m 3M 4P 5d 6M 7m","oriental"],["1P 2m 3m 3M 4A 5P 7m","flamenco"],["1P 2m 3m 4A 5P 6m 7M","todi raga"],["1P 2m 3M 4P 5d 6m 7M","persian"],["1P 2m 3M 5d 6m 7m 7M","enigmatic"],["1P 2M 3M 4P 5A 6M 7M","major augmented","major #5","ionian augmented","ionian #5"],["1P 2A 3M 4A 5P 6M 7M","lydian #9"],["1P 2m 2M 4P 4A 5P 6m 7M","messiaen's mode #4"],["1P 2m 3M 4P 4A 5P 6m 7M","purvi raga"],["1P 2m 3m 3M 4P 5P 6m 7m","spanish heptatonic"],["1P 2M 3m 3M 4P 5P 6M 7m","bebop minor"],["1P 2M 3M 4P 5P 5A 6M 7M","bebop major"],["1P 2m 3m 4P 5d 5P 6m 7m","bebop locrian"],["1P 2M 3m 4P 5P 6m 7m 7M","minor bebop"],["1P 2M 3M 4P 5d 5P 6M 7M","ichikosucho"],["1P 2M 3m 4P 5P 6m 6M 7M","minor six diminished"],["1P 2m 3m 3M 4A 5P 6M 7m","half-whole diminished","dominant diminished","messiaen's mode #2"],["1P 3m 3M 4P 5P 6M 7m 7M","kafi raga"],["1P 2M 3M 4P 4A 5A 6A 7M","messiaen's mode #6"],["1P 2M 3m 3M 4P 5d 5P 6M 7m","composite blues"],["1P 2M 3m 3M 4A 5P 6m 7m 7M","messiaen's mode #3"],["1P 2m 2M 3m 4P 4A 5P 6m 6M 7M","messiaen's mode #7"],["1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M","chromatic"]],oy=ay,ly={...Ae,intervals:[],aliases:[]},Ys=[],Si={};function dy(){return Ys.map(t=>t.name)}function Md(t){return Si[t]||ly}function Zs(){return Ys.slice()}function cy(t,e,i=[]){const r={...be(t),name:e,intervals:t,aliases:i};return Ys.push(r),Si[r.name]=r,Si[r.setNum]=r,Si[r.chroma]=r,r.aliases.forEach(n=>uy(r,n)),r}function uy(t,e){Si[e]=t}oy.forEach(([t,e,...i])=>cy(t.split(" "),e,i));var hy=[[.125,"dl",["large","duplex longa","maxima","octuple","octuple whole"]],[.25,"l",["long","longa"]],[.5,"d",["double whole","double","breve"]],[1,"w",["whole","semibreve"]],[2,"h",["half","minim"]],[4,"q",["quarter","crotchet"]],[8,"e",["eighth","quaver"]],[16,"s",["sixteenth","semiquaver"]],[32,"t",["thirty-second","demisemiquaver"]],[64,"sf",["sixty-fourth","hemidemisemiquaver"]],[128,"h",["hundred twenty-eighth"]],[256,"th",["two hundred fifty-sixth"]]],fy=hy;fy.forEach(([t,e,i])=>void 0);var py="C C# D D# E F F# G G# A A# B".split(" "),my="C Db D Eb E F Gb G Ab A Bb B".split(" ");function wd(t,e={}){if(isNaN(t)||t===-1/0||t===1/0)return"";t=Math.round(t);const r=(e.sharps===!0?py:my)[t%12];if(e.pitchClass)return r;const n=Math.floor(t/12)-1;return r+n}var yy=t=>t.name,gy=t=>t.map(W).filter(e=>!e.empty),go=W;function vy(t){return wd(t)}var Sd=(t,e)=>t.height-e.height;function _y(t,e){return e=e||Sd,gy(t).sort(e).map(yy)}function by(t){return _y(t,Sd).filter((e,i,r)=>i===0||e!==r[i-1])}function My(t,e){const i=go(t);if(i.empty)return"";const r=go(e||wd(i.midi||i.chroma,{sharps:i.alt<0,pitchClass:!0}));if(r.empty||r.chroma!==i.chroma)return"";if(i.oct===void 0)return r.pc;const n=i.chroma-i.alt,s=r.chroma-r.alt,a=n>11||s<0?-1:n<0||s>11?1:0,o=i.oct+a;return r.pc+o}var Qs=[[0,2773,0,"ionian","","Maj7","major"],[1,2902,2,"dorian","m","m7"],[2,3418,4,"phrygian","m","m7"],[3,2741,-1,"lydian","","Maj7"],[4,2774,1,"mixolydian","","7"],[5,2906,3,"aeolian","m","m7","minor"],[6,3434,5,"locrian","dim","m7b5"]],vo={...Ae,name:"",alt:0,modeNum:NaN,triad:"",seventh:"",aliases:[]},wy=Qs.map(Sy),os={};wy.forEach(t=>{os[t.name]=t,t.aliases.forEach(e=>{os[e]=t})});function Cd(t){return typeof t=="string"?os[t.toLowerCase()]||vo:t&&t.name?Cd(t.name):vo}function Sy(t){const[e,i,r,n,s,a,o]=t,l=o?[o]:[],c=Number(i).toString(2);return{empty:!1,intervals:Md(n).intervals,modeNum:e,chroma:c,normalized:c,name:n,setNum:i,alt:r,triad:s,seventh:a,aliases:l}}function Pd(t){return(e,i)=>{const r=Cd(e);if(r.empty)return[];const n=ji(r.modeNum,t),s=r.intervals.map(a=>zr(i,a));return n.map((a,o)=>s[o]+a)}}Pd(Qs.map(t=>t[4]));Pd(Qs.map(t=>t[5]));var Cy=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7  ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 #4 #11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -7 m -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim  o"],["1P 3m 5d 7d","diminished seventh","dim7 7 o7"],["1P 3m 5d 7m","half-diminished","m7b5  -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],Py=Cy;({...Ae});var Nd=[],_r={};function Ny(t,e,i){const r=xy(t),n={...be(t),name:i||"",quality:r,intervals:t,aliases:e};Nd.push(n),n.name&&(_r[n.name]=n),_r[n.setNum]=n,_r[n.chroma]=n,n.aliases.forEach(s=>ky(n,s))}function ky(t,e){_r[e]=t}function xy(t){const e=i=>t.indexOf(i)!==-1;return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}Py.forEach(([t,e,i])=>Ny(t.split(" "),i.split(" "),e));Nd.sort((t,e)=>t.setNum-e.setNum);var Ly=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7  ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 #4 #11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -7 m -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim  o"],["1P 3m 5d 7d","diminished seventh","dim7 7 o7"],["1P 3m 5d 7m","half-diminished","m7b5  -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],Ey=Ly;({...Ae});var ea=[],br={};function Ay(){return ea.slice()}function By(t,e,i){const r=Iy(t),n={...be(t),name:i||"",quality:r,intervals:t,aliases:e};ea.push(n),n.name&&(br[n.name]=n),br[n.setNum]=n,br[n.chroma]=n,n.aliases.forEach(s=>Ty(n,s))}function Ty(t,e){br[e]=t}function Iy(t){const e=i=>t.indexOf(i)!==-1;return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}Ey.forEach(([t,e,i])=>By(t.split(" "),i.split(" "),e));ea.sort((t,e)=>t.setNum-e.setNum);var Gy={empty:!0,name:"",type:"",tonic:null,setNum:NaN,chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function kd(t){if(typeof t!="string")return["",""];const e=t.indexOf(" "),i=W(t.substring(0,e));if(i.empty){const n=W(t);return n.empty?["",t.toLowerCase()]:[n.name,""]}const r=t.substring(i.name.length+1).toLowerCase();return[i.name,r.length?r:""]}var Oy=dy;function Be(t){const e=Array.isArray(t)?t:kd(t),i=W(e[0]).name,r=Md(e[1]);if(r.empty)return Gy;const n=r.name,s=i?r.intervals.map(o=>zr(i,o)):[],a=i?i+" "+n:n;return{...r,name:a,type:n,tonic:i,notes:s}}var Dy=Be;function Fy(t,e={}){const i=qm(t),r=W(e.tonic??t[0]??""),n=r.chroma;if(n===void 0)return[];const s=i.split("");s[n]="1";const a=ji(n,s).join(""),o=Zs().find(c=>c.chroma===a),l=[];return o&&l.push(r.name+" "+o.name),e.match==="exact"||xd(a).forEach(c=>{l.push(r.name+" "+c)}),l}function Ry(t){const e=Be(t),i=vd(e.chroma);return Ay().filter(r=>i(r.chroma)).map(r=>r.aliases[0])}function xd(t){const e=Xs(t)?t:Be(t).chroma,i=zm(e);return Zs().filter(r=>i(r.chroma)).map(r=>r.name)}function Uy(t){const e=vd(Be(t).chroma);return Zs().filter(i=>e(i.chroma)).map(i=>i.name)}function Ld(t){const e=t.map(n=>W(n).pc).filter(n=>n),i=e[0],r=by(e);return ji(r.indexOf(i),r)}function Hy(t){const e=Be(t);if(e.empty)return[];const i=e.tonic?e.notes:e.intervals;return $m(e.chroma).map((r,n)=>{const s=Be(r).name;return s?[i[n],s]:["",""]}).filter(r=>r[0])}function qy(t){const e=Array.isArray(t)?Ld(t):Be(t).notes,i=e.map(r=>W(r).chroma);return r=>{const n=W(typeof r=="number"?vy(r):r),s=n.height;if(s===void 0)return;const a=s%12,o=i.indexOf(a);if(o!==-1)return My(n.name,e[o])}}function jy(t){const e=qy(t);return(i,r)=>{const n=W(i).height,s=W(r).height;return n===void 0||s===void 0?[]:Pm(n,s).map(e).filter(a=>a)}}function Ky(t){const{intervals:e,tonic:i}=Be(t),r=pd(e,i);return n=>n?r(n>0?n-1:n):""}function $y(t){const{intervals:e,tonic:i}=Be(t);return pd(e,i)}var zy={degrees:Ky,detect:Fy,extended:xd,get:Be,modeNames:Hy,names:Oy,rangeOf:jy,reduced:Uy,scaleChords:Ry,scaleNotes:Ld,steps:$y,tokenize:kd,scale:Dy};const Vy=new Set(["C","C#","Db","D","D#","Eb","E","E#","Fb","F","F#","Gb","G","G#","Ab","A","A#","Bb","B","B#","Cb"]),Wy=new Set(["M","m"]);function Jy(t){const e=t.slice(0,-1),i=t.slice(-1);if(!Vy.has(e)||!Wy.has(i))return null;const r=i==="M"?"major":"minor",n=zy.get(`${e} ${r}`);return n.empty?null:n.notes}function Ed(t){const e=Jy(t),i=new Map;if(!e)return i;const r=new Set(e.map(n=>nd[n]%12));for(let n=0;n<=127;n++){const s=n%12;i.set(n,r.has(s))}return i}function Ad(){return typeof window<"u"&&typeof localStorage<"u"}function rn(t,e){Ad()&&localStorage.setItem(t,JSON.stringify(e))}function nn(t){if(!Ad())return null;const e=localStorage.getItem(t);if(!e)return null;try{return JSON.parse(e)}catch(i){return console.error(`Error parsing localStorage key "${t}":`,i),null}}const Bd="grid-key-highlighting",Td="grid-snap-enabled",Id="snap-to-in-key",Xy="CM";let Gd=nn(Bd)??!1,Od=nn(Td)??!0,Dd=nn(Id)??!1,Fd=Ed(Xy),Rd=!1;function Ud(){return Gd}function Yy(t){Gd=t,rn(Bd,t)}function Hd(){return Od}function Zy(t){Od=t,rn(Td,t)}function sn(){return Dd}function Qy(t){Dd=t,rn(Id,t)}function an(){return Fd}function eg(t){Fd=Ed(t)}function Bi(){return Rd}function _o(t){Rd=t}function tg(t,e){const i=structuredClone(t);return i.songKey=e.songKey,eg(e.songKey),i}function qd(t){return{type:"CHANGE_SONG_KEY",songKey:t}}function ig(t){return qd(t)}function rg(t,e){const i=structuredClone(t);return i.snapResolution=e.snapResolution,i}function jd(t){return{type:"CHANGE_SNAP_RESOLUTION",snapResolution:t}}function ng(t){return jd(t)}function sg(t,e){const i=structuredClone(t);return i.noteDuration=e.noteDuration,i}function Kd(t){return{type:"CHANGE_NOTE_DURATION",noteDuration:t}}function ag(t){return Kd(t)}function og(t,e){const i=structuredClone(t);return i.isTripletMode=e.triplet,i.isDottedMode=e.dotted,i}function $d(t,e){return{type:"SET_NOTE_MODIFIER_MODE",triplet:t,dotted:e}}function lg(t,e){return $d(t,e)}function dg(t,e){const i=structuredClone(t);if(i.sequencers.push({id:e.id,instrument:e.instrument,notes:e.notes??[],volume:e.volume,pan:e.pan}),!j.find(n=>n.id===e.id)){const n={id:e.id,instrument:e.instrument,notes:e.notes??[],volume:e.volume,pan:e.pan};cc(n)}return i}function zd(t,e,i,r){return{type:"CREATE_SEQUENCER",id:t,instrument:e,volume:i,pan:r}}function ta(t){return{type:"DELETE_SEQUENCER",id:t}}function cg(t,e){const i=structuredClone(t);i.sequencers=i.sequencers.filter(n=>n.id!==e.id);const r=j.findIndex(n=>n.id===e.id);return r!==-1&&(j[r].destroy(),j.splice(r,1)),i}function Vd(t,e,i=[],r,n){return{type:"DELETE_SEQUENCER",id:t,instrument:e,notes:structuredClone(i),volume:r,pan:n}}function Wd(t,e,i=[],r,n){return{type:"CREATE_SEQUENCER",id:t,instrument:e,notes:structuredClone(i),volume:r,pan:n}}function ug(t,e){const i=structuredClone(t),r=i.sequencers.find(n=>n.id===e.sequencerId);return r&&e.instrument&&(r.instrument=e.instrument),i}function hg(t,e){return{type:"SET_INSTRUMENT",sequencerId:t,instrument:e}}function fg(t,e){return{type:"SET_INSTRUMENT",sequencerId:t,instrument:e}}function pg(t,e){var n;const i=structuredClone(t),r=i.sequencers.find(s=>s.id===e.id);if(r&&typeof e.volume=="number"){r.volume=e.volume;const s=j.find(a=>a.id===e.id);s&&(s.volume=e.volume,(n=s.refreshVolumeUI)==null||n.call(s))}return i}function mg(t,e){return{type:"SET_VOLUME",id:t,volume:e}}function yg(t,e){return{type:"SET_VOLUME",id:t,volume:e}}function gg(t,e){var n;const i=structuredClone(t),r=i.sequencers.find(s=>s.id===e.id);if(r&&typeof e.pan=="number"){r.pan=e.pan;const s=j.find(a=>a.id===e.id);s&&(s.pan=e.pan,(n=s.refreshPanUI)==null||n.call(s))}return i}function vg(t,e){return{type:"SET_PAN",id:t,pan:e}}function _g(t,e){return{type:"SET_PAN",id:t,pan:e}}function bg(t,e){const i=structuredClone(t),r=i.sequencers.find(n=>n.id===e.sequencerId);return r?(r.notes.push(...e.notes),i):t}function ia(t,e){return{type:"PLACE_NOTES",sequencerId:t,notes:structuredClone(e)}}function ra(t,e){return{type:"DELETE_NOTES",sequencerId:t,notes:structuredClone(e)}}function Mg(t,e){const i=structuredClone(t),r=i.sequencers.find(s=>s.id===e.sequencerId);if(!r)return t;const n=new Set(e.notes.map(s=>`${s.pitch}|${s.start}|${s.duration}`));return r.notes=r.notes.filter(s=>{const a=`${s.pitch}|${s.start}|${s.duration}`;return!n.has(a)}),i}function Pe(t,e){return{type:"DELETE_NOTES",sequencerId:t,notes:structuredClone(e)}}function Ne(t,e){return{type:"PLACE_NOTES",sequencerId:t,notes:structuredClone(e)}}function wg(t,e){const i=structuredClone(t),r=i.sequencers.find(a=>a.id===e.sequencerId);if(!r)return t;const n=e.from,s=e.to;for(let a=0;a<n.length;a++){const o=n[a],l=s[a],c=r.notes.findIndex(d=>d.pitch===o.pitch&&d.start===o.start&&d.duration===o.duration);c!==-1&&(r.notes[c].pitch=l.pitch,r.notes[c].start=l.start)}return i}function Jd(t,e,i){return{type:"MOVE_NOTES",sequencerId:t,from:structuredClone(e),to:structuredClone(i)}}function Sg(t,e,i){return Jd(t,i,e)}function Cg(t,e){const i=structuredClone(t),r=i.sequencers.find(s=>s.id===e.sequencerId);if(!r)return t;const n=new Set(e.notes.map(s=>`${s.pitch}|${s.start}|${s.duration}`));return r.notes=r.notes.filter(s=>{const a=`${s.pitch}|${s.start}|${s.duration}`;return!n.has(a)}),i}function Pg(t,e){const i=structuredClone(t),r=i.sequencers.find(n=>n.id===e.sequencerId);return r?(r.notes.push(...e.notes),i):t}function Ng(t,e){const i=structuredClone(t),r=i.sequencers.find(s=>s.id===e.sequencerId);if(!r)return t;const n=e.resizes;for(const s of n){const a=r.notes.find(o=>o.pitch===s.pitch&&o.start===s.start);a&&(a.duration=s.newDuration)}return i}function kg(t,e){return{type:"RESIZE_NOTES",sequencerId:t,resizes:structuredClone(e)}}function xg(t,e){const i=e.map(r=>({pitch:r.pitch,start:r.start,newDuration:r.oldDuration}));return{type:"RESIZE_NOTES",sequencerId:t,resizes:i}}function Lg(t,e){const i=structuredClone(t),r=i.sequencers.find(s=>s.id===e.sequencerId);if(!r)return t;const n=e.notes;for(const s of n){const a=r.notes.find(o=>o.pitch===s.pitch&&o.start===s.start&&o.duration===s.duration);a&&(a.velocity=s.velocity)}return i}function Eg(t,e){return{type:"SET_NOTE_VELOCITY",sequencerId:t,notes:structuredClone(e)}}function Ag(t,e){return{type:"SET_NOTE_VELOCITY",sequencerId:t,notes:structuredClone(e)}}function Bg(t,e){return structuredClone(t)}function na(t=""){return{type:"CHECKPOINT",label:t}}function Xd(t=""){return na(t)}const Tg=Object.freeze(Object.defineProperty({__proto__:null,CHANGE_NOTE_DURATION:sg,CHANGE_SNAP_RESOLUTION:rg,CHANGE_SONG_KEY:tg,CHANGE_TEMPO:Kp,CHECKPOINT:Bg,CREATE_SEQUENCER:dg,CUT_NOTES:Cg,DELETE_NOTES:Mg,DELETE_SEQUENCER:cg,MOVE_NOTES:wg,PASTE_NOTES:Pg,PLACE_NOTES:bg,RESIZE_NOTES:Ng,SET_INSTRUMENT:ug,SET_NOTE_MODIFIER_MODE:og,SET_NOTE_VELOCITY:Lg,SET_PAN:gg,SET_TIME_SIGNATURE:zp,SET_TOTAL_MEASURES:Wp,SET_VOLUME:pg},Symbol.toStringTag,{value:"Module"}));function sa(t){const e=Tg[t.type];if(!e)throw new Error(`Unknown diff type: ${t.type}`);const i=e(H(),t);Fg(i)}const ls=new Set;function on(t){return ls.add(t),()=>ls.delete(t)}function ln(t){for(const e of ls)e(t)}const Qe=[];let Fe=-1;const Ig=100;function Gg({forwardDiff:t,reverseDiff:e}){Qe.splice(Fe+1),Qe.push({forwardDiff:t,reverseDiff:e}),Fe=Qe.length-1,Qe.length>Ig&&(Qe.shift(),Fe--)}function Og(){var t;if(Fe<0)return null;for(let e=Fe;e>=0;e--){const i=Qe[e];if(((t=i==null?void 0:i.forwardDiff)==null?void 0:t.type)==="CHECKPOINT")return null;if(i!=null&&i.reverseDiff)return Fe=e-1,sa(i.reverseDiff),ln(H()),i.reverseDiff}return null}function Dg(){if(Fe>=Qe.length-1)return null;Fe++;const t=Qe[Fe];return!t||!t.forwardDiff?null:(sa(t.forwardDiff),ln(H()),t.forwardDiff)}let Vr={tempo:120,timeSignature:[4,4],totalMeasures:8,sequencers:[],songKey:"CM",snapResolution:1,noteDuration:1,isTripletMode:!1,isDottedMode:!1};function H(){return Vr}function Fg(t){Vr=structuredClone(t),ln(Vr)}function D(t,e){sa(t),Gg({forwardDiff:t,reverseDiff:e}),ln(Vr)}let Yd=500,Zd=!1;function xe(){return H().totalMeasures*H().timeSignature[0]}function Ke(){return 60/(Yd/1e3)}function aa(t,e=!0){const i=Ke();if(e){D(ad(t),$p(i));return}performance.now(),R.getCurrentBeat(),Yd=60/t*1e3,R.isActive()&&R.syncAfterTempoChange(i)}function oa(t,e=!0){const i=H().timeSignature[0];if(e){D(od(t),Vp(i));return}Bt().forEach(r=>r.updateBeatsPerMeasure())}function la(t,e=!0){const i=H().totalMeasures;if(e){D(ld(t),Jp(i));return}}function Qd(t,e=!0){const i=H().songKey;e&&D(qd(t),ig(i))}function dn(){return Hd()?H().snapResolution:.001}function bo(t,e=!0){const i=dn();if(e){D(jd(t),ng(i));return}}function Rg(t,e=!0){const i=H().noteDuration;if(e){D(Kd(t),ag(i));return}}function Mo(t,e,i=!0){const r=H(),n=r.isTripletMode,s=r.isDottedMode;if(i){D($d(t,e),lg(n,s));return}}function Mr(){return H().isTripletMode}function Bn(){return H().isDottedMode}function Ug(){return H().noteDuration}function da(){return H().timeSignature[0]}function ca(){return H().totalMeasures}function ec(){return H().songKey}function Hg(t){Zd=t}function qg(){return Zd}async function jg(t,e,i,r,n,s,a){if(!r||r.length===0)return;const o=60/Ke();if(a!=null&&a.aborted)return;const l=await rd(t,e,i,n,s);if(!(a!=null&&a.aborted))for(const c of r){if(a!=null&&a.aborted)return;const d=c.start*o,u=Math.max(.01,d),f=c.duration*o,h=c.velocity??100,m=te(c.pitch);if(m==null)continue;const g=t.split("/"),p=(g.length>=3?g[1]:g[0])==="drummachines"&&l.__midiMap?l.__midiMap.get(m)??m:m;try{l.start({note:p,duration:f,velocity:h,time:u,loop:!1})}catch(_){console.warn("[exportNotesToOffline] Failed to start note:",c,_)}}}function wo(t){if(!t.container)return;const e=t.container.querySelector(".mute-btn"),i=t.container.querySelector(".solo-btn"),r=t.container.querySelector(".sequencer-body"),n=t.container.querySelector(".mini-contour");e==null||e.classList.toggle("bg-red-600",t.mute),e==null||e.classList.toggle("bg-gray-700",!t.mute),i==null||i.classList.toggle("bg-yellow-200",t.solo),i==null||i.classList.toggle("bg-gray-700",!t.solo);const s=t.mute&&!t.solo;r==null||r.classList.toggle("opacity-40",s),r==null||r.classList.toggle("opacity-100",!s),n==null||n.classList.toggle("opacity-40",s),n==null||n.classList.toggle("opacity-100",!s)}function Kg(t,e,i,r,n){const s=t.querySelector(".zoom-in-btn"),a=t.querySelector(".zoom-out-btn"),o=t.querySelector(".zoom-reset-btn");!s||!a||!o||(n.on(s,"click",e),n.on(a,"click",i),n.on(o,"click",r))}function $g(t,e){var i,r,n,s,a;(i=t.querySelector(".zoom-in-btn"))==null||i.classList.toggle("hidden",!e),(r=t.querySelector(".zoom-out-btn"))==null||r.classList.toggle("hidden",!e),(n=t.querySelector(".zoom-reset-btn"))==null||n.classList.toggle("hidden",!e),(s=t.querySelector(".zoom-button-divider"))==null||s.classList.toggle("hidden",!e),(a=t.querySelector(".grip-handle"))==null||a.classList.toggle("hidden",!e)}function zg(t,e,i){const r=t.querySelector(".cursor-grab");if(!r)return;const n=t.querySelector(".sequencer-body");if(!n)return;let s=!1,a=0,o=0;const l=150,c=1e3;i.on(r,"mousedown",d=>{s=!0,a=d.clientY,o=n.offsetHeight,r.classList.replace("cursor-grab","cursor-grabbing"),document.body.style.userSelect="none"}),i.on(window,"mousemove",d=>{if(!s)return;const u=d.clientY-a;let f=o+u;f=Math.max(l,Math.min(c,f)),n.style.height=`${f}px`,e.resize()}),i.on(window,"mouseup",()=>{s&&(s=!1,r.classList.replace("cursor-grabbing","cursor-grab"),document.body.style.userSelect="")})}function Vg(t,e){var i;(i=t.querySelector(".cursor-grab"))==null||i.classList.toggle("hidden",!e)}const ei=["#ff006e","#3a86ff","#ffbe0b","#8338ec","#06d6a0","#ef476f","#118ab2","#ffd166","#073b4c","#8ac926","#0077b6","#00b4d8","#005f73","#03045e","#023e8a"];function Ki(t,e,i,r=0){const n=t.getContext("2d");if(!n)return;n.imageSmoothingEnabled=!1;const s=t.width,a=t.height;if(n.clearRect(0,0,s,a),!e.length)return;const o=ei[r%ei.length];n.fillStyle=o;const l=xe(),c=e.map(p=>Z(p.pitch)).filter(p=>p!==null);if(!c.length)return;let d=Math.min(...c),u=Math.max(...c),f=Math.max(1,u-d);for(;a%f!==0;)u++,f=u-d;const h=a/f;for(const p of e){const _=Z(p.pitch);if(_==null)continue;const M=p.start/l*s,v=p.duration/l*s,w=(_-d)/f,S=a-w*a-h/2,C=Math.round(M),P=Math.max(1,Math.round(v)),k=Math.round(S);n.fillRect(C,k,P,h)}const m=da(),g=ca();n.save();let y=1;g>256?y=16:g>128?y=8:g>32&&(y=4);for(let p=0;p<=g;p++){if(p%y!==0)continue;const M=p*m/l*s,v=Math.round(M)+.5;n.beginPath(),n.moveTo(v,0),n.lineTo(v,a);const w=y===1||p%(y*2)===0;n.strokeStyle=w?"rgba(255, 255, 255, 0.12)":"rgba(255, 255, 255, 0.04)",n.lineWidth=.2,n.stroke()}n.restore()}function tc(t,e=!0){var l;if(!t.container||!t.body||!t.miniContour||!t.collapseIcon)return;t.collapsed=e;const i=t.container,r=t.body,n=t.miniContour,s=t.collapseIcon,a=c=>{$g(i,c),Vg(i,c)},o=()=>{for(const c of t.scheduledAnimations)clearTimeout(c);t.scheduledAnimations=[]};r.classList.toggle("hidden",e),n.classList.toggle("hidden",!e),s.setAttribute("href",e?"#icon-caret-up":"#icon-caret-down"),e?(o(),a(!1),Ki(n,t.notes,t.config,t.colorIndex)):(a(!0),(l=t.matrix)==null||l.resize(),R.isActive()&&t.resumeAnimationsFromCurrentTime(R.getStartTime(),R.getStartBeat()))}function ds(t,e){const{config:i,container:r,matrix:n,colorIndex:s,getNotes:a}=t,[o,l]=e,c=te(o),d=te(l);if(c===null||d===null){console.warn(`Invalid note range: ${e}`);return}if(c>=d){console.warn("Invalid note range: low note must be lower than high note");return}i.noteRange=e,i.visibleNotes=jp(l,o)+1;const u=r==null?void 0:r.querySelector(".mini-contour");u&&Ki(u,a(),i,s),n.setNoteRange(c,d)}function Wg(t){t.instrumentName.toLowerCase().includes("drum kit")?(ds(t,["B1","A5"]),t.matrix.setCustomLabels(vp)):(ds(t,["A0","C9"]),t.matrix.setCustomLabels(null))}const Jg={totalMeasures:16,beatsPerMeasure:4,layout:{labelWidthColumns:1,headerHeightRows:2,footerHeightRows:1,labelWidth:80,headerHeight:40,footerHeight:40,baseCellWidth:70,minCellWidth:10,maxCellWidth:200,verticalCellRatio:4,highestMidi:108,lowestMidi:21},display:{showMeasureLines:!0,showBeatLines:!0,showHoveredCell:!0,highlightCurrentMeasure:!0},behavior:{zoom:1,scrollMargin:48,enableSnapping:!0,snapDivisions:4,maxZoom:1.6,minZoom:.5}};function Xg(){return structuredClone(Jg)}function Yg(t,e){return{...t,...e,layout:{...t.layout,...e.layout??{}},display:{...t.display,...e.display??{}},behavior:{...t.behavior,...e.behavior??{}}}}const Zg={global:{noteToolMode:"express"},theme:{gridColorScheme:"Darkroom",noteColorScheme:"Track Color",skin:"Default"},ai:{openaiApiKey:"",openaiModel:"gpt-4o"}},ic={name:"Default",appBackground:"bg-black",menuBackground:"bg-gradient-to-br from-gray-800 to-gray-900",surfaceBackground:"bg-gray-900",accentColor:"bg-purple-700",textColor:"text-white",borderColor:"border-purple-950",buttonPrimaryColor:"bg-purple-700",buttonPrimaryColorHover:"hover:bg-purple-600",buttonSecondaryColor:"bg-gray-800",buttonSecondaryColorHover:"hover:bg-gray-700",buttonTertiaryColor:"bg-blue-700",buttonTertiaryColorHover:"hover:bg-blue-600",toggleTrackBase:"bg-gray-700",toggleTrackChecked:"peer-checked:bg-purple-600",toggleKnobBase:"after:border-gray-300",toggleKnobChecked:"peer-checked:after:border-white",blackKeyColor:"#a6a09b",whiteKeyColor:"#292524"},Qg={name:"Blue Dream",appBackground:"bg-gradient-to-b from-blue-900 to-gray-900",menuBackground:"bg-gradient-to-br from-blue-800 to-blue-900",surfaceBackground:"bg-blue-950/80",accentColor:"bg-cyan-400",textColor:"text-white",borderColor:"border-cyan-400",buttonPrimaryColor:"bg-cyan-600",buttonPrimaryColorHover:"hover:bg-cyan-500",buttonSecondaryColor:"bg-blue-800",buttonSecondaryColorHover:"hover:bg-blue-700",buttonTertiaryColor:"bg-indigo-600",buttonTertiaryColorHover:"hover:bg-indigo-500",toggleTrackBase:"bg-blue-700",toggleTrackChecked:"peer-checked:bg-cyan-400",toggleKnobBase:"after:border-blue-300",toggleKnobChecked:"peer-checked:after:border-white",blackKeyColor:"#1b1f5f",whiteKeyColor:"#c0e7ff"},ev={name:"Modern Light",appBackground:"bg-white",menuBackground:"bg-gray-100",surfaceBackground:"bg-gray-200",accentColor:"bg-blue-600",textColor:"text-gray-900",borderColor:"border-blue-600",buttonPrimaryColor:"bg-blue-600",buttonPrimaryColorHover:"hover:bg-blue-500",buttonSecondaryColor:"bg-gray-200",buttonSecondaryColorHover:"hover:bg-gray-300",buttonTertiaryColor:"bg-gray-300",buttonTertiaryColorHover:"hover:bg-gray-400",toggleTrackBase:"bg-gray-300",toggleTrackChecked:"peer-checked:bg-blue-600",toggleKnobBase:"after:border-gray-400",toggleKnobChecked:"peer-checked:after:border-white",blackKeyColor:"#111111",whiteKeyColor:"#ffffff"},tv={name:"Synthwave",appBackground:"bg-gradient-to-br from-black via-gray-900 to-purple-950",menuBackground:"bg-gradient-to-br from-purple-800 to-pink-900",surfaceBackground:"bg-gray-900/80",accentColor:"bg-fuchsia-500",textColor:"text-neon-green",borderColor:"border-fuchsia-500",buttonPrimaryColor:"bg-pink-700",buttonPrimaryColorHover:"hover:bg-pink-600",buttonSecondaryColor:"bg-purple-800",buttonSecondaryColorHover:"hover:bg-purple-700",buttonTertiaryColor:"bg-gray-800",buttonTertiaryColorHover:"hover:bg-gray-700",toggleTrackBase:"bg-pink-800",toggleTrackChecked:"peer-checked:bg-fuchsia-500",toggleKnobBase:"after:border-pink-400",toggleKnobChecked:"peer-checked:after:border-white",blackKeyColor:"#d946ef",whiteKeyColor:"#f5d0fe"},iv={name:"Verdant Alloy",appBackground:"bg-gradient-to-b from-gray-900 to-green-950",menuBackground:"bg-gradient-to-tr from-emerald-800 to-lime-700",surfaceBackground:"bg-emerald-950/70",accentColor:"bg-lime-400",textColor:"text-lime-100",borderColor:"border-lime-400",buttonPrimaryColor:"bg-emerald-600",buttonPrimaryColorHover:"hover:bg-emerald-500",buttonSecondaryColor:"bg-lime-700",buttonSecondaryColorHover:"hover:bg-lime-600",buttonTertiaryColor:"bg-gray-700",buttonTertiaryColorHover:"hover:bg-gray-600",toggleTrackBase:"bg-emerald-700",toggleTrackChecked:"peer-checked:bg-lime-400",toggleKnobBase:"after:border-lime-300",toggleKnobChecked:"peer-checked:after:border-white",blackKeyColor:"#143016",whiteKeyColor:"#dbf4dc"},rv={name:"Sunset",appBackground:"bg-gradient-to-br from-orange-900 via-red-800 to-purple-900",menuBackground:"bg-gradient-to-bl from-rose-800 to-orange-700",surfaceBackground:"bg-orange-950/70",accentColor:"bg-yellow-400",textColor:"text-yellow-100",borderColor:"border-yellow-400",buttonPrimaryColor:"bg-amber-600",buttonPrimaryColorHover:"hover:bg-amber-500",buttonSecondaryColor:"bg-red-700",buttonSecondaryColorHover:"hover:bg-red-600",buttonTertiaryColor:"bg-purple-700",buttonTertiaryColorHover:"hover:bg-purple-600",toggleTrackBase:"bg-red-700",toggleTrackChecked:"peer-checked:bg-yellow-400",toggleKnobBase:"after:border-orange-300",toggleKnobChecked:"peer-checked:after:border-white",blackKeyColor:"#45122c",whiteKeyColor:"#fff3e0"},nv={Default:ic,"Blue Dream":Qg,"Modern Light":ev,Synthwave:tv,"Verdant Alloy":iv,Sunset:rv};function sv(t){return nv[t]||ic}const cn=structuredClone(Zg);cn.theme.skin;function oe(){return cn}function K(){return sv(cn.theme.skin)}function Re(t){rc(cn,t);for(const e of Bt())e.redraw()}function rc(t,e){for(const i in e)e[i]&&typeof e[i]=="object"&&!Array.isArray(e[i])?(t[i]||(t[i]={}),rc(t[i],e[i])):t[i]=e[i]}const ua={Midnight:{whiteKey:"#1e1e1e",blackKey:"#2a103b",labelWhite:"#2c2c2c",labelBlack:"#3a1d4d",textWhite:"#cfcfcf",textBlack:"#e6d9ff",gridLine:"#333",beatLine:"#4e3d63",measureLine:"#8561c2",outOfKey:"rgb(255, 1, 1)"},Seashell:{whiteKey:"#fefefe",blackKey:"#f1e7dc",labelWhite:"#dddddd",labelBlack:"#d4cfc9",textWhite:"#444",textBlack:"#663300",gridLine:"#ccc",beatLine:"#bbb",measureLine:"#999",outOfKey:"rgba(255, 255, 255, 0.05)"},Cyberpunk:{whiteKey:"#162447",blackKey:"#1b1b2f",labelWhite:"#1f4068",labelBlack:"#1f4068",textWhite:"#e43f5a",textBlack:"#e43f5a",gridLine:"#1f4068",beatLine:"#e43f5a",measureLine:"#ffcc00",outOfKey:"rgba(255, 255, 255, 0.05)"},"Classic Blue":{whiteKey:"#f5faff",blackKey:"#dceeff",labelWhite:"#aaccee",labelBlack:"#88bbdd",textWhite:"#002244",textBlack:"#001122",gridLine:"#99bbdd",beatLine:"#88aacc",measureLine:"#336699",outOfKey:"rgba(255, 255, 255, 0.05)"},Darkroom:{whiteKey:"#2c2c2c",blackKey:"#1e1e1e",labelWhite:"#2a2a2a",labelBlack:"#383838",textWhite:"#e0e0e0",textBlack:"#a0a0a0",gridLine:"#404040",beatLine:"#606060",measureLine:"#808080",outOfKey:"rgba(255, 255, 255, 0.05)"}};class av{constructor(e,i,r,n,s){this.getBlackKeyMap=n,this.getInKeyMap=s,this.scroll=e,this.config=i,this.interactionStore=r}draw(e){const{totalMeasures:i,beatsPerMeasure:r,layout:{baseCellWidth:n,verticalCellRatio:s,labelWidth:a,headerHeight:o},behavior:{zoom:l}}=this.config,{gridColorScheme:c}=oe().theme,d=ua[c],u=this.config.layout.highestMidi-this.config.layout.lowestMidi+1,f=n*l,h=f/s,m=this.scroll.getX(),g=this.scroll.getY();(e.canvas.width-a)/f;const y=i*r;e.save(),e.translate(a-m,o-g);const p=Math.max(0,Math.floor((m-a)/f)),_=Ud(),M=this.getInKeyMap();for(let v=0;v<u;v++){const w=v*h,S=this.config.layout.highestMidi-v;let C;_?C=M.get(S)?d.whiteKey:d.blackKey:C=this.getBlackKeyMap().get(S)?d.blackKey:d.whiteKey,e.fillStyle=C,e.fillRect(0,w,y*f,h),e.strokeStyle=d.gridLine,e.beginPath(),e.moveTo(0,w),e.lineTo(y*f,w),e.stroke()}for(let v=p;v<=y;v++){if(v<0)continue;const w=v*f;e.strokeStyle=v%r===0?d.measureLine:d.beatLine,e.beginPath(),e.moveTo(w,0),e.lineTo(w,u*h),e.stroke()}e.restore()}}function ov(t){const{layout:{labelWidth:e,baseCellWidth:i},totalMeasures:r,beatsPerMeasure:n,behavior:{zoom:s}}=t,a=i*s;return e+r*n*a}function lv(t){const{layout:{baseCellWidth:e,verticalCellRatio:i,highestMidi:r,lowestMidi:n,headerHeight:s},behavior:{zoom:a}}=t,o=r-n+1,l=e*a/i;return o*l+s}class dv{constructor(e,i){this.scrollX=0,this.scrollY=0,this.canvas=e,this.config=i}getX(){return this.scrollX}getY(){return this.scrollY}setScroll(e,i){this.scrollX=this.clampX(e),this.scrollY=this.clampY(i)}recalculateBounds(){}getMaxScrollX(){const e=this.canvas.offsetWidth;return Math.max(0,this.getContentWidth()-e)}getMaxScrollY(){const e=this.canvas.offsetHeight-this.config.layout.headerHeight;return Math.max(0,this.getContentHeight()-e)}clampX(e){return Math.max(0,Math.min(e,this.getMaxScrollX()))}clampY(e){return Math.max(0,Math.min(e,this.getMaxScrollY()))}getContentWidth(){return ov(this.config)}getContentHeight(){return lv(this.config)}}function $i(t,e){const i=e.getBoundingClientRect();return{x:t.clientX-i.left,y:t.clientY-i.top}}function nc(t,e,i,r){const n=e.getBoundingClientRect();return{x:t.clientX-n.left+i.getX()-r.layout.labelWidth,y:t.clientY-n.top+i.getY()-r.layout.headerHeight}}function cv(t,e,i,r,n){const s=i.getBoundingClientRect();return{x:t-s.left+r.getX()-n.layout.labelWidth,y:e-s.top+r.getY()-n.layout.headerHeight}}function zi(t,e,i,r,n=!1){const{layout:{labelWidth:s,headerHeight:a,baseCellWidth:o,verticalCellRatio:l,highestMidi:c,lowestMidi:d},behavior:{zoom:u}}=i,f=c-d+1,h=o*u,m=h/l,g=(t.x+e.getX()-s)/h;let y=Math.floor((t.y+e.getY()-a)/m);const p=n?r*(2/3):r,_=Math.floor(g/p)*p;if(_<0||y<0||y>=f)return null;if(sn()&&!Bi()){const M=an(),v=c-y;let w=null,S=1/0;for(let C=-12;C<=12;C++){const P=v+C;if(P<d||P>c||!M.get(P))continue;const k=c-P,N=Math.abs(k-y);if(N<S&&(S=N,w=k),N===0)break}w!==null&&(y=w)}return{x:_,y}}class uv{constructor(e,i){this.notes=[],this.noteIndex=new Map,this.pitchIndex=new Map,this.config=e,this.playNote=i}set(e){this.notes=e}getAll(){return this.notes}add(e){this.notes.push(e)}getTrackedNotes(e){const i=e.getHoveredNoteKey(),r=s=>e.isNoteHighlighted(s),n=new Set(e.getSelectedNotes().map(s=>`${s.pitch}:${s.start}`));return this.notes.map(s=>{const a=`${s.pitch}:${s.start}`;return{note:s,state:{hovered:a===i,selected:n.has(a),highlighted:r(s)}}})}remove(e){const i=`${e.pitch}:${e.start}`;this.notes=this.notes.filter(r=>!(r.pitch===e.pitch&&r.start===e.start)),this.noteIndex.delete(i)}removeAll(e){const i=new Set(e.map(r=>`${r.pitch}:${r.start}`));this.notes=this.notes.filter(r=>!i.has(`${r.pitch}:${r.start}`));for(const r of i)this.noteIndex.delete(r)}rebuildIndex(){this.noteIndex.clear(),this.pitchIndex.clear();for(const e of this.notes){const i=`${e.pitch}:${e.start}`;this.noteIndex.set(i,e),this.pitchIndex.has(e.pitch)||this.pitchIndex.set(e.pitch,[]),this.pitchIndex.get(e.pitch).push(e)}for(const e of this.pitchIndex.values())e.sort((i,r)=>i.start-r.start)}findNoteAtMousePosition(e,i,r,n,s){const a=$i(e,i);J("Raw mouse pos (grid-relative)",a);const o=dn(),l=zi(a,r,n,o);if(!l){J("Snapped position is invalid",{mouse:a,snap:o});return}const c=pe(l.y,n.layout.lowestMidi,n.layout.highestMidi),d=l.x;J("Snapped grid position",l),J("Computed pitch and beat",{pitch:c,beat:d});const u=s.findNoteUnderCursor(c,d);return J("Note under cursor (if any)",u),u}findAtPosition(e,i){return this.noteIndex.get(`${e}:${i}`)}findNoteUnderCursor(e,i){const r=this.pitchIndex.get(e);if(!r||r.length===0)return;let n=0,s=r.length-1,a=-1;for(;n<=s;){const o=Math.floor((n+s)/2);r[o].start<=i?(a=o,n=o+1):s=o-1}if(a!==-1)for(let o=a;o>=0;o--){const l=r[o];if(i>=l.start&&i<l.start+l.duration)return l;if(l.start+l.duration<i)break}}findNoteEdgeAtCursor(e,i,r=.25){const n=this.pitchIndex.get(e);if(!n||n.length===0)return;let s=0,a=n.length-1,o=-1;for(;s<=a;){const l=Math.floor((s+a)/2);n[l].start<=i?(o=l,s=l+1):a=l-1}if(o!==-1)for(let l=o;l>=0;l--){const c=n[l],d=c.start+c.duration*(1-r),u=c.start+c.duration;if(i>=d&&i<=u)return c;if(c.start+c.duration<i)break}}mergeSelections(e,i){const r=new Set,n=[];for(const s of[...e,...i]){const a=`${s.pitch}:${s.start}`;r.has(a)||(r.add(a),n.push(s))}return n}previewNote(e,i,r=100,n=!1){this.playNote(e,i,r,n)}}function Ti(t,e,i,r,n,s=4){t.beginPath(),t.moveTo(e+s,i),t.lineTo(e+r-s,i),t.quadraticCurveTo(e+r,i,e+r,i+s),t.lineTo(e+r,i+n-s),t.quadraticCurveTo(e+r,i+n,e+r-s,i+n),t.lineTo(e+s,i+n),t.quadraticCurveTo(e,i+n,e,i+n-s),t.lineTo(e,i+s),t.quadraticCurveTo(e,i,e+s,i),t.closePath()}function hv(t,e,i,r){const{layout:{baseCellWidth:n,verticalCellRatio:s,highestMidi:a,lowestMidi:o},behavior:{zoom:l}}=i,c=a-o+1,d=n*l,u=d/s,f=r.offsetWidth,h=r.offsetHeight,m=0,g=t/d-m,y=(t+f)/d+m,p=Math.floor(e/u),_=Math.min(c-1,Math.ceil((e+h)/u)+m),M=new Map;return v=>v.filter(({note:w})=>{if(w.start+w.duration<g||w.start>y)return!1;let C=M.get(w.pitch);if(C==null){const P=Js(w.pitch,o,a);if(P==null||P<0||P>=c)return!1;C=P,M.set(w.pitch,C)}return C>=p&&C<=_})}function fv(t){const e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(e,(u,f,h,m)=>f+f+h+h+m+m);const i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);if(!i)return null;const r=parseInt(i[1],16)/255,n=parseInt(i[2],16)/255,s=parseInt(i[3],16)/255,a=Math.max(r,n,s),o=Math.min(r,n,s);let l=0,c=0,d=(a+o)/2;if(a!==o){const u=a-o;switch(c=d>.5?u/(2-a-o):u/(a+o),a){case r:l=(n-s)/u+(n<s?6:0);break;case n:l=(s-r)/u+2;break;case s:l=(r-n)/u+4;break}l*=60}return{h:Math.round(l),s:Math.round(c*100),l:Math.round(d*100)}}const pv=["#FF0000","#9400D3","#FFFF00","#FF69B4","#00FF00","#00FFFF","#0000FF","#8A2BE2","#FF8C00","#FFD700","#ADFF2F","#DC143C"];function mv(t,e){const i=fv(t);if(!i)return"#999";const n=10+(e??100)/127*50;return`hsl(${i.h}, ${i.s}%, ${n}%)`}function nr(t){return(e,i)=>{const r=t(e,i);return mv(r,e.velocity)}}function yv(t){const e=te(t.pitch);if(e==null)return"#999";const i=e*3%360,r=100,n=60,a=.2+(t.velocity??100)/127*.8;return`hsla(${i}, ${r}%, ${n}%, ${a})`}const gv={Scriabin:nr((t,{getPitchClass:e}={})=>{const i=e?e(t.pitch):0;return pv[i]||"#999"}),"Track Color":nr((t,{getTrackColor:e}={})=>(e==null?void 0:e())||"#999"),"Note Velocity":nr((t,{getTrackColor:e}={})=>(e==null?void 0:e())||"#ff0000"),"Octave Bands":yv,"Pitch Class Contrast":nr((t,{getPitchClass:e}={})=>{const i=te(t.pitch);if(i==null)return"#999";const r=i%12;return["#ff0000","#ff7f00","#ffff00","#7fff00","#00ff00","#00ff7f","#00ffff","#007fff","#0000ff","#7f00ff","#ff00ff","#ff007f"][r]||"#999"})};function vv(t){return t<0&&(console.error(`Invalid trackId: ${t}. Using default color.`),t=0),ei[t%ei.length]}class _v{constructor(e,i,r,n,s){this.scroll=e,this.config=i,this.noteManager=r,this.interactionStore=n,this.sequencerId=s}draw(e){const{layout:{baseCellWidth:i,verticalCellRatio:r,labelWidth:n,headerHeight:s},behavior:{zoom:a}}=this.config,{noteColorScheme:o}=oe().theme,l=gv[o]||(()=>"#999"),c={getPitchClass:qp,getTrackColor:()=>vv(this.sequencerId)},d=i*a,u=d/r,f=this.scroll.getX(),h=this.scroll.getY(),m=e.canvas,g=this.noteManager.getTrackedNotes(this.interactionStore);e.save(),e.translate(n-f,s-h);const p=hv(f,h,this.config,m)(g);for(const{note:_,state:M}of p){const w=Js(_.pitch,this.config.layout.lowestMidi,this.config.layout.highestMidi)*u,S=_.start*d,C=_.duration*d,P=u,k=l(_,c);e.fillStyle=k,Ti(e,S,w,C,P,4),e.fill(),(M.selected||M.hovered||M.highlighted)&&(e.lineWidth=2,e.strokeStyle=M.selected?"#ffffff":M.hovered?"#ff9933":"#33ff99",Ti(e,S,w,C,P,4),e.stroke())}e.restore()}}class bv{constructor(e,i,r,n){this.scroll=e,this.config=i,this.store=r,this.getNoteDuration=n}draw(e){const{layout:{baseCellWidth:i,verticalCellRatio:r,labelWidth:n,headerHeight:s,lowestMidi:a,highestMidi:o},behavior:{zoom:l}}=this.config,c=i*l,d=c/r;e.save(),e.translate(n-this.scroll.getX(),s-this.scroll.getY()),e.fillStyle="rgba(100, 180, 255, 0.5)";const u=this.store.getPreviewNotes();if(u.length>0){const p=o-a+1;for(const _ of u){const M=bt(_.pitch);if(M===null)continue;const v=p-1-(M-a),w=_.start*c,S=v*d,C=_.duration*c;Ti(e,w,S,C,d,3),e.fill()}e.restore();return}const f=this.store.getSnappedCursorGridPosition();if(!f){e.restore();return}const h=this.getNoteDuration(),m=f.x*c,g=f.y*d,y=c*h;Ti(e,m,g,y,d,3),e.fill(),e.restore()}}class Mv{constructor(e,i){this.scroll=e,this.config=i,this.animations=[]}playNote(e){const i=performance.now(),r=Ke();let n=e.duration*6e4/r;n=Math.max(100,Math.min(n,1600));const a=(te(e.pitch)||0)*5%360;this.animations.push({note:e,startTime:i,duration:n,hue:a})}draw(e){const{layout:{baseCellWidth:i,verticalCellRatio:r,labelWidth:n,headerHeight:s,lowestMidi:a,highestMidi:o},behavior:{zoom:l}}=this.config,c=this.scroll.getX(),d=this.scroll.getY(),u=i*l,f=u/r,h=performance.now();e.clearRect(0,0,e.canvas.width,e.canvas.height),this.animations=this.animations.filter(m=>{const g=(h-m.startTime)/m.duration;if(g>1)return!1;const{note:y,hue:p}=m,_=te(y.pitch);if(_==null||_<a||_>o)return!0;const M=o-_,v=y.start*u+n-c,w=M*f+s-d,S=y.duration*u,C=f-1,P=v+S/2,k=w+C/2,N=Math.sin(g*Math.PI),L=`hsla(${p}, 100%, 70%, ${.4*N})`;e.save(),e.globalAlpha=1,e.fillStyle=L,e.beginPath(),e.roundRect(v,w,S,C,4),e.fill();const x=2,T=50;for(let F=0;F<x;F++){const B=F*T,O=Math.max(0,Math.min(1,(h-m.startTime-B)/(m.duration-B))),G=Math.sin(O*Math.PI),le=1+(.1+F*.1)*G,ie=(1-O)*.3;e.globalAlpha=ie,e.strokeStyle=`hsl(${p}, 100%, 65%)`,e.lineWidth=1.5;const de=S*le,ze=C*le;e.beginPath(),e.roundRect(P-de/2,k-ze/2,de,ze,4),e.stroke()}return e.restore(),!0}),this.animations.length>0&&requestAnimationFrame(()=>this.draw(e))}}class wv{constructor(e,i){this.scroll=e,this.config=i,this.x=null}setPlayheadX(e){this.x=e}clear(){this.x=null}draw(e){if(this.x==null)return;const{layout:{verticalCellRatio:i,baseCellWidth:r,labelWidth:n,headerHeight:s,highestMidi:a,lowestMidi:o},behavior:{zoom:l}}=this.config,c=a-o+1,d=this.scroll.getX(),u=this.scroll.getY(),f=r*l/i,h=c*f+s,m=this.x;e.save(),e.translate(n-d,-u),e.lineWidth=2,e.strokeStyle="rgba(168, 85, 247, 1.0)",e.shadowColor="rgba(168, 85, 247, 0.5)",e.shadowBlur=6,e.beginPath(),e.moveTo(m,0),e.lineTo(m,h),e.stroke(),e.restore()}}class sr{constructor(e,i=!0){this.canvas=e,this.dpr=i&&window.devicePixelRatio||1;const r=this.canvas.getContext("2d");if(!r)throw new Error("Failed to get 2D context");this.ctx=r}resize(){const e=this.canvas.offsetWidth,i=this.canvas.offsetHeight,r=Math.floor(e*this.dpr),n=Math.floor(i*this.dpr);(this.canvas.width!==r||this.canvas.height!==n)&&(this.canvas.width=r,this.canvas.height=n,this.ctx.setTransform(1,0,0,1,0,0),this.ctx.scale(this.dpr,this.dpr))}getContext(){return this.ctx}withContext(e){e(this.ctx)}clear(){this.ctx.clearRect(0,0,this.canvas.offsetWidth,this.canvas.offsetHeight)}destroy(){this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.canvas.width=0,this.canvas.height=0,this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}class So{constructor(e,i,r,n,s){this.thumb=e,this.isHorizontal=i,this.scroll=r,this.interactionStore=n,this.requestRedraw=s,this.onMouseEnter=()=>this.interactionStore.setIsOnScrollbar(!0),this.onMouseLeave=()=>this.interactionStore.setIsOnScrollbar(!1),this.onThumbMouseDown=o=>this.handleMouseDown(o),this.onMouseMove=null,this.onMouseUp=null;const a=this.thumb.parentElement;if(!a)throw new Error("Scrollbar thumb must have a parent track element.");this.track=a,this.attachDragHandler()}attachDragHandler(){this.track.addEventListener("mouseenter",this.onMouseEnter),this.track.addEventListener("mouseleave",this.onMouseLeave),this.thumb.addEventListener("mouseenter",this.onMouseEnter),this.thumb.addEventListener("mouseleave",this.onMouseLeave),this.thumb.addEventListener("mousedown",this.onThumbMouseDown)}handleMouseDown(e){e.preventDefault(),this.interactionStore.setIsScrolling(!0),this.onMouseMove=i=>{const r=this.track.getBoundingClientRect(),n=this.isHorizontal?this.track.offsetWidth:this.track.offsetHeight,a=(this.isHorizontal?i.clientX:i.clientY)-(this.isHorizontal?r.left:r.top),o=this.isHorizontal?this.thumb.offsetWidth:this.thumb.offsetHeight,l=n-o,c=Math.max(0,Math.min(a-o/2,l)),d=l>0?c/l:0,u=this.isHorizontal?this.scroll.getMaxScrollX():this.scroll.getMaxScrollY(),f=d*u;this.isHorizontal?this.scroll.setScroll(f,this.scroll.getY()):this.scroll.setScroll(this.scroll.getX(),f),this.requestRedraw()},this.onMouseUp=()=>{document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),this.interactionStore.setIsScrolling(!1),this.onMouseMove=null,this.onMouseUp=null},document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}destroy(){this.track.removeEventListener("mouseenter",this.onMouseEnter),this.track.removeEventListener("mouseleave",this.onMouseLeave),this.thumb.removeEventListener("mouseenter",this.onMouseEnter),this.thumb.removeEventListener("mouseleave",this.onMouseLeave),this.thumb.removeEventListener("mousedown",this.onThumbMouseDown),this.onMouseMove&&document.removeEventListener("mousemove",this.onMouseMove),this.onMouseUp&&document.removeEventListener("mouseup",this.onMouseUp),this.onMouseMove=null,this.onMouseUp=null}}let Co=!1;function Sv(){if(Co)return;const t=document.createElement("style");t.textContent=`
    .grid-scrollbars {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none;
    }

    .grid-scrollbar {
      position: absolute;
      background: #1f1f1f;
      pointer-events: all;
    }

    .grid-scrollbar-thumb {
      position: absolute;
      background: #888;
      border-radius: 6px;
      cursor: pointer;
    }

    .grid-scrollbar-corner {
      position: absolute;
      width: 12px;
      height: 12px;
      bottom: 0;
      right: 0;
      background: #1f1f1f;
      z-index: 2;
      pointer-events: none;
    }
  `,document.head.appendChild(t),Co=!0}class Cv{constructor(e,i,r,n,s){this.container=e,this.scroll=i,this.config=r,this.interactionStore=n,this.requestRedraw=s,this.trackThickness=16,Sv(),this.createDOM(),this.attachEvents(),this.config=this.config,this.interactionStore=n}createDOM(){const e=this.hScrollbar=document.createElement("div"),i=this.hThumb=document.createElement("div"),r=this.vScrollbar=document.createElement("div"),n=this.vThumb=document.createElement("div"),s=this.corner=document.createElement("div");e.className="grid-scrollbar",r.className="grid-scrollbar",i.className="grid-scrollbar-thumb",n.className="grid-scrollbar-thumb",s.className="grid-scrollbar-corner",e.style.position=r.style.position=s.style.position="absolute",e.style.zIndex=r.style.zIndex=s.style.zIndex="5",e.style.bottom="0",e.style.left="0",e.style.right=`${this.trackThickness}px`,e.style.height=`${this.trackThickness}px`,r.style.top="0",r.style.right="0",r.style.bottom=`${this.trackThickness}px`,r.style.width=`${this.trackThickness}px`,s.style.width=`${this.trackThickness}px`,s.style.height=`${this.trackThickness}px`,s.style.right="0",s.style.bottom="0",s.style.background="#333",s.style.position="absolute",i.style.zIndex=n.style.zIndex="6",i.style.position=n.style.position="absolute",i.style.background="#7e22ce",n.style.background="#7e22ce",i.style.borderRadius=n.style.borderRadius="8px",i.style.height="100%",n.style.width="100%",e.appendChild(i),r.appendChild(n),this.container.appendChild(e),this.container.appendChild(r),this.container.appendChild(s)}attachEvents(){this.hDragHandler=new So(this.hThumb,!0,this.scroll,this.interactionStore,this.requestRedraw),this.vDragHandler=new So(this.vThumb,!1,this.scroll,this.interactionStore,this.requestRedraw)}update(){const{width:e,height:i}=this.container.getBoundingClientRect(),r=this.scroll.getContentWidth(),n=this.scroll.getContentHeight(),s=this.scroll.getX(),a=this.scroll.getY(),o=this.scroll.getMaxScrollX(),l=this.scroll.getMaxScrollY(),c=e-this.trackThickness,d=this.config.layout.labelWidth,u=Math.max(40,(e-d)/r*c),f=s/o*(c-u);this.hThumb.style.width=`${u}px`,this.hThumb.style.left=`${Math.max(0,f)}px`;const h=i-this.trackThickness,m=this.config.layout.headerHeight,g=Math.max(40,(i-m)/n*h),y=a/l*(h-g);this.vThumb.style.height=`${g}px`,this.vThumb.style.top=`${Math.max(0,y)}px`}destroy(){this.hDragHandler.destroy(),this.vDragHandler.destroy(),this.hScrollbar.remove(),this.vScrollbar.remove(),this.corner.remove(),this.hScrollbar=null,this.vScrollbar=null,this.corner=null}}var A=(t=>(t[t.NoteTool=0]="NoteTool",t[t.Selecting=1]="Selecting",t[t.SelectedIdle=2]="SelectedIdle",t[t.Dragging=3]="Dragging",t[t.Pasting=4]="Pasting",t[t.Sizing=5]="Sizing",t))(A||{});function Nt(t,e,i,r,n){const s=$i(t,e),a=i.getSnapResolution(),o=i.isTripletMode();return zi(s,r,n,a,o)}function nt(t,e,i,r){const{baseCellWidth:n}=r.layout,{zoom:s}=r.behavior,a=nc(t,e,i,r),o=n*s;return a.x/o}var U=(t=>(t.Default="default",t.Pointer="pointer",t.Crosshair="crosshair",t.Grabbing="grabbing",t.Grab="grab",t.ResizeHorizontal="ew-resize",t.ResizeVertical="ns-resize",t.Move="move",t.NotAllowed="not-allowed",t.Custom="url(cursor.png), auto",t))(U||{});function Ii(t,e,i,r){return!t||t.x>=xe()?(e.setSnappedCursorGridPosition(null),e.setHoveredNoteKey(null),i.set(U.Default),r(),!0):!1}class Pv{constructor(e,i,r,n,s,a,o,l,c,d,u,f){this.canvas=e,this.noteManager=i,this.scroll=r,this.config=n,this.store=s,this.grid=a,this.requestRedraw=o,this.getSequencerId=l,this.controller=c,this.cursorController=d,this.getClipboard=u,this.playNoteAnimation=f,this.initialMouseX=0,this.initialMouseY=0,this.dragThreshold=3}onMouseDown(e){if(e.button!==0||this.store.isOnNonGridElement())return;const i=Nt(e,this.canvas,this.grid,this.scroll,this.config);if(Ii(i,this.store,this.cursorController,this.requestRedraw))return;const r=nt(e,this.canvas,this.scroll,this.config);if(i){const n=pe(i.y,this.config.layout.lowestMidi,this.config.layout.highestMidi),s=this.noteManager.findNoteEdgeAtCursor(n,r),a=this.store.getHoveredNoteKey();if(s&&a===`${s.pitch}:${s.start}`){this.store.setSelectedNotes([s]),this.controller.transitionTo(A.Sizing);return}}this.store.beginSelectionDrag(),this.initialMouseX=e.clientX,this.initialMouseY=e.clientY}onMouseMove(e){if(this.store.isOnNonGridElement()){this.store.setSnappedCursorGridPosition(null),this.store.setHoveredNoteKey(null),this.requestRedraw();return}const i=e.clientX-this.initialMouseX,r=e.clientY-this.initialMouseY,n=Math.sqrt(i*i+r*r);if(this.store.isDraggingToSelect()){const d=this.store.getHoveredNoteKey();if(d&&n>=this.dragThreshold){const[u,f]=d.split(":"),h=this.noteManager.findAtPosition(u,Number(f));if(h){this.store.setSelectedNotes([h]),this.store.endSelectionDrag(),this.controller.transitionTo(A.Dragging);return}}if(n>=this.dragThreshold){this.store.endSelectionDrag(),this.controller.transitionTo(A.Selecting);return}}const s=Nt(e,this.canvas,this.grid,this.scroll,this.config);if(!s||Ii(s,this.store,this.cursorController,this.requestRedraw))return;this.store.setSnappedCursorGridPosition(s);const a=pe(s.y,this.config.layout.lowestMidi,this.config.layout.highestMidi),o=nt(e,this.canvas,this.scroll,this.config),l=this.noteManager.findNoteUnderCursor(a,o),c=this.noteManager.findNoteEdgeAtCursor(a,o);if(l){const d=`${l.pitch}:${l.start}`;this.store.setHoveredNoteKey(d),this.store.setSnappedCursorGridPosition(null),c===l?this.cursorController.set(U.ResizeHorizontal):this.cursorController.set(U.Pointer)}else this.store.setHoveredNoteKey(null),this.store.setSnappedCursorGridPosition(s),this.cursorController.set(U.Default);this.requestRedraw()}onMouseUp(e){if(e.button!==0)return;if(this.store.isOnNonGridElement()){this.store.setSnappedCursorGridPosition(null),this.store.setHoveredNoteKey(null),this.requestRedraw();return}this.store.isDraggingToSelect()&&this.store.endSelectionDrag();const i=this.store.getHoveredNoteKey();if(i){if(performance.now()-this.store.getLastDeletionTime()<100)return;const[c,d]=i.split(":"),u=this.noteManager.findAtPosition(c,Number(d));if(u){this.noteManager.previewNote(u.pitch,.25),this.store.setSelectedNotes([u]),this.controller.transitionTo(A.SelectedIdle);return}}const r=this.store.getSnappedCursorGridPosition();if(!r)return;const{layout:n}=this.config,s=this.grid.getNoteDuration(),a=pe(r.y,n.lowestMidi,n.highestMidi);if(!a||this.noteManager.findAtPosition(a,r.x))return;const l={start:r.x,duration:s,pitch:a,velocity:100};D(ia(this.getSequencerId(),[l]),ra(this.getSequencerId(),[l])),this.noteManager.previewNote(a,s),this.playNoteAnimation({start:r.x,duration:s,pitch:a,velocity:100})}onContextMenu(e){if(e.preventDefault(),this.store.isOnNonGridElement())return;const i=this.store.getHoveredNoteKey();if(!i)return;const[r,n]=i.split(":"),s=parseFloat(n);if(!r||isNaN(s))return;const a=this.noteManager.findAtPosition(r,s);a&&(D(Pe(this.getSequencerId(),[a]),Ne(this.getSequencerId(),[a])),this.store.setLastDeletionTime())}onMouseLeave(){this.store.setSnappedCursorGridPosition(null),this.store.setHoveredNoteKey(null),this.cursorController.set(U.Default),this.requestRedraw()}onKeyDown(e){if((navigator.platform.toUpperCase().includes("MAC")?e.metaKey:e.ctrlKey)&&e.key==="v"){if(!this.getClipboard().notes.length)return;this.store.clearSelection(),this.controller.transitionTo(A.Pasting)}}onEnter(){J("DefaultNoteToolHandler entered")}onExit(){this.store.setSnappedCursorGridPosition(null),this.store.setHoveredNoteKey(null),this.requestRedraw()}}function Po(t,e,i,r,n){const{layout:{baseCellWidth:s,verticalCellRatio:a,lowestMidi:o,highestMidi:l},behavior:{zoom:c}}=r,d=s*c,u=d/a,f=Math.min(e.startX,e.currentX+d/2),h=Math.max(e.startX,e.currentX+d/2),m=Math.min(e.startY,e.currentY),g=Math.max(e.startY,e.currentY),y=n.getSnapResolution(),p=Math.floor(f/d/y)*y,_=Math.floor(h/d/y)*y,M=Math.floor(m/u),v=Math.floor(g/u),w=Math.min(M,v),S=Math.max(M,v);return t.filter(C=>{const P=Js(C.pitch,o,l);if(P==null)return!1;const k=P>=w&&P<=S,N=C.start+C.duration,L=C.start>=p&&N<=_;return k&&L})}class Nv{constructor(e,i,r,n,s,a,o,l){this.canvas=e,this.config=i,this.scroll=r,this.grid=n,this.store=s,this.controller=a,this.noteManager=o,this.requestRedraw=l}onEnter(){const e=cv(this.controller.getLastMouseX(),this.controller.getLastMouseY(),this.canvas,this.scroll,this.config);this.store.setMarqueeBox({startX:e.x,startY:e.y,currentX:e.x,currentY:e.y})}onMouseMove(e){const i=this.store.getMarqueeBox();if(!i)return;const r=nc(e,this.canvas,this.scroll,this.config);i.currentX=r.x,i.currentY=r.y,this.store.setMarqueeBox({...i});const n=Po(this.noteManager.getAll(),i,this.scroll,this.config,this.grid);this.store.setHighlightedNotes(n),this.requestRedraw()}onMouseUp(e){const i=this.store.getMarqueeBox();if(!i){this.controller.transitionTo(A.NoteTool);return}const r=Po(this.noteManager.getAll(),i,this.scroll,this.config,this.grid),s=navigator.platform.toUpperCase().includes("MAC")?e.metaKey:e.ctrlKey;if(r.length>0){const a=this.store.getSelectedNotes(),o=s?this.noteManager.mergeSelections(a,r):r;this.store.setSelectedNotes(o),this.store.clearHighlightedNotes(),this.store.setMarqueeBox(null),this.controller.transitionTo(A.SelectedIdle)}else this.store.clearSelection(),this.controller.transitionTo(A.NoteTool)}onMouseLeave(){this.store.clearHighlightedNotes(),this.store.setMarqueeBox(null),this.controller.transitionTo(A.NoteTool)}onExit(){this.store.clearHighlightedNotes(),this.store.setMarqueeBox(null),this.requestRedraw()}}class kv{constructor(e,i,r,n,s,a,o,l,c,d,u,f){this.canvas=e,this.config=i,this.scroll=r,this.noteManager=n,this.store=s,this.grid=a,this.requestRedraw=o,this.getSequencerId=l,this.controller=c,this.cursorController=d,this.setClipboard=u,this.getClipboard=f,this.initialMouseX=0,this.initialMouseY=0,this.dragThreshold=3}onEnter(){}onExit(){this.store.setSnappedCursorGridPosition(null),this.store.setHoveredNoteKey(null),this.requestRedraw()}onMouseDown(e){if(e.button!==0||this.store.isOnNonGridElement())return;const i=Nt(e,this.canvas,this.grid,this.scroll,this.config);if(!i)return;const r=nt(e,this.canvas,this.scroll,this.config),n=pe(i.y,this.config.layout.lowestMidi,this.config.layout.highestMidi),s=this.noteManager.findNoteEdgeAtCursor(n,r);if(s){const a=`${s.pitch}:${s.start}`;new Set(this.store.getSelectedNotes().map(l=>`${l.pitch}:${l.start}`)).has(a)||this.store.setSelectedNotes([s]),this.controller.transitionTo(A.Sizing);return}this.store.beginSelectionDrag(),this.initialMouseX=e.clientX,this.initialMouseY=e.clientY}onMouseMove(e){if(this.store.isOnNonGridElement()){this.store.setHoveredNoteKey(null),this.cursorController.set(U.Default),this.requestRedraw();return}const i=e.clientX-this.initialMouseX,r=e.clientY-this.initialMouseY,n=Math.sqrt(i*i+r*r);if(this.store.isDraggingToSelect()){const h=this.store.getHoveredNoteKey();if(h&&n>=this.dragThreshold){const[m,g]=h.split(":"),y=parseFloat(g),p=this.noteManager.findAtPosition(m,y);if(!p)return;this.store.getSelectedNotes().some(v=>v.pitch===p.pitch&&v.start===p.start)||this.store.setSelectedNotes([p]),this.store.setDragAnchorNoteKey(`${p.pitch}:${p.start}`),this.store.endSelectionDrag(),this.controller.transitionTo(A.Dragging);return}if(!h&&n>=this.dragThreshold){!e.ctrlKey&&!e.metaKey&&this.store.clearSelection(),this.store.endSelectionDrag(),this.controller.transitionTo(A.Selecting);return}}const s=$i(e,this.canvas),a=this.grid.getSnapResolution(),o=this.grid.isTripletMode(),l=zi(s,this.scroll,this.config,a,o);if(!l){this.store.setHoveredNoteKey(null),this.cursorController.set(U.Default),this.requestRedraw();return}const c=nt(e,this.canvas,this.scroll,this.config),d=pe(l.y,this.config.layout.lowestMidi,this.config.layout.highestMidi),u=this.noteManager.findNoteUnderCursor(d,c),f=this.noteManager.findNoteEdgeAtCursor(d,c);if(u){const h=`${u.pitch}:${u.start}`;this.store.setHoveredNoteKey(h),f&&f===u?this.cursorController.set(U.ResizeHorizontal):this.cursorController.set(U.Pointer)}else this.store.setHoveredNoteKey(null),this.cursorController.set(U.Default);this.requestRedraw()}onMouseUp(e){if(e.button!==0||this.store.isOnNonGridElement())return;this.store.endSelectionDrag();const i=this.noteManager.findNoteAtMousePosition(e,this.canvas,this.scroll,this.config,this.noteManager);if(i){const r=`${i.pitch}:${i.start}`,n=this.store.getSelectedNotes(),s=n.some(l=>`${l.pitch}:${l.start}`===r);if(navigator.platform.toUpperCase().includes("MAC")?e.metaKey:e.ctrlKey){if(s){const l=n.filter(c=>`${c.pitch}:${c.start}`!==r);this.store.setSelectedNotes(l)}else this.noteManager.previewNote(i.pitch,.25),this.store.setSelectedNotes([...n,i]);this.controller.transitionTo(A.SelectedIdle);return}this.store.setSelectedNotes([i]),this.noteManager.previewNote(i.pitch,.25),this.controller.transitionTo(A.SelectedIdle);return}this.store.clearSelection(),this.controller.transitionTo(A.NoteTool)}onContextMenu(e){if(e.preventDefault(),this.store.isOnNonGridElement())return;const i=this.store.getHoveredNoteKey();if(!i)return;const[r,n]=i.split(":"),s=parseFloat(n),a=this.noteManager.findNoteUnderCursor(r,s);if(!a)return;const o=this.store.getSelectedNotes(),l=o.some(c=>c.pitch===a.pitch&&c.start===a.start);o.length>0&&l?D(Pe(this.getSequencerId(),o),Ne(this.getSequencerId(),o)):D(Pe(this.getSequencerId(),[a]),Ne(this.getSequencerId(),[a])),this.store.clearSelection(),this.controller.transitionTo(A.NoteTool)}onKeyDown(e){const i=this.store.getSelectedNotes(),n=navigator.platform.toUpperCase().includes("MAC")?e.metaKey:e.ctrlKey;if(n&&e.key==="c"){i.length&&this.setClipboard(i);return}if(n&&e.key==="x"){if(!i.length)return;this.setClipboard(i),D(Pe(this.getSequencerId(),i),Ne(this.getSequencerId(),i)),this.store.clearSelection(),this.controller.transitionTo(A.NoteTool);return}if(n&&e.key==="v"){if(!this.getClipboard().notes.length)return;this.store.clearSelection(),this.controller.transitionTo(A.Pasting);return}if(e.key==="Delete"){if(!i.length)return;D(Pe(this.getSequencerId(),i),Ne(this.getSequencerId(),i)),this.store.clearSelection(),this.controller.transitionTo(A.NoteTool)}}}function xv({notes:t,anchorBeat:e,anchorMidi:i,targetBeat:r,targetMidi:n,lowestMidi:s,highestMidi:a}){const o=r-e,l=t.map(y=>y.start+o),c=t.map(y=>y.start+o+y.duration),d=Math.min(...l),u=Math.max(...c),f=Math.min(0,d),h=Math.max(0,u-xe()),m=o-f-h;if(!sn()||Bi()){const y=n-i;return t.flatMap(p=>{const _=bt(p.pitch);if(_==null)return[];let M=_+y;M<s&&(M=s),M>a&&(M=a);const v=Qt(M);return v?[{pitch:v,start:p.start+m,duration:p.duration,velocity:p.velocity??100}]:[]})}else{const y=an(),p=[];for(let w=a;w>=s;w--)y.get(w)&&p.push(w);const _=p.indexOf(i),M=p.indexOf(n);if(_===-1||M===-1)return[];const v=M-_;return t.flatMap(w=>{const S=bt(w.pitch);if(S==null)return[];const C=p.indexOf(S);if(C===-1)return[];const P=C+v;if(P<0||P>=p.length)return[];const k=p[P],N=Qt(k);return N?[{pitch:N,start:w.start+m,duration:w.duration,velocity:w.velocity??100}]:[]})}}class Lv{constructor(e,i,r,n,s,a,o,l,c,d){this.canvas=e,this.config=i,this.scroll=r,this.store=n,this.grid=s,this.requestRedraw=a,this.getSequencerId=o,this.controller=l,this.cursorController=c,this.getClipboard=d}onMouseMove(e){const i=Nt(e,this.canvas,this.grid,this.scroll,this.config);if(!i||Ii(i,this.store,this.cursorController,this.requestRedraw))return;const r=this.getClipboard();if(!r.notes.length)return;const{lowestMidi:n,highestMidi:s}=this.config.layout,a=s-n+1,o=n+(a-1-i.y),l=i.x,c=xv({notes:r.notes,anchorBeat:r.anchorBeat,anchorMidi:r.anchorMidi,targetBeat:l,targetMidi:o,lowestMidi:n,highestMidi:s});this.store.setPreviewNotes(c),this.cursorController.set(U.Pointer),this.requestRedraw()}onMouseDown(e){if(e.button!==0||this.store.isOnNonGridElement())return;const i=this.store.getPreviewNotes();i.length&&(D(ia(this.getSequencerId(),i),ra(this.getSequencerId(),i)),this.store.clearPreviewNotes(),this.controller.transitionTo(A.NoteTool))}onMouseLeave(){this.store.clearPreviewNotes(),this.controller.transitionTo(A.NoteTool)}onExit(){this.store.clearPreviewNotes(),this.requestRedraw()}}function Ev({originalNotes:t,anchorNote:e,targetPitch:i,targetBeat:r,lowestMidi:n,highestMidi:s}){const a=bt(i),o=bt(e.pitch);if(a==null||o==null)return[];const l=r-e.start,c=t.map(p=>p.start+l),d=t.map(p=>p.start+l+p.duration),u=Math.min(...c),f=Math.max(...d),h=Math.min(0,u),m=Math.max(0,f-xe()),g=l-h-m;if(!sn()||Bi()){const p=a-o;return t.flatMap(_=>{const M=bt(_.pitch);if(M==null)return[];let v=M+p;v<n&&(v=n),v>s&&(v=s);const w=Qt(v);return w?[{pitch:w,start:_.start+g,duration:_.duration,velocity:_.velocity??100}]:[]})}else{const p=an(),_=[];for(let S=s;S>=n;S--)p.get(S)&&_.push(S);const M=_.indexOf(o),v=_.indexOf(a);if(M===-1||v===-1)return[];const w=v-M;return t.flatMap(S=>{const C=bt(S.pitch);if(C==null)return[];const P=_.indexOf(C);if(P===-1)return[];const k=P+w;if(k<0||k>=_.length)return[];const N=_[k],L=Qt(N);return L?[{pitch:L,start:S.start+g,duration:S.duration,velocity:S.velocity??100}]:[]})}}class Av{constructor(e,i,r,n,s,a,o,l,c,d){this.canvas=e,this.config=i,this.scroll=r,this.store=n,this.noteManager=s,this.grid=a,this.requestRedraw=o,this.controller=l,this.cursorController=c,this.getSequencerId=d,this.originalNotes=[],this.anchorNote=null,this.hasMoved=!1,this.lastPreviewedPitch=null}onEnter(){const e=this.store.getSelectedNotes();if(!e.length){this.controller.transitionTo(A.NoteTool);return}this.originalNotes=e.map(n=>({...n}));const i=this.store.getDragAnchorNoteKey(),r=i?e.find(n=>`${n.pitch}:${n.start}`===i):e[0];this.anchorNote=r??e[0],this.noteManager.removeAll(e),this.store.setPreviewNotes(this.originalNotes),this.hasMoved=!1,this.requestRedraw()}onMouseMove(e){const i=$i(e,this.canvas),r=this.grid.getSnapResolution(),n=this.grid.isTripletMode(),s=zi(i,this.scroll,this.config,r,n);if(!s||!this.anchorNote)return;const{layout:a}=this.config,o=pe(s.y,a.lowestMidi,a.highestMidi);if(!o)return;const l=Ev({originalNotes:this.originalNotes,anchorNote:this.anchorNote,targetPitch:o,targetBeat:s.x,lowestMidi:a.lowestMidi,highestMidi:a.highestMidi});this.store.setPreviewNotes(l),this.hasMoved=!0,this.cursorController.set(U.Grabbing),o!==this.lastPreviewedPitch&&(this.noteManager.previewNote(o,.25),this.lastPreviewedPitch=o),this.requestRedraw()}onMouseUp(e){if(e.button!==0||!this.anchorNote)return;const i=this.store.getPreviewNotes();if(this.hasMoved&&i.some((n,s)=>n.start!==this.originalNotes[s].start||n.pitch!==this.originalNotes[s].pitch))D(Jd(this.getSequencerId(),this.originalNotes,i),Sg(this.getSequencerId(),this.originalNotes,i));else for(const n of this.originalNotes)this.noteManager.add(n);this.store.clearPreviewNotes(),this.store.clearSelection(),this.controller.transitionTo(A.NoteTool)}onMouseLeave(){this.hasMoved=!1,this.controller.transitionTo(A.NoteTool)}onExit(){if(!this.hasMoved&&this.originalNotes.length>0){for(const e of this.originalNotes)this.noteManager.add(e);this.noteManager.rebuildIndex()}this.originalNotes=[],this.anchorNote=null,this.store.clearPreviewNotes(),this.store.clearSelection(),this.store.setDragAnchorNoteKey(null),this.requestRedraw()}}class Bv{constructor(e,i,r,n,s,a,o,l,c,d){this.canvas=e,this.config=i,this.scroll=r,this.store=n,this.noteManager=s,this.grid=a,this.requestRedraw=o,this.controller=l,this.cursorController=c,this.getSequencerId=d,this.originalNotes=[],this.previewNotes=[],this.anchorNote=null,this.hasResized=!1,this.hasMoved=!1,this.initialMouseX=0,this.accumulatedDelta=0}onEnter(){const e=this.store.getSelectedNotes();if(!e.length){this.controller.transitionTo(A.NoteTool);return}this.originalNotes=e.map(r=>({...r}));const i=this.store.getHoveredNoteKey();this.anchorNote=i?e.find(r=>`${r.pitch}:${r.start}`===i)??null:e[0],this.noteManager.removeAll(e),this.store.setPreviewNotes(this.originalNotes),this.hasResized=!1,this.hasMoved=!1,this.accumulatedDelta=0,this.initialMouseX=this.controller.getLastMouseX(),this.requestRedraw()}onMouseMove(e){if(!this.anchorNote)return;const i=this.grid.getSnapResolution(),n=this.grid.isTripletMode()?i*(2/3):i,s=e.clientX-this.initialMouseX,o=this.config.layout.baseCellWidth*this.config.behavior.zoom*n,l=s/o,c=Math.round(l);if(c===this.accumulatedDelta)return;this.accumulatedDelta=c;const d=c*n,u=this.originalNotes.map(f=>{const h=Math.max(n,f.duration+d);return{...f,duration:h}});this.previewNotes=u,this.store.setPreviewNotes(u),this.cursorController.set(U.ResizeHorizontal),this.hasResized=!0,this.requestRedraw()}onMouseUp(e){if(e.button!==0||!this.anchorNote||!this.hasResized)return;const i=this.originalNotes,n=this.previewNotes.map((a,o)=>({pitch:a.pitch,start:a.start,newDuration:a.duration})),s=i.map((a,o)=>({pitch:a.pitch,start:a.start,oldDuration:a.duration}));D(kg(this.getSequencerId(),n),xg(this.getSequencerId(),s)),this.store.clearPreviewNotes(),this.store.clearSelection(),this.controller.transitionTo(A.NoteTool)}onMouseLeave(){this.controller.transitionTo(A.NoteTool)}onExit(){if(!this.hasResized&&this.originalNotes.length>0){for(const e of this.originalNotes)this.noteManager.add(e);this.noteManager.rebuildIndex()}this.originalNotes=[],this.previewNotes=[],this.anchorNote=null,this.store.clearPreviewNotes(),this.store.clearSelection(),this.requestRedraw()}}class Tv{constructor(e,i,r,n,s,a,o,l,c,d,u,f){this.canvas=e,this.noteManager=i,this.scroll=r,this.config=n,this.store=s,this.grid=a,this.requestRedraw=o,this.getSequencerId=l,this.controller=c,this.cursorController=d,this.getClipboard=u,this.playNoteAnimation=f,this.initialMouseX=0,this.initialMouseY=0,this.dragThreshold=3}onMouseDown(e){if(!this.store.isOnNonGridElement())if(e.button!==0)this.store.beginSelectionDrag(),this.initialMouseX=e.clientX,this.initialMouseY=e.clientY;else{const i=Nt(e,this.canvas,this.grid,this.scroll,this.config);if(Ii(i,this.store,this.cursorController,this.requestRedraw)||!i)return;const r=nt(e,this.canvas,this.scroll,this.config),n=pe(i.y,this.config.layout.lowestMidi,this.config.layout.highestMidi);if(!n)return;const s=this.noteManager.findNoteUnderCursor(n,r),a=this.noteManager.findNoteEdgeAtCursor(n,r);if(a&&s&&`${s.pitch}:${s.start}`==`${a.pitch}:${a.start}`){this.store.setSelectedNotes([a]),this.controller.transitionTo(A.Sizing);return}if(s){this.noteManager.previewNote(s.pitch,.25),this.store.setSelectedNotes([s]),this.store.suppressNextMouseUpEvent(),this.controller.transitionTo(A.SelectedIdle);return}this.store.beginSelectionDrag(),this.initialMouseX=e.clientX,this.initialMouseY=e.clientY;const o=this.grid.getNoteDuration();if(this.noteManager.findAtPosition(n,i.x))return;const c={start:i.x,duration:o,pitch:n,velocity:100};D(ia(this.getSequencerId(),[c]),ra(this.getSequencerId(),[c])),this.noteManager.previewNote(n,o),this.playNoteAnimation(c)}}onMouseMove(e){if(this.store.isOnNonGridElement()){this.store.setSnappedCursorGridPosition(null),this.store.setHoveredNoteKey(null),this.requestRedraw();return}const i=e.clientX-this.initialMouseX,r=e.clientY-this.initialMouseY,n=Math.sqrt(i*i+r*r);if(e.buttons===1&&this.store.isDraggingToSelect()){const d=this.store.getHoveredNoteKey();if(d&&n>=this.dragThreshold){const[u,f]=d.split(":"),h=this.noteManager.findAtPosition(u,Number(f));if(h){this.store.setSelectedNotes([h]),this.store.endSelectionDrag(),this.controller.transitionTo(A.Sizing);return}}}if(e.buttons===2&&this.store.isDraggingToSelect()){const d=e.clientX-this.initialMouseX,u=e.clientY-this.initialMouseY;if(Math.sqrt(d*d+u*u)>=this.dragThreshold){this.store.endSelectionDrag(),this.controller.transitionTo(A.Selecting);return}}const s=Nt(e,this.canvas,this.grid,this.scroll,this.config);if(!s||Ii(s,this.store,this.cursorController,this.requestRedraw))return;this.store.setSnappedCursorGridPosition(s);const a=pe(s.y,this.config.layout.lowestMidi,this.config.layout.highestMidi),o=nt(e,this.canvas,this.scroll,this.config),l=this.noteManager.findNoteUnderCursor(a,o),c=this.noteManager.findNoteEdgeAtCursor(a,o);if(l){const d=`${l.pitch}:${l.start}`;this.store.setHoveredNoteKey(d),this.store.setSnappedCursorGridPosition(null),c===l?this.cursorController.set(U.ResizeHorizontal):this.cursorController.set(U.Pointer)}else this.store.setHoveredNoteKey(null),this.store.setSnappedCursorGridPosition(s),this.cursorController.set(U.Default);this.requestRedraw()}onMouseUp(e){this.store.endSelectionDrag()}onContextMenu(e){if(e.preventDefault(),this.store.isOnNonGridElement())return;const i=this.store.getHoveredNoteKey();if(!i)return;const[r,n]=i.split(":"),s=parseFloat(n);if(!r||isNaN(s))return;const a=this.noteManager.findAtPosition(r,s);a&&(D(Pe(this.getSequencerId(),[a]),Ne(this.getSequencerId(),[a])),this.store.setLastDeletionTime())}onMouseLeave(){this.store.setSnappedCursorGridPosition(null),this.store.setHoveredNoteKey(null),this.cursorController.set(U.Default),this.requestRedraw()}onKeyDown(e){if((navigator.platform.toUpperCase().includes("MAC")?e.metaKey:e.ctrlKey)&&e.key==="v"){if(!this.getClipboard().notes.length)return;this.store.clearSelection(),this.controller.transitionTo(A.Pasting)}}onEnter(){J("ExpressNoteToolHandler entered")}onExit(){this.store.setSnappedCursorGridPosition(null),this.store.setHoveredNoteKey(null),this.requestRedraw()}}class Iv{constructor(e,i,r,n,s,a,o,l,c,d,u,f){this.canvas=e,this.config=i,this.scroll=r,this.noteManager=n,this.store=s,this.grid=a,this.requestRedraw=o,this.getSequencerId=l,this.controller=c,this.cursorController=d,this.setClipboard=u,this.getClipboard=f,this.initialMouseX=0,this.initialMouseY=0,this.dragThreshold=3}onEnter(){var e;if(window&&((e=window.event)==null?void 0:e.buttons)&1){this.store.beginSelectionDrag();const i=window.event;this.initialMouseX=i.clientX,this.initialMouseY=i.clientY}}onExit(){this.store.setSnappedCursorGridPosition(null),this.store.setHoveredNoteKey(null),this.requestRedraw()}onMouseDown(e){if(this.store.isOnNonGridElement())return;const i=e.button===0,r=e.button===2,n=Nt(e,this.canvas,this.grid,this.scroll,this.config);if(!n){r&&this.beginSelectionDrag(e);return}const s=pe(n.y,this.config.layout.lowestMidi,this.config.layout.highestMidi);if(!s){r&&this.beginSelectionDrag(e);return}const a=nt(e,this.canvas,this.scroll,this.config),o=this.noteManager.findNoteUnderCursor(s,a);if(i){const l=this.noteManager.findNoteEdgeAtCursor(s,a);if(l){const c=`${l.pitch}:${l.start}`;new Set(this.store.getSelectedNotes().map(u=>`${u.pitch}:${u.start}`)).has(c)||this.store.setSelectedNotes([l]),this.controller.transitionTo(A.Sizing);return}o&&(this.beginSelectionDrag(e),this.initialMouseX=e.clientX,this.initialMouseY=e.clientY)}if(r)if(o){const l=`${o.pitch}:${o.start}`;this.store.setHoveredNoteKey(l)}else this.store.setHoveredNoteKey(null),this.beginSelectionDrag(e)}beginSelectionDrag(e){this.store.beginSelectionDrag(),this.initialMouseX=e.clientX,this.initialMouseY=e.clientY}onMouseMove(e){if(this.store.isOnNonGridElement()){this.store.setHoveredNoteKey(null),this.cursorController.set(U.Default),this.requestRedraw();return}const i=e.clientX-this.initialMouseX,r=e.clientY-this.initialMouseY,n=Math.sqrt(i*i+r*r);if(this.store.isDraggingToSelect()&&e.buttons&1){const h=this.store.getHoveredNoteKey();if(h&&n>=this.dragThreshold){const[m,g]=h.split(":"),y=parseFloat(g),p=this.noteManager.findAtPosition(m,y);if(!p)return;this.store.getSelectedNotes().some(v=>v.pitch===p.pitch&&v.start===p.start)||this.store.setSelectedNotes([p]),this.store.setDragAnchorNoteKey(`${p.pitch}:${p.start}`),this.store.endSelectionDrag(),this.controller.transitionTo(A.Dragging);return}}else if(this.store.isDraggingToSelect()&&e.buttons&2&&!this.store.getHoveredNoteKey()&&n>=this.dragThreshold){!e.metaKey&&!e.shiftKey&&!e.ctrlKey&&this.store.clearSelection(),this.store.endSelectionDrag(),this.controller.transitionTo(A.Selecting);return}const s=$i(e,this.canvas),a=this.grid.getSnapResolution(),o=this.grid.isTripletMode(),l=zi(s,this.scroll,this.config,a,o);if(!l){this.store.setHoveredNoteKey(null),this.cursorController.set(U.Default),this.requestRedraw();return}const c=nt(e,this.canvas,this.scroll,this.config),d=pe(l.y,this.config.layout.lowestMidi,this.config.layout.highestMidi),u=this.noteManager.findNoteUnderCursor(d,c),f=this.noteManager.findNoteEdgeAtCursor(d,c);if(u){const h=`${u.pitch}:${u.start}`;this.store.setHoveredNoteKey(h),f&&f===u?this.cursorController.set(U.ResizeHorizontal):this.cursorController.set(U.Pointer)}else this.store.setHoveredNoteKey(null),this.cursorController.set(U.Default);this.requestRedraw()}onMouseUp(e){if(e.button!==0||this.store.isOnNonGridElement()||this.store.consumeSuppressMouseUpFlag())return;this.store.endSelectionDrag();const i=this.noteManager.findNoteAtMousePosition(e,this.canvas,this.scroll,this.config,this.noteManager);if(i){const r=`${i.pitch}:${i.start}`,n=this.store.getSelectedNotes(),s=n.some(l=>`${l.pitch}:${l.start}`===r);if(navigator.platform.toUpperCase().includes("MAC")?e.metaKey:e.ctrlKey){if(s){const l=n.filter(c=>`${c.pitch}:${c.start}`!==r);this.store.setSelectedNotes(l)}else this.noteManager.previewNote(i.pitch,.25),this.store.setSelectedNotes([...n,i]);this.controller.transitionTo(A.SelectedIdle);return}this.store.setSelectedNotes([i]),this.noteManager.previewNote(i.pitch,.25),this.controller.transitionTo(A.SelectedIdle);return}this.store.clearSelection(),this.controller.transitionTo(A.NoteTool)}onContextMenu(e){if(e.preventDefault(),this.store.isOnNonGridElement())return;const i=this.store.getHoveredNoteKey();if(!i)return;const[r,n]=i.split(":"),s=parseFloat(n),a=this.noteManager.findNoteUnderCursor(r,s);if(!a)return;const o=this.store.getSelectedNotes(),l=o.some(c=>c.pitch===a.pitch&&c.start===a.start);o.length>0&&l?D(Pe(this.getSequencerId(),o),Ne(this.getSequencerId(),o)):D(Pe(this.getSequencerId(),[a]),Ne(this.getSequencerId(),[a])),this.store.clearSelection(),this.controller.transitionTo(A.NoteTool)}onKeyDown(e){const i=this.store.getSelectedNotes(),n=navigator.platform.toUpperCase().includes("MAC")?e.metaKey:e.ctrlKey;if(n&&e.key==="c"){i.length&&this.setClipboard(i);return}if(n&&e.key==="x"){if(!i.length)return;this.setClipboard(i),D(Pe(this.getSequencerId(),i),Ne(this.getSequencerId(),i)),this.store.clearSelection(),this.controller.transitionTo(A.NoteTool);return}if(n&&e.key==="v"){if(!this.getClipboard().notes.length)return;this.store.clearSelection(),this.controller.transitionTo(A.Pasting);return}if(e.key==="Delete"){if(!i.length)return;D(Pe(this.getSequencerId(),i),Ne(this.getSequencerId(),i)),this.store.clearSelection(),this.controller.transitionTo(A.NoteTool)}}}class Gv{constructor(e){this.data=e,this.mode=A.NoteTool,this.activeHandler=null,this.lastMouseX=0,this.lastMouseY=0,this.transitionTo(A.NoteTool)}handleMouseDown(e){var i,r;this.lastMouseX=e.clientX,this.lastMouseY=e.clientY,(r=(i=this.activeHandler)==null?void 0:i.onMouseDown)==null||r.call(i,e)}handleMouseMove(e){var i,r;this.lastMouseX=e.clientX,this.lastMouseY=e.clientY,(r=(i=this.activeHandler)==null?void 0:i.onMouseMove)==null||r.call(i,e)}handleMouseUp(e){var i,r;this.lastMouseX=e.clientX,this.lastMouseY=e.clientY,(r=(i=this.activeHandler)==null?void 0:i.onMouseUp)==null||r.call(i,e)}handleContextMenu(e){var i,r;this.lastMouseX=e.clientX,this.lastMouseY=e.clientY,(r=(i=this.activeHandler)==null?void 0:i.onContextMenu)==null||r.call(i,e)}handleMouseLeave(){var e,i;(i=(e=this.activeHandler)==null?void 0:e.onMouseLeave)==null||i.call(e)}handleMouseEnter(e){var i,r;(r=(i=this.activeHandler)==null?void 0:i.onMouseEnter)==null||r.call(i,e)}handleKeyDown(e){var i,r;(r=(i=this.activeHandler)==null?void 0:i.onKeyDown)==null||r.call(i,e)}transitionTo(e){var i,r,n,s;J(`Transitioning to mode: ${A[e]} from ${A[this.mode]}`),(r=(i=this.activeHandler)==null?void 0:i.onExit)==null||r.call(i),this.mode=e,this.activeHandler=this.createHandlerForMode(e),(s=(n=this.activeHandler)==null?void 0:n.onEnter)==null||s.call(n)}reset(){this.transitionTo(A.NoteTool)}createHandlerForMode(e){const i={transitionTo:r=>this.transitionTo(r),getLastMouseX:()=>this.lastMouseX,getLastMouseY:()=>this.lastMouseY};switch(e){case A.NoteTool:{const{global:{noteToolMode:r}}=oe(),n=r==="express"?Tv:Pv,s=[this.data.canvas,this.data.noteManager,this.data.scroll,this.data.config,this.data.store,this.data.grid,this.data.requestRedraw,()=>this.data.sequencerContext.getId(),i,this.data.cursorController,this.data.getClipboard,this.data.playNoteAnimation];return new n(...s)}case A.Selecting:return new Nv(this.data.canvas,this.data.config,this.data.scroll,this.data.grid,this.data.store,i,this.data.noteManager,this.data.requestRedraw);case A.SelectedIdle:{const{global:{noteToolMode:r}}=oe(),n=r==="express"?Iv:kv,s=[this.data.canvas,this.data.config,this.data.scroll,this.data.noteManager,this.data.store,this.data.grid,this.data.requestRedraw,()=>this.data.sequencerContext.getId(),i,this.data.cursorController,this.data.setClipboard,this.data.getClipboard];return new n(...s)}case A.Pasting:return new Lv(this.data.canvas,this.data.config,this.data.scroll,this.data.store,this.data.grid,this.data.requestRedraw,()=>this.data.sequencerContext.getId(),i,this.data.cursorController,this.data.getClipboard);case A.Dragging:return new Av(this.data.canvas,this.data.config,this.data.scroll,this.data.store,this.data.noteManager,this.data.grid,this.data.requestRedraw,i,this.data.cursorController,()=>this.data.sequencerContext.getId());case A.Sizing:return new Bv(this.data.canvas,this.data.config,this.data.scroll,this.data.store,this.data.noteManager,this.data.grid,this.data.requestRedraw,i,this.data.cursorController,()=>this.data.sequencerContext.getId());default:return{}}}destroy(){var e,i;(i=(e=this.activeHandler)==null?void 0:e.onExit)==null||i.call(e),this.activeHandler=null}}class Ov{constructor(e){this.current=U.Default,this.canvas=e}set(e){this.current!==e&&(this.canvas.style.cursor=e,this.current=e)}reset(){this.set(U.Default)}}class Dv{constructor(e,i){this.context=e,this.canvas=i,this.onMouseMove=r=>{this.context.handleMouseMove(r)},this.onMouseDown=r=>{this.context.handleMouseDown(r)},this.onMouseUp=r=>{this.context.handleMouseUp(r)},this.onMouseLeave=()=>{this.context.handleMouseLeave()},this.onMouseEnter=r=>{var n,s;(s=(n=this.context).handleMouseEnter)==null||s.call(n,r)},this.onContextMenu=r=>{this.context.handleContextMenu(r)},this.onKeyDown=r=>{this.context.handleKeyDown(r)},this.attachListeners(),this.canvas.style.pointerEvents="auto"}attachListeners(){this.canvas.addEventListener("mousemove",this.onMouseMove),this.canvas.addEventListener("mouseleave",this.onMouseLeave),this.canvas.addEventListener("mouseenter",this.onMouseEnter),this.canvas.addEventListener("mousedown",this.onMouseDown),this.canvas.addEventListener("mouseup",this.onMouseUp),this.canvas.addEventListener("contextmenu",this.onContextMenu),window.addEventListener("keydown",this.onKeyDown)}destroy(){this.canvas.removeEventListener("mousemove",this.onMouseMove),this.canvas.removeEventListener("mouseenter",this.onMouseEnter),this.canvas.removeEventListener("mouseleave",this.onMouseLeave),this.canvas.removeEventListener("mousedown",this.onMouseDown),this.canvas.removeEventListener("mouseup",this.onMouseUp),this.canvas.removeEventListener("contextmenu",this.onContextMenu),this.canvas.removeEventListener("keydown",this.onKeyDown)}}class Fv{constructor(e,i,r){this.canvas=e,this.scroll=i,this.requestRedraw=r,this.SCROLL_SPEED_X=1,this.SCROLL_SPEED_Y=1,this.onWheel=n=>{n.preventDefault();const s=n.shiftKey||Math.abs(n.deltaX)>Math.abs(n.deltaY),a=n.deltaX||n.deltaY;if(s){const o=this.scroll.getX()+a*this.SCROLL_SPEED_X;this.scroll.setScroll(o,this.scroll.getY())}else{const o=this.scroll.getY()+n.deltaY*this.SCROLL_SPEED_Y;this.scroll.setScroll(this.scroll.getX(),o)}this.requestRedraw()},this.attachListeners()}attachListeners(){this.canvas.addEventListener("wheel",this.onWheel,{passive:!1})}destroy(){this.canvas.removeEventListener("wheel",this.onWheel)}}class Rv{constructor(){this.snappedCursorGridPosition=null,this.previewNotes=[],this.hoveredNoteKey=null,this.marqueeBox=null,this.highlightedNoteKeys=new Set,this.suppressNextMouseUp=!1,this.selectedNotes=[],this.dragAnchorNoteKey=null,this.isOnScrollbar=!1,this.isScrolling=!1,this.isInitiatingSelectionDrag=!1,this.isDraggingNotes=!1,this.lastDeletionTime=0}setSnappedCursorGridPosition(e){this.snappedCursorGridPosition=e}getSnappedCursorGridPosition(){return this.snappedCursorGridPosition}setPreviewNotes(e){this.previewNotes=e}getPreviewNotes(){return this.previewNotes}clearPreviewNotes(){this.previewNotes=[]}setHoveredNoteKey(e){this.hoveredNoteKey=e}getHoveredNoteKey(){return this.hoveredNoteKey}setMarqueeBox(e){this.marqueeBox=e}getMarqueeBox(){return this.marqueeBox}hasMarquee(){return this.marqueeBox!==null}setHighlightedNotes(e){this.highlightedNoteKeys=new Set(e.map(i=>`${i.pitch}:${i.start}`))}clearHighlightedNotes(){this.highlightedNoteKeys.clear()}isNoteHighlighted(e){return this.highlightedNoteKeys.has(`${e.pitch}:${e.start}`)}suppressNextMouseUpEvent(){this.suppressNextMouseUp=!0}consumeSuppressMouseUpFlag(){const e=this.suppressNextMouseUp;return this.suppressNextMouseUp=!1,e}getSelectedNotes(){return this.selectedNotes}setSelectedNotes(e){this.selectedNotes=e}clearSelection(){this.selectedNotes=[]}hasSelection(){return this.selectedNotes.length>0}setDragAnchorNoteKey(e){this.dragAnchorNoteKey=e}getDragAnchorNoteKey(){return this.dragAnchorNoteKey}setIsOnScrollbar(e){this.isOnScrollbar=e}getIsOnScrollbar(){return this.isOnScrollbar}setIsScrolling(e){this.isScrolling=e}isOnNonGridElement(){return this.isOnScrollbar||this.isScrolling}beginSelectionDrag(){this.isInitiatingSelectionDrag=!0}endSelectionDrag(){this.isInitiatingSelectionDrag=!1}isDraggingToSelect(){return this.isInitiatingSelectionDrag}setIsDraggingNotes(e){this.isDraggingNotes=e}getIsDraggingNotes(){return this.isDraggingNotes}isActivelyDragging(){return this.isDraggingNotes||this.isInitiatingSelectionDrag}setLastDeletionTime(){this.lastDeletionTime=performance.now()}getLastDeletionTime(){return this.lastDeletionTime}}class Uv{constructor(e){this.container=this.createContainer(),e.appendChild(this.container),this.gridCanvas=this.createCanvas("gridCanvas"),this.noteCanvas=this.createCanvas("noteCanvas"),this.animationCanvas=this.createCanvas("animationCanvas"),this.playheadCanvas=this.createCanvas("playheadCanvas"),this.container.appendChild(this.gridCanvas),this.container.appendChild(this.noteCanvas),this.container.appendChild(this.animationCanvas),this.container.appendChild(this.playheadCanvas),this.gridCtx=this.getCtx(this.gridCanvas),this.noteCtx=this.getCtx(this.noteCanvas),this.animationCtx=this.getCtx(this.animationCanvas),this.playheadCtx=this.getCtx(this.playheadCanvas),this.injectContainerStyles(),this.injectCanvasStyles()}createContainer(){const e=document.createElement("div");return e.id="grid-container",e.style.position="relative",e.style.width="100%",e.style.height="100%",e.style.background="#222",e.style.border="1px solid #333",e.style.overflow="hidden",e.style.boxShadow="0 0 20px rgba(0,0,0,0.4)",e.style.borderRadius="6px",e}createCanvas(e){const i=document.createElement("canvas");return i.id=e,i.style.display="block",i.style.position="absolute",i.style.top="0",i.style.left="0",i.style.width="100%",i.style.height="100%",i.style.pointerEvents="none",i}getCtx(e){const i=e.getContext("2d");if(!i)throw new Error(`2D context not available for canvas with id: ${e.id}`);return i}injectContainerStyles(){const e=document.createElement("style");e.textContent=`
        #grid-container canvas {
          z-index: 0;
        }
        #grid-container canvas#noteCanvas {
          z-index: 1;
        }
        #grid-container canvas#animationCanvas {
          z-index: 2;
        }
        #grid-container canvas#playheadCanvas {
          z-index: 3;
        }
      `,document.head.appendChild(e)}injectCanvasStyles(){}}class Hv{constructor(e,i){this.scroll=e,this.config=i}draw(e){const{layout:{baseCellWidth:i,headerHeight:r,labelWidth:n},totalMeasures:s,beatsPerMeasure:a,behavior:{zoom:o}}=this.config,{gridColorScheme:l}=oe().theme,c=ua[l],d=i*o,u=this.scroll.getX(),f=e.canvas.offsetWidth;e.save(),e.translate(n-u,0);const h=e.createLinearGradient(0,0,0,r);h.addColorStop(0,c.labelWhite),h.addColorStop(1,c.labelBlack),e.fillStyle=h,e.fillRect(-n+u,0,f,r);for(let m=0;m<=s;m++){const y=m*a*d,p=m%4===0;e.strokeStyle=p?c.measureLine:c.beatLine,e.lineWidth=p?2:1,e.beginPath(),e.moveTo(y,0),e.lineTo(y,r),e.stroke(),e.textAlign="center",e.textBaseline="top",e.fillStyle=p?c.textWhite:c.textBlack,e.font=`${p?"bold":""} ${Math.floor(r*.5)}px 'Inter', sans-serif`;const _=y+a*d/2;e.fillText(`${m+1}`,_,4)}e.restore()}}class qv{constructor(e,i,r,n){this.scroll=e,this.config=i,this.getCustomLabels=r,this.getBlackKeyMap=n;const{lowestMidi:s,highestMidi:a}=i.layout;this.blackKeyMap=sd(s,a)}draw(e){const{layout:{baseCellWidth:i,verticalCellRatio:r,headerHeight:n,labelWidth:s,highestMidi:a,lowestMidi:o},behavior:{zoom:l}}=this.config,{gridColorScheme:c}=oe().theme,d=ua[c],u=a-o+1,f=this.scroll.getY(),m=i*l/r,g=e.canvas.offsetHeight??u*m+n;e.save(),e.translate(0,-f);const y=e.createLinearGradient(0,0,0,g);y.addColorStop(0,d.labelWhite),y.addColorStop(1,d.labelBlack),e.fillStyle=y,e.fillRect(0,f,s,g),e.font=`${Math.floor(m*.6)}px 'Inter', sans-serif`,e.textAlign="right",e.textBaseline="middle",e.strokeStyle=d.gridLine,e.lineWidth=1,e.beginPath(),e.moveTo(s-.5,f),e.lineTo(s-.5,f+g),e.stroke();const p=this.getCustomLabels();for(let _=0;_<u;_++){const M=_*m+n,v=a-_,w=(p==null?void 0:p[v])??pe(_,o,a),S=this.getBlackKeyMap().get(v)??!1;e.fillStyle=S?d.textBlack:d.textWhite,e.fillText(w,s-8,M+m/2)}e.restore()}}class jv{constructor(e,i,r){this.scroll=e,this.config=i,this.interactionStore=r}draw(e){const i=this.interactionStore.getMarqueeBox();if(!i)return;const{layout:{baseCellWidth:r,verticalCellRatio:n},behavior:{zoom:s}}=this.config,a=this.scroll.getX(),o=this.scroll.getY(),l=Math.min(i.startX,i.currentX),c=Math.min(i.startY,i.currentY),d=Math.abs(i.currentX-i.startX),u=Math.abs(i.currentY-i.startY);d<1||u<1||(e.save(),e.translate(this.config.layout.labelWidth-a,this.config.layout.headerHeight-o),e.strokeStyle="rgba(128, 90, 213, 1.0)",e.lineWidth=2,e.setLineDash([5,5]),Ti(e,l,c,d,u,3),e.stroke(),e.restore())}}const Vi={cellWidth:40,cellHeight:20,visibleNotes:36,noteRange:["C1","B9"],currentDuration:1,snapResolution:1,isTripletMode:!1,loopEnabled:!1,useEqualTemperament:!0};let sc={notes:[],anchorBeat:0,anchorMidi:0};function Kv(t){if(t.length===0)return;const e=t[0],i=e.start,r=Z(e.pitch)??0;sc={notes:t.map(n=>({pitch:n.pitch,start:n.start,duration:n.duration,velocity:n.velocity??100})),anchorBeat:i,anchorMidi:r}}function $v(){return sc}class zv{constructor(){this.listeners={}}on(e,i){this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(i)}off(e,i){var r;(r=this.listeners[e])==null||r.delete(i)}emit(e,i){var r;(r=this.listeners[e])==null||r.forEach(n=>n(i))}clear(e){var i;(i=this.listeners[e])==null||i.clear()}removeAllListeners(){var e;for(const i in this.listeners)(e=this.listeners[i])==null||e.clear()}}class Vv{constructor(e,i={},r){this.sequencerConfig=Vi,this.needsRedraw=!0,this.customLabels=null,this.blackKeyMap=new Map,this.isDestroyed=!1,this.onWindowResize=()=>this.resize(),this.config=Yg(Xg(),i),this.sequencerContext=r,this.recalculateLabelAndHeader(),this.gridManager=new Uv(e);const{gridCanvas:n,noteCanvas:s,animationCanvas:a,playheadCanvas:o}=this.gridManager;this.gridCanvasManager=new sr(n),this.noteCanvasManager=new sr(s),this.animationCanvasManager=new sr(a),this.playheadCanvasManager=new sr(o);const l=this.gridManager.container;this.noteManager=new uv(this.config,this.sequencerContext.playNote),this.interactionStore=new Rv,this.emitter=new zv,this.scroll=new dv(l,this.config),this.scrollbars=new Cv(l,this.scroll,this.config,this.interactionStore,()=>this.requestRedraw()),this.wheelHandler=new Fv(l,this.scroll,()=>this.requestRedraw()),this.cursorController=new Ov(l);const c={canvas:s,noteManager:this.noteManager,scroll:this.scroll,config:this.config,store:this.interactionStore,grid:this,addNote:d=>this.noteManager.add(d),requestRedraw:()=>this.requestRedraw(),sequencerContext:r,cursorController:this.cursorController,setClipboard:Kv,getClipboard:$v,playNoteAnimation:d=>this.playNoteAnimation(d)};this.interactionContext=new Gv(c),this.inputTracker=new Dv(this.interactionContext,l),this.gridRenderer=new av(this.scroll,this.config,this.interactionStore,()=>this.getBlackKeyMap(),()=>an()),this.noteRenderer=new _v(this.scroll,this.config,this.noteManager,this.interactionStore,this.sequencerContext.getId()),this.notePreviewRenderer=new bv(this.scroll,this.config,this.interactionStore,()=>this.getNoteDuration()),this.animationRenderer=new Mv(this.scroll,this.config),this.headerRenderer=new Hv(this.scroll,this.config),this.labelRenderer=new qv(this.scroll,this.config,()=>this.customLabels,()=>this.getBlackKeyMap()),this.playheadRenderer=new wv(this.scroll,this.config),this.marqueeRenderer=new jv(this.scroll,this.config,this.interactionStore),this.initialZoom=this.zoom,this.customLabels=null,requestAnimationFrame(()=>this.resize()),this.playheadRenderer.setPlayheadX(0),this.attachListeners(),this.renderLoop()}attachListeners(){window.addEventListener("resize",this.onWindowResize)}detachListeners(){window.removeEventListener("resize",this.onWindowResize)}renderLoop(){this.isDestroyed||(this.needsRedraw&&(this.render(),this.needsRedraw=!1),requestAnimationFrame(()=>this.renderLoop()))}recalculateLabelAndHeader(){const{baseCellWidth:e,verticalCellRatio:i,labelWidthColumns:r,headerHeightRows:n}=this.config.layout,s=this.zoom,a=e*s,o=a/i;this.config.layout.labelWidth=r*a,this.config.layout.headerHeight=n*o}get zoom(){return this.config.behavior.zoom}set zoom(e){this.config.behavior.zoom=e}get notes(){const e=this.noteManager.getAll();return e||[]}render(){this.gridCanvasManager.clear(),this.noteCanvasManager.clear(),this.animationCanvasManager.clear(),this.playheadCanvasManager.clear();const e=this.gridCanvasManager.getContext(),i=this.noteCanvasManager.getContext(),r=this.animationCanvasManager.getContext(),n=this.playheadCanvasManager.getContext();this.gridRenderer.draw(e),this.noteRenderer.draw(i),this.notePreviewRenderer.draw(i),this.animationRenderer.draw(r),this.labelRenderer.draw(e),this.headerRenderer.draw(e),this.playheadRenderer.draw(n),this.interactionStore.hasMarquee()&&this.marqueeRenderer.draw(r),this.scrollbars.update()}requestRedraw(){this.needsRedraw=!0}resize(){this.gridCanvasManager.resize(),this.noteCanvasManager.resize(),this.animationCanvasManager.resize(),this.playheadCanvasManager.resize(),this.scroll.recalculateBounds(),this.scrollbars.update(),this.requestRedraw()}on(e,i){this.emitter.on(e,i)}off(e,i){this.emitter.off(e,i)}setPlayheadPixelX(e){this.playheadRenderer.setPlayheadX(e),this.requestRedraw()}getPixelsPerBeat(){return this.config.layout.baseCellWidth*this.config.behavior.zoom}setNotes(e){this.noteManager.set(e),this.requestRedraw()}playNoteAnimation(e){this.animationRenderer.playNote(e)}getTrackedNotes(){return this.noteManager.getTrackedNotes(this.interactionStore)}scrollTo(e,i){this.scroll.setScroll(e,i),this.scrollbars.update(),this.requestRedraw()}setZoom(e){this.zoom=e,this.scroll.recalculateBounds(),this.recalculateLabelAndHeader(),this.requestRedraw()}getZoom(){return this.zoom}resetZoom(){this.setZoom(this.initialZoom)}zoomIn(){this.setZoom(Math.min(this.config.behavior.maxZoom,this.zoom+.1))}zoomOut(){this.setZoom(Math.max(this.config.behavior.minZoom,this.zoom-.1))}setCustomLabels(e){this.customLabels=e,this.requestRedraw()}getMeasures(){return this.config.totalMeasures}setMeasures(e){this.config.totalMeasures=Math.max(1,e),this.scroll.recalculateBounds(),this.requestRedraw()}getBeatsPerMeasure(){return this.config.beatsPerMeasure}setBeatsPerMeasure(e){this.config.beatsPerMeasure=Math.max(1,e),this.scroll.recalculateBounds(),this.requestRedraw()}getTotalBeats(){return this.config.totalMeasures*this.config.beatsPerMeasure}setNoteRange(e,i){this.config.layout.lowestMidi=e,this.config.layout.highestMidi=i,this.blackKeyMap=sd(e,i),this.scroll.recalculateBounds(),this.recalculateLabelAndHeader(),this.resize(),this.requestRedraw()}refreshNoteRange(){this.setNoteRange(this.config.layout.lowestMidi,this.config.layout.highestMidi)}getBlackKeyMap(){return this.blackKeyMap}isTripletMode(){return Mr()}getNoteDuration(){return this.sequencerConfig.currentDuration}getSnapResolution(){return dn()}getInteractionStore(){return this.interactionStore}getNoteManager(){return this.noteManager}getInteractionContext(){return this.interactionContext}emit(e,i){this.emitter.emit(e,i)}destroy(){this.inputTracker.destroy(),this.wheelHandler.destroy(),this.scrollbars.destroy(),this.gridManager.container.remove(),this.gridCanvasManager.destroy(),this.noteCanvasManager.destroy(),this.animationCanvasManager.destroy(),this.playheadCanvasManager.destroy(),this.detachListeners(),this.emitter.removeAllListeners(),this.interactionContext.destroy(),this.isDestroyed=!0}}function Wv(t,e,i){return new Vv(t,e,i)}function ac({instrument:t,midi:e,time:i,duration:r,velocity:n}){var a;const s=((a=t.__midiMap)==null?void 0:a.get(e))??e;if(!(t!=null&&t.start)){console.warn("[startInstrumentNote] Instrument missing start() method");return}try{t.start({note:s,time:i,duration:r,velocity:n})}catch(o){console.warn("[startInstrumentNote] Failed to start instrument note",{midi:e,resolved:s,err:o})}}function ha(t,e){var i;(i=t==null?void 0:t.stop)==null||i.call(t);for(const r of e)clearTimeout(r);e.length=0}async function Jv(t,e,i,r,n,s,a,o=0){if(!n)return;if(t||await e(),ha(t,s),!(t!=null&&t.start)){console.warn("[playback] Instrument does not support scheduled playback.");return}const c=60/Ke(),d=performance.now();i.sort((f,h)=>f.start-h.start);let u=0;for(;u<i.length&&i[u].start<o;)u++;for(;u<i.length;u++){const f=i[u],h=te(f.pitch);if(h==null)continue;const m=f.start-o,g=a+m*c,y=f.duration*c,p=f.velocity??100;if(ac({instrument:t,midi:h,time:g,duration:y,velocity:p}),!r){const _=d+m*c*1e3,M=Math.max(0,_-performance.now()),v=setTimeout(()=>{n==null||n.playNoteAnimation(f)},M);s.push(v)}}}function Xv(t,e,i,r,n,s){if(!r||n)return;const o=60/Ke();performance.now();const d=(ee().currentTime-e)/o,u=i+d;for(const f of t){if(f.start<u)continue;const m=(f.start-u)*o*1e3;if(m>=0){const g=setTimeout(()=>{r==null||r.playNoteAnimation(f)},m);s.push(g)}}}async function Yv(t,e,i,r,n,s,a,o,l,c=0){if(!r||(ha(t,o),t||await e(),s||!a||!(t!=null&&t.start)))return;const u=60/Ke(),f=performance.now(),h=ee().currentTime,m=i.filter(g=>g.start>=c);for(const g of m){const y=te(g.pitch);if(y==null)continue;const p=g.start-c,_=l+p*u;if(_<=h+.01)continue;const M=g.duration*u,v=g.velocity??100;if(ac({instrument:t,midi:y,time:_,duration:M,velocity:v}),!n){const w=f+p*u*1e3,S=Math.max(0,w-performance.now()),C=setTimeout(()=>{r==null||r.playNoteAnimation(g)},S);o.push(C)}}}const ve=class ve{constructor(e,i,r=ee(),n=$t(),s="sf2/fluidr3-gm/acoustic_grand_piano",a=!1,o=0){if(this.colorIndex=0,this._registry=null,this.id=0,this.mute=!1,this.solo=!1,this.collapsed=!1,this.miniContour=null,this.body=null,this.collapseIcon=null,this._scheduledAnimations=[],this._volume=100/127,this._pan=0,this._instrument=null,ve.allSequencers.push(this),this.id=o,this.container=e,this.config={...i},this.context=r,this.destination=n,this.instrumentName=s,this.squelchLoadingScreen=a,this.container){const l=this.container.querySelector(".sequencer-body");this.matrix=Wv(l,{},{playNote:this.playNote.bind(this),getId:()=>this.id}),this.matrix.refreshNoteRange()}}static isAnySoloActive(){return ve.allSequencers.some(e=>e.solo)}static rescheduleAll(){if(!R.isActive())return;const e=R.getStartTime(),i=R.getStartBeat();for(const r of ve.allSequencers)r.stopScheduledNotes(),r.shouldPlay&&(r.reschedulePlayback(e,i),r.resumeAnimationsFromCurrentTime(e,i))}async initInstrument(){try{this._instrument=await rd(this.instrumentName,this.context,this.destination,this._volume,this._pan,!1,!1),this.updateToDrumNoteRange()}catch(e){console.warn(`[SEQ:${this.id}] Failed to load instrument '${this.instrumentName}':`,e)}}setInstrument(e){this.instrumentName=e,this.updateTrackLabel(),this.initInstrument()}updateTrackLabel(){var i;const e=(i=this.container)==null?void 0:i.querySelector(".track-name");e&&(e.textContent=`${this.id+1}: ${this.instrumentName}`)}get notes(){var e;return((e=this.matrix)==null?void 0:e.notes)??[]}get volume(){return this._volume}set volume(e){var i;this._volume=Math.max(0,Math.min(1,e)),(i=this._instrument)!=null&&i.setVolume&&this._instrument.setVolume(this._volume)}get pan(){return this._pan}set pan(e){var i;this._pan=Math.max(-1,Math.min(1,e)),(i=this._instrument)!=null&&i.setPan&&this._instrument.setPan(this._pan)}get shouldPlay(){return ve.isAnySoloActive()?this.solo:!this.mute}get scheduledAnimations(){return this._scheduledAnimations}set scheduledAnimations(e){this._scheduledAnimations=e}toggleMute(){this.mute=!this.mute,this.mute&&(this.solo=!1),this.stopScheduledNotes(),wo(this),R.isActive()&&ve.rescheduleAll()}toggleSolo(){this.solo=!this.solo,this.solo&&(this.mute=!1),wo(this),R.isActive()&&ve.rescheduleAll()}setCollapsed(e){tc(this,e)}resetInteractionMode(){var e;(e=this.matrix)==null||e.getInteractionContext().reset()}async preparePlayback(e,i=0){var r;await Jv(this._instrument,()=>this.initInstrument(),((r=this.matrix)==null?void 0:r.notes)??[],this.collapsed,this.matrix??null,this._scheduledAnimations,e,i)}stopScheduledNotes(){ha(this._instrument,this._scheduledAnimations)}resumeAnimationsFromCurrentTime(e,i){var r;Xv(((r=this.matrix)==null?void 0:r.notes)??[],e,i,this.matrix??null,this.collapsed,this._scheduledAnimations)}async reschedulePlayback(e,i=0){var r;await Yv(this._instrument,()=>this.initInstrument(),((r=this.matrix)==null?void 0:r.notes)??[],this.matrix??null,this.collapsed,this.mute,this.shouldPlay,this._scheduledAnimations,e,i)}async exportToOffline(e,i){var n;const r=i??((n=this.matrix)==null?void 0:n.notes);!r||r.length===0||await jg(this.instrumentName,this.context,this.destination,r,this._volume,this._pan,e)}playNote(e,i,r=100,n=!1){return Ip(this.instrumentName,e,i,r,n,null,At(),this.destination,this.volume,this.pan)}updateTotalMeasures(){this.matrix&&this.matrix.setMeasures(ca())}updateBeatsPerMeasure(){this.matrix&&this.matrix.setBeatsPerMeasure(da())}redraw(){var e;(e=this.matrix)==null||e.requestRedraw()}getState(){return this.matrix?{notes:[...this.matrix.notes],config:{...this.config},instrument:this.instrumentName}:{notes:[],config:this.config,instrument:this.instrumentName}}setState({notes:e,config:i,instrument:r,volume:n,pan:s}){this.matrix&&(this.matrix.setNotes(e),Object.assign(this.config,i),typeof n=="number"&&(this.volume=n),typeof s=="number"&&(this.pan=s),r&&(this.instrumentName=r),this.redraw())}updateNotesFromTrackMap(e){this.matrix&&this.matrix.notes.splice(0,this.matrix.notes.length,...e.n.map(([i,r,n,s=100])=>({pitch:i,start:r,duration:n,velocity:s})))}updateNoteRange(e){ds({config:this.config,container:this.container,matrix:this.matrix,instrumentName:this.instrumentName,colorIndex:this.colorIndex,getNotes:()=>{var i;return((i=this.matrix)==null?void 0:i.notes)??[]}},e)}updateToDrumNoteRange(){Wg({config:this.config,container:this.container,matrix:this.matrix,instrumentName:this.instrumentName,colorIndex:this.colorIndex,getNotes:()=>{var e;return((e=this.matrix)==null?void 0:e.notes)??[]}})}setRegistry(e){this._registry=e}destroy(){var e,i,r;this.stopScheduledNotes(),(e=this.matrix)==null||e.destroy(),(i=this.container)==null||i.remove(),ve.allSequencers=ve.allSequencers.filter(n=>n!==this),(r=this._registry)==null||r.clear(),this._instrument=null,this.matrix=void 0,this.container=null,this.refreshPanUI=void 0,this.refreshVolumeUI=void 0}};ve.allSequencers=[];let Wr=ve,et,Rt,oc,lc,St,Ce,De="sf2";function Zv(){et=document.getElementById("instrument-select-modal"),Rt=document.getElementById("instrument-select"),oc=document.getElementById("instrument-select-confirm"),lc=document.getElementById("instrument-cancel-btn"),St=document.getElementById("instrument-engine-select"),Ce=document.getElementById("instrument-library-select"),Qv(),e0()}function Qv(){const t=Fp();St.innerHTML="",t.forEach(e=>{const i=document.createElement("option");i.value=e,i.textContent=e.toUpperCase(),St.appendChild(i)}),St.value=De}function e0(){St.addEventListener("change",async()=>{De=St.value,await dc()}),Ce.addEventListener("change",()=>{const t=new CustomEvent("instrument-library-change",{detail:{preselect:null}});Ce.dispatchEvent(t)}),Ce.addEventListener("instrument-library-change",async t=>{var n;const e=t,i=Ce.value,r=((n=e.detail)==null?void 0:n.preselect)??null;try{const s=await Dp(i,De);Rt.innerHTML="",s.forEach(a=>{const o=document.createElement("option");o.value=`${De}/${i}/${a}`,o.textContent=a.split("_").map(l=>l?l[0].toUpperCase()+l.slice(1):"").join(" "),Rt.appendChild(o)}),r?Rt.value=r:s.length>0&&(Rt.value=`${De}/${i}/${s[0]}`)}catch(s){console.error(`Failed to load instruments for library: ${i}`,s)}}),oc.addEventListener("click",t0),lc.addEventListener("click",i0)}async function dc(t=null,e=null){try{const i=await Op(De);Ce.innerHTML="",i.forEach(n=>{const s=document.createElement("option");s.value=n,s.textContent=n.replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()),Ce.appendChild(s)}),t&&i.includes(t)?Ce.value=t:i.length>0&&(Ce.value=i[0]);const r=new CustomEvent("instrument-library-change",{detail:{preselect:e}});Ce.dispatchEvent(r)}catch(i){console.error("Failed to refresh libraries for engine:",De,i)}}async function fa(t,e){const[i,r,n]=t.split("/");De=i||"sf2",St.value=De,e!==void 0?et.dataset.currentSequencer=String(e):delete et.dataset.currentSequencer,await dc(r,t)}async function t0(){const t=Rt.value;et.classList.add("hidden");const e=Number(et.dataset.currentSequencer);if(et.dataset.currentSequencer!==void 0&&!isNaN(e)){const i=d0(e);if(i){D(hg(i.id,t),fg(i.id,i.instrumentName)),i.setInstrument(t);return}console.warn(`Failed to find sequencer with ID ${e}`);return}if(et.dataset.currentSequencer===void 0)try{return await Ql(t),window.dispatchEvent(new CustomEvent("global-instrument-selected",{detail:{fullName:t}})),t}catch(i){console.error("Failed to load global instrument:",t,i)}}function i0(){et.classList.add("hidden")}function r0(t,e){var f;const i=(f=t.querySelector(".volume-fill"))==null?void 0:f.parentElement,r=t.querySelector(".volume-fill"),n=t.querySelector(".volume-thumb");let s=!1,a=!1,o=!1,l=null;if(!i||!r){console.warn("[setupVolumeBar] Volume bar or fill element missing.");return}function c(){const h=Math.max(0,Math.min(1,e.volume)),m=100/127,g=i.clientWidth,y=14,p=0,_=g-y,M=h*g,v=Math.max(p,Math.min(_,M-y/2)),w=Math.round(h*100);r.style.width=`${w}%`,n.style.left=`${v}px`;const S=Math.round(h/m*100);i.setAttribute("title",`Volume: ${S}%`),h>m?(r.classList.add("overdrive"),n.classList.add("overdrive")):(r.classList.remove("overdrive"),n.classList.remove("overdrive"))}function d(){a?(r.classList.add("precise"),n.classList.add("precise")):(r.classList.remove("precise"),n.classList.remove("precise"))}e.refreshVolumeUI=c,requestAnimationFrame(c);function u(h){const m=i.getBoundingClientRect(),g=h-m.left,y=100/127,p=.1;let _=Math.max(0,Math.min(1,g/m.width));return!a&&Math.abs(_-y)<p?(_=y,!s&&navigator.vibrate&&navigator.vibrate(10),s=!0):s=!1,e.volume=_,c(),_}i.addEventListener("mousedown",h=>{o=!0,a=h.shiftKey,l=e.volume,d(),u(h.clientX),h.preventDefault()}),window.addEventListener("mousemove",h=>{o&&(a=h.shiftKey,d(),u(h.clientX))}),window.addEventListener("mouseup",h=>{if(!o)return;o=!1;const m=u(h.clientX);l!==null&&m!==l&&D(mg(e.id,m),yg(e.id,l)),a=!1,d(),r.classList.remove("precise"),n.classList.remove("precise"),c(),l=null})}function n0(t,e){var f;const i=(f=t.querySelector(".pan-fill"))==null?void 0:f.parentElement,r=t.querySelector(".pan-fill"),n=t.querySelector(".pan-thumb");let s=!1,a=!1,o=!1,l=null;if(!i||!r){console.warn("[setupPanBar] Pan bar or fill element missing.");return}function c(){const h=Math.max(-1,Math.min(1,e.pan)),m=(h+1)/2,g=i.clientWidth,y=14,p=0,_=g-y,M=m*g,v=Math.max(p,Math.min(_,M-y/2)),w=Math.round(m*100);r.style.width=`${w}%`,n.style.left=`${v}px`;const S=Math.round(h*100);i.setAttribute("title",`Pan: ${S}%`)}e.refreshPanUI=c;function d(){a?(r.classList.add("precise"),n.classList.add("precise")):(r.classList.remove("precise"),n.classList.remove("precise"))}requestAnimationFrame(c);function u(h){const m=i.getBoundingClientRect(),g=h-m.left;let p=Math.max(0,Math.min(1,g/m.width))*2-1;const _=0;return!a&&Math.abs(p-_)<.05?(p=_,!s&&navigator.vibrate&&navigator.vibrate(10),s=!0):s=!1,e.pan=p,c(),p}i.addEventListener("mousedown",h=>{o=!0,a=h.shiftKey,l=e.pan,d(),u(h.clientX),h.preventDefault()}),window.addEventListener("mouseup",h=>{if(!o)return;o=!1;const m=u(h.clientX);l!==null&&m!==l&&D(vg(e.id,m),_g(e.id,l)),a=!1,d(),r.classList.remove("precise"),n.classList.remove("precise"),c(),l=null}),window.addEventListener("mousemove",h=>{o&&(a=h.shiftKey,d(),u(h.clientX))})}class s0{constructor(){this.listeners=[]}on(e,i,r,n){e.addEventListener(i,r,n),this.listeners.push({target:e,type:i,handler:r,options:n})}clearHandler(e,i,r){for(let n=this.listeners.length-1;n>=0;n--){const s=this.listeners[n];s.target===e&&s.type===i&&s.handler===r&&(e.removeEventListener(i,r,s.options),this.listeners.splice(n,1))}}clear(){for(const{target:e,type:i,handler:r,options:n}of this.listeners)e.removeEventListener(i,r,n);this.listeners.length=0}}const j=[],a0=document.getElementById("sequencers-container"),o0=document.getElementById("sequencer-template"),l0=document.getElementById("add-sequencer");function cc(t){const e=new s0,r=o0.content.cloneNode(!0).querySelector(".sequencer");a0.insertBefore(r,l0);const n=j.length,s={id:n,...Vi},a=(t==null?void 0:t.instrument)||"sf2/fluidr3-gm/acoustic_grand_piano",o=new Wr(r,s,ee(),$t(),a,!0,n);o.id=n,o.colorIndex=n,o.mute=!1,o.solo=!1,o.volume=100/127,t!=null&&t.notes&&o.matrix&&o.matrix.setNotes(t.notes);const l=r.querySelector("canvas.mini-contour");t&&o.setState({notes:t.notes,config:{},instrument:t.instrument,volume:t.volume,pan:t.pan}),Ki(l,o.notes,o.config,o.colorIndex),o.miniContour=l,o.updateTrackLabel(),o.initInstrument(),r0(r,o),n0(r,o);const c=r.querySelector(".collapse-btn"),d=c.querySelector("use"),u=r.querySelector(".sequencer-body");o.body=u,o.collapseIcon=d,e.on(c,"click",()=>{tc(o,!o.collapsed)});const f=r.querySelector(".delete-btn");e.on(f,"click",()=>{const p=document.getElementById("delete-confirm-modal"),_=document.getElementById("delete-confirm"),M=document.getElementById("delete-cancel");p.classList.remove("hidden");const v=()=>{D(Vd(o.id,o.instrumentName,o.notes,o.volume,o.pan),Wd(o.id,o.instrumentName,o.notes,o.volume,o.pan)),S()},w=()=>S(),S=()=>{p.classList.add("hidden"),e.clearHandler(_,"click",v),e.clearHandler(M,"click",w)};e.on(_,"click",v),e.on(M,"click",w)});const h=r.querySelector(".mute-btn"),m=r.querySelector(".solo-btn"),g=r.querySelector(".instrument-select-btn"),y=(p,_)=>p.classList.toggle("side-button-activated",_);return e.on(h,"click",()=>{o.toggleMute(),y(h,o.mute),y(m,o.solo)}),e.on(m,"click",()=>{o.toggleSolo(),y(h,o.mute),y(m,o.solo)}),e.on(g,"click",async()=>{const p=o.instrumentName||"sf2/fluidr3-gm/acoustic_grand_piano";await fa(p,o.id),document.getElementById("instrument-select-modal").classList.remove("hidden")}),zg(r,o.matrix,e),Kg(r,()=>{var p;return(p=o.matrix)==null?void 0:p.zoomIn()},()=>{var p;return(p=o.matrix)==null?void 0:p.zoomOut()},()=>{var p;return(p=o.matrix)==null?void 0:p.resetZoom()},e),j.push(o),o.setRegistry(e),o.setCollapsed(!1),{seq:o,wrapper:r}}function Bt(){return j}function d0(t){const e=t;return j.find(i=>i.id===e)}function c0(){var t,e;for(const i of j.slice())D(Vd(i.id,i.instrumentName,((t=i.matrix)==null?void 0:t.getNoteManager().getAll())??[],i.volume,i.pan),Wd(i.id,i.instrumentName,((e=i.matrix)==null?void 0:e.getNoteManager().getAll())??[],i.volume,i.pan))}function uc(){return Bt()}function u0(){J("Sequencer Dump",uc())}const h0=Object.freeze(Object.defineProperty({__proto__:null,dumpSequencers:u0,getSequencers:uc},Symbol.toStringTag,{value:"Module"}));function hc(){return H()}function f0(){J("App State Dump",hc())}const p0=Object.freeze(Object.defineProperty({__proto__:null,dumpState:f0,getAppState:hc},Symbol.toStringTag,{value:"Module"}));function m0(){const t=Object.create(null);return Object.assign(t,h0,p0),t}const y0="SEQUENZIA_DEV";function g0(){if(typeof window>"u")return;localStorage.getItem(y0)==="true"&&!Sn()&&(Qa(),console.info("[SEQUENZIA] Dev mode re-enabled from localStorage")),window.toggleDevMode=()=>{const e=!Sn();e?Qa():zh(),console.info(`[SEQUENZIA] Dev mode ${e?"enabled":"disabled"}`),e?No():delete window.DEVTOOLS},Sn()&&No()}function No(){window.DEVTOOLS=m0()}function v0(){window.addEventListener("contextmenu",t=>t.preventDefault()),window.addEventListener("dragstart",t=>t.preventDefault()),window.addEventListener("selectstart",t=>t.preventDefault()),window.addEventListener("drop",t=>t.preventDefault()),window.addEventListener("dragover",t=>t.preventDefault()),window.addEventListener("keydown",t=>{const e=[" ","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Tab","Home","End","PageUp","PageDown"],i=t.metaKey,r=t.ctrlKey;(e.includes(t.key)||(i||r)&&["s","p"].includes(t.key.toLowerCase()))&&t.preventDefault()})}function fc(t,e){const i=t.getContext("2d");if(!i)return;const r=window.devicePixelRatio||1,n=t.width/r,s=t.height/r;i.clearRect(0,0,n,s);const a=xe();for(const o of e){const{notes:l,config:c}=o;if(!(l!=null&&l.length))continue;const d=ei[e.indexOf(o)%ei.length];i.fillStyle=d;const u=Z(c.noteRange[0]),f=Z(c.noteRange[1]);if(u==null||f==null)continue;const h=f-u||1,m=Math.max(2,s/h);for(const g of l){const y=Z(g.pitch);if(y==null)continue;const p=g.start/a*n,_=Math.max(1,g.duration/a*n),M=(y-u)/h,v=s-M*s-m/2;i.fillRect(p,v,_,m)}}}function _0(t,e){fc(t,e)}function pc(){const t=document.getElementById("global-mini-contour");t&&fc(t,j)}function b0(t,e,i,r=!0){const n=t.getInteractionStore();let s=new Set;if(r){const a=n.getSelectedNotes();s=new Set(a.map(o=>`${o.pitch}:${o.start}:${o.duration}:${o.velocity}`))}if(t.setNotes(structuredClone(e)),t.getNoteManager().rebuildIndex(),r&&s.size>0){const a=t.notes.filter(o=>s.has(`${o.pitch}:${o.start}:${o.duration}:${o.velocity}`));n.setSelectedNotes(a)}if(R!=null&&R.isActive()){const a=R.getStartTime(),o=R.getStartBeat();i.reschedulePlayback(a,o)}t.requestRedraw()}function M0(t,e){return t!==void 0&&e!==void 0&&t===e}function w0(t=H()){var i;aa(t.tempo,!1),oa(t.timeSignature[0],!1),la(t.totalMeasures,!1);for(const r of j)r.updateTotalMeasures();for(const r of t.sequencers){const n=j.find(s=>M0(s.id,r.id));if(n){n.instrumentName=r.instrument,typeof r.volume=="number"&&(n.volume=r.volume),typeof r.pan=="number"&&(n.pan=r.pan);const s=(i=n.container)==null?void 0:i.querySelector("canvas.mini-contour");s&&Ki(s,r.notes,n.config,n.colorIndex),n.matrix&&b0(n.matrix,r.notes,n,!0)}else{const s={id:r.id,instrument:r.instrument,notes:structuredClone(r.notes),volume:r.volume,pan:r.pan};cc(s)}}document.getElementById("global-mini-contour")&&pc()}class S0{constructor(e){this.startTime=0,this.startBeat=0,this.isPlaying=!1,this.animationFrameId=null,this.onResumeCallback=null,this.onStopCallback=null,this.tick=()=>{var n;if(!this.isPlaying)return;const i=this.getCurrentBeat(),r=xe();if(i>=r)if(qg())this.seek(0),this.start();else{this.stop(),(n=this.onStopCallback)==null||n.call(this);return}this.animationFrameId=requestAnimationFrame(this.tick)},this.context=ee(),this.sequencers=e}setOnResumeCallback(e){this.onResumeCallback=e}setOnStopCallback(e){this.onStopCallback=e}getCurrentBeat(){if(!this.isPlaying)return this.startBeat;const e=60/Ke();return(this.context.currentTime-this.startTime)/e+this.startBeat}async start(){const e=this.context.currentTime+.1;this.startTime=e,this.startBeat=0,this.isPlaying=!0,await this.scheduleAll(e,this.startBeat),this.context.state==="suspended"&&await this.context.resume(),this.animationFrameId=requestAnimationFrame(this.tick)}async pause(){if(!this.isPlaying)return;const e=this.getCurrentBeat();for(const i of this.sequencers)i.stopScheduledNotes();await this.context.suspend(),this.startBeat=e,this.isPlaying=!1,this.animationFrameId&&cancelAnimationFrame(this.animationFrameId)}async resume(){var r;if(this.isPlaying)return;await this.context.resume();const i=this.context.currentTime+.05;this.startTime=i,await this.scheduleAll(i,this.startBeat),this.isPlaying=!0,(r=this.onResumeCallback)==null||r.call(this),this.animationFrameId=requestAnimationFrame(this.tick)}stop(){for(const e of this.sequencers)e.stopScheduledNotes();this.isPlaying=!1,this.startBeat=0,this.startTime=0,this.animationFrameId&&cancelAnimationFrame(this.animationFrameId)}seek(e){this.startBeat=e,this.startTime=this.context.currentTime;const i=this.isPlaying;if(this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),i){const r=this.context.currentTime+.05;this.startTime=r,this.scheduleAll(r,this.startBeat).then(()=>{this.animationFrameId=requestAnimationFrame(this.tick)}),this.context.state==="suspended"&&this.context.resume(),this.isPlaying=!0}else this.isPlaying=!1}syncAfterTempoChange(e){const i=this.context.currentTime,r=60/e,n=(i-this.startTime)/r+this.startBeat;this.startBeat=n,this.startTime=i}setSequencers(e){this.sequencers=e}isActive(){return this.isPlaying}getStartTime(){return this.startTime}getStartBeat(){return this.startBeat}async scheduleAll(e,i){for(const r of this.sequencers)r.shouldPlay?await r.preparePlayback(e,i):r.stopScheduledNotes()}}function mc(t){const e=[];for(const i of t)Array.isArray(i)?e.push(...mc(i)):i!=null&&i!==!1&&e.push(i);return e}function b(t,e={},...i){const r=document.createElement(t);for(const[s,a]of Object.entries(e))if(!(a==null||a===!1))if(s==="class"||s==="className")r.className=a;else if(s==="style"&&typeof a=="object")for(const[o,l]of Object.entries(a))l!=null&&(r.style[o]=l);else if(s==="dataset"&&typeof a=="object")for(const[o,l]of Object.entries(a))r.dataset[o]=String(l);else s.startsWith("data-")?r.setAttribute(s,String(a)):s.startsWith("on")&&typeof a=="function"?r.addEventListener(s.slice(2).toLowerCase(),a):s in r?r[s]=a:r.setAttribute(s,String(a));const n=mc(i);for(const s of n)r.appendChild(typeof s=="string"?document.createTextNode(s):s);return r}function C0(t,e=[],i="w-[1276px]"){const r=t.id||"bottom-drawer",n=t.ariaLabel||"Bottom drawer",s=t.edgeOffsetClass||"bottom-[60px]",a=t.drawerClassOverride||"",o=i.toString(),l=K(),c=b("div",{id:r,class:["fixed bottom-0 left-1/2 translate-x-[-50%] z-40",o,"overflow-y-auto","rounded-t-lg",l.menuBackground,l.textColor,"transition-transform","translate-y-0","border-t border-gray-200 dark:border-gray-700 pb-[20px]",s,a].join(" "),"aria-labelledby":`${r}-label`,"data-drawer-placement":"bottom","data-drawer-edge":"true","data-drawer-edge-offset":s}),d=b("div",{class:[t.toggleHandleHeightClass,"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700"].join(" ")},b("span",{class:"absolute w-8 h-1 -translate-x-1/2 bg-gray-300 rounded-lg top-3 left-1/2 dark:bg-gray-600"}),b("h5",{id:`${r}-label`,class:"inline-flex items-center text-base text-gray-500 dark:text-gray-400 font-medium"},n));c.appendChild(d),e.forEach(f=>c.appendChild(f));const u=new Ns(c,{placement:"bottom",edge:!0,edgeOffset:s,backdrop:!1,bodyScrolling:!0},{id:r,override:!0});return u.show(),d.addEventListener("click",()=>{u.toggle()}),c}const P0="w-[1260px]",Tn=1100,N0=[{value:"4",label:"",title:"Whole"},{value:"2",label:"",title:"Half"},{value:"1",label:"",title:"Quarter"},{value:"0.5",label:"",title:"Eighth"},{value:"0.25",label:"",title:"Sixteenth"},{value:"0.125",label:"",title:"32nd"}];class k0{constructor(){this.globalPlayheadRow=b("div",{id:"global-playhead-row",class:"w-full mb-2"}),this.globalToolsRow=b("div",{id:"global-tools-row",class:"w-full mb-2"}),this.globalTransportRow=b("div",{id:"global-transport-row",class:"w-full"});const e=C0({id:"global-controls-drawer",ariaLabel:" ",edgeOffsetClass:"bottom-[40px]",toggleHandleHeightClass:"py-2"},[this.globalPlayheadRow,this.globalToolsRow,this.globalTransportRow],P0);this.drawer=e;const i=document.getElementById("footer-main");i?i.appendChild(this.drawer):console.warn("footer-main container not found. GlobalControls not injected.")}render(){return this.drawer}destroy(){this.drawer.remove()}getGlobalPlayheadRow(){return this.globalPlayheadRow}getGlobalToolsRow(){return this.globalToolsRow}getGlobalTransportRow(){return this.globalTransportRow}}function ar(t,e,i){const r=window.devicePixelRatio||1;t.width=e*r,t.height=i*r,t.style.width=`${e}px`,t.style.height=`${i}px`;const n=t.getContext("2d");n&&n.scale(r,r)}const x0=Et("static/svg/icon-caret-up.svg");function L0(){const t=`w-[${Tn}px]`,e="h-[75px]",i=b("div",{class:"relative flex justify-center w-full mt-4"}),r=b("canvas",{id:"global-mini-contour",class:`absolute top-0 left-0 ${t} ${e} z-0`}),n=b("canvas",{id:"global-mini-playhead",class:`absolute top-0 left-0 ${t} ${e} z-10`,style:"cursor: pointer;"}),s=b("div",{class:`relative ${t} ${e} bg-gray-900/80 backdrop-blur-sm shadow-md rounded-xl`},r,n);ar(r,Tn,75),ar(n,Tn,75),new ResizeObserver(()=>{const c=s.getBoundingClientRect(),d=Math.round(c.width),u=Math.round(c.height);ar(r,d,u),ar(n,d,u),pc()}).observe(s);const o=b("img",{id:"global-mini-collapse-icon",src:x0,class:"w-4 h-4",alt:"Expand Mini Contour"}),l=b("button",{id:"global-mini-collapse-btn",class:"absolute right-[calc(50%-600px)] bottom-0 mb-2 p-2 bg-purple-700 text-white text-sm rounded hover:bg-purple-600 transition-colors",style:"cursor: pointer;",title:"Expand Mini Contour"},o);return i.appendChild(s),i.appendChild(l),b("div",{id:"globalControls-miniContour-body",class:"w-full max-w-[1260px] mx-auto"},i)}function pa(t,e=[],i={}){const r=K(),n=i.id||`popover-${Math.random().toString(36).slice(2,9)}`,s=b("div",{id:n,"data-popover":"",role:"tooltip",class:["absolute z-[9999] inline-block w-64 text-sm transition-opacity duration-300","border rounded-lg shadow-xs opacity-0 invisible",r.menuBackground,r.textColor,r.borderColor,"bg-white dark:bg-gray-800"].join(" ")});if(i.title){const u=b("div",{class:["px-3 py-2 border-b rounded-t-lg","bg-gray-100 dark:bg-gray-700","border-gray-200 dark:border-gray-600"].join(" ")},b("h3",{class:"font-semibold text-gray-900 dark:text-white",textContent:i.title}));s.appendChild(u)}const a=b("div",{class:"px-3 py-2"},...e);s.appendChild(a),document.body.appendChild(s);const o={placement:i.placement||"bottom",triggerType:i.triggerType||"click",offset:i.offset??10,onShow:i.onShow??(()=>{}),onHide:i.onHide??(()=>{}),onToggle:i.onToggle??(()=>{})},l={id:n,override:i.overrideInstance??!0},c=new Ls(s,t,o,l);let d=null;return c.updateOnShow(()=>{var u;d=f=>{(f.key==="Escape"||f.key.length===1)&&c.hide()},document.addEventListener("keydown",d,{once:!0}),(u=o.onShow)==null||u.call(o,c)}),c.updateOnHide(()=>{var u;d&&(document.removeEventListener("keydown",d),d=null),(u=o.onHide)==null||u.call(o,c)}),{trigger:t,content:s,instance:c}}function z(t,e){return b("img",{src:Et(`static/svg/${t}.svg`),class:"w-6 h-6",alt:e})}const E0=[{id:"velocity-tool",label:"Velocity Tool",iconName:"icon-cog",hotkey:"V"},{id:"quantize-tool",label:"Quantize Tool",iconName:"icon-cog",hotkey:"Q",disabled:!0},{id:"transpose-tool",label:"Transpose Tool",iconName:"icon-cog",hotkey:"T",disabled:!0},{id:"chordifier",label:"Chordifier",iconName:"icon-adjustments-vertical",hotkey:"Shift+C",disabled:!0},{id:"humanizer",label:"Humanizer",iconName:"icon-adjustments-vertical",hotkey:"Shift+H",disabled:!0}];function A0(){const t=K(),e=b("button",{id:"note-editing-options-btn",class:"bg-gray-800 px-3 py-1 rounded text-white hover:bg-purple-700 w-[52px] h-[42px] flex items-center justify-center",style:"cursor: pointer;",title:"Tools"},z("icon-chart-bar","Editing"));let i;const r=[b("div",{class:"max-h-72 overflow-y-auto flex flex-col gap-1"},...E0.flatMap((a,o)=>{const l=o===2,c=b("button",{class:["flex items-center justify-between gap-2 px-3 py-2 text-sm rounded text-left transition-colors",a.disabled?"text-gray-500 bg-gray-700/30 cursor-not-allowed opacity-50":"text-white hover:bg-purple-700 cursor-pointer"].join(" "),...a.disabled?{}:{onClick:()=>{const d=new CustomEvent("editor-invoke",{detail:{editorId:a.id},bubbles:!0});e.dispatchEvent(d),requestAnimationFrame(()=>{i==null||i.hide()})}}},b("div",{class:"flex items-center gap-2"},z(a.iconName,a.label),b("span",{textContent:a.label})),a.hotkey?b("span",{class:"text-xs text-gray-400 font-mono",textContent:a.hotkey}):null);return l?[c,b("div",{class:`my-2 border-t ${t.borderColor} mx-2`})]:[c]}))];i=pa(e,r,{title:"Tools",placement:"bottom",triggerType:"click"}).instance;let s=null;return i.updateOnShow(()=>{s=a=>{(a.key==="Escape"||a.key.length===1)&&(i==null||i.hide())},document.addEventListener("keydown",s,{once:!0})}),i.updateOnHide(()=>{s&&(document.removeEventListener("keydown",s),s=null)}),e}function zt(t){const{id:e,label:i,stateA:r,stateB:n,tooltipTrigger:s,inline:a}=t,o=K(),l=r?b("span",{class:`text-sm transition-opacity ${o.textColor}`,textContent:r}):null,c=b("span",{class:`text-sm transition-opacity ${o.textColor}`,textContent:n}),d=b("input",{id:e,type:"checkbox",class:"sr-only peer"}),u=b("div",{class:["w-11 h-6 rounded-full peer relative",o.toggleTrackBase,o.toggleTrackChecked,'after:content-[""] after:absolute after:top-[2px] after:left-[2px]',"after:bg-white after:border after:rounded-full","after:h-5 after:w-5 after:transition-all",o.toggleKnobBase,o.toggleKnobChecked,"peer-checked:after:translate-x-full"].join(" ")}),f=()=>{const y=d.checked;l&&(l.style.opacity=y?"0.5":"1"),c.style.opacity=y?"1":"0.5"};d.addEventListener("change",f);const h=[];l&&h.push(l),h.push(b("label",{class:"relative inline-flex items-center cursor-pointer"},d,u)),h.push(c),s&&h.push(s);const m=b("div",{class:"flex items-center gap-3"},...h),g=a?m:b("div",{class:"mb-6"},i?b("label",{class:`block text-sm font-medium mb-2 ${o.textColor}`,textContent:i}):null,m);return requestAnimationFrame(f),{element:g,input:d,setChecked:y=>{d.checked=y,f()},getChecked:()=>d.checked,update:f}}function Ut(t){const e=K();return b("span",{class:`font-semibold ${e.accentColor} rounded text-xs`,textContent:t})}function ne(...t){const e=K();return b("p",{class:`text-sm leading-relaxed ${e.textColor}`},...t)}function Vt(t,e="?",i){const r=K(),n=b("span",{"data-tooltip-target":t,tabIndex:-1,class:[`${r.textColor} border border-white/40`,"hover:bg-white/10","font-medium rounded-full text-xs px-2 py-[2px]","pointer-events-auto select-none","cursor-default","focus:outline-none focus:ring-0","aria-hidden"].join(" ")},e),s=Array.isArray(i)?i.map(o=>typeof o=="string"?ne(o):o):[typeof i=="string"?ne(i):i],a=b("div",{id:t,role:"tooltip",class:["absolute z-10 invisible inline-block max-w-xs px-4 py-3 text-sm",`${r.textColor} transition-opacity duration-300 ${r.surfaceBackground} rounded-lg shadow-xs`,"opacity-0 tooltip"].join(" ")},b("div",{class:"space-y-2"},...s),b("div",{class:"tooltip-arrow","data-popper-arrow":""}));return{trigger:n,tooltip:a}}function B0(){const t=K(),e=b("button",{id:"note-placement-options-btn",class:"bg-gray-800 px-3 py-1 rounded text-white hover:bg-purple-700 w-[52px] h-[42px] flex items-center justify-center",title:"Grid Settings",style:"cursor: pointer;"},z("icon-music","Placement")),i=Vt("tooltip-grid-guides","?",[ne(Ut("Key Grid Highlighting:")," colors each piano roll row based on the current song key."),ne("In-key notes are shown as white rows. Out-of-key notes are shown as black rows.")]),r=zt({id:"toggle-grid-guides",stateA:"Off",stateB:"Transpose Grid to Key",inline:!0,tooltipTrigger:i.trigger});r.input.addEventListener("change",()=>{Yy(r.getChecked())});const n=Vt("tooltip-snap-to-key","?",[ne(Ut("Snap to Key:")," constrains vertical note placement to notes in the current key."),ne("Hold ",Ut("CTRL")," while placing notes to temporarily allow chromatic input.")]),s=zt({id:"toggle-snap-key",stateA:"Off",stateB:"Snap Notes to Key",inline:!0,tooltipTrigger:n.trigger});s.input.addEventListener("change",()=>{Qy(s.getChecked())});const a=Vt("tooltip-snap-to-grid","?",[ne(Ut("Snap to Grid:")," constrains horizontal note placement to musical durations."),ne("Notes will align to the selected beat value (e.g. quarter, eighth, sixteenth).")]),o=zt({id:"toggle-snap-grid",stateA:"Off",stateB:"Snap Notes to Grid",inline:!0,tooltipTrigger:a.trigger});o.input.addEventListener("change",()=>{Zy(o.getChecked())});const l=()=>{r.setChecked(Ud()),s.setChecked(sn()),o.setChecked(Hd())},c=[b("div",{class:"mb-1"},r.element),i.tooltip,b("div",{class:`my-2 border-t ${t.borderColor} mb-3 mx-2`}),b("div",{class:"mb-1"},s.element),n.tooltip,b("div",{class:"mt-1"},o.element),a.tooltip];return pa(e,c,{title:"Grid Settings",placement:"bottom",triggerType:"click",onShow:()=>requestAnimationFrame(l)}),{trigger:e,refreshToggles:l}}function T0(){const t=B0();return{element:b("div",{class:"flex flex-wrap justify-center items-center gap-4 p-4"},b("div",{class:"flex items-center gap-1 px-3 py-2 rounded-xl bg-gray-900/80 backdrop-blur-sm shadow-md cursor-pointer"},b("button",{id:"note-mode-btn",class:"bg-blue-600 px-3 py-1 rounded text-white hover:bg-blue-700 text-sm font-semibold w-[52px] h-[42px] flex items-center justify-center",style:"cursor: pointer;",title:"Note Options Toolbar"},z("icon-pen","Note Mode")),b("button",{id:"ai-mode-btn",class:"bg-gray-800 px-3 py-1 rounded text-white hover:bg-purple-700 text-sm font-semibold w-[52px] h-[42px] flex items-center justify-center",style:"cursor: pointer;",title:"AI Options Toolbar"},z("icon-brain-white","AI Mode"))),b("div",{class:"flex items-center gap-1 px-3 py-2 rounded-xl bg-gray-900/80 backdrop-blur-sm shadow-md cursor-pointer"},t.trigger,A0()),b("div",{class:"flex items-center gap-1 px-3 py-2 rounded-xl bg-gray-900/80 backdrop-blur-sm shadow-md"},...N0.map((i,r)=>b("button",{class:["bg-transparent hover:bg-gray-700","text-white","cursor-pointer px-3 py-1 rounded text-2xl","w-[52px] h-[42px] flex items-center justify-center"].join(" "),"data-value":i.value,title:`${i.title} (${r+1} or Shift+${r+1})`},i.label))),b("div",{class:"flex items-center gap-1 px-3 py-2 rounded-xl bg-gray-900/80 backdrop-blur-sm shadow-md"},b("button",{id:"dotted-note-btn",class:["bg-transparent hover:bg-purple-700","text-white","cursor-pointer px-3 py-1 rounded text-2xl font-semibold","w-[52px] h-[42px] flex items-center justify-center"].join(" "),title:"Toggle Dotted Note (.)"},""),b("button",{id:"triplet-note-btn",class:["bg-transparent hover:bg-purple-700","text-white","cursor-pointer px-3 py-1 rounded text-2xl font-semibold","w-[52px] h-[42px] flex items-center justify-center"].join(" "),title:"Toggle Triplet (/)"},""))),refreshGridSettings:t.refreshToggles}}function I0(){const t=b("div",{class:"fixed left-[calc(50%-678px)] bottom-[20px] flex flex-col gap-2 z-[9999]"},b("button",{id:"footer-help-btn",class:"side-button side-button-info",title:"Help / Documentation"},z("icon-lightbulb","Help")),b("button",{id:"footer-whats-new-btn",class:"side-button side-button-info",title:"What's New / Release Notes"},z("icon-circle-plus","What's New")));return document.body.appendChild(t),t}function ko(){const t=K();return b("div",{class:["h-12 w-px",t.accentColor,"shadow-inner","rounded-full"].join(" ")})}function Gt(t,e,i,r,n){return b("button",{id:t,title:e,class:["w-12 h-12 flex items-center justify-center rounded-full cursor-pointer shadow transition-all hover:scale-110","text-white",r,n].join(" ")},i)}function In(t){const{id:e,value:i,min:r,max:n,onInput:s}=t,a=K();return b("input",{id:e,type:"number",value:String(i),min:r==null?void 0:r.toString(),max:n==null?void 0:n.toString(),class:["w-[72px] h-[40px] px-2 rounded text-sm font-semibold",a.surfaceBackground,a.textColor,a.borderColor].join(" "),oninput:s})}function he(t,e){const i=K();if(typeof t=="string")return b("label",{class:`block text-sm font-medium mb-2 flex items-center gap-2 ${i.textColor}`},t,e??null);const{text:r,for:n,trailingElement:s}=t;return b("label",{...n?{htmlFor:n}:{},class:`block text-sm font-medium mb-2 flex items-center gap-2 ${i.textColor}`},r,s??null)}function ai(t="4"){return b("div",{class:`inline-block w-${t}`})}function V({id:t,text:e,kind:i="primary",onClick:r,additionalClasses:n=""}){const s=K(),a={primary:s.buttonPrimaryColor,secondary:s.buttonSecondaryColor,tertiary:s.buttonTertiaryColor}[i],o={primary:s.buttonPrimaryColorHover,secondary:s.buttonSecondaryColorHover,tertiary:s.buttonTertiaryColorHover}[i];return b("button",{id:t,class:["cursor-pointer flex-1 py-2 rounded-lg transition-all text-sm",a,o,s.textColor,n].join(" "),textContent:e,onclick:r})}function G0(){const t=K();return b("div",{class:["w-full h-px",t.accentColor,"shadow-inner","rounded-full","my-2"].join(" ")})}const O0=["C","D","E","F","G","A","B"],D0=["C#","D#","","F#","G#","A#",""];function F0(){return ec()??"CM"}function Gn(t){const e=t.endsWith("m")?"m":"M";return[t.slice(0,t.length-1),e]}function R0(){K();let[t,e]=Gn(F0());const i=V({id:"key-selector-trigger",text:`${t}${e}`,kind:"secondary",additionalClasses:"w-14 px-2 py-[10px] text-center truncate"}),r=(d,u)=>{if(d==="")return;t=d,e=u;const f=`${d}${u}`;Qd(f),i.textContent=f,l()},n=b("div",{class:"flex w-full mt-2 gap-[6px]"},...O0.map(d=>b("button",{class:On(d,t),onClick:()=>r(d,e)},d))),s=b("div",{class:"flex w-full mb-1 gap-[6px] translate-x-[22px]"},...D0.map(d=>d===""?b("div",{class:"w-8"}):b("button",{class:On(d,t),onClick:()=>r(d,e)},d))),a=zt({id:"key-mode-toggle",stateA:"Major",stateB:"Minor",inline:!0});a.setChecked(e==="m"),a.input.addEventListener("change",()=>{const d=a.getChecked()?"m":"M";r(t,d)});const o=[s,n,G0(),a.element],l=()=>{[...n.children,...s.children].forEach(u=>{if(!(u instanceof HTMLButtonElement))return;const f=u.textContent||"";u.className=On(f,t)}),a.setChecked(e==="m")};return pa(i,o,{title:"Key Selector",placement:"bottom",triggerType:"click"}),on(d=>{const[u,f]=Gn(d.songKey);t=u,e=f,i.textContent=d.songKey,l()}),{trigger:i,refreshUI:()=>{const[d,u]=Gn(ec());t=d,e=u,i.textContent=`${d}${u}`,l()}}}function On(t,e){return["w-8 h-8 rounded-full text-xs flex items-center justify-center","transition-all duration-150","cursor-pointer focus:outline-none","text-white",t===e?"bg-cyan-600 ring-2 ring-white":"bg-gray-600 hover:bg-gray-500 hover:ring-1 hover:ring-white"].join(" ")}function U0(){const t=zt({id:"loop-toggle",stateB:"Loop",inline:!0}),e=R0();return{element:b("div",{class:"flex justify-center items-center gap-4 flex-wrap"},b("div",{class:"flex items-center gap-2"},Gt("play-button","Play/Pause",z("icon-play","Play"),"bg-blue-600","hover:bg-blue-700"),Gt("stop-button","Stop",z("icon-stop","Stop"),"bg-blue-600","hover:bg-blue-700"),ai("4"),Gt("record-button","Record",z("icon-record","Record"),"bg-red-600","hover:bg-red-700"),ai("4"),t.element,ai("4"),ko()),b("div",{class:"flex items-center gap-4 px-3 py-2 rounded-xl bg-gray-900/80 backdrop-blur-sm shadow-md"},b("div",{class:"flex flex-col items-start gap-1"},he("Key"),e.trigger),b("div",{class:"flex flex-col items-start gap-1"},he("Tempo"),In({id:"tempo-input",min:20,max:300,value:120})),b("div",{class:"flex flex-col items-start gap-1"},he("Measures"),In({id:"measures-input",min:1,max:1e3,value:8})),b("div",{class:"flex flex-col items-start gap-1"},he("Beats"),In({id:"beats-per-measure-input",min:1,max:16,value:4}))),ko(),b("div",{class:"flex items-center gap-2"},ai("4"),Gt("save-button","Save",z("icon-save","Save"),"bg-green-600","hover:bg-green-700"),Gt("load-button","Load",z("icon-load","Load"),"bg-yellow-600","hover:bg-yellow-700"),ai("4"),Gt("config-button","User Settings",z("icon-user-settings","Settings"),"bg-purple-600","hover:bg-purple-700"))),refreshToggles:()=>{e.refreshUI()}}}const H0=Et("static/svg/icon-caret-up.svg"),q0=Et("static/svg/icon-caret-down.svg");function j0(t){var c;const e=()=>{},i=(c=t.querySelector("#global-mini-contour"))==null?void 0:c.parentElement,r=t.querySelector("#global-mini-collapse-btn"),n=t.querySelector("#global-mini-collapse-icon"),s=300,a=75;let o=!0;const l=()=>{if(!i||!r||!n)return;o=!o,i.style.height=o?`${a}px`:`${s}px`,i.querySelectorAll("canvas").forEach(u=>{u.style.height=o?`${a}px`:`${s}px`}),n.src=o?H0:q0,r.title=o?"Expand Mini Contour":"Collapse Mini Contour"};return r==null||r.addEventListener("click",l),{detach:()=>{r==null||r.removeEventListener("click",l)},refreshUI:e}}const xo={Digit1:4,Digit2:2,Digit3:1,Digit4:.5,Digit5:.25,Digit6:.125};function K0(t){const e=t.querySelectorAll("button[data-value]"),i=t.querySelector("#dotted-note-btn"),r=t.querySelector("#triplet-note-btn"),n=t.querySelector("#ai-mode-btn"),s=()=>{const u=dn(),f=Ug();e.forEach(h=>{const m=parseFloat(h.dataset.value??"-1");h.classList.remove("bg-purple-700","bg-blue-700","bg-gray-800"),h.classList.add("bg-transparent"),m===f?(h.classList.add("bg-purple-700"),h.classList.remove("bg-transparent")):m===u?(h.classList.add("bg-blue-700"),h.classList.remove("bg-transparent")):h.classList.add("bg-gray-800")})},a=on(u=>{s(),i==null||i.classList.toggle("bg-purple-700",u.isDottedMode),i==null||i.classList.toggle("bg-transparent",!u.isDottedMode),r==null||r.classList.toggle("bg-purple-700",u.isTripletMode),r==null||r.classList.toggle("bg-transparent",!u.isTripletMode),o(u.noteDuration,!1)}),o=(u,f=!0)=>{const h=Bn(),m=Mr();let g=u;h?g*=1.5:m&&(g*=2/3),Vi.currentDuration=g,j.forEach(y=>{var p;y.config.currentDuration=g,(p=y.matrix)==null||p.requestRedraw()}),Rg(u,f)},l=(u=!0)=>{const f=t.querySelector("button[data-value].bg-purple-700");if(f){const h=parseFloat(f.dataset.value);o(h,u)}},c=()=>{s();const u=Bn(),f=Mr();i==null||i.classList.toggle("bg-purple-700",u),i==null||i.classList.toggle("bg-transparent",!u),r==null||r.classList.toggle("bg-purple-700",f),r==null||r.classList.toggle("bg-transparent",!f)};e.forEach(u=>{u.classList.add("note-duration-btn"),u.addEventListener("click",f=>{if(f.button===0){const h=parseFloat(u.dataset.value);o(h)}}),u.addEventListener("contextmenu",f=>{f.preventDefault();const h=parseFloat(u.dataset.value);bo(h,!0)})}),r==null||r.addEventListener("click",()=>{const u=!Mr();Mo(u,!1),l(!1)}),i==null||i.addEventListener("click",()=>{const u=!Bn();Mo(!1,u),l(!1)});const d=u=>{const f=u.target;if(!(f.tagName==="INPUT"||f.tagName==="TEXTAREA"||f.isContentEditable||wt())){if(xo.hasOwnProperty(u.code)){u.preventDefault();const h=xo[u.code];u.shiftKey?bo(h,!0):o(h);return}if(u.key==="."){u.preventDefault(),i==null||i.click();return}if(u.key==="/"){u.preventDefault(),r==null||r.click();return}}};return window.addEventListener("keydown",d),n==null||n.addEventListener("click",()=>{Le.showFeatureBlocked()}),c(),{detach:()=>{window.removeEventListener("keydown",d),a(),n&&n.replaceWith(n.cloneNode(!0)),e.forEach(h=>{const m=h.cloneNode(!0);h.replaceWith(m)});const u=i==null?void 0:i.cloneNode(!0);u&&(i!=null&&i.parentNode)&&i.parentNode.replaceChild(u,i);const f=r==null?void 0:r.cloneNode(!0);f&&(r!=null&&r.parentNode)&&r.parentNode.replaceChild(f,r)},refreshUI:c}}function $0(t,e){const i=t.querySelector("#footer-help-btn"),r=t.querySelector("#footer-whats-new-btn"),n=()=>{},s=()=>{window.open("https://github.com/alacrity-ai/sequenzia","_blank")},a=()=>{e.show()};return i==null||i.addEventListener("click",s),r==null||r.addEventListener("click",a),{detach:()=>{i==null||i.removeEventListener("click",s),r==null||r.removeEventListener("click",a)},refreshUI:n}}function z0(t,e,i,r,n){const s=t.querySelector("#play-button"),a=t.querySelector("#stop-button"),o=t.querySelector("#record-button"),l=t.querySelector("#loop-toggle"),c=t.querySelector("#tempo-input"),d=t.querySelector("#measures-input"),u=t.querySelector("#beats-per-measure-input"),f=t.querySelector("#save-button"),h=t.querySelector("#load-button"),m=t.querySelector("#config-button"),g=x=>{if(!s)return;s.classList.toggle("bg-blue-800",x),s.classList.toggle("bg-blue-600",!x);const T=x?"icon-pause":"icon-play",F=Et(`static/svg/${T}.svg`),B=s.querySelector("img");if((B==null?void 0:B.getAttribute("src"))!==F){const O=z(T,x?"Pause":"Play");B?s.replaceChild(O,B):s.appendChild(O)}},y=()=>{g(e.isPlaying())};e.setOnStopCallback(()=>{g(!1)});const p=()=>{const x=!e.isPlaying();e.toggle(),g(x)},_=()=>{e.stop(),g(!1)},M=()=>{},v=()=>{const x=c==null?void 0:c.valueAsNumber;x&&x>=20&&x<=300&&aa(x,!0)},w=()=>{const x=d==null?void 0:d.valueAsNumber;x&&x>=1&&x<=1e3&&la(x,!0)},S=()=>{const x=u==null?void 0:u.valueAsNumber;x&&x>=1&&x<=16&&oa(x,!0)};on(x=>{c&&(c.value=String(x.tempo)),d&&(d.value=String(x.totalMeasures)),u&&(u.value=String(x.timeSignature[0]))});const C=()=>{Hg((l==null?void 0:l.checked)??!1)},P=()=>{r.show()},k=()=>{n.show()},N=()=>{i.show()},L=x=>{var B;const T=(B=document.activeElement)==null?void 0:B.tagName,F=T==="INPUT"||T==="TEXTAREA";x.key===" "&&!F&&(x.preventDefault(),x.shiftKey?_():p())};return s==null||s.addEventListener("click",p),a==null||a.addEventListener("click",_),o==null||o.addEventListener("click",M),c==null||c.addEventListener("change",v),d==null||d.addEventListener("change",w),u==null||u.addEventListener("change",S),l==null||l.addEventListener("change",C),f==null||f.addEventListener("click",P),h==null||h.addEventListener("click",k),m==null||m.addEventListener("click",N),window.addEventListener("keydown",L),{detach:()=>{s==null||s.removeEventListener("click",p),a==null||a.removeEventListener("click",_),o==null||o.removeEventListener("click",M),c==null||c.removeEventListener("change",v),d==null||d.removeEventListener("change",w),u==null||u.removeEventListener("change",S),l==null||l.removeEventListener("change",C),f==null||f.removeEventListener("click",P),h==null||h.removeEventListener("click",k),m==null||m.removeEventListener("click",N),window.removeEventListener("keydown",L)},refreshUI:y}}function yc(t,e){var i;for(const r of t.sequencers){const n=r.matrix;if(!n)continue;const s=(i=n.getPixelsPerBeat)==null?void 0:i.call(n);if(!s)continue;const a=e*s;n.setPlayheadPixelX(a)}}let Oe=null,Ci=null;function V0(t){Ci=t,Oe=Ci.getContext("2d")}function un(t){if(!Oe||!Ci)return;const e=window.devicePixelRatio||1,i=Ci.width/e,r=Ci.height/e;Oe.clearRect(0,0,i,r);const n=Math.round(t)+.5;Oe.strokeStyle="#ff00ff",Oe.lineWidth=1,Oe.beginPath(),Oe.moveTo(n,0),Oe.lineTo(n,r),Oe.stroke()}function W0(t,e){const i=e.snapResolution||.25,r=e.isTripletMode?i*(2/3):i;return Math.round(t/r)*r}let or=!1,ge=null,Dn=!1;function J0(t){if(ge=t.querySelector("#global-mini-playhead"),!ge)throw new Error("Playhead canvas not found in container.");const e=(o,l=!0)=>{const c=xe(),d=W0(o,Vi),u=Math.max(0,Math.min(c,d)),f=R.isActive();if(R.seek(u),l&&f&&R.resume(),yc(R,u),ge){const h=window.devicePixelRatio||1,m=ge.width/h,g=u/c*m;un(g)}},i=o=>{if(!ge)return;const l=window.devicePixelRatio||1,c=ge.getBoundingClientRect(),d=ge.width/l;let u=(o.clientX-c.left)*(d/c.width);u=Math.max(0,Math.min(d,u));const f=xe(),h=u/d*f;e(h,!1)},r=o=>{var f;const l=(f=document.activeElement)==null?void 0:f.tagName;if(l==="INPUT"||l==="TEXTAREA"||!o.shiftKey)return;const c=xe(),d=da();let u=R.getCurrentBeat();switch(o.key.toLowerCase()){case"a":u-=1;break;case"d":u+=1;break;case"s":{const h=Math.floor(u),m=Math.floor(h/d)*d;u=h===m?Math.max(0,m-d):m;break}case"w":{const h=Math.floor(u),g=Math.floor(h/d)*d+d;u=Math.min(c,g);break}default:return}o.preventDefault(),e(u)},n=async o=>{R.isActive()&&(await R.pause(),Dn=!0),or=!0,i(o)},s=o=>{or&&i(o)},a=o=>{or&&(i(o),or=!1,Dn&&(R.resume(),Dn=!1))};return ge.addEventListener("mousedown",o=>void n(o)),window.addEventListener("mousemove",s),window.addEventListener("mouseup",a),window.addEventListener("keydown",r),{detach:()=>{ge==null||ge.removeEventListener("mousedown",n),window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",a),window.removeEventListener("keydown",r)},refreshUI:()=>{}}}function gc(){const t=Bt();for(const e of t){const i=e.matrix;if(!i)continue;const r=i.getInteractionStore();if(r.hasSelection())return{sequencerId:e.id,selectedNotes:r.getSelectedNotes()}}return null}function X0(t){const e=()=>{const o=gc();if(!o||o.selectedNotes.length===0){Le.showError("No notes selected. Please select notes before adjusting velocity.");return}t.velocity.show(o.selectedNotes)},i=o=>{var u;if(o.key.toLowerCase()!=="v"||o.ctrlKey||o.metaKey||o.altKey)return;const l=(u=document.activeElement)==null?void 0:u.tagName,c=l==="INPUT"||l==="TEXTAREA",d=wt();c||d||(o.preventDefault(),e())},r=o=>{o.type==="keydown"&&o.ctrlKey&&!Bi()&&_o(!0),o.type==="keyup"&&o.key==="Control"&&Bi()&&_o(!1)},n=o=>{i(o),r(o)},s=o=>{r(o)},a=o=>{const{editorId:l}=o.detail;l==="velocity-tool"&&e()};return window.addEventListener("keydown",n),window.addEventListener("keyup",s),document.body.addEventListener("editor-invoke",a),{detach:()=>{window.removeEventListener("keydown",n),window.removeEventListener("keyup",s),document.body.removeEventListener("editor-invoke",a)},refreshUI:()=>{}}}let Pi=null;function Lo(t,e){const i=xe(),r=window.devicePixelRatio||1,n=e/r;function s(){if(!t.isActive())return;const a=t.getCurrentBeat(),o=a/i*n;un(o),yc(t,a),Pi=requestAnimationFrame(s)}cs(),Pi=requestAnimationFrame(s)}function cs(){Pi!==null&&(cancelAnimationFrame(Pi),Pi=null)}function Y0(t){var e;un(0);for(const i of t.sequencers)(e=i.matrix)==null||e.setPlayheadPixelX(0)}class Z0{constructor(e){this.onStop=null,this.engine=e,this.playheadCanvasWidth=300,this.engine.setOnResumeCallback(()=>{Lo(this.engine,this.playheadCanvasWidth)}),this.engine.setOnStopCallback(()=>{var i;(i=this.onStop)==null||i.call(this)})}play(){this.engine.start(),Lo(this.engine,this.playheadCanvasWidth)}stop(){this.engine.stop(),cs(),Y0(this.engine)}setOnStopCallback(e){this.onStop=e}async pause(){await this.engine.pause(),cs()}async resume(){await this.engine.resume()}toggle(){this.engine.isActive()?this.pause():this.resume()}isPlaying(){return this.engine.isActive()}getEngine(){return this.engine}setSequencers(e){this.engine.setSequencers(e)}setPlayheadCanvasWidth(e){this.playheadCanvasWidth=e}}const Q0={sm:{widthClass:"w-[300px]",maxWidthClass:"max-w-sm"},md:{widthClass:"w-[500px]",maxWidthClass:"max-w-md"},lg:{widthClass:"w-[700px]",maxWidthClass:"max-w-lg"},xl:{widthClass:"w-[900px]",maxWidthClass:"max-w-xl"},full:{widthClass:"w-full",maxWidthClass:"max-w-full"}};function $e(t,e,i={}){const r=K(),n=i.sizePreset?Q0[i.sizePreset]:void 0,s=i.widthClass||(n==null?void 0:n.widthClass)||"w-[500px]",a=i.maxWidthClass||(n==null?void 0:n.maxWidthClass)||"max-w-full",o=b("div",{class:"absolute inset-0 rounded-2xl border-2 border-purple-500 opacity-30 blur-xl animate-pulse pointer-events-none"}),l=b("div",{class:["relative flex flex-col",r.menuBackground,"border border-purple-700 shadow-2xl rounded-2xl","px-10 py-8 animate-fade-in text-white",s,a].join(" ")},o,...Array.isArray(e)?e:[e]);return b("div",{id:t,class:"fixed inset-0 bg-black/70 flex items-center justify-center z-[9999] hidden"},l)}const e_={sm:"text-base",md:"text-lg",lg:"text-xl",xl:"text-2xl"};function Tt(t){const e=K();if(typeof t=="string")return b("h2",{class:["text-lg font-semibold mb-4",e.textColor].join(" "),textContent:t});const{text:i,size:r="md",additionalClasses:n=""}=t;return b("h2",{class:[e_[r],"font-semibold mb-4",e.textColor,n].join(" "),textContent:i})}function t_(){const t=Tt(" Export"),e=V({id:"export-json",text:"Save Project",kind:"primary"}),i=b("div",{class:"h-px bg-gray-600"}),r=V({id:"export-wav",text:"Export as WAV",kind:"secondary",additionalClasses:"bg-green-600 hover:bg-green-700"}),n=V({id:"export-midi",text:"Export as MIDI",kind:"secondary",additionalClasses:"bg-yellow-600 hover:bg-yellow-700"}),s=V({id:"export-cancel",text:"Cancel",kind:"tertiary",additionalClasses:"mt-6 w-full"}),a=b("div",{class:"flex flex-col gap-3 w-full z-10"},e,i,r,n);return $e("export-modal",[t,a,s])}function i_(t){if(!t.sequencers.length)throw new Error("No tracks to export.");const e=t.tempo,i=t.timeSignature[0],r=t.totalMeasures,n=t.songKey,s={v:3,t:new Date().toISOString(),c:{b:e,bpm:i,tm:r,sk:n},i:t.sequencers.map(o=>o.instrument||"sf2/fluidr3-gm/acoustic_grand_piano"),vlm:t.sequencers.map(o=>o.volume??100/127),pan:t.sequencers.map(o=>o.pan??0),tr:t.sequencers.map(o=>({n:o.notes.map(l=>[l.pitch,l.start,l.duration,l.velocity??100])}))},a=new Blob([JSON.stringify(s)],{type:"application/json"});return{url:URL.createObjectURL(a),filename:`session-${Date.now()}.json`}}async function r_(t,e={sampleRate:44100,includePan:!0}){if(!t.tracks||t.tracks.length===0)throw new Error("No tracks to export.");const i=e.sampleRate,r=e.includePan?2:1,n=new AbortController;let s=!1;yi("Exporting Session","Rendering your session offline...",()=>{s=!0,n.abort()},!0);try{const o=60/Ke(),l=Math.max(...t.tracks.flatMap(m=>m.notes.map(g=>(g.start+g.duration)*o+.2))),c=new OfflineAudioContext(r,Math.ceil(i*l),i);for(const m of t.tracks){if(s)return;const g=m.instrument||"sf2/fluidr3-gm/acoustic_grand_piano";if(await new Wr(null,m.config,c,c.destination,g,!0).exportToOffline(n.signal,m.notes),s)return}if(s)return;yi("Rendering Audio","Rendering audio buffer",void 0,!0);const d=await c.startRendering();yi("Converting to WAV","Converting to WAV format",void 0,!0);const u=n_(d);yi("Downloading WAV","Please wait...",void 0,!0);const f=URL.createObjectURL(u),h=document.createElement("a");h.href=f,h.download=`session-${Date.now()}.wav`,h.click(),URL.revokeObjectURL(f)}catch(a){s?console.warn("Export operation was cancelled by the user."):console.error("Error during export:",a)}finally{zs(!0)}}function n_(t){const e=t.numberOfChannels,i=t.length*e*2,r=new DataView(new ArrayBuffer(44+i)),n=(a,o)=>{for(let l=0;l<o.length;l++)r.setUint8(a+l,o.charCodeAt(l))};n(0,"RIFF"),r.setUint32(4,36+i,!0),n(8,"WAVE"),n(12,"fmt "),r.setUint32(16,16,!0),r.setUint16(20,1,!0),r.setUint16(22,e,!0),r.setUint32(24,t.sampleRate,!0),r.setUint32(28,t.sampleRate*e*2,!0),r.setUint16(32,e*2,!0),r.setUint16(34,16,!0),n(36,"data"),r.setUint32(40,i,!0);let s=44;for(let a=0;a<t.length;a++)for(let o=0;o<e;o++){const l=t.getChannelData(o)[a],c=Math.max(-1,Math.min(1,l));r.setInt16(s,c*32767,!0),s+=2}return new Blob([r.buffer],{type:"audio/wav"})}async function s_(t){var l,c,d,u;const e=await t.text();let i;try{i=JSON.parse(e)}catch{throw new Error("Invalid JSON format.")}if(!Array.isArray(i.tr))throw new Error("Missing or invalid `tr` (tracks) array.");const r={bpm:((l=i.c)==null?void 0:l.b)??120,beatsPerMeasure:((c=i.c)==null?void 0:c.bpm)??4,totalMeasures:((d=i.c)==null?void 0:d.tm)??8,songKey:((u=i.c)==null?void 0:u.sk)??"CM"},n=Array.isArray(i.i)?i.i:[],s=Array.isArray(i.vlm)?i.vlm:[],a=Array.isArray(i.pan)?i.pan:[],o=i.tr.map((f,h)=>{if(!Array.isArray(f.n))throw new Error(`Track ${h} missing \`n\` (notes) array.`);const m=f.n.map(([_,M,v,w])=>({pitch:_,start:M,duration:v,velocity:w??100})),g=n[h]||"sf2/fluidr3-gm/acoustic_grand_piano",y=s[h],p=a[h];return{notes:m,instrument:g,volume:typeof y=="number"?y:void 0,pan:typeof p=="number"?p:void 0,config:{}}});return{globalConfig:r,tracks:o}}function a_(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var i=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};i.prototype=e.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(i,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})}),i}var dt={},lr={},Fn,Eo;function o_(){if(Eo)return Fn;Eo=1;function t(n){var s=new r(n),a=s.readChunk();if(a.id!="MThd")throw"Bad MIDI file.  Expected 'MHdr', got: '"+a.id+"'";for(var o=e(a.data),l=[],c=0;!s.eof()&&c<o.numTracks;c++){var d=s.readChunk();if(d.id!="MTrk")throw"Bad MIDI file.  Expected 'MTrk', got: '"+d.id+"'";var u=i(d.data);l.push(u)}return{header:o,tracks:l}}function e(n){var s=new r(n),a=s.readUInt16(),o=s.readUInt16(),l={format:a,numTracks:o},c=s.readUInt16();return c&32768?(l.framesPerSecond=256-(c>>8),l.ticksPerFrame=c&255):l.ticksPerBeat=c,l}function i(n){for(var s=new r(n),a=[];!s.eof();){var o=c();a.push(o)}return a;var l;function c(){var d={};d.deltaTime=s.readVarInt();var u=s.readUInt8();if((u&240)===240)if(u===255){d.meta=!0;var f=s.readUInt8(),h=s.readVarInt();switch(f){case 0:if(d.type="sequenceNumber",h!==2)throw"Expected length for sequenceNumber event is 2, got "+h;return d.number=s.readUInt16(),d;case 1:return d.type="text",d.text=s.readString(h),d;case 2:return d.type="copyrightNotice",d.text=s.readString(h),d;case 3:return d.type="trackName",d.text=s.readString(h),d;case 4:return d.type="instrumentName",d.text=s.readString(h),d;case 5:return d.type="lyrics",d.text=s.readString(h),d;case 6:return d.type="marker",d.text=s.readString(h),d;case 7:return d.type="cuePoint",d.text=s.readString(h),d;case 32:if(d.type="channelPrefix",h!=1)throw"Expected length for channelPrefix event is 1, got "+h;return d.channel=s.readUInt8(),d;case 33:if(d.type="portPrefix",h!=1)throw"Expected length for portPrefix event is 1, got "+h;return d.port=s.readUInt8(),d;case 47:if(d.type="endOfTrack",h!=0)throw"Expected length for endOfTrack event is 0, got "+h;return d;case 81:if(d.type="setTempo",h!=3)throw"Expected length for setTempo event is 3, got "+h;return d.microsecondsPerBeat=s.readUInt24(),d;case 84:if(d.type="smpteOffset",h!=5)throw"Expected length for smpteOffset event is 5, got "+h;var m=s.readUInt8(),g={0:24,32:25,64:29,96:30};return d.frameRate=g[m&96],d.hour=m&31,d.min=s.readUInt8(),d.sec=s.readUInt8(),d.frame=s.readUInt8(),d.subFrame=s.readUInt8(),d;case 88:if(d.type="timeSignature",h!=2&&h!=4)throw"Expected length for timeSignature event is 4 or 2, got "+h;return d.numerator=s.readUInt8(),d.denominator=1<<s.readUInt8(),h===4?(d.metronome=s.readUInt8(),d.thirtyseconds=s.readUInt8()):(d.metronome=36,d.thirtyseconds=8),d;case 89:if(d.type="keySignature",h!=2)throw"Expected length for keySignature event is 2, got "+h;return d.key=s.readInt8(),d.scale=s.readUInt8(),d;case 127:return d.type="sequencerSpecific",d.data=s.readBytes(h),d;default:return d.type="unknownMeta",d.data=s.readBytes(h),d.metatypeByte=f,d}}else if(u==240){d.type="sysEx";var h=s.readVarInt();return d.data=s.readBytes(h),d}else if(u==247){d.type="endSysEx";var h=s.readVarInt();return d.data=s.readBytes(h),d}else throw"Unrecognised MIDI event type byte: "+u;else{var y;if((u&128)===0){if(l===null)throw"Running status byte encountered before status byte";y=u,u=l,d.running=!0}else y=s.readUInt8(),l=u;var p=u>>4;switch(d.channel=u&15,p){case 8:return d.type="noteOff",d.noteNumber=y,d.velocity=s.readUInt8(),d;case 9:var _=s.readUInt8();return d.type=_===0?"noteOff":"noteOn",d.noteNumber=y,d.velocity=_,_===0&&(d.byte9=!0),d;case 10:return d.type="noteAftertouch",d.noteNumber=y,d.amount=s.readUInt8(),d;case 11:return d.type="controller",d.controllerType=y,d.value=s.readUInt8(),d;case 12:return d.type="programChange",d.programNumber=y,d;case 13:return d.type="channelAftertouch",d.amount=y,d;case 14:return d.type="pitchBend",d.value=y+(s.readUInt8()<<7)-8192,d;default:throw"Unrecognised MIDI event type: "+p}}}}function r(n){this.buffer=n,this.bufferLen=this.buffer.length,this.pos=0}return r.prototype.eof=function(){return this.pos>=this.bufferLen},r.prototype.readUInt8=function(){var n=this.buffer[this.pos];return this.pos+=1,n},r.prototype.readInt8=function(){var n=this.readUInt8();return n&128?n-256:n},r.prototype.readUInt16=function(){var n=this.readUInt8(),s=this.readUInt8();return(n<<8)+s},r.prototype.readInt16=function(){var n=this.readUInt16();return n&32768?n-65536:n},r.prototype.readUInt24=function(){var n=this.readUInt8(),s=this.readUInt8(),a=this.readUInt8();return(n<<16)+(s<<8)+a},r.prototype.readInt24=function(){var n=this.readUInt24();return n&8388608?n-16777216:n},r.prototype.readUInt32=function(){var n=this.readUInt8(),s=this.readUInt8(),a=this.readUInt8(),o=this.readUInt8();return(n<<24)+(s<<16)+(a<<8)+o},r.prototype.readBytes=function(n){var s=this.buffer.slice(this.pos,this.pos+n);return this.pos+=n,s},r.prototype.readString=function(n){var s=this.readBytes(n);return String.fromCharCode.apply(null,s)},r.prototype.readVarInt=function(){for(var n=0;!this.eof();){var s=this.readUInt8();if(s&128)n+=s&127,n<<=7;else return n+s}return n},r.prototype.readChunk=function(){var n=this.readString(4),s=this.readUInt32(),a=this.readBytes(s);return{id:n,length:s,data:a}},Fn=t,Fn}var Rn,Ao;function l_(){if(Ao)return Rn;Ao=1;function t(s,a){if(typeof s!="object")throw"Invalid MIDI data";a=a||{};var o=s.header||{},l=s.tracks||[],c,d=l.length,u=new n;for(e(u,o,d),c=0;c<d;c++)i(u,l[c],a);return u.buffer}function e(s,a,o){var l=a.format==null?1:a.format,c=128;a.timeDivision?c=a.timeDivision:a.ticksPerFrame&&a.framesPerSecond?c=-(a.framesPerSecond&255)<<8|a.ticksPerFrame&255:a.ticksPerBeat&&(c=a.ticksPerBeat&32767);var d=new n;d.writeUInt16(l),d.writeUInt16(o),d.writeUInt16(c),s.writeChunk("MThd",d.buffer)}function i(s,a,o){var l=new n,c,d=a.length,u=null;for(c=0;c<d;c++)(o.running===!1||!o.running&&!a[c].running)&&(u=null),u=r(l,a[c],u,o.useByte9ForNoteOff);s.writeChunk("MTrk",l.buffer)}function r(s,a,o,l){var c=a.type,d=a.deltaTime,u=a.text||"",f=a.data||[],h=null;switch(s.writeVarInt(d),c){case"sequenceNumber":s.writeUInt8(255),s.writeUInt8(0),s.writeVarInt(2),s.writeUInt16(a.number);break;case"text":s.writeUInt8(255),s.writeUInt8(1),s.writeVarInt(u.length),s.writeString(u);break;case"copyrightNotice":s.writeUInt8(255),s.writeUInt8(2),s.writeVarInt(u.length),s.writeString(u);break;case"trackName":s.writeUInt8(255),s.writeUInt8(3),s.writeVarInt(u.length),s.writeString(u);break;case"instrumentName":s.writeUInt8(255),s.writeUInt8(4),s.writeVarInt(u.length),s.writeString(u);break;case"lyrics":s.writeUInt8(255),s.writeUInt8(5),s.writeVarInt(u.length),s.writeString(u);break;case"marker":s.writeUInt8(255),s.writeUInt8(6),s.writeVarInt(u.length),s.writeString(u);break;case"cuePoint":s.writeUInt8(255),s.writeUInt8(7),s.writeVarInt(u.length),s.writeString(u);break;case"channelPrefix":s.writeUInt8(255),s.writeUInt8(32),s.writeVarInt(1),s.writeUInt8(a.channel);break;case"portPrefix":s.writeUInt8(255),s.writeUInt8(33),s.writeVarInt(1),s.writeUInt8(a.port);break;case"endOfTrack":s.writeUInt8(255),s.writeUInt8(47),s.writeVarInt(0);break;case"setTempo":s.writeUInt8(255),s.writeUInt8(81),s.writeVarInt(3),s.writeUInt24(a.microsecondsPerBeat);break;case"smpteOffset":s.writeUInt8(255),s.writeUInt8(84),s.writeVarInt(5);var m={24:0,25:32,29:64,30:96},g=a.hour&31|m[a.frameRate];s.writeUInt8(g),s.writeUInt8(a.min),s.writeUInt8(a.sec),s.writeUInt8(a.frame),s.writeUInt8(a.subFrame);break;case"timeSignature":s.writeUInt8(255),s.writeUInt8(88),s.writeVarInt(4),s.writeUInt8(a.numerator);var y=Math.floor(Math.log(a.denominator)/Math.LN2)&255;s.writeUInt8(y),s.writeUInt8(a.metronome),s.writeUInt8(a.thirtyseconds||8);break;case"keySignature":s.writeUInt8(255),s.writeUInt8(89),s.writeVarInt(2),s.writeInt8(a.key),s.writeUInt8(a.scale);break;case"sequencerSpecific":s.writeUInt8(255),s.writeUInt8(127),s.writeVarInt(f.length),s.writeBytes(f);break;case"unknownMeta":a.metatypeByte!=null&&(s.writeUInt8(255),s.writeUInt8(a.metatypeByte),s.writeVarInt(f.length),s.writeBytes(f));break;case"sysEx":s.writeUInt8(240),s.writeVarInt(f.length),s.writeBytes(f);break;case"endSysEx":s.writeUInt8(247),s.writeVarInt(f.length),s.writeBytes(f);break;case"noteOff":var p=l!==!1&&a.byte9||l&&a.velocity==0?144:128;h=p|a.channel,h!==o&&s.writeUInt8(h),s.writeUInt8(a.noteNumber),s.writeUInt8(a.velocity);break;case"noteOn":h=144|a.channel,h!==o&&s.writeUInt8(h),s.writeUInt8(a.noteNumber),s.writeUInt8(a.velocity);break;case"noteAftertouch":h=160|a.channel,h!==o&&s.writeUInt8(h),s.writeUInt8(a.noteNumber),s.writeUInt8(a.amount);break;case"controller":h=176|a.channel,h!==o&&s.writeUInt8(h),s.writeUInt8(a.controllerType),s.writeUInt8(a.value);break;case"programChange":h=192|a.channel,h!==o&&s.writeUInt8(h),s.writeUInt8(a.programNumber);break;case"channelAftertouch":h=208|a.channel,h!==o&&s.writeUInt8(h),s.writeUInt8(a.amount);break;case"pitchBend":h=224|a.channel,h!==o&&s.writeUInt8(h);var _=8192+a.value,M=_&127,v=_>>7&127;s.writeUInt8(M),s.writeUInt8(v);break;default:throw"Unrecognized event type: "+c}return h}function n(){this.buffer=[]}return n.prototype.writeUInt8=function(s){this.buffer.push(s&255)},n.prototype.writeInt8=n.prototype.writeUInt8,n.prototype.writeUInt16=function(s){var a=s>>8&255,o=s&255;this.writeUInt8(a),this.writeUInt8(o)},n.prototype.writeInt16=n.prototype.writeUInt16,n.prototype.writeUInt24=function(s){var a=s>>16&255,o=s>>8&255,l=s&255;this.writeUInt8(a),this.writeUInt8(o),this.writeUInt8(l)},n.prototype.writeInt24=n.prototype.writeUInt24,n.prototype.writeUInt32=function(s){var a=s>>24&255,o=s>>16&255,l=s>>8&255,c=s&255;this.writeUInt8(a),this.writeUInt8(o),this.writeUInt8(l),this.writeUInt8(c)},n.prototype.writeInt32=n.prototype.writeUInt32,n.prototype.writeBytes=function(s){this.buffer=this.buffer.concat(Array.prototype.slice.call(s,0))},n.prototype.writeString=function(s){var a,o=s.length,l=[];for(a=0;a<o;a++)l.push(s.codePointAt(a));this.writeBytes(l)},n.prototype.writeVarInt=function(s){if(s<0)throw"Cannot write negative variable-length integer";if(s<=127)this.writeUInt8(s);else{var a=s,o=[];for(o.push(a&127),a>>=7;a;){var l=a&127|128;o.push(l),a>>=7}this.writeBytes(o.reverse())}},n.prototype.writeChunk=function(s,a){this.writeString(s),this.writeUInt32(a.length),this.writeBytes(a)},Rn=t,Rn}var Bo;function vc(){return Bo||(Bo=1,lr.parseMidi=o_(),lr.writeMidi=l_()),lr}var Un={},ct={},To;function _c(){if(To)return ct;To=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.insert=ct.search=void 0;function t(i,r,n){n===void 0&&(n="ticks");var s=0,a=i.length,o=a;if(a>0&&i[a-1][n]<=r)return a-1;for(;s<o;){var l=Math.floor(s+(o-s)/2),c=i[l],d=i[l+1];if(c[n]===r){for(var u=l;u<i.length;u++){var f=i[u];f[n]===r&&(l=u)}return l}else{if(c[n]<r&&d[n]>r)return l;c[n]>r?o=l:c[n]<r&&(s=l+1)}}return-1}ct.search=t;function e(i,r,n){if(n===void 0&&(n="ticks"),i.length){var s=t(i,r[n],n);i.splice(s+1,0,r)}else i.push(r)}return ct.insert=e,ct}var Io;function us(){return Io||(Io=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Header=t.keySignatureKeys=void 0;var e=_c(),i=new WeakMap;t.keySignatureKeys=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];var r=function(){function n(s){var a=this;if(this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",i.set(this,480),s){i.set(this,s.header.ticksPerBeat),s.tracks.forEach(function(l){l.forEach(function(c){c.meta&&(c.type==="timeSignature"?a.timeSignatures.push({ticks:c.absoluteTime,timeSignature:[c.numerator,c.denominator]}):c.type==="setTempo"?a.tempos.push({bpm:6e7/c.microsecondsPerBeat,ticks:c.absoluteTime}):c.type==="keySignature"&&a.keySignatures.push({key:t.keySignatureKeys[c.key+7],scale:c.scale===0?"major":"minor",ticks:c.absoluteTime}))})});var o=0;s.tracks[0].forEach(function(l){o+=l.deltaTime,l.meta&&(l.type==="trackName"?a.name=l.text:(l.type==="text"||l.type==="cuePoint"||l.type==="marker"||l.type==="lyrics")&&a.meta.push({text:l.text,ticks:o,type:l.type}))}),this.update()}}return n.prototype.update=function(){var s=this,a=0,o=0;this.tempos.sort(function(l,c){return l.ticks-c.ticks}),this.tempos.forEach(function(l,c){var d=c>0?s.tempos[c-1].bpm:s.tempos[0].bpm,u=l.ticks/s.ppq-o,f=60/d*u;l.time=f+a,a=l.time,o+=u}),this.timeSignatures.sort(function(l,c){return l.ticks-c.ticks}),this.timeSignatures.forEach(function(l,c){var d=c>0?s.timeSignatures[c-1]:s.timeSignatures[0],u=(l.ticks-d.ticks)/s.ppq,f=u/d.timeSignature[0]/(d.timeSignature[1]/4);d.measures=d.measures||0,l.measures=f+d.measures})},n.prototype.ticksToSeconds=function(s){var a=(0,e.search)(this.tempos,s);if(a!==-1){var o=this.tempos[a],l=o.time,c=(s-o.ticks)/this.ppq;return l+60/o.bpm*c}else{var d=s/this.ppq;return 60/120*d}},n.prototype.ticksToMeasures=function(s){var a=(0,e.search)(this.timeSignatures,s);if(a!==-1){var o=this.timeSignatures[a],l=(s-o.ticks)/this.ppq;return o.measures+l/(o.timeSignature[0]/o.timeSignature[1])/4}else return s/this.ppq/4},Object.defineProperty(n.prototype,"ppq",{get:function(){return i.get(this)},enumerable:!1,configurable:!0}),n.prototype.secondsToTicks=function(s){var a=(0,e.search)(this.tempos,s,"time");if(a!==-1){var o=this.tempos[a],l=o.time,c=s-l,d=c/(60/o.bpm);return Math.round(o.ticks+d*this.ppq)}else{var u=s/.5;return Math.round(u*this.ppq)}},n.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map(function(s){return{bpm:s.bpm,ticks:s.ticks}}),timeSignatures:this.timeSignatures}},n.prototype.fromJSON=function(s){this.name=s.name,this.tempos=s.tempos.map(function(a){return Object.assign({},a)}),this.timeSignatures=s.timeSignatures.map(function(a){return Object.assign({},a)}),this.keySignatures=s.keySignatures.map(function(a){return Object.assign({},a)}),this.meta=s.meta.map(function(a){return Object.assign({},a)}),i.set(this,s.ppq),this.update()},n.prototype.setTempo=function(s){this.tempos=[{bpm:s,ticks:0}],this.update()},n}();t.Header=r}(Un)),Un}var oi={},Hn={},Go;function bc(){return Go||(Go=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ControlChange=t.controlChangeIds=t.controlChangeNames=void 0,t.controlChangeNames={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"},t.controlChangeIds=Object.keys(t.controlChangeNames).reduce(function(n,s){return n[t.controlChangeNames[s]]=s,n},{});var e=new WeakMap,i=new WeakMap,r=function(){function n(s,a){e.set(this,a),i.set(this,s.controllerType),this.ticks=s.absoluteTime,this.value=s.value}return Object.defineProperty(n.prototype,"number",{get:function(){return i.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"name",{get:function(){return t.controlChangeNames[this.number]?t.controlChangeNames[this.number]:null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"time",{get:function(){var s=e.get(this);return s.ticksToSeconds(this.ticks)},set:function(s){var a=e.get(this);this.ticks=a.secondsToTicks(s)},enumerable:!1,configurable:!0}),n.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},n}();t.ControlChange=r}(Hn)),Hn}var li={},Oo;function d_(){if(Oo)return li;Oo=1,Object.defineProperty(li,"__esModule",{value:!0}),li.createControlChanges=void 0;var t=bc();function e(){return new Proxy({},{get:function(i,r){if(i[r])return i[r];if(t.controlChangeIds.hasOwnProperty(r))return i[t.controlChangeIds[r]]},set:function(i,r,n){return t.controlChangeIds.hasOwnProperty(r)?i[t.controlChangeIds[r]]=n:i[r]=n,!0}})}return li.createControlChanges=e,li}var di={},Do;function c_(){if(Do)return di;Do=1,Object.defineProperty(di,"__esModule",{value:!0}),di.PitchBend=void 0;var t=new WeakMap,e=function(){function i(r,n){t.set(this,n),this.ticks=r.absoluteTime,this.value=r.value}return Object.defineProperty(i.prototype,"time",{get:function(){var r=t.get(this);return r.ticksToSeconds(this.ticks)},set:function(r){var n=t.get(this);this.ticks=n.secondsToTicks(r)},enumerable:!1,configurable:!0}),i.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},i}();return di.PitchBend=e,di}var ci={},Te={},Fo;function u_(){return Fo||(Fo=1,Object.defineProperty(Te,"__esModule",{value:!0}),Te.DrumKitByPatchID=Te.InstrumentFamilyByID=Te.instrumentByPatchID=void 0,Te.instrumentByPatchID=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"],Te.InstrumentFamilyByID=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"],Te.DrumKitByPatchID={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"}),Te}var Ro;function h_(){if(Ro)return ci;Ro=1,Object.defineProperty(ci,"__esModule",{value:!0}),ci.Instrument=void 0;var t=u_(),e=new WeakMap,i=function(){function r(n,s){if(this.number=0,e.set(this,s),this.number=0,n){var a=n.find(function(o){return o.type==="programChange"});a&&(this.number=a.programNumber)}}return Object.defineProperty(r.prototype,"name",{get:function(){return this.percussion?t.DrumKitByPatchID[this.number]:t.instrumentByPatchID[this.number]},set:function(n){var s=t.instrumentByPatchID.indexOf(n);s!==-1&&(this.number=s)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"family",{get:function(){return this.percussion?"drums":t.InstrumentFamilyByID[Math.floor(this.number/8)]},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"percussion",{get:function(){var n=e.get(this);return n.channel===9},enumerable:!1,configurable:!0}),r.prototype.toJSON=function(){return{family:this.family,number:this.number,name:this.name}},r.prototype.fromJSON=function(n){this.number=n.number},r}();return ci.Instrument=i,ci}var ui={},Uo;function f_(){if(Uo)return ui;Uo=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.Note=void 0;function t(a){var o=Math.floor(a/12)-1;return e(a)+o.toString()}function e(a){var o=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],l=a%12;return o[l]}function i(a){var o=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return o.indexOf(a)}var r=function(){var a=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,o={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13};return function(l){var c=a.exec(l),d=c[1],u=c[2],f=o[d.toLowerCase()];return f+(parseInt(u,10)+1)*12}}(),n=new WeakMap,s=function(){function a(o,l,c){n.set(this,c),this.midi=o.midi,this.velocity=o.velocity,this.noteOffVelocity=l.velocity,this.ticks=o.ticks,this.durationTicks=l.ticks-o.ticks}return Object.defineProperty(a.prototype,"name",{get:function(){return t(this.midi)},set:function(o){this.midi=r(o)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(o){var l=o-this.octave;this.midi+=l*12},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"pitch",{get:function(){return e(this.midi)},set:function(o){this.midi=12*(this.octave+1)+i(o)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"duration",{get:function(){var o=n.get(this);return o.ticksToSeconds(this.ticks+this.durationTicks)-o.ticksToSeconds(this.ticks)},set:function(o){var l=n.get(this),c=l.secondsToTicks(this.time+o);this.durationTicks=c-this.ticks},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"time",{get:function(){var o=n.get(this);return o.ticksToSeconds(this.ticks)},set:function(o){var l=n.get(this);this.ticks=l.secondsToTicks(o)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"bars",{get:function(){var o=n.get(this);return o.ticksToMeasures(this.ticks)},enumerable:!1,configurable:!0}),a.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},a}();return ui.Note=s,ui}var Ho;function qo(){if(Ho)return oi;Ho=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.Track=void 0;var t=_c(),e=bc(),i=d_(),r=c_(),n=h_(),s=f_(),a=new WeakMap,o=function(){function l(c,d){var u=this;if(this.name="",this.notes=[],this.controlChanges=(0,i.createControlChanges)(),this.pitchBends=[],a.set(this,d),c){var f=c.find(function(v){return v.type==="trackName"});this.name=f?f.text:""}if(this.instrument=new n.Instrument(c,this),this.channel=0,c){for(var h=c.filter(function(v){return v.type==="noteOn"}),m=c.filter(function(v){return v.type==="noteOff"}),g=function(){var v=h.shift();y.channel=v.channel;var w=m.findIndex(function(C){return C.noteNumber===v.noteNumber&&C.absoluteTime>=v.absoluteTime});if(w!==-1){var S=m.splice(w,1)[0];y.addNote({durationTicks:S.absoluteTime-v.absoluteTime,midi:v.noteNumber,noteOffVelocity:S.velocity/127,ticks:v.absoluteTime,velocity:v.velocity/127})}},y=this;h.length;)g();var p=c.filter(function(v){return v.type==="controller"});p.forEach(function(v){u.addCC({number:v.controllerType,ticks:v.absoluteTime,value:v.value/127})});var _=c.filter(function(v){return v.type==="pitchBend"});_.forEach(function(v){u.addPitchBend({ticks:v.absoluteTime,value:v.value/Math.pow(2,13)})});var M=c.find(function(v){return v.type==="endOfTrack"});this.endOfTrackTicks=M!==void 0?M.absoluteTime:void 0}}return l.prototype.addNote=function(c){var d=a.get(this),u=new s.Note({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},d);return Object.assign(u,c),(0,t.insert)(this.notes,u,"ticks"),this},l.prototype.addCC=function(c){var d=a.get(this),u=new e.ControlChange({controllerType:c.number},d);return delete c.number,Object.assign(u,c),Array.isArray(this.controlChanges[u.number])||(this.controlChanges[u.number]=[]),(0,t.insert)(this.controlChanges[u.number],u,"ticks"),this},l.prototype.addPitchBend=function(c){var d=a.get(this),u=new r.PitchBend({},d);return Object.assign(u,c),(0,t.insert)(this.pitchBends,u,"ticks"),this},Object.defineProperty(l.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var c=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,d=0;d<this.notes.length-1;d++){var u=this.notes[d].time+this.notes[d].duration;c<u&&(c=u)}return c},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var c=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,d=0;d<this.notes.length-1;d++){var u=this.notes[d].ticks+this.notes[d].durationTicks;c<u&&(c=u)}return c},enumerable:!1,configurable:!0}),l.prototype.fromJSON=function(c){var d=this;this.name=c.name,this.channel=c.channel,this.instrument=new n.Instrument(void 0,this),this.instrument.fromJSON(c.instrument),c.endOfTrackTicks!==void 0&&(this.endOfTrackTicks=c.endOfTrackTicks);for(var u in c.controlChanges)c.controlChanges[u]&&c.controlChanges[u].forEach(function(f){d.addCC({number:f.number,ticks:f.ticks,value:f.value})});c.notes.forEach(function(f){d.addNote({durationTicks:f.durationTicks,midi:f.midi,ticks:f.ticks,velocity:f.velocity})})},l.prototype.toJSON=function(){for(var c={},d=0;d<127;d++)this.controlChanges.hasOwnProperty(d)&&(c[d]=this.controlChanges[d].map(function(f){return f.toJSON()}));var u={channel:this.channel,controlChanges:c,pitchBends:this.pitchBends.map(function(f){return f.toJSON()}),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map(function(f){return f.toJSON()})};return this.endOfTrackTicks!==void 0&&(u.endOfTrackTicks=this.endOfTrackTicks),u},l}();return oi.Track=o,oi}var ut={};function p_(t){var e=[];return Mc(t,e),e}function Mc(t,e){for(var i=0;i<t.length;i++){var r=t[i];Array.isArray(r)?Mc(r,e):e.push(r)}}const m_=Object.freeze(Object.defineProperty({__proto__:null,flatten:p_},Symbol.toStringTag,{value:"Module"})),y_=a_(m_);var jo;function g_(){if(jo)return ut;jo=1;var t=ut&&ut.__spreadArray||function(p,_,M){if(M||arguments.length===2)for(var v=0,w=_.length,S;v<w;v++)(S||!(v in _))&&(S||(S=Array.prototype.slice.call(_,0,v)),S[v]=_[v]);return p.concat(S||Array.prototype.slice.call(_))};Object.defineProperty(ut,"__esModule",{value:!0}),ut.encode=void 0;var e=vc(),i=us(),r=y_;function n(p,_){return[{absoluteTime:p.ticks,channel:_,deltaTime:0,noteNumber:p.midi,type:"noteOn",velocity:Math.floor(p.velocity*127)},{absoluteTime:p.ticks+p.durationTicks,channel:_,deltaTime:0,noteNumber:p.midi,type:"noteOff",velocity:Math.floor(p.noteOffVelocity*127)}]}function s(p){return(0,r.flatten)(p.notes.map(function(_){return n(_,p.channel)}))}function a(p,_){return{absoluteTime:p.ticks,channel:_,controllerType:p.number,deltaTime:0,type:"controller",value:Math.floor(p.value*127)}}function o(p){for(var _=[],M=0;M<127;M++)p.controlChanges.hasOwnProperty(M)&&p.controlChanges[M].forEach(function(v){_.push(a(v,p.channel))});return _}function l(p,_){return{absoluteTime:p.ticks,channel:_,deltaTime:0,type:"pitchBend",value:p.value}}function c(p){var _=[];return p.pitchBends.forEach(function(M){_.push(l(M,p.channel))}),_}function d(p){return{absoluteTime:0,channel:p.channel,deltaTime:0,programNumber:p.instrument.number,type:"programChange"}}function u(p){return{absoluteTime:0,deltaTime:0,meta:!0,text:p,type:"trackName"}}function f(p){return{absoluteTime:p.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/p.bpm),type:"setTempo"}}function h(p){return{absoluteTime:p.ticks,deltaTime:0,denominator:p.timeSignature[1],meta:!0,metronome:24,numerator:p.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}function m(p){var _=i.keySignatureKeys.indexOf(p.key);return{absoluteTime:p.ticks,deltaTime:0,key:_+7,meta:!0,scale:p.scale==="major"?0:1,type:"keySignature"}}function g(p){return{absoluteTime:p.ticks,deltaTime:0,meta:!0,text:p.text,type:p.type}}function y(p){var _={header:{format:1,numTracks:p.tracks.length+1,ticksPerBeat:p.header.ppq},tracks:t([t(t(t(t([{absoluteTime:0,deltaTime:0,meta:!0,text:p.header.name,type:"trackName"}],p.header.keySignatures.map(function(M){return m(M)}),!0),p.header.meta.map(function(M){return g(M)}),!0),p.header.tempos.map(function(M){return f(M)}),!0),p.header.timeSignatures.map(function(M){return h(M)}),!0)],p.tracks.map(function(M){return t(t(t([u(M.name),d(M)],s(M),!0),o(M),!0),c(M),!0)}),!0)};return _.tracks=_.tracks.map(function(M){M=M.sort(function(w,S){return w.absoluteTime-S.absoluteTime});var v=0;return M.forEach(function(w){w.deltaTime=w.absoluteTime-v,v=w.absoluteTime,delete w.absoluteTime}),M.push({deltaTime:0,meta:!0,type:"endOfTrack"}),M}),new Uint8Array((0,e.writeMidi)(_))}return ut.encode=y,ut}var Ko;function v_(){return Ko||(Ko=1,function(t){var e=dt&&dt.__awaiter||function(u,f,h,m){function g(y){return y instanceof h?y:new h(function(p){p(y)})}return new(h||(h=Promise))(function(y,p){function _(w){try{v(m.next(w))}catch(S){p(S)}}function M(w){try{v(m.throw(w))}catch(S){p(S)}}function v(w){w.done?y(w.value):g(w.value).then(_,M)}v((m=m.apply(u,f||[])).next())})},i=dt&&dt.__generator||function(u,f){var h={label:0,sent:function(){if(y[0]&1)throw y[1];return y[1]},trys:[],ops:[]},m,g,y,p;return p={next:_(0),throw:_(1),return:_(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function _(v){return function(w){return M([v,w])}}function M(v){if(m)throw new TypeError("Generator is already executing.");for(;h;)try{if(m=1,g&&(y=v[0]&2?g.return:v[0]?g.throw||((y=g.return)&&y.call(g),0):g.next)&&!(y=y.call(g,v[1])).done)return y;switch(g=0,y&&(v=[v[0]&2,y.value]),v[0]){case 0:case 1:y=v;break;case 4:return h.label++,{value:v[1],done:!1};case 5:h.label++,g=v[1],v=[0];continue;case 7:v=h.ops.pop(),h.trys.pop();continue;default:if(y=h.trys,!(y=y.length>0&&y[y.length-1])&&(v[0]===6||v[0]===2)){h=0;continue}if(v[0]===3&&(!y||v[1]>y[0]&&v[1]<y[3])){h.label=v[1];break}if(v[0]===6&&h.label<y[1]){h.label=y[1],y=v;break}if(y&&h.label<y[2]){h.label=y[2],h.ops.push(v);break}y[2]&&h.ops.pop(),h.trys.pop();continue}v=f.call(u,h)}catch(w){v=[6,w],g=0}finally{m=y=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Header=t.Track=t.Midi=void 0;var r=vc(),n=us(),s=qo(),a=g_(),o=function(){function u(f){var h=this,m=null;if(f){var g=f instanceof ArrayBuffer?new Uint8Array(f):f;m=(0,r.parseMidi)(g),m.tracks.forEach(function(y){var p=0;y.forEach(function(_){p+=_.deltaTime,_.absoluteTime=p})}),m.tracks=d(m.tracks)}this.header=new n.Header(m),this.tracks=[],f&&(this.tracks=m.tracks.map(function(y){return new s.Track(y,h.header)}),m.header.format===1&&this.tracks[0].duration===0&&this.tracks.shift())}return u.fromUrl=function(f){return e(this,void 0,void 0,function(){var h,m;return i(this,function(g){switch(g.label){case 0:return[4,fetch(f)];case 1:return h=g.sent(),h.ok?[4,h.arrayBuffer()]:[3,3];case 2:return m=g.sent(),[2,new u(m)];case 3:throw new Error("Could not load '".concat(f,"'"))}})})},Object.defineProperty(u.prototype,"name",{get:function(){return this.header.name},set:function(f){this.header.name=f},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"duration",{get:function(){var f=this.tracks.map(function(h){return h.duration});return Math.max.apply(Math,f)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"durationTicks",{get:function(){var f=this.tracks.map(function(h){return h.durationTicks});return Math.max.apply(Math,f)},enumerable:!1,configurable:!0}),u.prototype.addTrack=function(){var f=new s.Track(void 0,this.header);return this.tracks.push(f),f},u.prototype.toArray=function(){return(0,a.encode)(this)},u.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map(function(f){return f.toJSON()})}},u.prototype.fromJSON=function(f){var h=this;this.header=new n.Header,this.header.fromJSON(f.header),this.tracks=f.tracks.map(function(m){var g=new s.Track(void 0,h.header);return g.fromJSON(m),g})},u.prototype.clone=function(){var f=new u;return f.fromJSON(this.toJSON()),f},u}();t.Midi=o;var l=qo();Object.defineProperty(t,"Track",{enumerable:!0,get:function(){return l.Track}});var c=us();Object.defineProperty(t,"Header",{enumerable:!0,get:function(){return c.Header}});function d(u){for(var f=[],h=0;h<u.length;h++)for(var m=f.length,g=new Map,y=Array(16).fill(0),p=0,_=u[h];p<_.length;p++){var M=_[p],v=m,w=M.channel;if(w!==void 0){M.type==="programChange"&&(y[w]=M.programNumber);var S=y[w],C="".concat(S," ").concat(w);g.has(C)?v=g.get(C):(v=m+g.size,g.set(C,v))}f[v]||f.push([]),f[v].push(M)}return f}}(dt)),dt}var wc=v_();const Sc=["acoustic_grand_piano","bright_acoustic_piano","electric_grand_piano","honkytonk_piano","electric_piano_1","electric_piano_2","harpsichord","clavinet","celesta","glockenspiel","music_box","vibraphone","marimba","xylophone","tubular_bells","dulcimer","drawbar_organ","percussive_organ","rock_organ","church_organ","reed_organ","accordion","harmonica","tango_accordion","acoustic_guitar_nylon","acoustic_guitar_steel","electric_guitar_jazz","electric_guitar_clean","electric_guitar_muted","overdriven_guitar","distortion_guitar","guitar_harmonics","acoustic_bass","electric_bass_finger","electric_bass_pick","fretless_bass","slap_bass_1","slap_bass_2","synth_bass_1","synth_bass_2","violin","viola","cello","contrabass","tremolo_strings","pizzicato_strings","orchestral_harp","timpani","string_ensemble_1","string_ensemble_2","synth_strings_1","synth_strings_2","choir_aahs","voice_oohs","synth_choir","orchestra_hit","trumpet","trombone","tuba","muted_trumpet","french_horn","brass_section","synth_brass_1","synth_brass_2","soprano_sax","alto_sax","tenor_sax","baritone_sax","oboe","english_horn","bassoon","clarinet","piccolo","flute","recorder","pan_flute","blown_bottle","shakuhachi","whistle","ocarina","lead_1_square","lead_2_sawtooth","lead_3_calliope","lead_4_chiff","lead_5_charang","lead_6_voice","lead_7_fifths","lead_8_bass__lead","pad_1_new_age","pad_2_warm","pad_3_polysynth","pad_4_choir","pad_5_bowed","pad_6_metallic","pad_7_halo","pad_8_sweep","fx_1_rain","fx_2_soundtrack","fx_3_crystal","fx_4_atmosphere","fx_5_brightness","fx_6_goblins","fx_7_echoes","fx_8_scifi","sitar","banjo","shamisen","koto","kalimba","bagpipe","fiddle","shanai","tinkle_bell","agogo","steel_drums","woodblock","taiko_drum","melodic_tom","synth_drum","reverse_cymbal","guitar_fret_noise","breath_noise","seashore","bird_tweet","telephone_ring","helicopter","applause","gunshot"];function __(t){const e=t.split("/"),r=e[e.length-1].trim().toLowerCase().replace(/\s+/g,"_"),n=Sc.findIndex(s=>s===r);return n!==-1?n:(r.includes("drum")||r.includes("drummachine"),0)}async function b_(t){var h;const e=await t.arrayBuffer(),i=new wc.Midi(e),r=i.header.tempos[0],n=i.header.timeSignatures[0],s=(r==null?void 0:r.bpm)??120,a=((h=n==null?void 0:n.timeSignature)==null?void 0:h[0])??4,l=Math.max(0,...i.tracks.flatMap(m=>m.notes.map(g=>g.time+g.duration)))*(s/60),c=Math.ceil(l/a)||8,d={bpm:s,beatsPerMeasure:a,totalMeasures:c,songKey:"CM"},u=await sp(),f=i.tracks.map(m=>{const g=m.notes.map(S=>({pitch:S.name,start:S.time*(s/60),duration:S.duration*(s/60),velocity:Math.max(1,Math.min(127,Math.round(S.velocity*127)))}));let y=m.instrument.number;(y===void 0||y===0)&&(y=m.channel===9?0:m.channel%128);const p=m.controlChanges[7]||[],_=m.controlChanges[10]||[],M=p.length>0?p[0].value:void 0,v=_.length>0?_[0].value*2-1:void 0;let w;if(m.channel===9){const S=yp(y);S?w=`webaudiofont/${S.library}/${S.displayName}`:w=`sf2/drummachines/${u.includes("LM-2")?"LM-2":u[0]??"TR-808"}`}else w=`sf2/fluidr3-gm/${Sc[y]||"acoustic_grand_piano"}`;return{notes:g,instrument:w,volume:M,pan:v,config:{}}});return{globalConfig:d,tracks:f}}async function M_(t){if(!t.sequencers.length)throw new Error("No tracks to export.");const e=new wc.Midi;e.header.setTempo(t.tempo),e.header.timeSignatures.push({ticks:0,timeSignature:t.timeSignature});for(const[n,s]of t.sequencers.entries()){const a=e.addTrack(),o=s.instrument.toLowerCase().includes("drum");a.channel=o?9:n%16;const l=__(s.instrument);if(a.instrument.number=l,typeof s.volume=="number"&&a.addCC({number:7,time:0,value:Math.max(0,Math.min(1,s.volume))}),typeof s.pan=="number"){const c=(s.pan+1)/2;a.addCC({number:10,time:0,value:Math.max(0,Math.min(1,c))})}for(const c of s.notes){const d=Z(c.pitch),u=Math.max(.01,Math.min(1,(c.velocity??100)/127));if(d===null)continue;const f=$o(c.start,t.tempo),h=$o(c.duration,t.tempo);a.addNote({midi:d,time:f,duration:h,velocity:u})}}const i=new Blob([e.toArray()],{type:"audio/midi"});return{url:URL.createObjectURL(i),filename:`session-${Date.now()}.mid`}}function $o(t,e){return 60/e*t}function w_(){for(const t of j){const e=t.container;if(!e)continue;const i=e.querySelector(".sequencer-body"),r=e.querySelector("canvas.mini-contour"),n=e.querySelector(".collapse-btn use");!i||!r||i.classList.contains("hidden")||requestAnimationFrame(()=>{i.classList.add("hidden"),r.classList.remove("hidden"),n==null||n.setAttribute("href","#icon-caret-up"),t.setCollapsed(!0),Ki(r,t.notes,t.config,t.colorIndex)})}}function zo(t,e){R.isActive()&&R.pause(),aa(e.bpm),oa(e.beatsPerMeasure),la(e.totalMeasures),Qd(e.songKey);const i=document.getElementById("tempo-input");i&&(i.value=String(Ke()));const r=document.getElementById("measures-input");r&&(r.value=String(ca())),c0();for(const[s,a]of t.entries()){const o=s,l=a.instrument||"sf2/fluidr3-gm/acoustic_grand_piano",c=a.notes||[],d=a.volume,u=a.pan;D({type:"CREATE_SEQUENCER",id:o,instrument:l,notes:structuredClone(c),volume:d,pan:u,config:{...a.config||{}}},ta(o))}D(na("Session Loaded"),Xd("Session Loaded")),R.setSequencers(j),w_();const n=document.getElementById("global-mini-contour");n&&_0(n,j),un(0)}class ti{static async save(e){const i=H();if(e==="json"){const{url:r,filename:n}=i_(i);ti.download(r,n)}else if(e==="midi"){const{url:r,filename:n}=await M_(i);ti.download(r,n)}else throw new Error("Unsupported export format.")}static async saveWavWithOptions(e){const i=H();try{const r={globalConfig:{bpm:i.tempo,beatsPerMeasure:i.timeSignature[0],totalMeasures:i.totalMeasures,songKey:i.songKey},tracks:j.map(n=>({notes:n.notes,instrument:n.instrumentName,config:n.config,volume:n.volume,pan:n.pan}))};await r_(r,e)}catch(r){alert("Failed to export WAV: "+(r instanceof Error?r.message:"Unknown error"))}}static async load(e){var i;try{const r=(i=e.name.split(".").pop())==null?void 0:i.toLowerCase();if(r==="json"){const{tracks:n,globalConfig:s}=await s_(e);zo(n,s)}else if(r==="mid"||r==="midi"){const{tracks:n,globalConfig:s}=await b_(e);zo(n,s)}else throw new Error("Unsupported file type.")}catch(r){alert("Failed to load file: "+(r.message||"Unknown error"))}}static download(e,i){const r=document.createElement("a");r.href=e,r.download=i,r.click(),URL.revokeObjectURL(e)}}function S_(t,e){const i=t.querySelector("#export-cancel"),r=t.querySelector("#export-json"),n=t.querySelector("#export-wav"),s=t.querySelector("#export-midi"),a=()=>{t.classList.add("hidden")},o=async l=>{l==="wav"?(a(),e()):(await ti.save(l),a())};return i==null||i.addEventListener("click",a),r==null||r.addEventListener("click",()=>o("json")),n==null||n.addEventListener("click",()=>o("wav")),s==null||s.addEventListener("click",()=>o("midi")),{detach:()=>{i==null||i.removeEventListener("click",a),r==null||r.removeEventListener("click",()=>o("json")),n==null||n.removeEventListener("click",()=>o("wav")),s==null||s.removeEventListener("click",()=>o("midi"))},refreshUI:()=>{}}}class C_{constructor(e){this.detachFn=null,this.modal=t_(),document.body.appendChild(this.modal);const i=S_(this.modal,e);this.detachFn=i.detach}show(){this.modal.classList.remove("hidden")}hide(){this.modal.classList.add("hidden")}destroy(){var e;(e=this.detachFn)==null||e.call(this),this.modal.remove()}}function P_({id:t,label:e,options:i}){const r=K(),n=b("select",{id:t,class:["w-[80px] h-[40px] text-sm font-semibold rounded px-2 cursor-pointer",r.surfaceBackground,r.textColor,r.borderColor].join(" ")},...i.map(s=>b("option",{value:s.value},s.label)));return e?b("div",{class:"flex flex-col items-start gap-1"},he(e),n):n}class N_{constructor(){const e=K();this.sampleRateSelect=P_({id:"save-wav-sample-rate",options:[{value:"44100",label:"44,100 Hz (CD Quality)"},{value:"32000",label:"32,000 Hz"},{value:"22050",label:"22,050 Hz (Faster Export)"}]}),this.includePanCheckbox=b("input",{id:"save-wav-include-pan",type:"checkbox",checked:!0,class:"accent-purple-500"}),this.cancelButton=V({id:"save-wav-options-cancel-btn",text:"Cancel",kind:"secondary"}),this.applyButton=V({id:"save-wav-options-apply-btn",text:"Export",kind:"primary"});const i=[Tt("Export Settings"),ne("Choose your WAV export parameters."),b("div",{class:"z-10 mb-4 w-full"},he({text:"Sample Rate",for:"save-wav-sample-rate"}),this.sampleRateSelect),b("div",{class:"z-10 mb-6"},b("label",{class:`flex items-center gap-2 text-sm ${e.textColor}`},this.includePanCheckbox,"Include Panning in Export")),b("div",{class:"flex justify-end gap-4 z-10"},this.cancelButton,this.applyButton)];this.modalEl=$e("save-wav-options-modal",i,{sizePreset:"md"}),document.body.appendChild(this.modalEl),this.attachListeners()}attachListeners(){this.cancelButton.addEventListener("click",()=>this.hide()),this.applyButton.addEventListener("click",()=>{const e=parseInt(this.sampleRateSelect.value,10),i=this.includePanCheckbox.checked;this.hide(),ti.saveWavWithOptions({sampleRate:e,includePan:i})})}show(){this.modalEl.classList.remove("hidden")}hide(){this.modalEl.classList.add("hidden")}destroy(){this.modalEl.remove()}}function k_(){const t=Tt(" Load Project"),e=V({id:"import-json",text:"Load Project",kind:"primary"}),i=b("div",{class:"h-px bg-gray-600"}),r=V({id:"import-midi",text:"Import MIDI",kind:"secondary",additionalClasses:"bg-yellow-600 hover:bg-yellow-700"}),n=V({id:"import-cancel",text:"Cancel",kind:"tertiary",additionalClasses:"mt-6 w-full"}),s=b("div",{class:"flex flex-col gap-3 w-full z-10"},e,i,r);return $e("import-modal",[t,s,n])}function x_(t){const e=t.querySelector("#import-cancel"),i=t.querySelector("#import-json"),r=t.querySelector("#import-midi"),n=()=>{t.classList.add("hidden")},s=async l=>{const c=document.createElement("input");c.type="file",c.accept=l.join(","),c.onchange=async()=>{var d;(d=c.files)!=null&&d[0]&&(await ti.load(c.files[0]),n())},c.click()},a=()=>s([".json"]),o=()=>s([".mid",".midi"]);return e==null||e.addEventListener("click",n),i==null||i.addEventListener("click",a),r==null||r.addEventListener("click",o),{detach:()=>{e==null||e.removeEventListener("click",n),i==null||i.removeEventListener("click",a),r==null||r.removeEventListener("click",o)},refreshUI:()=>{}}}class L_{constructor(){this.detachFn=null,this.modal=k_(),document.body.appendChild(this.modal);const e=x_(this.modal);this.detachFn=e.detach}show(){this.modal.classList.remove("hidden")}hide(){this.modal.classList.add("hidden")}destroy(){var e;(e=this.detachFn)==null||e.call(this),this.modal.remove()}}function E_(){const t=b("h2",{class:"text-xl font-semibold mb-2 z-10 text-center",textContent:"Adjust Velocity"}),e=b("p",{class:"text-sm text-gray-400 mb-4 text-center z-10",textContent:"Apply a velocity transformation to the selected notes."}),i=b("input",{id:"velocity-set-toggle",type:"checkbox",class:"accent-purple-500",checked:!0}),r=b("label",{class:"flex items-center gap-2 text-sm mb-2"},i,"Set base velocity to"),n=b("select",{id:"velocity-action-select",class:"flex-1 bg-gray-700 border border-gray-600 rounded px-3 py-2 text-sm focus:outline-none focus:border-purple-500 cursor-pointer"},b("option",{value:"set"},"Set Velocity To"),b("option",{value:"increase"},"Increase Velocity By"),b("option",{value:"decrease"},"Decrease Velocity By")),s=b("input",{id:"velocity-value-input",type:"number",value:"100",min:"1",max:"127",class:"w-[100px] bg-gray-700 border border-gray-600 rounded px-3 py-2 text-sm focus:outline-none focus:border-purple-500"}),a=b("div",{id:"velocity-set-fields",class:"flex items-center gap-3"},n,s),o=b("div",{class:"z-10 mb-4"},r,a),l=b("input",{id:"velocity-ramp-toggle",type:"checkbox",class:"accent-purple-500"}),c=b("label",{class:"flex items-center gap-2 text-sm mb-2"},l,"Enable velocity ramp"),d=b("select",{id:"velocity-ramp-direction",class:"flex-1 bg-gray-700 border border-gray-600 rounded px-3 py-2 text-sm focus:outline-none focus:border-purple-500 cursor-pointer"},b("option",{value:"up"},"Ramp Up"),b("option",{value:"down"},"Ramp Down")),u=b("input",{id:"velocity-ramp-amount",type:"number",value:"10",min:"1",max:"127",placeholder:" per note",class:"w-[100px] bg-gray-700 border border-gray-600 rounded px-3 py-2 text-sm focus:outline-none focus:border-purple-500"}),f=b("div",{class:"flex items-center gap-2 mb-4 text-sm text-gray-300"},b("label",{class:"flex items-center gap-1"},b("input",{type:"radio",name:"ramp-mode",value:"linear",checked:!0,class:"accent-purple-500"}),"Linear"),b("label",{class:"flex items-center gap-1"},b("input",{type:"radio",name:"ramp-mode",value:"exponential",class:"accent-purple-500"}),"Exponential")),h=b("div",{id:"velocity-ramp-fields",class:"opacity-50 pointer-events-none"},b("div",{class:"flex items-center gap-3 mb-2"},d,u),f),m=b("div",{class:"border-t border-gray-700 pt-4 mt-4 z-10"},c,h),g=b("input",{id:"velocity-randomize-toggle",type:"checkbox",class:"accent-purple-500"}),y=b("label",{class:"flex items-center gap-2 text-sm mb-2"},g,"Add random variation"),p=b("input",{id:"velocity-random-range",type:"number",value:"5",min:"1",max:"64",class:"w-[80px] bg-gray-700 border border-gray-600 rounded px-2 py-1 text-sm focus:outline-none focus:border-purple-500"}),_=b("div",{id:"velocity-random-fields",class:"flex items-center gap-2 text-sm text-gray-300 opacity-50 pointer-events-none"},b("span",{textContent:""}),p),M=b("div",{class:"border-t border-gray-700 pt-4 mt-4 z-10"},y,_),v=b("div",{id:"velocity-preview-summary",class:"mt-6 text-sm text-gray-400 text-center z-10"}),w=V({id:"velocity-apply-btn",text:"Apply",kind:"primary"}),S=V({id:"velocity-cancel-btn",text:"Cancel",kind:"tertiary"}),C=b("div",{class:"flex gap-3 mt-6 z-10"},w,S);return $e("velocity-modal",[t,e,o,m,M,v,C])}function A_(t){const e=gc();if(!e){console.warn("No active note selection to apply velocity changes.");return}const{sequencerId:i,selectedNotes:r}=e;if(r.length===0){console.warn("No notes selected in the active sequencer.");return}const n=Bt().find(p=>p.id===i);if(!(n!=null&&n.matrix)){console.warn(`Could not find matrix for sequencer ID ${i}.`);return}const s=r.map(p=>({...p})),{mode:a,value:o,rampDirection:l="none",rampAmount:c=0,rampMode:d="linear",randomize:u=!1,randomRange:f=0}=t,h=r.map((p,_)=>({note:p,originalIndex:_}));h.sort((p,_)=>p.note.start-_.note.start);const m=new Map;for(const p of h){const _=p.note.start;m.has(_)||m.set(_,[]),m.get(_).push(p)}Array.from(m.entries()).sort((p,_)=>p[0]-_[0]).map(([,p])=>p).forEach((p,_)=>{let M=d==="linear"?_:Math.pow(_,1.3),v=c*M;l==="down"&&(v=-v);for(const{note:w}of p){let S;switch(a){case"set":S=Math.max(1,o);break;case"increase":S=(w.velocity??100)+o;break;case"decrease":S=(w.velocity??100)-o;break;case"none":default:S=w.velocity??100;break}let C=S+v;if(u&&f>0){const P=(Math.random()*2-1)*f;C+=P}w.velocity=Math.max(1,Math.min(127,Math.round(C)))}});const y=h.sort((p,_)=>p.originalIndex-_.originalIndex).map(({note:p})=>({...p}));D(Eg(i,y),Ag(i,s))}function B_(t){const e=document.getElementById("velocity-modal");e&&e.classList.remove("hidden")}function qn(){const t=document.getElementById("velocity-modal");t&&t.classList.add("hidden")}function T_(t){var h;const e=t.querySelector("#velocity-apply-btn"),i=t.querySelector("#velocity-cancel-btn"),r=t.querySelector("#velocity-set-toggle"),n=((h=t.querySelector("#velocity-action-select"))==null?void 0:h.parentElement)??null,s=t.querySelector("#velocity-ramp-toggle"),a=t.querySelector("#velocity-ramp-fields"),o=t.querySelector("#velocity-randomize-toggle"),l=t.querySelector("#velocity-random-fields");function c(m,g){if(!m||!g)return;const y=m.checked;g.classList.toggle("opacity-50",!y),g.classList.toggle("pointer-events-none",!y)}function d(){r==null||r.addEventListener("change",()=>c(r,n)),s==null||s.addEventListener("change",()=>c(s,a)),o==null||o.addEventListener("change",()=>c(o,l)),c(r,n),c(s,a),c(o,l)}function u(){var P,k,N,L,x,T;const m=(r==null?void 0:r.checked)??!0,g=(s==null?void 0:s.checked)??!1,y=(o==null?void 0:o.checked)??!1,p=m?(P=t.querySelector("#velocity-action-select"))==null?void 0:P.value:"none",_=parseInt(((k=t.querySelector("#velocity-value-input"))==null?void 0:k.value)??"",10),M=isNaN(_)?100:Math.max(1,Math.min(127,_)),v=g?(N=t.querySelector("#velocity-ramp-direction"))==null?void 0:N.value:"none",w=g?parseInt(((L=t.querySelector("#velocity-ramp-amount"))==null?void 0:L.value)??"0",10):0,S=g?(x=t.querySelector('input[name="ramp-mode"]:checked'))==null?void 0:x.value:"linear",C=y?parseInt(((T=t.querySelector("#velocity-random-range"))==null?void 0:T.value)??"0",10):0;A_({mode:p,value:M,rampDirection:v,rampAmount:w,rampMode:S,randomize:y,randomRange:C}),qn()}const f=()=>{i==null||i.removeEventListener("click",qn),e==null||e.removeEventListener("click",u),r==null||r.removeEventListener("change",()=>c(r,n)),s==null||s.removeEventListener("change",()=>c(s,a)),o==null||o.removeEventListener("change",()=>c(o,l))};return i==null||i.addEventListener("click",qn),e==null||e.addEventListener("click",u),d(),{detach:f,refreshUI:()=>{}}}class I_{constructor(){this.detachFn=null,this.modal=E_(),document.body.appendChild(this.modal);const e=T_(this.modal);this.detachFn=e.detach}show(e){B_()}hide(){this.modal.classList.add("hidden")}destroy(){var e;(e=this.detachFn)==null||e.call(this),this.modal.remove()}}const G_="v0.1.0",O_="May 11, 2025",D_=[" New Features","-  Added customizable interface skins via user config","-  Rewrote sequencer grid from the ground up for responsiveness, faster rendering, and zoomable matrix layout","-  Introduced Express Note Tool as the new default for intuitive, fast note placement (Classic mode still available)","-  Added song key selection with support for transposed piano roll and in-key snapping","-  Rebuilt transport controls with higher resolution layout and improved submenu behavior","-  Introduced granular snap controls (toggle snapping, in-key snapping, full off)","-  Added right-click marquee selection, shift multi-selection, and consistent hover behavior","-  Enabled drag threshold-aware note dragging directly from selection with improved state tracking","-  Implemented keyboard shortcuts for transport, navigation (e.g. Shift+WASD), and tool toggles"," Known Issues","-  Note placement during live playback of large sequences causes performance issues"," Roadmap","-  AI-assisted generation and track extension tools (May rollout)"];function F_(){const t=he({text:`${G_}  Updated ${O_}`});t.id="whats-new-metadata",t.classList.add("italic","text-gray-400","text-center","self-center","mb-4");const e=b("ul",{id:"whats-new-content",class:"list-disc list-inside text-left space-y-2 text-md w-full"});let i=null;for(const a of D_)if(a.startsWith("")||a.startsWith("")||a.startsWith("")){const o=b("li",{class:"font-bold mt-6 text-lg",textContent:a});e.appendChild(o),i=b("ul",{class:"list-disc list-inside ml-6 mt-2 space-y-1"}),e.appendChild(i)}else if(i){const o=b("li",{textContent:a.replace(/^- /,"")});i.appendChild(o)}const r=b("img",{src:Et("static/logo.png"),alt:"Sequenzia",class:"w-[180px] h-auto rounded-xl mb-6 self-center"}),n=V({id:"whats-new-close-btn",text:"Close",kind:"primary",additionalClasses:"mt-8 self-center text-base px-6 py-2 font-medium"}),s=Tt({text:" What's New in Sequenzia",size:"xl",additionalClasses:"text-center self-center"});return $e("whats-new-modal",[r,s,t,e,n],{sizePreset:"xl"})}function R_(t){const e=t.querySelector("#whats-new-close-btn"),i=()=>{t.style.opacity="0",t.style.transition="opacity 0.4s ease-out",setTimeout(()=>{t.classList.add("hidden"),t.style.opacity="1"},400)};return e==null||e.addEventListener("click",i),{detach:()=>{e==null||e.removeEventListener("click",i)},refreshUI:()=>{}}}class U_{constructor(){this.detachFn=null,this.modal=F_(),document.body.appendChild(this.modal);const e=R_(this.modal);this.detachFn=e.detach}show(){this.modal.classList.remove("hidden"),this.modal.style.opacity="1"}hide(){this.modal.style.opacity="0",this.modal.style.transition="opacity 0.4s ease-out",setTimeout(()=>{this.modal.classList.add("hidden"),this.modal.style.opacity="1"},400)}destroy(){var e;(e=this.detachFn)==null||e.call(this),this.modal.remove()}}class H_{constructor(e,i){this.contour=null,this.miniCanvas=null,this.sideButtons=null,this.detachFns=[],this.refreshFns=[],this.engine=e,this.userConfigModalController=i,this.playbackService=new Z0(this.engine),this.initializeUI()}initializeUI(){this.controls=new k0,this.wavOptionsModal=new N_,this.saveModal=new C_(()=>this.wavOptionsModal.show()),this.loadModal=new L_,this.velocityModal=new I_,this.whatsNewModal=new U_;const e=L0(),i=T0(),r=U0(),n=I0();this.controls.getGlobalPlayheadRow().appendChild(e),this.controls.getGlobalToolsRow().appendChild(i.element),this.controls.getGlobalTransportRow().appendChild(r.element);const s=document.getElementById("footer-main");s&&s.appendChild(n),this.miniCanvas=this.getGlobalMiniContourCanvas(),this.sideButtons=n,this.contour=e;const a=j0(e),o=K0(i.element),l=z0(r.element,this.playbackService,this.userConfigModalController,this.saveModal,this.loadModal),c=$0(n,this.whatsNewModal),d=J0(this.controls.getGlobalPlayheadRow()),u=X0({velocity:this.velocityModal});this.detachFns=[a.detach,o.detach,l.detach,c.detach,d.detach,u.detach,i.refreshGridSettings],this.refreshFns=[a.refreshUI,o.refreshUI,l.refreshUI,c.refreshUI,d.refreshUI,u.refreshUI,r.refreshToggles],Fi(),this.initPlayhead()}initPlayhead(){if(!this.contour)return;const e=this.contour.querySelector("#global-mini-playhead");e&&(V0(e),this.playbackService.setPlayheadCanvasWidth(e.width))}getPlaybackService(){return this.playbackService}getGlobalMiniContourCanvas(){var e;return((e=this.contour)==null?void 0:e.querySelector("#global-mini-contour"))??null}show(){this.refreshFns.forEach(e=>e()),this.controls.render().classList.remove("hidden")}hide(){this.controls.render().classList.add("hidden")}destroy(){var e,i,r,n,s,a;this.detachFns.forEach(o=>o()),this.controls.destroy(),(e=this.sideButtons)!=null&&e.parentNode&&this.sideButtons.parentNode.removeChild(this.sideButtons),this.sideButtons=null,(i=this.wavOptionsModal)==null||i.destroy(),(r=this.saveModal)==null||r.destroy(),(n=this.loadModal)==null||n.destroy(),(s=this.velocityModal)==null||s.destroy(),(a=this.whatsNewModal)==null||a.destroy()}reload(){this.destroy(),this.initializeUI()}}function q_(){const t=b("div",{class:"absolute inset-0 rounded-2xl border-2 border-purple-500 opacity-30 blur-xl animate-pulse pointer-events-none"}),e=b("h2",{class:"text-xl font-semibold mb-4 text-center tracking-wide z-10",textContent:"Oops!"}),i=b("div",{id:"error-message-content",class:["bg-gray-700 text-gray-100 rounded-xl px-4 py-3 text-sm whitespace-pre-wrap","z-10 max-h-[240px] overflow-y-auto text-center"].join(" ")}),r=V({id:"error-close-btn",text:"Close",kind:"primary",additionalClasses:"mt-8 self-center text-base px-6 py-2 font-medium"});return $e("error-modal",[t,e,i,r],{widthClass:"w-[420px]",maxWidthClass:"max-w-full"})}function j_(t){const e=t.querySelector("#error-close-btn"),i=t.querySelector("div.relative"),r=()=>{t.style.opacity="0",t.style.transition="opacity 0.3s ease-out",setTimeout(()=>{t.classList.add("hidden"),t.style.opacity="1"},300)},n=s=>{i&&(i.contains(s.target)||r())};return e==null||e.addEventListener("click",r),t.addEventListener("mousedown",n),{detach:()=>{e==null||e.removeEventListener("click",r),t.removeEventListener("mousedown",n)},refreshUI:()=>{}}}class K_{constructor(){this.detachFn=null,this.modal=q_(),this.messageBox=this.modal.querySelector("#error-message-content"),document.body.appendChild(this.modal);const e=j_(this.modal);this.detachFn=e.detach}show(e){this.messageBox.textContent=e,this.modal.classList.remove("hidden"),this.modal.style.opacity="1"}hide(){this.modal.classList.add("hidden"),this.modal.style.opacity="1"}destroy(){var e;(e=this.detachFn)==null||e.call(this),this.modal.remove()}}function $_(){const t=b("div",{class:"absolute inset-0 rounded-2xl border-2 border-purple-500 opacity-30 blur-xl animate-pulse pointer-events-none"}),e=b("div",{class:"text-[100px] mb-4 z-10 animate-bounce text-center",textContent:""}),i=b("div",{class:"text-xl font-semibold text-white z-10 tracking-wide text-center",textContent:"Feature Not Implemented"}),r=b("div",{class:"text-sm text-gray-400 mt-2 z-10 text-center",innerHTML:"This part of Sequenzia is still under construction.<br />Check back soon!"}),n=V({id:"feature-modal-close-btn",text:"Got it",kind:"primary",additionalClasses:"mt-6 self-center z-10 px-6 py-2 text-base"});return $e("feature-not-implemented-modal",[t,e,i,r,n],{widthClass:"w-[400px]",maxWidthClass:"max-w-full"})}function z_(t){const e=t.querySelector("#feature-modal-close-btn"),i=t.querySelector("div.relative"),r=()=>{t.style.opacity="0",t.style.transition="opacity 0.3s ease-out",setTimeout(()=>{t.classList.add("hidden"),t.style.opacity="1"},300)},n=s=>{i&&(i.contains(s.target)||r())};return e==null||e.addEventListener("click",r),t.addEventListener("mousedown",n),{detach:()=>{e==null||e.removeEventListener("click",r),t.removeEventListener("mousedown",n)},refreshUI:()=>{}}}class V_{constructor(){this.detachFn=null,this.modal=$_(),document.body.appendChild(this.modal);const e=z_(this.modal);this.detachFn=e.detach}show(){this.modal.classList.remove("hidden"),this.modal.style.opacity="1"}hide(){this.modal.classList.add("hidden"),this.modal.style.opacity="1"}destroy(){var e;(e=this.detachFn)==null||e.call(this),this.modal.remove()}}function W_(){const t=b("div",{class:"absolute inset-0 rounded-2xl border-2 border-purple-500 opacity-30 blur-xl animate-pulse pointer-events-none"}),e=b("div",{class:"flex justify-center items-center space-x-3 mb-6 z-10"},b("div",{class:"w-4 h-4 bg-purple-400 rounded-full animate-bounce",style:"animation-delay: 0s"}),b("div",{class:"w-4 h-4 bg-purple-400 rounded-full animate-bounce",style:"animation-delay: 0.1s"}),b("div",{class:"w-4 h-4 bg-purple-400 rounded-full animate-bounce",style:"animation-delay: 0.2s"})),i=b("div",{id:"loading-modal-title",class:"text-xl font-semibold text-white z-10 tracking-wide text-center",textContent:"Loading Sounds..."}),r=b("div",{id:"loading-modal-subtext",class:"text-sm text-gray-400 mt-2 z-10 text-center",textContent:"Please wait while we dial it in."}),n=b("button",{id:"loading-modal-cancel",class:"cursor-pointer mt-6 z-10 text-sm text-purple-400 hover:text-purple-300 underline hidden",textContent:"Cancel"});return $e("loading-modal",[t,e,i,r,n],{widthClass:"w-[360px]",maxWidthClass:"max-w-full"})}function J_(t,e){const i=t.querySelector("#loading-modal-cancel"),r=()=>{e()};return i==null||i.addEventListener("click",r),{detach:()=>{i==null||i.removeEventListener("click",r)},refreshUI:()=>{}}}class X_{constructor(e){this.detachFn=null,this.modal=W_(),this.titleEl=this.modal.querySelector("#loading-modal-title"),this.subtextEl=this.modal.querySelector("#loading-modal-subtext"),this.cancelBtn=this.modal.querySelector("#loading-modal-cancel"),document.body.appendChild(this.modal);const i=J_(this.modal,e);this.detachFn=i.detach}show(e){e!=null&&e.title&&(this.titleEl.textContent=e.title),e!=null&&e.subtext&&(this.subtextEl.textContent=e.subtext),this.cancelBtn.classList.toggle("hidden",!(e!=null&&e.cancelable)),this.modal.classList.remove("hidden"),this.modal.style.opacity="1"}hide(){this.modal.classList.add("hidden"),this.modal.style.opacity="1"}destroy(){var e;(e=this.detachFn)==null||e.call(this),this.modal.remove()}}class Y_{constructor(e){this.onCancelLoading=e,this.initialize()}initialize(){this.errorModal=new K_,this.featureModal=new V_,this.loadingModal=new X_(this.onCancelLoading)}showError(e){this.errorModal.show(e)}showFeatureBlocked(){this.featureModal.show()}showLoading(e){this.loadingModal.show(e)}hideLoading(){this.loadingModal.hide()}destroy(){var e,i,r;(e=this.errorModal)==null||e.destroy(),(i=this.featureModal)==null||i.destroy(),(r=this.loadingModal)==null||r.destroy()}reload(){this.destroy(),this.initialize()}}function Z_(t,e){window.addEventListener("keydown",i=>{const r=(i.ctrlKey||i.metaKey)&&i.key.toLowerCase()==="z",n=(i.ctrlKey||i.metaKey)&&(i.key.toLowerCase()==="y"||i.shiftKey&&i.key.toLowerCase()==="z");if(!r&&!n)return;i.preventDefault(),i.target instanceof HTMLElement&&i.target.matches('input, textarea, [contenteditable="true"]')||(r?t():e())},{capture:!0})}function Q_(){const t=b("canvas",{id:"waveform",width:1260,height:100,class:"rounded border border-purple-800 bg-gray-900"}),e=b("button",{id:"visualizer-mode",class:"side-button side-button-primary",title:"Change visualizer mode",textContent:""}),i=b("div",{class:"flex flex-col gap-2"},e),r=b("div",{class:"flex items-start gap-2"},t,i),n=document.getElementById("visualizer-container");return n&&n.appendChild(r),r}function eb(t,e){const i=e.getContext("2d");if(!i)throw new Error("Canvas 2D context not available");const r=e.width,n=e.height,s=new Uint8Array(t.fftSize),a=new Uint8Array(t.frequencyBinCount),o=document.createElement("canvas");o.width=r,o.height=n;const l=o.getContext("2d");if(!l)throw new Error("Offscreen canvas 2D context not available");let c="frequency";function d(){if(!i)return;t.getByteTimeDomainData(s),i.fillStyle="#000",i.fillRect(0,0,r,n),i.lineWidth=2,i.strokeStyle="#00ffcc",i.beginPath();const m=r/s.length;let g=0;for(let y=0;y<s.length;y++){const _=s[y]/128*n/2;y===0?i.moveTo(g,_):i.lineTo(g,_),g+=m}i.lineTo(r,n/2),i.stroke()}function u(){if(t.getByteFrequencyData(a),!i)return;i.fillStyle="#000",i.fillRect(0,0,r,n),i.fillStyle="rgba(255,255,255,0.2)",i.fillRect(0,0,1,n),i.fillRect(r-1,0,1,n);const m=128,g=2,y=[];for(let p=0;p<m;p++)y.push(p*r/(m-1));y[y.length-1]=r-1;for(let p=0;p<m;p++){const _=y[p],M=p<m-1?y[p+1]:r,v=Math.max(1,M-_-g),w=20,S=2e4,C=p/(m-1),P=w*Math.pow(S/w,C),N=Math.min(a.length-1,Math.floor(P/22050*a.length)),L=a[N]/255,x=Math.max(1,L*n),T=240-C*240;i.fillStyle=`hsl(${T}, ${80+L*20}%, ${40+L*40}%)`,i.fillRect(_,n-x,v,x)}}function f(){if(t.getByteFrequencyData(a),!l)return;o.initialized||(l.fillStyle="#000",l.fillRect(0,0,r,n),o.initialized=!0),l.drawImage(o,-1,0),l.fillStyle="#000",l.fillRect(r-1,0,1,n);const m=128,g=20,y=2e4;for(let p=0;p<m;p++){const _=p/(m-1),M=g*Math.pow(y/g,_),w=Math.min(a.length-1,Math.floor(M/22050*a.length)),S=a[w]/255,C=n-1-Math.floor(p*n/m);if(S<.05)continue;const P=Math.floor(S*255),k=Math.floor(S*(255-_*200)),N=Math.floor(S*(100+_*155));l.fillStyle=`rgb(${P}, ${k}, ${N})`,l.fillRect(r-1,C,1,1)}i&&(i.fillStyle="#000",i.fillRect(0,0,r,n),i.drawImage(o,0,0))}function h(){switch(requestAnimationFrame(h),c){case"frequency":u();break;case"spectrogram":f();break;case"waveform":default:d()}}return h(),{setMode(m){["waveform","frequency","spectrogram"].includes(m)&&(c=m,i.clearRect(0,0,r,n),c==="spectrogram"&&l.clearRect(0,0,r,n))}}}function tb(t){const e=t.querySelector("#waveform"),i=t.querySelector("#visualizer-mode");if(!e||!i)return console.warn("Visualizer setup failed: missing canvas or button"),{detach:()=>{},refreshUI:()=>{}};const r=eb(td(),e),n=[{name:"waveform",emoji:""},{name:"frequency",emoji:""},{name:"spectrogram",emoji:""}];let s=0;function a(){if(!i)return;s=(s+1)%n.length;const{name:o,emoji:l}=n[s];r.setMode(o),i.textContent=l,i.title=`Mode: ${o}`}return i.addEventListener("click",a),a(),{detach:()=>{i.removeEventListener("click",a)},refreshUI:()=>{i.textContent=n[s].emoji,i.title=`Mode: ${n[s].name}`}}}class ib{constructor(){this.detachFn=null,this.refreshFn=null,this.initializeUI()}initializeUI(){this.container=Q_();const e=tb(this.container);this.detachFn=e.detach,this.refreshFn=e.refreshUI}show(){var e;this.container.classList.remove("hidden"),(e=this.refreshFn)==null||e.call(this)}hide(){this.container.classList.add("hidden")}destroy(){var e;(e=this.detachFn)==null||e.call(this),this.container.remove()}reload(){this.destroy(),this.initializeUI()}}function rb(){const t=b("div",{id:"left-sidebutton-column",class:"absolute left-[-46px] flex flex-col gap-2 z-10"},b("button",{id:"piano-toggle-btn",class:"side-button side-button-info",title:"Toggle Piano View",textContent:""}),b("button",{id:"mixer-toggle-btn",class:"side-button side-button-info",title:"Toggle Mixer View",textContent:""}),b("button",{id:"ai-toggle-btn",class:"side-button side-button-info",title:"Toggle AI View",textContent:""})),e=document.getElementById("top-controls-container");return e?e.appendChild(t):console.warn("[SideMenuUI] #top-controls-container not found."),t}function nb(t){const e=t.querySelector("#piano-toggle-btn"),i=t.querySelector("#mixer-toggle-btn"),r=t.querySelector("#ai-toggle-btn"),n=()=>{Le.showFeatureBlocked()},s=()=>{Le.showFeatureBlocked()},a=()=>{Le.showFeatureBlocked()};return e==null||e.addEventListener("click",n),i==null||i.addEventListener("click",s),r==null||r.addEventListener("click",a),{detach:()=>{e==null||e.removeEventListener("click",n),i==null||i.removeEventListener("click",s),r==null||r.removeEventListener("click",a)},refreshUI:()=>{}}}class sb{constructor(){this.detachFn=null,this.refreshFn=null,this.initializeUI()}initializeUI(){this.container=rb();const e=nb(this.container);this.detachFn=e.detach,this.refreshFn=e.refreshUI}show(){var e;this.container.classList.remove("hidden"),(e=this.refreshFn)==null||e.call(this)}hide(){this.container.classList.add("hidden")}destroy(){var e;(e=this.detachFn)==null||e.call(this),this.container.remove()}reload(){this.destroy(),this.initializeUI()}}function ab(){const t=b("canvas",{id:"piano",width:1260,height:200,class:"rounded shadow-lg border border-purple-700"}),e=b("button",{id:"octave-up",class:"side-button side-button-primary",title:"Octave Up"},z("icon-arrow-up","Octave Up")),i=b("button",{id:"octave-down",class:"side-button side-button-primary",title:"Octave Down"},z("icon-arrow-down","Octave Down")),r=b("button",{id:"global-instrument-select-btn",class:"side-button side-button-primary",title:"Select Instrument"},z("icon-list-instrument","Instrument")),n=b("button",{id:"disable-keyboard-inputs",class:"side-button side-button-secondary",title:"Toggle Keyboard Input"},z("icon-keyboard","Keyboard Input")),s=b("div",{class:"flex flex-col gap-2"},e,i,r,n);return{wrapper:b("div",{class:"flex items-start gap-2"},t,s),canvas:t}}function Vo(t,e){const i=parseInt(t.replace("#",""),16),r=Math.round(2.55*e),n=Math.max(0,Math.min(255,(i>>16)+r)),s=Math.max(0,Math.min(255,(i>>8&255)+r)),a=Math.max(0,Math.min(255,(i&255)+r));return`rgb(${n},${s},${a})`}function Gi(t,e,i=new Set,r=null){t.clearRect(0,0,t.canvas.width,t.canvas.height);const{whiteKeyColor:n,blackKeyColor:s}=K(),a={};if(r)for(const[o,l]of Object.entries(r))a[l]=o;for(const o of Object.values(e))if(!o.isBlack){const l=t.createLinearGradient(0,0,0,o.height);i.has(o.note)?(l.addColorStop(0,"#99cfff"),l.addColorStop(1,"#cce0ff")):(l.addColorStop(0,Vo(n,-20)),l.addColorStop(1,n)),Wo(t,{...o,fill:l,stroke:"#333",radius:6}),t.fillStyle="#333",t.font="12px sans-serif",t.textAlign="center",a[o.note]&&(t.fillStyle="#7c3aed",t.fillText(a[o.note],o.x+o.width/2,o.height-24),t.fillStyle="#333"),t.fillText(o.note,o.x+o.width/2,o.height-8)}for(const o of Object.values(e))if(o.isBlack){const l=t.createLinearGradient(0,0,0,o.height);i.has(o.note)?(l.addColorStop(0,"#3040ff"),l.addColorStop(1,"#4a60ff")):(l.addColorStop(0,Vo(s,-20)),l.addColorStop(1,s)),Wo(t,{...o,fill:l,stroke:"#000000",radius:4}),a[o.note]&&(t.fillStyle="#c084fc",t.font="10px sans-serif",t.textAlign="center",t.fillText(a[o.note],o.x+o.width/2,o.height-28))}}function Wo(t,e){const{x:i,width:r,height:n,fill:s,stroke:a,radius:o=8}=e;t.beginPath(),t.moveTo(i,0),t.lineTo(i,n-o),t.quadraticCurveTo(i,n,i+o,n),t.lineTo(i+r-o,n),t.quadraticCurveTo(i+r,n,i+r,n-o),t.lineTo(i+r,0),t.closePath(),t.fillStyle=s,t.fill(),t.strokeStyle=a,t.lineWidth=1,t.stroke()}function ob(t){const e=t.getContext("2d");if(!e)throw new Error("Canvas context unavailable.");const i=new Map,r=new Set;let n=!1;function s(h,m){const g=Kt();for(const y of Object.values(g))if(y.isBlack&&h>=y.x&&h<=y.x+y.width&&m>=0&&m<=y.height)return y.note;for(const y of Object.values(g))if(!y.isBlack&&h>=y.x&&h<=y.x+y.width&&m>=0&&m<=y.height)return y.note;return null}function a(h){if(!h||r.has(h)||!e)return;const m=Gp(h);m&&(i.set(h,m),r.add(h),Gi(e,Kt(),r,void 0))}function o(h){if(!r.has(h)||!e)return;const m=i.get(h);m&&(m.stop(),i.delete(h)),r.delete(h),Gi(e,Kt(),r,void 0)}function l(){for(const h of r)o(h)}const c=h=>{n=!0;const m=t.getBoundingClientRect(),g=h.clientX-m.left,y=h.clientY-m.top,p=s(g,y);a(p)},d=h=>{if(!n)return;const m=t.getBoundingClientRect(),g=h.clientX-m.left,y=h.clientY-m.top,p=s(g,y);a(p)},u=()=>{n=!1,l()},f=()=>{n=!1,l()};return t.addEventListener("mousedown",c),t.addEventListener("mousemove",d),t.addEventListener("mouseup",u),t.addEventListener("mouseleave",f),{detach:()=>{t.removeEventListener("mousedown",c),t.removeEventListener("mousemove",d),t.removeEventListener("mouseup",u),t.removeEventListener("mouseleave",f)},refreshUI:()=>{}}}const Cc=[..."qwertyuiop[zxcvbnm,./"],Pc=["2","3","5","6","7","9","0","=","s","d","g","h","k","l",";"];function lb(t){const e=t.getContext("2d");if(!e)throw new Error("Canvas context unavailable.");const i=new Set,r=new Set,n=new Map;function s(){const d=Kt(),u=Object.values(d).filter(m=>!m.isBlack).sort((m,g)=>m.x-g.x).map(m=>m.note),f=Object.values(d).filter(m=>m.isBlack).sort((m,g)=>m.x-g.x).map(m=>m.note),h={};return Cc.forEach((m,g)=>{u[g]&&(h[m]=u[g])}),Pc.forEach((m,g)=>{f[g]&&(h[m]=f[g])}),h}function a(d){const u=s(),f=u[d];if(!(!f||i.has(d)||!e)){if(i.add(d),!r.has(f)){const h=ed(f,100,Ep());h&&(n.set(f,{stop:h}),r.add(f))}Gi(e,Kt(),r,u)}}function o(d){const u=s(),f=u[d];!f||!e||(i.delete(d),r.has(f)&&(Tp(f),n.delete(f),r.delete(f)),Gi(e,Kt(),r,u))}const l=d=>{d.repeat||!wt()||a(d.key)},c=d=>{wt()&&o(d.key)};return window.addEventListener("keydown",l),window.addEventListener("keyup",c),{detach:()=>{window.removeEventListener("keydown",l),window.removeEventListener("keyup",c)},refreshUI:()=>{}}}function Jo(t,e){e?(t.classList.remove("side-button-secondary","side-button-primary"),t.classList.add("side-button-activated")):(t.classList.remove("side-button-activated"),t.classList.add("side-button-secondary"))}function db(t){const e=Object.values(t).filter(n=>!n.isBlack).sort((n,s)=>n.x-s.x).map(n=>n.note),i=Object.values(t).filter(n=>n.isBlack).sort((n,s)=>n.x-s.x).map(n=>n.note),r={};return Cc.forEach((n,s)=>{e[s]&&(r[n]=e[s])}),Pc.forEach((n,s)=>{i[s]&&(r[n]=i[s])}),r}function cb(t){const e=t.querySelector("#piano"),i=e==null?void 0:e.getContext("2d");if(!e||!i)throw new Error("Keyboard canvas not available");const r=t.querySelector("#octave-up"),n=t.querySelector("#octave-down"),s=t.querySelector("#disable-keyboard-inputs"),a=t.querySelector("#global-instrument-select-btn");function o(){if(!i)return;const f=kn(),h=Xl(f);Bp(h),s&&Jo(s,wt());const m=wt()?db(h):null;Gi(i,h,new Set,m??void 0)}const l=()=>{const f=kn();f<7&&(so(f+1),o())},c=()=>{const f=kn();f>1&&(so(f-1),o())},d=()=>{const f=wt();Ap(!f),o(),s&&Jo(s,!f)},u=async()=>{const f=Qr()||"sf2/fluidr3-gm/acoustic_grand_piano",h=document.getElementById("instrument-select-modal");if(!h){console.warn("[Keyboard] Instrument selector modal not found in DOM.");return}delete h.dataset.currentSequencer,await fa(f),h.classList.remove("hidden")};return r==null||r.addEventListener("click",l),n==null||n.addEventListener("click",c),s==null||s.addEventListener("click",d),a==null||a.addEventListener("click",u),{detach:()=>{r==null||r.removeEventListener("click",l),n==null||n.removeEventListener("click",c),s==null||s.removeEventListener("click",d),a==null||a.removeEventListener("click",u)},refreshUI:o}}class ub{constructor(){this.detachFns=[],this.refreshFns=[];const{wrapper:e,canvas:i}=ab();this.wrapper=e,this.canvas=i}render(){return this.wrapper}initialize(){Lp();const e=Qr();fa(e);const i=ob(this.canvas),r=lb(this.canvas),n=cb(this.wrapper);this.detachFns=[i.detach,r.detach,n.detach],this.refreshFns=[i.refreshUI,r.refreshUI,n.refreshUI],this.refresh()}refresh(){this.refreshFns.forEach(e=>e())}hide(){this.wrapper.classList.add("hidden")}show(){this.wrapper.classList.remove("hidden"),this.refresh()}destroy(){this.detachFns.forEach(e=>e()),this.wrapper.parentNode&&this.wrapper.parentNode.removeChild(this.wrapper)}}class hb{constructor(){this.activeMode="keyboard",this.activeElement=null,this.detachFns=[];const e=document.getElementById("top-controls-container");if(!e)throw new Error("#top-controls-container not found in DOM");this.container=e,this.initialize()}initialize(){this.sideMenuController=new sb,this.keyboardController=new ub,this.setMode("keyboard")}setMode(e){if(this.activeElement){if(this.activeMode===e)return;this.container.removeChild(this.activeElement),this.activeElement=null}switch(this.activeMode=e,e){case"keyboard":this.activeElement=this.keyboardController.render(),this.container.appendChild(this.activeElement),this.keyboardController.initialize();break;case"ai":this.activeElement=this.createStub("AI View not implemented"),this.container.appendChild(this.activeElement);break;case"mixer":this.activeElement=this.createStub("Mixer View not implemented"),this.container.appendChild(this.activeElement);break}}getCurrentMode(){return this.activeMode}destroy(){var e,i,r;this.detachFns.forEach(n=>n()),this.detachFns=[],(e=this.sideMenuController)==null||e.destroy(),(i=this.keyboardController)==null||i.destroy(),((r=this.activeElement)==null?void 0:r.parentNode)===this.container&&this.container.removeChild(this.activeElement),this.activeElement=null}reload(){this.destroy(),this.initialize()}createStub(e){const i=document.createElement("div");return i.className="text-gray-400 text-sm p-4 border border-gray-600 rounded",i.textContent=e,i}}function fb(t){return b("div",{class:"flex justify-between items-center mb-6 border-b border-purple-700 pb-2 z-10"},b("div",{class:"flex gap-4 text-xl select-none"},...t.map(e=>b("span",{class:["settings-tab","hover:text-white hover:scale-110 transition-all duration-150 cursor-pointer",e.isActive?"text-purple-500":"text-gray-300"].join(" "),dataset:{tab:e.key},title:e.title,textContent:e.icon}))))}class pb{constructor(){this.globalSection=b("div",{id:"userconfig-global-settings",class:"settings-section z-10"}),this.themeSection=b("div",{id:"userconfig-theme-settings",class:"settings-section hidden z-10"}),this.aiSection=b("div",{id:"userconfig-ai-settings",class:"settings-section hidden z-10"});const e=fb([{key:"global-settings",icon:"",title:"Global Settings",isActive:!0},{key:"theme-settings",icon:"",title:"Theme Settings"},{key:"ai-settings",icon:"",title:"AI Settings"}]);this.saveButton=V({id:"userconfig-save",text:"Save",kind:"primary"}),this.closeButton=V({id:"userconfig-close-bottom",text:"Cancel",kind:"secondary"});const i=b("div",{class:"flex gap-3 mt-4 z-10"},this.saveButton,this.closeButton);this.modal=$e("userconfig-modal",[e,this.globalSection,this.themeSection,this.aiSection,i]),document.body.appendChild(this.modal)}render(){return this.modal}show(){this.modal.classList.remove("hidden")}hide(){this.modal.classList.add("hidden")}destroy(){this.modal.remove()}getSectionContainer(e){switch(e){case"global":return this.globalSection;case"theme":return this.themeSection;case"ai":return this.aiSection}}getSaveButton(){return this.saveButton}getCloseButton(){return this.closeButton}getTabs(){return this.modal.querySelectorAll(".settings-tab")}getSections(){return this.modal.querySelectorAll(".settings-section")}}function mb(){const{trigger:t,tooltip:e}=Vt("tooltip-note-mode","?",[ne(Ut("Default Mode:")," gesture-based note placement. Allows click-and-drag selection and edit gestures."),ne(Ut("Express Mode:")," notes are placed immediately on mouse down. Holding allows drag-resizing. Right-click initiates multi-note selection.")]),i=zt({id:"note-tool-toggle",label:"Note Placement:",stateA:"Classic",stateB:"Express",tooltipTrigger:t});i.input.addEventListener("change",()=>{const s=i.getChecked()?"express":"default";Re({global:{noteToolMode:s}})});const r=()=>{const s=oe().global.noteToolMode;i.setChecked(s==="express")};return{element:b("div",{},Tt("Global Settings"),i.element,e),refreshToggle:r}}const yb=["Default","Blue Dream","Modern Light","Synthwave","Verdant Alloy","Sunset"],gb=["Darkroom","Seashell","Cyberpunk","Classic Blue","Midnight"],vb=["Track Color","Note Velocity","Pitch Class Contrast","Scriabin","Octave Bands"];function _b(){const t=gb.map(r=>b("option",{value:r,textContent:r})),e=vb.map(r=>b("option",{value:r,textContent:r})),i=yb.map(r=>b("option",{value:r,textContent:r}));return b("div",{},Tt("Theme Settings"),b("div",{className:"mb-6"},he("Interface Skin"),b("select",{id:"skin-select",className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 focus:outline-none focus:border-purple-500 cursor-pointer"},...i)),b("div",{className:"mb-6"},he("Grid Color Scheme"),b("select",{id:"grid-color-select",className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 focus:outline-none focus:border-purple-500 cursor-pointer"},...t)),b("div",{className:"mb-6"},he("Note Color Scheme"),b("select",{id:"note-color-select",className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 focus:outline-none focus:border-purple-500 cursor-pointer"},...e)))}const bb=[{value:"gpt-4o",label:"gpt-4o"},{value:"gpt-4o-mini",label:"gpt-4o-mini"},{value:"gpt-4.1",label:"gpt-4.1"},{value:"gpt-4.1-mini",label:"gpt-4.1-mini"},{value:"o3-mini",label:"o3-mini"},{value:"o4-mini",label:"o4-mini",className:"bg-green-700 text-white"}];function Mb(){const t=bb.map(s=>b("option",{value:s.value,className:s.className,textContent:s.label})),{trigger:e,tooltip:i}=Vt("tooltip-openai-key","?",["You must provide an OpenAI API key to use AI features.",ne("Visit ",b("a",{href:"https://platform.openai.com/account/api-keys",target:"_blank",class:"text-blue-400 underline hover:text-blue-300"},"platform.openai.com")," to manage your key.")]),{trigger:r,tooltip:n}=Vt("tooltip-openai-model","?",["Different models offer varying performance and response quality.",ne("Models marked in ",b("span",{class:"text-green-400 font-semibold"},"green")," are recommended for best results."),"We will add support for new models as they become available."]);return b("div",{},Tt("AI Configuration"),b("div",{class:"mb-6"},he("OpenAI API Key",e),b("input",{type:"password",id:"openai-key-input",placeholder:"sk-...",className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 focus:outline-none focus:border-purple-500"}),i),b("div",{class:"mb-8"},he("OpenAI Model",r),b("select",{id:"openai-model-select",className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 focus:outline-none focus:border-purple-500 cursor-pointer"},...t),n))}function wb(t,e={}){const i=t.getTabs(),r=t.getSections(),n=t.getCloseButton(),s=t.getSaveButton(),a=d=>{r.forEach(f=>{f.classList.add("hidden")});const u=document.getElementById(`userconfig-${d}`);u&&u.classList.remove("hidden"),i.forEach(f=>{const h=f.dataset.tab===d;f.classList.toggle("text-purple-500",h),f.classList.toggle("opacity-100",h),f.classList.toggle("text-gray-300",!h),f.classList.toggle("opacity-50",!h)})},o=[];i.forEach(d=>{const u=d.dataset.tab;if(!u)return;const f=()=>a(u);d.addEventListener("click",f),o.push(()=>d.removeEventListener("click",f))});const l=()=>{var d;(d=e.onClose)==null||d.call(e),t.hide()},c=()=>{var u;(u=e.onSave)==null||u.call(e);const d=K();d.name,_t.getInstance().reloadAll(),t.hide()};return n.addEventListener("click",l),s.addEventListener("click",c),(()=>{const d=Array.from(i).find(u=>u.classList.contains("text-purple-500"));d!=null&&d.dataset.tab&&a(d.dataset.tab)})(),()=>{o.forEach(d=>d()),n.removeEventListener("click",l),s.removeEventListener("click",c)}}function Sb(t){const e=t.querySelector("#openai-key-input"),i=t.querySelector("#openai-model-select"),r=()=>{var o;const a=oe();e&&(e.value=a.ai.openaiApiKey||""),i&&(i.value=a.ai.openaiModel||((o=i.options[0])==null?void 0:o.value)||"")},n=a=>{const o=a.target;Re({ai:{openaiApiKey:o.value}})},s=a=>{const o=a.target;Re({ai:{openaiModel:o.value}})};return e==null||e.addEventListener("input",n),i==null||i.addEventListener("change",s),r(),{detach:()=>{e==null||e.removeEventListener("input",n),i==null||i.removeEventListener("change",s)},refreshUI:r}}function Cb(t){const e=t.querySelector("#grid-color-select"),i=t.querySelector("#note-color-select"),r=t.querySelector("#skin-select"),n=()=>{var c,d,u;const l=oe();e&&(e.value=l.theme.gridColorScheme||((c=e.options[0])==null?void 0:c.value)||""),i&&(i.value=l.theme.noteColorScheme||((d=i.options[0])==null?void 0:d.value)||""),r&&(r.value=l.theme.skin||((u=r.options[0])==null?void 0:u.value)||"")},s=l=>{const c=l.target;Re({theme:{gridColorScheme:c.value}})},a=l=>{const c=l.target;Re({theme:{noteColorScheme:c.value}})},o=l=>{const c=l.target;Re({theme:{skin:c.value}})};return e==null||e.addEventListener("change",s),i==null||i.addEventListener("change",a),r==null||r.addEventListener("change",o),n(),{detach:()=>{e==null||e.removeEventListener("change",s),i==null||i.removeEventListener("change",a),r==null||r.removeEventListener("change",o)},refreshUI:n}}function Pb(t){const e=t.querySelector("#note-tool-toggle");if(!e)return console.warn("[GlobalSettings] Toggle input not found."),{detach:()=>{},refreshUI:()=>{}};const i=()=>{const n=oe();e.checked=n.global.noteToolMode==="express"},r=n=>{const a=n.target.checked?"express":"default";Re({global:{noteToolMode:a}}),Bt().forEach(o=>o.resetInteractionMode())};return e.addEventListener("change",r),i(),{detach:()=>e.removeEventListener("change",r),refreshUI:i}}const Nc="userConfig";function Nb(){const t=oe();rn(Nc,t)}function kb(){const t=nn(Nc);t&&Re(t)}kb();class xb{constructor(){this.modal=null,this.detachFns=[],this.refreshFns=[],this.initialSnapshot=structuredClone(oe()),this.initializeUI()}initializeUI(){this.modal=new pb;const e=mb(),i=_b(),r=Mb();this.modal.getSectionContainer("global").appendChild(e.element),this.modal.getSectionContainer("theme").appendChild(i),this.modal.getSectionContainer("ai").appendChild(r);const n=wb(this.modal,{onSave:()=>Nb(),onClose:()=>Re(this.initialSnapshot)}),s=Pb(e.element),a=Cb(i),o=Sb(r);this.detachFns.push(n,s.detach,a.detach,o.detach),this.refreshFns.push(s.refreshUI,a.refreshUI,o.refreshUI,e.refreshToggle),Fi(),document.body.appendChild(this.modal.render())}show(){var e;this.initialSnapshot=structuredClone(oe()),this.refreshFns.forEach(i=>i()),(e=this.modal)==null||e.show()}hide(){var e;(e=this.modal)==null||e.hide()}destroy(){var e;this.detachFns.forEach(i=>i()),(e=this.modal)==null||e.destroy(),this.modal=null,this.detachFns=[],this.refreshFns=[]}reload(){this.destroy(),this.initializeUI()}}function Lb(){document.getElementById("add-sequencer").addEventListener("click",()=>{const e=j.length;D(zd(e,"sf2/fluidr3-gm/acoustic_grand_piano"),ta(e))})}Yf();g0();v0();const Wi=_t.getInstance();Zv();const kc=new xb;Wi.registerReloadable(()=>kc.reload());const R=new S0(Bt()),Eb=new hb;Wi.registerReloadable(()=>Eb.reload());const xc=new H_(R,kc);Wi.registerReloadable(()=>xc.reload());xc.show();const Le=new Y_(()=>{console.warn("User cancelled loading.")});Wi.registerReloadable(()=>Le.reload());const Lc=new ib;Wi.registerReloadable(()=>Lc.reload());Lc.show();on(w0);const Xo=0,Ab="sf2/fluidr3-gm/acoustic_grand_piano";D(zd(Xo,Ab),ta(Xo));D(na("Initial App State"),Xd("Initial App State"));J("Setting up additional UI...");Z_(Og,Dg);Lb();Zf();Al("Sequenzia initialized");J("Current config: ",Vi);J("Current sequencers: ",j[0]);J("Current state: ",H());export{R as engine,Le as popupsController,Eb as topControlsController};
